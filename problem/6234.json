{"title":"Square Network","time_limit":8000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6234","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6234&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6234","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6234"},"statement":[{"title":"Problem Description","content":"Alice and Bob are extremely happy recently. Because the school assigns a new machine room to their lab. They are in charge of setting up a group of servers. In the room, there are $N \\times N$ blanks to put servers. Alice wants the arrangement of servers to be elegant, so she thinks that some blanks must be empty, while others must not be empty. According to the need of lab, Bob is planning to purchase $K$ types of severs. Moreover, he gives $T$ groups of blanks, where one blank might be contained in different groups. Each group has exactly $K$ blanks, and any two of servers in the blanks of one group must not be the same type. Now, some servers has been put in some blank, which can not be changed. With all these conditions, Alice and Bob want to know how many ways that they can arrange the machine room.<br>","type":"description","format":"html"},{"title":"Input","content":"The first line is the number of test cases.<br>For each test case, the first line consists of three integers $N$, $K$, and $T (N, K \\leq 6, T\\leq 12)$.<br>In the next $N$ lines, each line consists of $N$ integers $A_{i, j}$.If $A_{i, j} = -1$, the blank $(i, j)$ must be empty. If $A_{i, j} = 0$, a server is require to put on this blank. Otherwise, a server of type $A_{i, j}$ is on this blank.<br>In the next $T$ lines, each line consists of $K$ pair of integers. Each pair of integers donate the coordinate of blank in this group.","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output an integer donating the ways that Alice and Bob can arrange the room. If the solution is larger than $20172017$, output `TOO MANY`.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n3 3 4\n0 0 1\n0 -1 0\n0 0 0\n1 1 1 2 1 3\n1 1 2 1 3 1\n1 3 2 3 3 3\n3 1 3 2 3 3\n5 5 0\n0 0 0 0 0\n0 0 0 0 0\n0 0 0 0 0\n0 0 0 0 0\n0 0 0 0 0</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">6\nTOO MANY</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2017%D6%D0%B9%FA%B4%F3%D1%A7%C9%FA%B3%CC%D0%F2%C9%E8%BC%C6%BE%BA%C8%FC-%B9%FE%B6%FB%B1%F5%D5%BE-%D6%D8%CF%D6%C8%FC%A3%A8%B8%D0%D0%BB%B9%FE%C0%ED%B9%A4%A3%A9&amp;source=1&amp;searchmode=source\"> 2017&#xFFFD;&#x439;&#xFFFD;&#xFFFD;&#xFFFD;&#x467;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#x1BE;&#xFFFD;&#xFFFD;&#xFFFD;-&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#x57E;-&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#x43B;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD; </a> ","type":"source","format":"html"}]}