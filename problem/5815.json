{"title":"Golden Week","time_limit":1000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5815","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5815&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5815","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5815"},"statement":[{"title":"Problem Description","content":"The ACM kingdom has N cities, numbered from 1 to N. The capital is numbered 1. There are N &#x2013; 1 roads each connecting two cities in the kingdom such that there exactly one path between any pair of cities.<br><br>Now the Golden Week Vocation is coming. M travelers living in the capital are going to travel to other cities. Every traveler will start from the capital, and the ith traveler has chosen city Ci as his destination. As a manager of the travel agencies, Mr. Chopsticks decides to assign prices to the roads in the kingdom during the vocation. After some investigation, Mr. Chopsticks has found that every traveler has a budget for his trip, and if the total price of the roads in the path from the capital to his destination city is larger than his budget, he will give up his trip; otherwise he will pay for it to the travel agencies. Mr. Chopsticks wants to assign prices to roads so as to maximize the agencies&#x2019; revenue. Could you help him? Each road should be assigned a price between 0 and 1000,000,000 inclusive.<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The input begins with an integer T (T&lt;=50), indicating the number of test cases. Each case begins with two integers N and M (2 &lt;= N &lt;= 1000, 1 &lt;= M &lt;= 1000), indicating the number of cities and the number of travelers respectively. Then N &#x2013; 1 lines follow, where the ith line contains two integers $u_i$ and $v_i$ $(1 \\leq u_i, v_i \\leq N)$ indicating that the ith road connects the cities $u_i$ and $v_i$. The next M lines each contain two integers $C_i$ and $B_i$ $(1 \\leq C_i \\leq N, 1 \\leq B_i \\leq 1000 000 000)$, indicating the ith traveler&#x2019;s destination and budget respectively.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each case, output a line containing the maximum revenue, followed by a line containing N &#x2013; 1 nonnegative integers, separated by one space, in which the ith integer denotes the price of the ith road. If there are multiple optimum solutions, output any of them.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n2 3\n1 2\n2 3\n2 5\n2 9\n4 4\n1 2\n1 3\n2 4\n2 4\n2 7\n4 5\n3 6</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">10\n5\n19\n4 6 1</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Author","content":"SYSU","type":"source","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2016+Multi-University+Training+Contest+7&amp;source=1&amp;searchmode=source\"> 2016 Multi-University Training Contest 7 </a> ","type":"source","format":"html","require":["katex"]}]}