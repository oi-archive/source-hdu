{"title":"Rainbow Graph","time_limit":10000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6455","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6455&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6455","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6455"},"statement":[{"title":"Problem Description","content":"A graph without loops or multiple edges is known as a simple graph.<br><br>A vertex-colouring is an assignment of colours to each vertex of a graph.<br>A proper vertex-colouring is a vertex-colouring in which no edge connects two identically coloured vertices.<br><br>A vertex-colouring with $n$ colours of an undirected simple graph is called an $n$-rainbow colouring if every colour appears once, and only once, on all the adjacent vertices of each vertex.<br>Note that an $n$-rainbow colouring is not a proper colouring, since adjacent vertices may share the same colour.<br><br>An undirected simple graph is called an $n$-rainbow graph if the graph can admit at least one legal $n$-rainbow colouring.<br>Two $n$-rainbow graphs $G$ and $H$ are called isomorphic if, between the sets of vertices in $G$ and $H$, a bijective mapping $f: V(G) \\to V(H)$ exists such that two vertices in $G$ are adjacent if and only if their images in $H$ are adjacent.<br><br>Your task in this problem is to count the number of distinct non-isomorphic $n$-rainbow graphs having $2 n$ vertices and report that number modulo a prime number $p$.<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The input contains several test cases, and the first line contains a positive integer $T$ indicating the number of test cases which is up to $1000$.<br><br>For each test case, the only line contains two integers $n$ and $p$ where $1 \\le n \\le 64$, $n + 1 \\le p \\le 2^{30}$ and $p$ is a prime.<br><br>We guarantee that the numbers of test cases satisfying $n \\ge 16$, $n \\ge 32$ and $n \\ge 48$ are no larger than $200$, $100$ and $20$ respectively.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, output a line containing &quot;Case #x: y&quot; (without quotes), where $x$ is the test case number starting from $1$, and $y$ is the answer modulo $p$.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5\n1 11059\n2 729557\n3 1461283\n4 5299739\n63 49121057</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1: 1\nCase #2: 1\nCase #3: 2\nCase #4: 3\nCase #5: 5694570\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nIf you came up with a solution such that the time complexity is asymptotic to p(n), the number of partitions of n, or similar, you might want to know p(16) = 231, p(32) = 8349, p(48) = 147273 and  p(64) = 1741630.\nThe following figures illustrate all the non-isomorphic rainbow graphs mentioned in the first four sample cases.\n\n<center><img src=\"../../../data/images/C755-1007-1.jpg\"></center>\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=The+43rd+ACM+International+Collegiate+Programming+Contest+Asia+Shenyang+Regional+Contest&amp;source=1&amp;searchmode=source\"> The 43rd ACM International Collegiate Programming Contest Asia Shenyang Regional Contest </a> ","type":"source","format":"html","require":["katex"]}]}