{"title":"LCP Array","time_limit":2000,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5635","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5635&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5635","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5635"},"statement":[{"title":"Problem Description","content":"Peter has a string $s=s_{1}s_{2}...s_{n}$, let $\\text{suff}_i =s_{i}s_{i+1}...s_{n}$ be the suffix start with $i$-th character of $s$. Peter knows the lcp (longest common prefix) of each two adjacent suffixes which denotes as $a_i = \\text{lcp}(\\text{suff}_i, \\text{suff}_{i+1}) \\quad (1 \\le i &lt; n$).<br><br>Given the lcp array, Peter wants to know how many strings containing lowercase English letters only will satisfy the lcp array. The answer may be too large, just print it modulo $10^9 + 7$.","type":"description","format":"html"},{"title":"Input","content":"There are multiple test cases. The first line of input contains an integer $T$ indicating the number of test cases. For each test case:<br><br>The first line contains an integer $n$ ($2 \\le n \\le 10^5)$ -- the length of the string. The second line contains $n - 1$ integers: $a_1,a_2,...,a_{n-1}$ $(0 \\le a_i \\le n)$.<br><br>The sum of values of $n$ in all test cases doesn&apos;t exceed $10^6$.","type":"input_format","format":"html"},{"title":"Output","content":"For each test case output one integer denoting the answer. The answer must be printed modulo $10^9+7$.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n3\n0 0\n4\n3 2 1\n3\n1 2</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">16250\n26\n0</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=BestCoder+Round+%2374+%28div.2%29&amp;source=1&amp;searchmode=source\"> BestCoder Round #74 (div.2) </a> ","type":"source","format":"html"}]}