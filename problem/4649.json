{"title":"Professor Tian","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4649","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4649&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4649","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4649"},"statement":[{"title":"Problem Description","content":"Timer took the Probability and Mathematical Statistics course in the 2012, But his bad attendance angered Professor Tian who is in charge of the course. Therefore, Professor Tian decided to let Timer face a hard probability problem, and announced that if he fail to slove the problem there would be no way for Timer to pass the final exam. <br>As a result , Timer passed. <br>Now, you, the bad guy, also angered the Professor Tian when September Ends. You have to faced the problem too.  The problem comes that there is an expression and you should calculate the excepted value of it. And the operators it may contains are &apos;&amp;&apos; (and),&apos;|&apos;(or) and &apos;^&apos;(xor) which are all bit operators.  For example: 7&amp;3=3, 5&amp;2=0, 2|5=7, 4|10=14, 6^5=3, 3^4=7.<br>Professor Tian declares that each operator O<sub>i</sub> with its coming number A<sub>i+1</sub> may disappear, and the probability that it happens is P<sub>i</sub> (0&lt;i&lt;=n). <br>","type":"description","format":"html"},{"title":"Input","content":"The input contains several test cases. For each test case, there is a integer n (0&lt;n&lt;=200) in the first line.In the second line, there are n+1 integers, stand for {A<sub>i</sub>}. The next line contains n operators ,stand for {O<sub>i</sub>}. The forth line contains {P<sub>i</sub>}. <br>A<sub>i</sub> will be less than 2<sup>20</sup>, 0&lt;=P<sub>i</sub>&lt;=1.","type":"input_format","format":"html"},{"title":"Output","content":"For each text case, you should print the number of text case in the first line.Then output the excepted value of the expression, round to 6 decimal places.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n1 2 3\n^ ^\n0.1 0.2\n2\n8 9 10\n^ ^\n0.5 0.78\n1\n1 2\n&amp;\n0.5</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1:\n0.720000\nCase 2:\n4.940000\nCase 3:\n0.500000</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2013+Multi-University+Training+Contest+5&amp;source=1&amp;searchmode=source\"> 2013 Multi-University Training Contest 5 </a> ","type":"source","format":"html"}]}