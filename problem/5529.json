{"title":"Play a game","time_limit":4000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5529","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5529&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5529","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5529"},"statement":[{"title":"Problem Description","content":"Andy and Andrew are very smart guys and they like to play all kinds of games in their spare time. The most amazing thing is that they always find the best strategy, and that&apos;s why they feel bored again and again. They just invented a new game, as they usually did.<br><br>At the beginning of the game, they write down one string $S=s_1s_2s_3 \\ldots  s_k$, and then they take turns(Andy first) to either:<br><br>1. Erase the leftmost character from $S$, that is, $S=s_2s_3s_4 \\ldots s_k$. <br>2. Erase the rightmost character from $S$, that is, $S=s_1s_2s_3 \\ldots s_{k-1}$.<br><br>Whenever $S$ is empty or $S \\in A$ ($A$ is a given list of strings), the player which plays next loses the game.<br><br>For example, let $S=dzxx$ and $A=\\{z,dz\\}$. If Andy erases &apos;x&apos; then Andrew can erase another &apos;x&apos;, because $S=dz$ and $dz$ is in $A$, Andy, the next player, loses. Otherwise, Andy erases &apos;d&apos;, and then Andrew can erase &apos;z&apos; result in a losing position for Andy.<br><br>You are given a string $T=t_1t_2t_3\\ldots t_n$ and a list of string $A=\\{a_1,a_2,\\ldots,a_m\\}$. Your task is to find who is the winner if $S$ is some substring of $T$. Andy and Andrew play so many times so you need to answer multiple queries.","type":"description","format":"html"},{"title":"Input","content":"The first line contains an integer $t$ indicating the total number of test cases. The following lines describe a test case.<br><br>The first line of each case contains three integers $n$, $m$, $q$, the length of $T$, the size of $A$, and the number of queries.The second line contains a string, representing $T$. Next $m$ lines, each line consists of a string, representing $a_i$. Next $q$ lines, each line consists of two integers $l,r$, representing a query that you should output who is the winner if $S=t_lt_{l+1} \\ldots t_{r}$.<br><br>$1 \\le t \\le 21$<br>$1 \\le n, q \\le 40000$<br>$1 \\le m \\le 10000$<br>$1 \\le \\sum\\limits_{i=1}^{m}|a_i| \\le 10000$<br>$1 \\le l \\le r \\le n$<br>$T$ and strings in $A$ consist of lowercase English letters.<br>There are at most 6 test cases with $n&gt;5000$.","type":"input_format","format":"html"},{"title":"Output","content":"For each query, if Andy wins, print &quot;1&quot; (without the quotes) on a single line, otherwise print &quot;0&quot; (without the quotes) on a single line.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n10 4 10\nzzzabcdzxx\na\nz\ndz\nabcd\n1 3\n1 4\n3 6\n3 7\n3 8\n3 9\n4 4\n4 5\n5 5\n7 10</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">0\n1\n1\n1\n0\n1\n0\n1\n1\n0</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2015ACM%2FICPC%D1%C7%D6%DE%C7%F8%B3%A4%B4%BA%D5%BE-%D6%D8%CF%D6%C8%FC%A3%A8%B8%D0%D0%BB%B6%AB%B1%B1%CA%A6%B4%F3%A3%A9&amp;source=1&amp;searchmode=source\"> 2015ACM/ICPC&#x4E9A;&#x6D32;&#x533A;&#x957F;&#x6625;&#x7AD9;-&#x91CD;&#x73B0;&#x8D5B;&#xFF08;&#x611F;&#x8C22;&#x4E1C;&#x5317;&#x5E08;&#x5927;&#xFF09; </a> ","type":"source","format":"html"}]}