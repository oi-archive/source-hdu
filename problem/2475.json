{"title":"Box","time_limit":5000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=2475","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=2475&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=2475","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=2475"},"statement":[{"title":"Problem Description","content":"There are N boxes on the ground, which are labeled by numbers from 1 to N. The boxes are magical, the size of each one can be enlarged or reduced arbitrarily.<br>Jack can perform the &#x201C;MOVE x y&#x201D; operation to the boxes: take out box x; if y = 0, put it on the ground; Otherwise, put it inside box y. All the boxes inside box x remain the same. It is possible that an operation is illegal, that is, if box y is contained (directly or indirectly) by box x, or if y is equal to x.<br>In the following picture, box 2 and 4 are directly inside box 6, box 3 is directly inside box 4, box 5 is directly inside box 1, box 1 and 6 are on the ground.<br><img style=\"max-width:100%;\" src=\"../../data/images/C165-1002-1.jpg\"><br>The picture below shows the state after Jack performs &#x201C;MOVE 4 1&#x201D;:<br><img style=\"max-width:100%;\" src=\"../../data/images/C165-1002-2.jpg\"><br>Then he performs &#x201C;MOVE 3 0&#x201D;, the state becomes:<br><img style=\"max-width:100%;\" src=\"../../data/images/C165-1002-3.jpg\"><br>During a sequence of MOVE operations, Jack wants to know the root box of a specified box. The root box of box x is defined as the most outside box which contains box x. In the last picture, the root box of box 5 is box 1, and box 3&#x2019;s root box is itself.","type":"description","format":"html"},{"title":"Input","content":"Input contains several test cases.<br>For each test case, the first line has an integer N (1 &lt;= N &lt;= 50000), representing the number of boxes.<br>Next line has N integers: a1, a2, a3, ... , aN (0 &lt;= ai &lt;= N), describing the initial state of the boxes. If ai is 0, box i is on the ground, it is not contained by any box; Otherwise, box i is directly inside box ai. It is guaranteed that the input state is always correct (No loop exists).<br>Next line has an integer M (1 &lt;= M &lt;= 100000), representing the number of MOVE operations and queries.<br>On the next M lines, each line contains a MOVE operation or a query:<br>1.&#xA0;&#xA0;MOVE x y, 1 &lt;= x &lt;= N, 0 &lt;= y &lt;= N, which is described above. If an operation is illegal, just ignore it.<br>2.&#xA0;&#xA0;QUERY x, 1 &lt;= x &lt;= N, output the root box of box x.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each query, output the result on a single line. Use a blank line to separate each test case.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n0 1\n5\nQUERY 1\nQUERY 2\nMOVE 2 0\nMOVE 1 2\nQUERY 1\n6\n0 6 4 6 1 0\n4\nMOVE 4 1\nQUERY 3\nMOVE 1 4\nQUERY 1</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n1\n2\n\n1\n1</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2008+Asia+Regional+Chengdu&amp;source=1&amp;searchmode=source\"> 2008 Asia Regional Chengdu </a> ","type":"source","format":"html"}]}