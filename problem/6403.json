{"title":"Card Game","time_limit":3000,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6403","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6403&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6403","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6403"},"statement":[{"title":"Problem Description","content":"Alice and Bob are playing a card game. In this card game, a number is written on each face of the playing card. The rule of the game is described as follows:<br><br>- Alice arranges the cards in a row, and for each of the cards, she chooses one of its faces to place it up;<br>- Bob turns over minimum number of cards to make all numbers on the front faces unique.<br><br>They play the game some times, and Bob always succeeds making the numbers unique. However, both of them are not sure whether the number of cards flipped is minimum. Moreover, they want to figure out the number of different ways of turning over minimum number of cards to make the numbers unique. Two ways are considered equal if and only if the sets of flipped cards are equal. Please write a program to help them!","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line of the input is a single integer $T$ $(1 \\leq T \\leq 50)$, the number of test cases.<br><br>Each test case begins with a single line of integer $n$ $(1 \\leq n \\leq 10^5)$, the number of cards on the table. Then follow $n$ lines, specifying the cards that Alice arranges. Each of these $n$ lines contains two integers $x, y$ $(1 \\leq x, y \\leq 2n)$, meaning that Alice places a card with number $x$ on the front face and number $y$ on the back face.<br><br>It is guaranteed that the sum of $n$ over all test cases does not exceed $10^6$.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, display two integers in a line, the minimum number of cards to turn over, and the number of different ways of flipping modulo $998244353$, respectively. If it is impossible to turn over cards to make all numbers unique, display $\\texttt{-1 -1}$ instead.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n4\n1 2\n1 3\n4 5\n4 6\n2\n1 1\n1 1\n3\n1 2\n3 4\n5 6</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2 4\n-1 -1\n0 1\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nIn the first sample test case, Bob may turn over one of the first two cards and one of the last two cards, so there are four different ways of turning over two cards to\nmake all numbers on the front faces unique. Obviously, this can&apos;t be done with less than two cards flipped.\n\nIn the second sample test case, it is impossible to make all numbers on the front faces unique.\n\nIn the third sample test case, all numbers on the front faces are already distinct.\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2018+Multi-University+Training+Contest+8&amp;source=1&amp;searchmode=source\"> 2018 Multi-University Training Contest 8 </a> ","type":"source","format":"html","require":["katex"]}]}