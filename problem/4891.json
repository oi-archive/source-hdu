{"title":"The Great Pan","time_limit":1000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4891","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4891&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4891","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4891"},"statement":[{"title":"Problem Description","content":"   As a programming contest addict, Waybl is always happy to take part in various competitive programming contests. One day, he was competing at a regional contest of Inventing Crappy Problems Contest(ICPC). He tried really hard to solve a &quot;geometry&quot; task without success.<br><br>   After the contest, he found that the problem statement is ambiguous! He immediately complained to jury. But problem setter, the Great Pan, told him &quot;There are only four possibilities, why don&apos;t you just try all of them and get Accepted?&quot;.<br><br>   Waybl was really shocked. It is the first time he learned that enumerating problem statement is as useful as trying to solve some ternary search problem by enumerating a subset of possible angle!<br><br>   Three years later, while chatting with Ceybl, Waybl was told that some problem &quot;setters&quot; (yeah, other than the Great Pan) could even change the whole problem 30 minutes before the contest end! He was again shocked.<br><br>   Now, for a given problem statement, Waybl wants to know how many ways there are to understand it.<br><br>   A problem statement contains only newlines and printable ASCII characters (32 &#xFFFD;&#xFFFD; their ASCII code &#xFFFD;&#xFFFD; 127) except &apos;{&apos;, &apos;}&apos;, &apos;|&apos; and &apos;$&apos;.<br><br>   Waybl has already marked all ambiguity in the following two formats:<br><br>    1.{A|B|C|D|...} indicates this part could be understand as A or B or C or D or ....<br>    2.$blah blah$ indicates this part is printed in proportional fonts, it is impossible to determine how many space characters there are.<br><br>   Note that A, B, C, D won&apos;t be duplicate, but could be empty. (indicate evil problem setters addedclarified it later.)<br><br>   Also note that N consecutive spaces lead to N+1 different ways of understanding, not 2<sup>N</sup> ways.<br><br>   It is impossible to escape from &quot;$$&quot; and &quot;{}&quot; markups even with newlines. There won&apos;t be nested markups, i.e. something like &quot;${A|B}$&quot; or &quot;{$A$|B}&quot; or &quot;{{A|B}|C}&quot; is prohibited. All markups will be properly matched.","type":"description","format":"html"},{"title":"Input","content":"   Input contains several test cases, please process till EOF.<br>   For each test case, the first line contains an integer n, indicating the line count of this statement. Next n lines is the problem statement.<br>   1 &#xFFFD;&#xFFFD; n &#xFFFD;&#xFFFD; 1000, size of the input file will not exceed 1024KB.","type":"input_format","format":"html"},{"title":"Output","content":"   For each test case print the number of ways to understand this statement, or &quot;doge&quot; if your answer is more than <b>10<sup>5</sup></b>.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">9\nI&apos;ll shoot the magic arrow several\n times on the ground, and of course\n the arrow will leave some holes\n on the ground. When you connect\n three holes with three line segments,\n you may get a triangle.\n{|It is hole! Common sense!|\nNo Response, Read Problem\n Statement|don&apos;t you know what a triangle is?}\n1\nCase $1: = &gt;$\n5\n$/*This is my code printed in\n proportional font, isn&apos;t it cool?*/\nprintf(&quot;Definitely it is cooooooool \\\n%d\\n&quot;,4 * 4 * 4 * 4 * 4 * 4 * 4 * 4 * 4 \n* 4 * 4 * 4 * 4 * 4 * 4 * 4 * 4 * 4);$\n2\n$Two  space$ and {blue|\nred} color!</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">4\n4\ndoge\n6</div></pre>","type":"example","format":"html"},{"title":"Author","content":"Fudan University","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2014+Multi-University+Training+Contest+3&amp;source=1&amp;searchmode=source\"> 2014 Multi-University Training Contest 3 </a> ","type":"source","format":"html"}]}