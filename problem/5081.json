{"title":"Trie","time_limit":6000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5081","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5081&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5081","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5081"},"statement":[{"title":"Problem Description","content":"Little Bob studied Trie in Data Structure class. He learned that Trie is a rooted tree to store some strings. There is a character on each edge of a Trie. (In this problem, the valid characters are lowercase Latin letters.)<br><br>Bob draws a Trie with n nodes, and the nodes are numbered with integers from 1 to n. The number of the root node is always 1.<br><br>He uses S<sub>i</sub> to denote the string concatenated with characters on the path from the root to node i. It can be seen that S1 is the empty string. Furthermore, for a set P <img style=\"max-width:100%;\" src=\"../../data/images/C549-1012-2.jpg\"> {1, 2, . . . , n}, S<sub>P</sub> = {S<sub>i</sub> | i <img style=\"max-width:100%;\" src=\"../../data/images/C549-1012-3.jpg\"> P}.<br><br>Bob defines a kind of trait on this Trie. The trait can be described with a set P  <img style=\"max-width:100%;\" src=\"../../data/images/C549-1012-2.jpg\"> {1, 2, . . . , n}. We say a string a has this trait, if and only if there exists a string b <img style=\"max-width:100%;\" src=\"../../data/images/C549-1012-3.jpg\"> S<sub>P</sub> such that a ends with b. Here string a ends with string b means the last |b| characters of a is exactly b. (Note that every string ends with the empty string).<br><br>Bob also defines a mapping f on P <img style=\"max-width:100%;\" src=\"../../data/images/C549-1012-2.jpg\">{1, 2, ..., n}, and f (P) is also a subset of {1, 2, . . . , n}. i <img style=\"max-width:100%;\" src=\"../../data/images/C549-1012-3.jpg\"> f (P) if and only if there exists j <img style=\"max-width:100%;\" src=\"../../data/images/C549-1012-3.jpg\"> P such that S<sub>j</sub> ends with S<sub>i</sub>.<br><br>Initially, there is no traits been defined. Bob will add traits whenever he wants. Let D<sub>i</sub> denote the number of traits that S<sub>i</sub> has until now. Note that D<sub>i</sub> may change when a new trait is added.<br><br>Besides adding new traits, Bob may also ask you something about his Trie. In each query, Bob will give you a set P <img style=\"max-width:100%;\" src=\"../../data/images/C549-1012-2.jpg\"> {1, 2, . . . , n}, and you need to compute <img style=\"max-width:100%;\" src=\"../../data/images/C549-1012-4.jpg\">. Are you willing to do this for Bob?","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line contains an integer T (T &#x2264; 5), denoting the number of the test cases.<br><br>For each test case, the first line contains an integer n(1 &#x2264; n &#x2264; 10<sup>5</sup>).<br><br>From the second to the n-th line, this n - 1 lines describe Bob&apos; s Trie.  The i-th line contains an integer u(u &lt; i), and a lowercase letter c, which means that the father of node i is node u and the character on that edge is c. We ensure that for each node i, letters on edges connecting i and its children are all different.<br><br>The next line contains an integer m(m &#x2264; 10<sup>5</sup>), which means there are m operations.<br><br>The next m lines describe all operations. In each line, the first integer indicates the type of this operation. 1 means Bob will add a new trait and 2 means Bob is asking you a question. The second integer k is the size of set P , and the next k integers are the elements of P. We ensure that these k integers are different, and they are all between 1 and n. The total size of the m sets will not be larger than 5&#xB7;10<sup>5</sup>.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, output the answer for each query operation, one answer in a line.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n6\n1 a\n1 b\n1 c\n3 a\n3 b\n5\n1 2 3 4\n2 2 5 6\n1 2 2 3\n2 2 4 5\n2 1 6</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n3\n4</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2014+Asia+AnShan+Regional+Contest&amp;source=1&amp;searchmode=source\"> 2014 Asia AnShan Regional Contest </a> ","type":"source","format":"html","require":["katex"]}]}