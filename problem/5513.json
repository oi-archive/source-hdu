{"title":"Efficient Tree","time_limit":6000,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5513","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5513&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5513","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5513"},"statement":[{"title":"Problem Description","content":"A graph $G$ with $n\\times m$ nodes forms a $n\\times m$ grid with $n\\times m$ vertices.<br>$(n-1)\\times m$ weighted edges connect the vertices of adjacent rows, and $n\\times(m-1)$ weighted edges connect the vertices of adjacent columns.<br><br>A spanning tree of graph $G$ is a subgraph that is a tree and connects all the vertices together.<br>A minimum spanning tree (MST) or minimum weight spanning tree is then a spanning tree with weight less than or equal to the weight of every other spanning tree.<br>Graph $G$ has many different minimum spanning trees.<br>For each MST $T$, the $LRdeg(u)$ of node $u$ is defined as the number of nodes, in the previous column or the previous row connecting with $u$, plus one.<br>And we define $\\tau(T)=\\prod_u LRdeg(u)$ as the product of $LRdeg(u)$ for all nodes.<br><br>Your mission is to find the weight of the minimum spanning tree of graph $G$, and count $\\tau(T)$ of all minimum spanning trees. Two MST(s) are considered different if they contain different subsets of edges.","type":"description","format":"html"},{"title":"Input","content":"The input contains several test cases. The first line of the input is a single integer $t~(1\\le t\\le 32)$ which is the number of test cases. Then $t$ test cases follow.<br><br>For each test case, the first line contains the two integers $n~(1\\le n\\le 800)$ and $m~(1\\le m\\le 7)$.<br>Each line of the next $n$ lines contains $m-1$ integers, which describe the weights of edges connecting the vertices of adjacent columns.<br>And each line of the next $n-1$ lines contains $m$ integers, which describe the weights of edges connecting the vertices of adjacent rows. The weights of edges are no more than $10$.","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, you should output two integers in one line. The first one is the weight of the minimum spanning tree.<br>The second one is the sum of $\\tau(T)$ for all different minimum spanning trees, modulo $10^9+7$.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n\n2 5\n9 8 5 6\n4 6 2 3\n1 7 8 3 8\n\n5 5\n8 10 5 4\n1 7 7 7\n5 4 5 5\n3 2 2 2\n8 7 8 3\n8 5 7 8 6\n10 3 2 4 3\n8 7 2 8 9\n9 4 8 3 9</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1: 37 288\nCase #2: 96 4478976</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2015ACM%2FICPC%D1%C7%D6%DE%C7%F8%C9%F2%D1%F4%D5%BE-%D6%D8%CF%D6%C8%FC%A3%A8%B8%D0%D0%BB%B6%AB%B1%B1%B4%F3%D1%A7%A3%A9&amp;source=1&amp;searchmode=source\"> 2015ACM/ICPC&#x4E9A;&#x6D32;&#x533A;&#x6C88;&#x9633;&#x7AD9;-&#x91CD;&#x73B0;&#x8D5B;&#xFF08;&#x611F;&#x8C22;&#x4E1C;&#x5317;&#x5927;&#x5B66;&#xFF09; </a> ","type":"source","format":"html"}]}