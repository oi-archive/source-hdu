{"title":"Hike on a Graph","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=1252","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=1252&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=1252","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=1252"},"statement":[{"title":"Problem Description","content":"&quot;Hike on a Graph&quot; is a game that is played on a board on which an undirected graph is drawn. The graph is complete and has all loops, i.e. for any two locations there is exactly one arrow between them. The arrows are coloured. There are three players, and each of them has a piece. At the beginning of the game, the three pieces are in fixed locations on the graph. In turn, the players may do a move. A move consists of moving one&apos;s own piece along an arrow to a new location on the board. The following constraint is imposed on this: the piece may only be moved along arrows of the same colour as the arrow between the two opponents&apos; pieces. <br><br>In the sixties (&quot;make love not war&quot;) a one-person variant of the game emerged. In this variant one person moves all the three pieces, not necessarily one after the other, but of course only one at a time. Goal of this game is to get all pieces onto the same location, using as few moves as possible. Find out the smallest number of moves that is necessary to get all three pieces onto the same location, for a given board layout and starting positions.<br><br><center><img style=\"max-width:100%;\" src=\"/data/images/c15-1002-1.gif\"></center><br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The input file contains several test cases. Each test case starts with the number n. Input is terminated by n=0. Otherwise, 1&lt;=n&lt;=50. Then follow three integers p1, p2, p3 with 1&lt;=pi&lt;=n denoting the starting locations of the game pieces. The colours of the arrows are given next as a m&#xD7;m matrix of whitespace-separated lower-case letters. The element mij denotes the colour of the arrow between the locations i and j. Since the graph is undirected, you can assume the matrix to be symmetrical. <br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case output on a single line the minimum number of moves required to get all three pieces onto the same location, or the word &quot;impossible&quot; if that is not possible for the given board and starting locations.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3 1 2 3\nr b r\nb b b\nr b r\n2 1 2 2\ny g\ng y\n0</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\nimpossible</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=University+of+Ulm+Local+Contest+2000&amp;source=1&amp;searchmode=source\"> University of Ulm Local Contest 2000 </a> ","type":"source","format":"html","require":["katex"]}]}