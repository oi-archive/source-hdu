{"title":"Cut Pieces","time_limit":2000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4655","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4655&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4655","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4655"},"statement":[{"title":"Problem Description","content":"Suppose we have a sequence of n blocks. Then we paint the blocks. Each block should be painted a single color and block i can have color 1 to color a<sub>i</sub>. So there are a total of prod(a<sub>i</sub>)  different ways to color the blocks. <br>Consider one way to color the blocks. We call a consecutive sequence of blocks with the same color a &quot;piece&quot;. For example, sequence &quot;Yellow Yellow Red&quot; has two pieces and sequence &quot;Yellow Red Blue Blue Yellow&quot; has four pieces. What is S, the total number of pieces of all possible ways to color the blocks? <br><br>This is not your task. Your task is to permute the blocks (together with its corresponding a<sub>i</sub>) so that S is maximized. ","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"First line, number of test cases, T. <br>Following are 2*T lines. For every two lines, the first line is n, length of sequence; the second line contains n numbers, a<sub>1</sub>, ..., a<sub>n</sub>. <br><br>Sum of all n &lt;= 10<sup>6</sup>. <br>All numbers in the input are positive integers no larger than 10<sup>9</sup>.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"Output contains T lines. <br>Each line contains one number, the answer to the corresponding test case. <br>Since the answers can be very large, you should output them modulo 10<sup>9</sup>+7. <br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n3\n1 2 3</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">14\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nBoth sequence 1 3 2 and sequence 2 3 1 result in an S of 14. \n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2013+Multi-University+Training+Contest+6&amp;source=1&amp;searchmode=source\"> 2013 Multi-University Training Contest 6 </a> ","type":"source","format":"html","require":["katex"]}]}