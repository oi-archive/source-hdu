{"title":"Harry Potter and Cyber Sequence Generator","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4382","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4382&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4382","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4382"},"statement":[{"title":"Problem Description","content":"    After Voldemort and the Death Eater were wiped out by Harry Potter and his friends, Harry becomes the glory of the Wizarding World, magician treat him as model, hero, king&#x2026; and much more than that.<br>&#xA0;&#xA0;  Recently Harry Potter and his friends have been researching a kind of toy from the Muggle World, with the name Cyber Sequence Generator, wondering if after manipulated in some certain way, it can be useful and powerful for magicians.<br>&#x3000;&#x3000;This kind of generator has two magic containers C1 and C2, if we put a magic element in C1, after its magic is all over, the result magic element can be taken from C2. Because we Muggles(I&#x2019;m sorry if you are not a muggle, you can ask me for magic student version of this problem statement even you are competing and can&#x2019;t use the Internet) do not know magic languages, let&#x2019;s rearrange the words to describe how the generator works.<br>&#x3000;&#x3000;The generator&#x2019;s work can be split into simple works. Each work is like:<br><pre><br>     SET|ADD    C1|C2,    C1|C2|IntegerNumber<br>     MUL        C1|C2,    IntegerNumber<br></pre><br>By &#x201C;SET a,b &#x201C;, we have the value of the element in container a changed to b<br>By &#x201C;ADD a,b &#x201C;, we have the value of the element in container a added by b<br>By &#x201C;MUL a,b &#x201C;, we have the value of the element in container a multiplied by b<br>   After each of the operations, the value in b will not change.<br>&#x3000;&#x3000;Here C1, C2 denotes actually the value of magic element. <br>C2&#x2019;s initial value is 0.<br>&#x3000;&#x3000;All works are done in the order in input.<br>&#x3000;&#x3000;<br>&#x3000;&#x3000;Harry always has a magic element V at first, and can use the generator arbitary times, and wonders if so, what is the value of the result element.<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"&#x3000;&#x3000;One line T, the number of test cases.<br>&#x3000;&#x3000;For each test case, first line contains one integer V. Then a few lines describe the Cyber Sequence Generator, ended by &#x201C;END&#x201D;.<br>&#x3000;&#x3000;Then an integer Q, the number of Queries. <br>&#x3000;&#x3000;Q number following describe how many times Harry use the generator, for each query N , we have the initial value is V, and C2&#x2019;s initial value is 0.<br>&#x3000;&#x3000;The instruction is like &quot;SET_a,_b&quot;.(underscore &apos;_&apos; is just used to demonstrate blank char)<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"&#x3000;&#x3000;For each test case, first output a line &quot;Case num:&quot;, while num is the case number, based on 1. There is one space between &apos;Case&apos; and &apos;num&apos; and no more blanks in the same line.<br>&#x3000;&#x3000;<br>For each query, output a line of the value of the result magic element, modulo prime p = 10<sup>9</sup>+7(i.e 1 000 000 007).<br>&#x3000;&#x3000;<br>Constraints<br>   1&lt;=T&lt;=10<br>   1&lt;=N&lt;=10<sup>100</sup><br>   1&lt;=Q&lt;=100<br>&#x3000;&#x3000;One generator has no more than 100 instructions.<br>&#x3000;&#x3000;All integer constants in SET/ADD/MUL instruction will fit 32-bit integer type.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n1\nADD C1, 1\nSET C2, C1\nEND\n5\n1\n2\n3\n4\n5\n1\nADD C1, C1\nSET C2, 1\nADD C2, C1\nSET C1, C2\nEND\n5\n1\n2\n3\n4\n5</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1:\n2\n3\n4\n5\n6\nCase 2:\n3\n7\n15\n31\n63</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Author","content":"WHU","type":"source","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2012+Multi-University+Training+Contest+9&amp;source=1&amp;searchmode=source\"> 2012 Multi-University Training Contest 9 </a> ","type":"source","format":"html","require":["katex"]}]}