{"title":"Harry Potter and Cyber Sequence Generator","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4382","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4382&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4382","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4382"},"statement":[{"title":"Problem Description","content":"    After Voldemort and the Death Eater were wiped out by Harry Potter and his friends, Harry becomes the glory of the Wizarding World, magician treat him as model, hero, king&#xFFFD;&#xFFFD; and much more than that.<br>&#xA0;&#xA0;  Recently Harry Potter and his friends have been researching a kind of toy from the Muggle World, with the name Cyber Sequence Generator, wondering if after manipulated in some certain way, it can be useful and powerful for magicians.<br>&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;This kind of generator has two magic containers C1 and C2, if we put a magic element in C1, after its magic is all over, the result magic element can be taken from C2. Because we Muggles(I&#xFFFD;&#xFFFD;m sorry if you are not a muggle, you can ask me for magic student version of this problem statement even you are competing and can&#xFFFD;&#xFFFD;t use the Internet) do not know magic languages, let&#xFFFD;&#xFFFD;s rearrange the words to describe how the generator works.<br>&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;The generator&#xFFFD;&#xFFFD;s work can be split into simple works. Each work is like:<br><pre><br>     SET|ADD    C1|C2,    C1|C2|IntegerNumber<br>     MUL        C1|C2,    IntegerNumber<br></pre><br>By &#xFFFD;&#xFFFD;SET a,b &#xFFFD;&#xFFFD;, we have the value of the element in container a changed to b<br>By &#xFFFD;&#xFFFD;ADD a,b &#xFFFD;&#xFFFD;, we have the value of the element in container a added by b<br>By &#xFFFD;&#xFFFD;MUL a,b &#xFFFD;&#xFFFD;, we have the value of the element in container a multiplied by b<br>   After each of the operations, the value in b will not change.<br>&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;Here C1, C2 denotes actually the value of magic element. <br>C2&#xFFFD;&#xFFFD;s initial value is 0.<br>&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;All works are done in the order in input.<br>&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;<br>&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;Harry always has a magic element V at first, and can use the generator arbitary times, and wonders if so, what is the value of the result element.<br>","type":"description","format":"html"},{"title":"Input","content":"&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;One line T, the number of test cases.<br>&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;For each test case, first line contains one integer V. Then a few lines describe the Cyber Sequence Generator, ended by &#xFFFD;&#xFFFD;END&#xFFFD;&#xFFFD;.<br>&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;Then an integer Q, the number of Queries. <br>&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;Q number following describe how many times Harry use the generator, for each query N , we have the initial value is V, and C2&#xFFFD;&#xFFFD;s initial value is 0.<br>&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;The instruction is like &quot;SET_a,_b&quot;.(underscore &apos;_&apos; is just used to demonstrate blank char)<br>","type":"input_format","format":"html"},{"title":"Output","content":"&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;For each test case, first output a line &quot;Case num:&quot;, while num is the case number, based on 1. There is one space between &apos;Case&apos; and &apos;num&apos; and no more blanks in the same line.<br>&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;<br>For each query, output a line of the value of the result magic element, modulo prime p = 10<sup>9</sup>+7(i.e 1 000 000 007).<br>&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;<br>Constraints<br>   1&lt;=T&lt;=10<br>   1&lt;=N&lt;=10<sup>100</sup><br>   1&lt;=Q&lt;=100<br>&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;One generator has no more than 100 instructions.<br>&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;All integer constants in SET/ADD/MUL instruction will fit 32-bit integer type.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n1\nADD C1, 1\nSET C2, C1\nEND\n5\n1\n2\n3\n4\n5\n1\nADD C1, C1\nSET C2, 1\nADD C2, C1\nSET C1, C2\nEND\n5\n1\n2\n3\n4\n5</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1:\n2\n3\n4\n5\n6\nCase 2:\n3\n7\n15\n31\n63</div></pre>","type":"example","format":"html"},{"title":"Author","content":"WHU","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2012+Multi-University+Training+Contest+9&amp;source=1&amp;searchmode=source\"> 2012 Multi-University Training Contest 9 </a> ","type":"source","format":"html"}]}