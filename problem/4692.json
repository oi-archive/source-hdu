{"title":"Great Sequence","time_limit":10000,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4692","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4692&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4692","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4692"},"statement":[{"title":"Problem Description","content":"A great sequence S is a sequence contains N decimal integers, i.e. S = (x[1], x[2], ..., x[N]). S should also satisfy following rules:<br>a[i] &#x2264; x[i] &#x2264; b[i]<br>ds[i] c[i] ds[i+1], where ds[i] is the digit sum of x[i] and c[i] is one of the following relational operators: &quot;=&quot;, &quot;&lt;&quot;, &quot;&lt;=&quot;, &quot;&gt;&quot;, &quot;&gt;=&quot; and &quot;!=&quot;.<br>Obviously, there are a lot of great sequences. You are asked to find the K-th least great sequence in lexicographic order.","type":"description","format":"html"},{"title":"Input","content":"There are multiple test cases. Process to the End of File.<br>The first line of each test case contains two integers 1 &#x2264; N &#x2264; 100, 1 &#x2264; K &#x2264; 10<sup>16</sup>, as described above.<br>In the next N-1 lines, each line contains three elements, a[i], b[i] and c[i], where a[i] and b[i] are integers (1 &#x2264; a[i] &#x2264; b[i] &#x2264; 10<sup>18</sup>) while c[i] is one of the following strings: &quot;=&quot;, &quot;&lt;&quot;, &quot;&lt;=&quot;, &quot;&gt;&quot;, &quot;&gt;=&quot; and &quot;!=&quot;.<br>The last line of each test cases contains only two integers, a[N] and b[N] (1 &#x2264; a[N] &#x2264; b[N] &#x2264; 10<sup>18</sup>).","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, if the total number of great sequences is less than K, output &quot;OUT OF RANGE&quot; (without quotes); otherwise, output the K-th least great sequence in one line. Numbers in the sequence are separated by a single space.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3 15\n9 10 &lt;=\n99 100 =\n1 300\n3 20\n9 10 &lt;=\n99 100 =\n1 300</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">10 100 100\nOUT OF RANGE</div></pre>","type":"example","format":"html"},{"title":"Author","content":"Zejun Wu (watashi)","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2013+Multi-University+Training+Contest+9&amp;source=1&amp;searchmode=source\"> 2013 Multi-University Training Contest 9 </a> ","type":"source","format":"html"}]}