{"title":"Number Link","time_limit":6000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5520","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5520&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5520","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5520"},"statement":[{"title":"Problem Description","content":"Number Link is a famous game available in platforms including iOS and Android. Given a board with $n$ rows and $m$ columns, the target of the game is to connect pairs of grids with the same numbers. Once two numbers are paired, the path connecting them will occupy the corresponding grids. The path can only go vertically or horizontally. Note that, no two paths could intersect (by sharing the same grid) in any grid. In this problem, you are going to play a modified version, called Number Link ++. See the picture below for an example.<br><br><center><img style=\"max-width:100%;\" src=\"../../data/images/C645-1012-1.png\"></center><br><br>In this new game, you can use two types of paths. Type I is to connect two number grids with different parities (i.e., connect odd number with any other even number). It might be hard to cover the entire grid with only type I path, so we allow type II path, which is a circle path covers only the empty grids (the only <b>special case of type II path</b> is a path only connecting two adjacent empty grids; see the figure above).  Since there is no free lunch, we have no free path either. When goes from grid $(a,b)$ to an adjacent grid $(c,d)$, you have to pay for a certain amount of tolls. The cost is the same when goes back from $(c,d)$ to $(a,b)$. Usually the cost of a path is the sum of tolls you paid by traveling along the grids on this path. The only exception is for the special case of type II path. In that case, you have to <b>pay twice</b> the cost (since it is a circle).<br>The total cost of the game is the sum of costs for all the paths. Can you help me figure out the paths so that each grid is on exactly one path? If there exists such solution, what is the minimum possible cost?","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line of input consists of an integer $T$, which is the number of test cases.<br>Each case begins with two integers, $n$ and $m$, in a line $(   1 \\le n, m \\le 50)$.<br>The next $n$ lines describe the board. Each line consists of $m$ nonnegative numbers, which describe the status of each column from left to right. If the number is zero, then the grid is empty; otherwise it indicates the number on the corresponding grid.<br>The next $n-1$ lines each have $m$ nonnegative numbers, which describe the cost of vertical connection. The $j$-th number in $i$-th line is the cost when travels from grid $(i,j)$ to $(i+1,j)$.<br>The next $n$ lines each have $m-1$ nonnegative numbers, which describe the cost of horizontal connection. The $j$-th number in $i$-th line is the cost for a path to go from grid $(i,j)$ to $(i,j + 1)$.<br>All the numbers, including the answer, can be represented using $3$2-bit signed integer.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, first output the case number, then output a single number, which is the minimum cost possible to finish the game. When there is no solution available, simply output -1.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n3 3\n1 0 0\n1 0 0\n2 0 2\n1 2 1\n2 1 1\n3 1\n5 6\n1 4\n1 4\n1 1 2 2\n1 2 3\n3 5\n0 0 0 0 0\n0 5 0 6 0\n0 0 0 0 0\n1 1000 1000 1000 1\n1 1000 1000 1000 1\n1 1 1 1\n1000 1 1 1000\n1 1 1 1</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1: 10\nCase #2: -1\nCase #3: 14\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nBelow are the solutions corresponding to case 1 and case 3 respectively. In case 1, you should double pay the red path, since it is a special case of type II path.\n<img src=\"../../data/images/C645-1012-2.png\"><img src=\"../../data/images/C645-1012-3.png\">\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2015ACM%2FICPC%D1%C7%D6%DE%C7%F8%C9%F2%D1%F4%D5%BE-%D6%D8%CF%D6%C8%FC%A3%A8%B8%D0%D0%BB%B6%AB%B1%B1%B4%F3%D1%A7%A3%A9&amp;source=1&amp;searchmode=source\"> 2015ACM/ICPC&#x4E9A;&#x6D32;&#x533A;&#x6C88;&#x9633;&#x7AD9;-&#x91CD;&#x73B0;&#x8D5B;&#xFF08;&#x611F;&#x8C22;&#x4E1C;&#x5317;&#x5927;&#x5B66;&#xFF09; </a> ","type":"source","format":"html","require":["katex"]}]}