{"title":"Marriage is Stable","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=1522","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=1522&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=1522","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=1522"},"statement":[{"title":"Problem Description","content":"Albert, Brad, Chuck are happy bachelors who are in love with Laura, Marcy, Nancy. They all have three choices. But in fact, they do have some preference in mind. Say Albert, he likes Laura best, but that doesn&apos;t necesarily mean Laura likes him. Laura likes Chuck more than Albert. So if Albert can&apos;t marry Laura, he thinks Nancy a sensible choice. For Albert, he orders the girls Laura &gt; Nancy &gt; Marcy.<br><br>For the boys:<br><br>Albert: Laura &gt; Nancy &gt; Marcy<br>Brad: Marcy &gt; Nancy &gt; Laura<br>Chuck: Laura &gt; Marcy &gt; Nancy<br><br>For the girls:<br><br>Laura: Chuck &gt; Albert &gt; Brad<br>Marcy: Albert &gt; Chuck &gt; Brad<br>Nancy: Brad &gt; Albert &gt; Chuck<br><br>But if they were matched randomly, such as<br><br>Albert &lt;-&gt; Laura <br>Brad &lt;-&gt; Marcy<br>Chuck &lt;-&gt; Nancy<br><br>they would soon discover it&apos;s not a nice solution. For Laura, she likes Chuck instead of Albert. And what&apos;s more, Chuck likes Laura better than Nancy. So Laura and Chuck are likely to come together, leaving poor Albert and Nancy.<br><br>Now it&apos;s your turn to find a stable marriage. A stable marriage means for any boy G and girl M, with their choice m[G] and m[M], it will not happen that rank(G, M) &lt; rank(G, m[G]&#xFF09;and rank(M, G) &lt; rank(M, m[M]).<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"Each case starts with an integer n (1 &lt;= n &lt;= 500), the number of matches to make.<br><br>The following n lines contain n + 1 names each, the first being name of the boy, and rest being the rank of the girls.<br><br>The following n lines are the same information for the girls.<br><br>Process to the end of file.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"If there is a stable marriage, print n lines with two names on each line. You can choose any one if there are multiple solution. Print &quot;Impossible&quot; otherwise.<br><br>Print a blank line after each test.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\nAlbert Laura Nancy Marcy\nBrad Marcy Nancy Laura\nChuck Laura Marcy Nancy\nLaura Chuck Albert Brad\nMarcy Albert Chuck Brad\nNancy Brad Albert Chuck</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Albert Nancy\nBrad Marcy\nChuck Laura</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Author","content":"CHENG, Long","type":"source","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=ZOJ&amp;source=1&amp;searchmode=source\"> ZOJ </a> ","type":"source","format":"html","require":["katex"]}]}