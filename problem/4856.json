{"title":"Tunnels","time_limit":1500,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4856","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4856&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4856","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4856"},"statement":[{"title":"Problem Description","content":"   Bob is travelling in Xi&#x2019;an. He finds many secret tunnels beneath the city. In his eyes, the city is a grid. He can&#x2019;t enter a grid with a barrier. In one minute, he can move into an adjacent grid with no barrier. Bob is full of curiosity and he wants to visit all of the secret tunnels beneath the city. To travel in a tunnel, he has to walk to the entrance of the tunnel and go out from the exit after a fabulous visit. He can choose where he starts and he will travel each of the tunnels once and only once. Now he wants to know, how long it will take him to visit all the tunnels (excluding the time when he is in the tunnels).","type":"description","format":"html"},{"title":"Input","content":"   The input contains mutiple testcases. Please process till EOF.<br>   For each testcase, the first line contains two integers N (1 &#x2264; N &#x2264; 15), the side length of the square map and M (1 &#x2264; M &#x2264; 15), the number of tunnels.<br>   The map of the city is given in the next N lines. Each line contains exactly N characters. Barrier is represented by &#x201C;#&#x201D; and empty grid is represented by &#x201C;.&#x201D;.<br>   Then M lines follow. Each line consists of four integers x<sub>1</sub>, y<sub>1</sub>, x<sub>2</sub>, y<sub>2</sub>, indicating there is a tunnel with entrence in (x<sub>1</sub>, y<sub>1</sub>) and exit in (x<sub>2</sub>, y<sub>2</sub>). It&#x2019;s guaranteed that (x<sub>1</sub>, y<sub>1</sub>) and (x<sub>2</sub>, y<sub>2</sub>) in the map are both empty grid.","type":"input_format","format":"html"},{"title":"Output","content":"   For each case, output a integer indicating the minimal time Bob will use in total to walk between tunnels.<br>   If it is impossible for Bob to visit all the tunnels, output -1.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5 4\n....#\n...#.\n.....\n.....\n.....\n2 3 1 4\n1 2 3 5\n2 3 3 1\n5 4 2 1</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">7</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2014%CE%F7%B0%B2%C8%AB%B9%FA%D1%FB%C7%EB%C8%FC&amp;source=1&amp;searchmode=source\"> 2014&#x897F;&#x5B89;&#x5168;&#x56FD;&#x9080;&#x8BF7;&#x8D5B; </a> ","type":"source","format":"html"}]}