{"title":"Factorial Simplification","time_limit":2000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3758","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3758&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3758","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3758"},"statement":[{"title":"Problem Description","content":"Peter is working on a combinatorial problem. He has carried out quite lengthy derivations and got a resulting formula that is a ratio of two products of factorials like this:<br><center><img style=\"max-width:100%;\" src=\"http://acm.hdu.edu.cn/data/images/C326_1006_1.png\"></center><br><br>This does not surprise Peter, since factorials appear quite often in various combinatorial formulae, because n! represents the number of transpositions of n elements - one of the basic combinatorial objects.<br>However, Peter might have made a mistake in his derivations. He knows that the result should be an integer number and he needs to check this first. For an integer result Peter wants to simplify this formula to get a better feeling of its actual combinatorial significance. He wants to represent the same number as a product of factorials like this.<br><br><center><img style=\"max-width:100%;\" src=\"http://acm.hdu.edu.cn/data/images/C326_1006_2.png\"></center><br>where all ri are distinct integer numbers greater than one in the descending order (r<sub>i</sub> &gt; r<sub>i+1</sub> &gt; 1), si and t are positive integers. Among all the possible representations in this form, Peter is interested in one where r<sub>1</sub> is the largest possible number, among those in the one where s<sub>1</sub> is the largest possible number; among those in the one where r<sub>2</sub> is the largest possible number; among those in the one where s<sub>2</sub> is the largest possible number; etc, until the remaining t cannot be further represented in this form. Peter does not care about the actual value of t. He wants to know what is the factorial-product part of his result.","type":"description","format":"html"},{"title":"Input","content":"The input begins with an integer T. The next T blocks each represents a case. The first line of each case contains two integer numbers n and m (1 &#x2264; n, m &#x2264; 1000). The second line contains n integer numbers pi (1 &#x2264; pi &#x2264; 10 000) separated by spaces. The third line contains m integer numbers qi (1 &#x2264; qi &#x2264; 10 000) separated by spaces.","type":"input_format","format":"html"},{"title":"Output","content":"For each case, on the first line of the output write a single integer number k. Write k = -1 if the ratio of the given factorial products is not an integer. Write k = 0 if the ratio is an integer but it cannot be represented in the desired form. Write k &gt; 0 followed by k lines if the ratio can be represented by a factorial product as described in the problem statement. On each of the following k lines write two integers ri and si (for i = 1 ... k) separated by a space.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n1 2\n6\n4 4\n1 2\n6\n3 4\n4 2\n9 2 2 2\n3 4</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">-1\n0\n2\n7 1\n2 2</div></pre>","type":"example","format":"html"},{"title":"Author","content":"Andrey Stankevich","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2010+Northeastern+European+Regional+Contest&amp;source=1&amp;searchmode=source\"> 2010 Northeastern European Regional Contest </a> ","type":"source","format":"html"}]}