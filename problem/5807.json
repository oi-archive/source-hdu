{"title":"Keep In Touch","time_limit":2000,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5807","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5807&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5807","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5807"},"statement":[{"title":"Problem Description","content":"There are $n$ cities numbered with successive integers from $1$ to $n$ in Byteland. Also, there are $m$ one-way roads connecting the cities. The starting point of the $i$-th road is $u_i$ while the ending point is $v_i$.<br><br>There are $3$ spies : 007, 008 and 009. They are going to start $q$ secret missions.<br><br>During each mission, they may be in three different cities, and they contact each other using interphones. The radio frequency of the $i$-th city is $w_i$. Two spies can contact with each other if and only if the absolute value of the difference of radio frequency between the cities where they are in is no more than $K$. At each moment, three spies must choose a road and go to another city. The time for traveling each road is only a unit of time.<br><br>They can choose to end the mission in any city, even in the city where they started the mission. But they are not allowed to end mission in the middle of the roads. Now they want to know, for each mission whose start points are given, what&apos;s the number of possible ways, during which they can contact with each other at any moment when they are not on roads?<br><br>Two ways are considered different if and only if there exists at least one spy at different cities on the same moment.<br><br>Note : $3$ spies must end the mission at the same time.","type":"description","format":"html"},{"title":"Input","content":"The first line of the input contains an integer $T$ $(1\\leq T\\leq 10)$, denoting the number of test cases.<br><br>In each test case, the first line of the input contains four integers $n$ $(1\\leq n\\leq 50),m(0\\leq m\\leq \\frac{n(n-1)}{2}),K(0\\leq K\\leq 10^9),q(1\\leq q\\leq 125000)$, denoting the number of cities, the number of roads, the upper limit of interphone and the number of missions.<br><br>The second line of the input contains $n$ integers $w_1, w_2, ..., w_n$ $(1\\leq w_i\\leq 10^9)$, denoting the radio frequency of the $i$-th city.<br><br>Each of the next $m$ lines contains two integers $u_i,v_i$ $(1\\leq u_i &lt; v_i\\leq n)$, denoting an one-way road. There are no multiple edges in the graph.<br><br>Each of the next $q$ lines contains three integers $x,y,z(1\\leq x,y,z\\leq n)$, denoting the starting point of the three spies in each mission. You can assume that there are at least one possible way in each mission.","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, print $q$ lines with one integer per line. For each mission, print the number of possible ways modulo $998244353$.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n4 4 2 10\n8 8 4 1\n1 3\n1 4\n2 3\n2 4\n1 1 1\n1 1 2\n1 2 1\n1 2 2\n2 1 1\n2 1 2\n2 2 1\n2 2 2\n3 3 3\n4 4 4</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n3\n3\n3\n3\n3\n3\n3\n1\n1</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=BestCoder+Round+%2386&amp;source=1&amp;searchmode=source\"> BestCoder Round #86 </a> ","type":"source","format":"html"}]}