{"title":"Immortality of Frog","time_limit":4000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5555","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5555&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5555","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5555"},"statement":[{"title":"Problem Description","content":"$N$ frogs are attempting to prolong their life-span. They live in the bottom of a well which can be described as a two-dimensional $N&#xD7;N$ grid. $Grid (i,j)$ is located in the $i-th$ row and the $j-th$ column. At the beginning, the $i-th$ frog lives in the bottom of $i-th$ column, i.e. the place below $grid (1,i)$.<br>The frogs are so devout that God decides to give them a chance. In each row $i$, a horizontal membrane ranging from $(i,L_i $) to $(i,R_i )$ inclusively is created. A capsule of elixir is placed at one of the grids of the membrane with uniform probability.<br><br>Now the frogs are jumping upwards to pursue immortality. The $i-th$ frog would be in $grid (j,i)$ after $j$ jumps. When a frog arrives at a grid that contains a capsule of elixir, it will eat the capsule and gain immortality. After that, it continues jumping upwards until it gets out of the well.<br><br>A membrane is considered &#x201C;<b>bad</b>&#x201D; if it convers less than $N$ grids. The frogs are very sensitive, so they can only endure passing through 10 bad membrane. When a frog reaches the $11^{th}$ bad membrane, it thinks that there is no hope to get out of the well, so it will go back to the bottom of well and live there until death, even though it has eaten a capsule of elixir already.<br><br>The frogs are friends, so they want all of them gain immortality and live a happy life out of the well. They want to know the probability $P$ that every frog eats exactly one capsule of elixir and gets out of the well.<br>","type":"description","format":"html"},{"title":"Input","content":"The first line of input contains a number $T$ indicating the number of test cases ($T&#x2264;100$).<br><br>Each test case starts with a line containing an integer $N$ as described above ($1&#x2264;N&#x2264;1000$). The second line contains $N$ space separated integers $L_1,L_2,...,L_N$. The third line contains $N$ space separated integers $R_1,R_2,...,R_N$. ($1&#x2264;L_i&#x2264;R_i&#x2264;N$)<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output a single line consisting of &#x201C;<b>Case #X: Y</b>&#x201D;. $X$ is the test case number starting from 1. $Y$ is an integer defined as the probability $P$ multiplies $\\prod_{i=1}^{N} (R_i-L_i+1)$ . As the answer could be huge, you only need to output it module 105225319.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n2\n1 2\n1 2\n2\n1 1\n2 2</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1: 1\nCase #2: 2</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2015ACM%2FICPC%D1%C7%D6%DE%C7%F8%BA%CF%B7%CA%D5%BE-%D6%D8%CF%D6%C8%FC%A3%A8%B8%D0%D0%BB%D6%D0%BF%C6%B4%F3%A3%A9&amp;source=1&amp;searchmode=source\"> 2015ACM/ICPC&#x4E9A;&#x6D32;&#x533A;&#x5408;&#x80A5;&#x7AD9;-&#x91CD;&#x73B0;&#x8D5B;&#xFF08;&#x611F;&#x8C22;&#x4E2D;&#x79D1;&#x5927;&#xFF09; </a> ","type":"source","format":"html"}]}