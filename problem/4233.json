{"title":"Family Fortune ","time_limit":10000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4233","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4233&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4233","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4233"},"statement":[{"title":"Problem Description","content":"While studying the history of wealthy families, researchers want to know just how much of a fortune each family has amassed. There are various &apos;net worth&apos; figures for each individual throughout history, but totaling them is complicated by double counting, caused by inheritance. One way to estimate the wealth of a family is to sum up the net worth of a set of K people such that no one in the set is an ancestor or a descendant of anyone else in the set. The wealth of the family is the maximum sum achievable over all such sets of K people. Since historical records contain only the net worth of male family members, the family tree is a simple tree in which every male has exactly one father and a non-negative number of sons. Also, there is exactly one person who is an ancestor of all other family members.<br>Given information about a family tree, what is the wealth of the family, by this measure?","type":"description","format":"html"},{"title":"Input","content":"There will be several test cases in the input. Each test case will begin with two integers:<br>N K<br>Where N (1 &#xFFFD;&#xFFFD; N &#xFFFD;&#xFFFD; 100,000) is the total number of family members in the records, and K (1 &#xFFFD;&#xFFFD; K &#xFFFD;&#xFFFD; 1,000) is the size of the desired set of people.<br>Each of the next N lines will hold two integers:<br>P W<br>Where P (0 &#xFFFD;&#xFFFD; P &#xFFFD;&#xFFFD; N) indicates the parent of that family member. The family members are numbered from 1 to N, with the parent and fortune of family member i appearing on the i^th line. There will be a single root, with P=0. The tree will not have a depth greater than 1,000, and, of course, it won&#xFFFD;&#xFFFD;t have any cycles. W (1 &#xFFFD;&#xFFFD; W &#xFFFD;&#xFFFD; 1,000) is the wealth (in millions) of that family member.<br>The input will end with a line with two 0s.","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output a single integer on its own line, which is the maximum sum (in millions) of the fortunes of a set of K family members in the tree, where no member of the set is an ancestor or descendant of any other member of the set. If you cannot find K such nodes, then output 0. Output no extra spaces, and do not separate answers with blank lines.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">11 5\n0 1\n1 1\n1 1\n2 1\n2 1\n3 1\n3 1\n3 1\n5 1\n7 1\n7 1\n11 5\n11 3\n1 1\n4 1\n1 2\n10 2\n10 2\n6 2\n6 1\n10 2\n11 3\n0 4\n7 3\n0 18\n1 20\n1 15\n2 12\n2 6\n3 8\n3 8\n0 0</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5\n10\n36</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=SER2011&amp;source=1&amp;searchmode=source\"> SER2011 </a> ","type":"source","format":"html"}]}