{"title":"Guess the Money","time_limit":1000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5049","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5049&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5049","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5049"},"statement":[{"title":"Problem Description","content":"   Dshawn is a tuhao. He has a lot of money. One day, he gave A dollars to kuangbin and cxlove. kuangbin got B dollars and cxlove got C dollars. Obviously, A = B + C.<br><br>   wuyiqi is very curious, he want to know the A,B and C. But they didn&#xFFFD;&#xFFFD;t tell him. Just tell him some information about the three numbers.<br><br>   Dshawn said that the number A has N<sub>1</sub> digits in its decimal representation (without extra leading zero). Assume the digits of its decimal expansion from the left to the right are a<sub>0</sub>, a<sub>1</sub>, ..., a<sub>N1 - 1</sub>. Dshawn didn&#xFFFD;&#xFFFD;t tell wuyiqi all the digits but tell him M<sub>1</sub> digits.<br><br>   kuangbin said that the number B has N<sub>2</sub> digits in its decimal representation (without extra leading zero). Assume the digits of its decimal expansion from the left to the right are b<sub>0</sub>, b<sub>1</sub>, ..., b<sub>N2 - 1</sub>. kuangbin didn&#xFFFD;&#xFFFD;t tell wuyiqi all the digits but tell him M<sub>2</sub> digits.<br><br>   cxlove said that the number C has N<sub>3</sub> digits in its decimal representation (without extra leading zero). Assume the digits of its decimal expansion from the left to the right are c<sub>0</sub>, c<sub>1</sub>, ..., c<sub>N3 - 1</sub>. cxlove didn&#xFFFD;&#xFFFD;t tell wuyiqi all the digits but tell him M<sub>3</sub> digits.<br><br>   You should find the number of possible {A, B, C}. It is possible that someone tells lies, so if the information given is inconsistent with any possible {A, B, C}, you should also detect this.","type":"description","format":"html"},{"title":"Input","content":"   The first line of the input is T (1 &#xFFFD;&#xFFFD; T &#xFFFD;&#xFFFD; 50), which stands for the number of test cases you need to solve.<br><br>   The first line of each case contains two integers N<sub>1</sub>,M<sub>1</sub> (1 &#xFFFD;&#xFFFD; N<sub>1</sub> &#xFFFD;&#xFFFD; 10<sup>7</sup>, 0 &#xFFFD;&#xFFFD; M<sub>1</sub> &#xFFFD;&#xFFFD; min(N<sub>1</sub>, 10<sup>4</sup>)).<br><br>   For the next M<sub>1</sub> lines, each line contains two integers id and x (0 &#xFFFD;&#xFFFD; id &lt; N<sub>1</sub>, 0 &#xFFFD;&#xFFFD; x &#xFFFD;&#xFFFD; 9) means a<sub>id</sub> = x.<br><br>   The next line contains two integers N<sub>2</sub>,M<sub>2</sub> (1 &#xFFFD;&#xFFFD; N<sub>2</sub> &#xFFFD;&#xFFFD; 10<sup>7</sup>, 0 &#xFFFD;&#xFFFD; M<sub>2</sub> &#xFFFD;&#xFFFD; min(N<sub>2</sub>, 10<sup>4</sup>)).<br><br>   For the next M<sub>2</sub> lines, each line contains two integers id and x (0 &#xFFFD;&#xFFFD; id &lt; N<sub>2</sub>, 0 &#xFFFD;&#xFFFD; x &#xFFFD;&#xFFFD; 9) means b<sub>id</sub> = x.<br><br>   The next line contains two integers N<sub>3</sub>,M<sub>3</sub> (1 &#xFFFD;&#xFFFD; N<sub>3</sub> &#xFFFD;&#xFFFD; 10<sup>7</sup>, 0 &#xFFFD;&#xFFFD; M<sub>3</sub> &#xFFFD;&#xFFFD; min(N<sub>3</sub>, 10<sup>4</sup>)).<br><br>   For the next M<sub>3</sub> lines, each line contains two integers id and x (0 &#xFFFD;&#xFFFD; id &lt; N<sub>3</sub>, 0 &#xFFFD;&#xFFFD; x &#xFFFD;&#xFFFD; 9) means c<sub>id</sub> = x.","type":"input_format","format":"html"},{"title":"Output","content":"   For each test case, print a line &#xFFFD;&#xFFFD;Case #t: &#xFFFD;&#xFFFD;(without quotes, t means the index of the test case) at the beginning.<br><br>   If it is impossible, please output &#xFFFD;&#xFFFD;IMPOSSIBLE&#xFFFD;&#xFFFD; else output the answer modulo 20140927.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\t\n2 0\n1 1\n0 9\n1 0\n1 1\n0 5\n1 0\n1 0\n2 0\n3 0\n2 0</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1: 9\nCase #2: 6\nCase #3: IMPOSSIBLE</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2014+ACM%2FICPC+Asia+Regional+Shanghai+Online&amp;source=1&amp;searchmode=source\"> 2014 ACM/ICPC Asia Regional Shanghai Online </a> ","type":"source","format":"html"}]}