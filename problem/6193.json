{"title":"Yuno And Irotoridori no Sekai","time_limit":5000,"memory_limit":320,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6193","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6193&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6193","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6193"},"statement":[{"title":"Problem Description","content":"Yuno is playing a galgame called Irotoridori no Sekai.<br>It&apos;s a good game, so she decided to make a data structure problem for you.<br>You are given a tree with $n$ nodes, each node has a value.<br>You need to perform three operations:<br>$1~x~y$ : reverse all the value of nodes on the chain $x$ -&gt; $y$<br>$2~x~y~z$ : add $z$ to the value of nodes on the chain $x$ -&gt; $y$<br>$3~x~y$ Then followed by $y$ numbers $v_1,v_2, ... v_y$ : output the $v_1$th, $v_2$th, ... , $v_y$th smallest value of the nodes which distance on the tree is no more than $1$ from node $x$<br>","type":"description","format":"html"},{"title":"Input","content":"First line contains two numbers $n,m$.<br>Second line $n$ numbers indicating the value of the first node to the last node.<br>The next $n - 1$ lines, every line consists of two numbers $x,y$, indicating that there exists an edge between node $x$ and node $y$.<br>In the next $m$ lines, every line consists of an operation described above.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each query, output a number indicating the answer.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5 5\n1 2 3 4 5\n1 2\n2 3\n3 4\n4 5\n3 1 2 1 2\n3 2 3 1 2 3\n3 3 4 1 2 3 4\n3 4 2 1 2\n3 5 2 1 2</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n2\n1\n2\n3\n2\n3\n4\n5\n3\n4\n3\n5</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2017ACM%2FICPC%B9%E3%CE%F7%D1%FB%C7%EB%C8%FC-%D6%D8%CF%D6%C8%FC%A3%A8%B8%D0%D0%BB%B9%E3%CE%F7%B4%F3%D1%A7%A3%A9&amp;source=1&amp;searchmode=source\"> 2017ACM/ICPC&#x5E7F;&#x897F;&#x9080;&#x8BF7;&#x8D5B;-&#x91CD;&#x73B0;&#x8D5B;&#xFF08;&#x611F;&#x8C22;&#x5E7F;&#x897F;&#x5927;&#x5B66;&#xFF09; </a> ","type":"source","format":"html"}]}