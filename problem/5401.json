{"title":"Persistent Link/cut Tree","time_limit":1000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5401","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5401&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5401","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5401"},"statement":[{"title":"Problem Description","content":"Teacher Mai has $m+1$ trees, $T_0,T_1,\\cdots,T_m$. $T_0$ consists one vertex numbered $0$.<br><br>He generated the $T_i$ in this way. Get a copy of $T_{a_i}$ and $T_{b_i}$. Add an edge with length $l_i$ between vertex numbered $c_i$ in  $T&apos;_{a_i}$ and $d_i$ in $T&apos;_{b_i}$. Relabel the vertices in the new tree. Let $k$ be the number of vertices in $T&apos;_{a_i}$. He keeps labels of vertices in $T&apos;_{a_i}$ the same, and adds $k$ to labels of vertices in $T&apos;_{b_i}$.<br><br>If there is a tree $T$ with $n$ vertices $v_0,v_1,v_2,\\cdots,v_{n-1}$, $F(T)=\\sum_{i=0}^{n-1} \\sum_{j=i+1}^{n-1} d(v_i,v_j)$($d(v_i,v_j)$ means the distance between the $v_i$ and $v_j$).<br><br>For every $i(1\\leq i\\leq m)$, he wants to know $F(T_i)$.<br>","type":"description","format":"html"},{"title":"Input","content":"There are multiple test cases(about $100$).<br><br>For each test case, the first line contains one number $m(1\\leq m\\leq 60)$, the following are $m$ lines. The $i$-th lines contains five numbers $a_i,b_i,c_i,d_i,l_i(0\\leq a_i,b_i&lt;i,0\\leq l_i\\leq 10^9)$. It&apos;s guarenteed that there exists a vertex numbered $c_i$ in $T_{a_i}$ and there exists a vertex numbered $d_i$ in $T_{b_i}$.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, print $F(T_i)$ modulo $10^9+7$ in the $i$-th line.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n0 0 0 0 2\n1 1 0 0 4\n2 2 1 0 3</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n28\n216</div></pre>","type":"example","format":"html"},{"title":"Author","content":"xudyh","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2015+Multi-University+Training+Contest+9&amp;source=1&amp;searchmode=source\"> 2015 Multi-University Training Contest 9 </a> ","type":"source","format":"html"}]}