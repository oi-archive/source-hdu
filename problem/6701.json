{"title":"Make Rounddog Happy","time_limit":2000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6701","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6701&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6701","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6701"},"statement":[{"title":"Problem Description","content":"Rounddog always has an array $a_1, a_2, \\cdots, a_n$ in his right pocket, satisfying $1 \\le a_i  \\le n$.<br><br>A subarray is a non-empty subsegment of the original array. Rounddog defines a good subarray as a subsegment $a_l, a_{l+1}, \\cdots, a_r$ that all elements in it are different and $\\max({a_l, a_{l+1}, \\ldots, a_r}) - (r - l + 1) \\leq k$.<br><br>Rounddog is not happy today. As his best friend, you want to find all good subarrays of $a$ to make him happy. In this case, please calculate the total number of good subarrays of $a$. <br>","type":"description","format":"html"},{"title":"Input","content":"The input contains several test cases, and the first line contains a single integer $T~(1 \\leq T \\leq 20)$, the number of test cases.<br><br>The first line of each test case contains two integers $n~(1\\leq n \\le 300\\,000)$ and $k~(1\\leq k \\le 300\\,000)$.<br><br>The second line contains $n$ integers, the $i$-th of which is $a_i~(1 \\le a_i \\le n)$.<br><br>It is guaranteed that the sum of $n$ over all test cases never exceeds $1\\,000\\,000$.<br>","type":"input_format","format":"html"},{"title":"Output","content":"One integer for each test case, representing the number of subarrays Rounddog likes.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n5 3\n2 3 2 2 5\n10 4\n1 5 4 3 6 2 10 8 4 5</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">7\n31</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2019+Multi-University+Training+Contest+10&amp;source=1&amp;searchmode=source\"> 2019 Multi-University Training Contest 10 </a> ","type":"source","format":"html"}]}