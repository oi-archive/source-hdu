{"title":"Wow! Such City!","time_limit":8000,"memory_limit":100,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4849","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4849&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4849","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4849"},"statement":[{"title":"Problem Description","content":"   Doge, tired of being a popular image on internet, is considering moving to another city for a new way of life.<br>   In his country there are N (2 &#xFFFD;&#xFFFD;N&#xFFFD;&#xFFFD; 1000) cities labeled 0 . . . N - 1. He is currently in city 0. Meanwhile, for each pair of cities, there exists a road connecting them, costing C<sub>i</sub>,<sub>j</sub> (a positive integer) for traveling from city i to city j. Please note that C<sub>i</sub>,<sub>j</sub> may not equal to C<sub>j</sub>,<sub>i</sub> for any given i &#xFFFD;&#xFFFD; j.<br>   Doge is carefully examining the cities: in fact he will divide cities (his current city 0 is <b>NOT</b> included) into M (2 &#xFFFD;&#xFFFD; M &#xFFFD;&#xFFFD; 10<sup>6</sup>) categories as follow:  If the minimal cost from his current city (labeled 0) to the city i is Di, city i belongs to category numbered <b>D<sub>i</sub> mod M</b>.Doge wants to know the &#xFFFD;&#xFFFD;minimal&#xFFFD;&#xFFFD; category (a category with minimal number) which contains at least one city.<br>   For example, for a country with 4 cities (labeled 0 . . . 3, note that city 0 is not considered), Doge wants to divide them into 3 categories.  Suppose category 0 contains no city, category 1 contains city 2 and 3, while category 2 contains city 1, Doge consider category 1 as the minimal one.<br>   Could you please help Doge solve this problem?<br><br>Note:<br><br>   C<sub>i</sub>,<sub>j</sub> is generated in the following way:<br>   Given integers X<sub>0</sub>, X<sub>1</sub>, Y<sub>0</sub>, Y<sub>1</sub>, (1 &#xFFFD;&#xFFFD;  X<sub>0</sub>, X<sub>1</sub>, Y<sub>0</sub>, Y<sub>1</sub>&#xFFFD;&#xFFFD; 1234567), for k &#xFFFD;&#xFFFD; 2 we have<br>   Xk&#xA0;&#xA0;=  (12345 + X<sub>k-1</sub> * 23456 + X<sub>k-2</sub> * 34567 + X<sub>k-1</sub> * X<sub>k-2</sub> * 45678)&#xA0;&#xA0;mod&#xA0;&#xA0;5837501<br>   Yk&#xA0;&#xA0;=  (56789 + Y<sub>k-1</sub> * 67890 + Y<sub>k-2</sub> * 78901 + Y<sub>k-1</sub> * Y<sub>k-2</sub> * 89012)&#xA0;&#xA0;mod&#xA0;&#xA0;9860381<br>The for k &#xFFFD;&#xFFFD; 0 we have<br><br>                  Z<sub>k</sub> = (X<sub>k</sub> * 90123 + Y<sub>k</sub> ) mod 8475871 + 1<br><br>Finally for 0 &#xFFFD;&#xFFFD; i, j &#xFFFD;&#xFFFD; N - 1 we have<br><br>                  C<sub>i</sub>,<sub>j</sub> = Z<sub>i*n+j</sub>    for  i &#xFFFD;&#xFFFD; j<br>                  C<sub>i</sub>,<sub>j</sub> = 0&#xA0;&#xA0;     for  i = j<br>","type":"description","format":"html"},{"title":"Input","content":"   There are several test cases. Please process till EOF.<br>   For each test case, there is only one line containing 6 integers N,M,X<sub>0</sub>,X<sub>1</sub>,Y<sub>0</sub>,Y<sub>1</sub>.See the description for more details.","type":"input_format","format":"html"},{"title":"Output","content":"   For each test case, output a single line containing a single integer: the number of minimal category.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3 10 1 2 3 4\n4 20 2 3 4 5</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n10\n\nFor the first test case, we have\n\n\n\t   0\t   1\t   2\t   3\t   4\t   5\t   6\t   7\t   8\nX\t   1\t   2\t 185180\t 788997\t1483212\t4659423\t4123738\t2178800\t 219267\nY\t   3\t   4\t1633196\t7845564\t2071599\t4562697\t3523912\t317737\t1167849\nZ\t 90127\t 180251\t1620338\t2064506\t 625135\t5664774\t5647950\t8282552\t4912390\n\nthe cost matrix C is\n\t         \t   0\t 180251\t1620338\n\t                2064506\t   0\t5664774\n\t                5647950\t8282552\t   0\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>So the minimal cost from city 0 to city 1 is 180251, while the distance to city 2 is 1620338.\nGiven M = 10, city 1 and city 2 belong to category 1 and 8 respectively.\nSince only category 1 and 8 contain at least one city,\nthe minimal one of them, category 1, is the desired answer to Doge&#xFFFD;&#xFFFD;s question.</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2014%CE%F7%B0%B2%C8%AB%B9%FA%D1%FB%C7%EB%C8%FC&amp;source=1&amp;searchmode=source\"> 2014&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#x22B;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD; </a> ","type":"source","format":"html"}]}