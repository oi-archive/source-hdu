{"title":"I Curse Myself","time_limit":4000,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6041","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6041&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6041","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6041"},"statement":[{"title":"Problem Description","content":"There is a connected undirected graph with weights on its edges. It is guaranteed that each edge appears in at most one simple cycle.<br><br>Assuming that the weight of a weighted spanning tree is the sum of weights on its edges, define $V(k)$ as the weight of the $k$-th smallest weighted spanning tree of this graph, however, $V(k)$ would be defined as zero if there did not exist $k$ different weighted spanning trees.<br><br>Please calculate $\\displaystyle\\left(\\sum_{k=1}^{K}{k \\cdot V(k)}\\right) \\bmod 2^{32}$.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The input contains multiple test cases.<br><br>For each test case, the first line contains two positive integers $n, m$ $(2 \\leq n \\leq 1000, n-1 \\leq m \\leq 2n-3)$, the number of nodes and the number of edges of this graph.<br><br>Each of the next $m$ lines contains three positive integers $x, y, z$ $(1 \\leq x, y \\leq n, 1 \\leq z \\leq 10^6)$, meaning an edge weighted $z$ between node $x$ and node $y$. There does not exist multi-edge or self-loop in this graph.<br><br>The last line contains a positive integer $K$ $(1 \\leq K \\leq 10^5)$.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, output &quot;<b>Case #$x$: $y$</b>&quot; in one line (without quotes), where $x$ indicates the case number starting from $1$ and $y$ denotes the answer of corresponding case.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">4 3\n1 2 1\n1 3 2\n1 4 3\n1\n3 3\n1 2 1\n2 3 2\n3 1 3\n4\n6 7\n1 2 4\n1 3 2\n3 5 7\n1 5 3\n2 4 1\n2 6 2\n6 4 5\n7</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1: 6\nCase #2: 26\nCase #3: 493</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2017+Multi-University+Training+Contest+-+Team+1&amp;source=1&amp;searchmode=source\"> 2017 Multi-University Training Contest - Team 1 </a> ","type":"source","format":"html","require":["katex"]}]}