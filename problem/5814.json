{"title":"Find the Period","time_limit":4000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5814","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5814&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5814","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5814"},"statement":[{"title":"Problem Description","content":"For a string $S = s_{1}s_{2}\\cdots s_{N}$, the period of S is defined as the smallest positive integer p &lt;= N, such that si+p = si holds for all 1 &lt;= i &lt;= N &#x2013; p. Now given two integers L and R (1 &lt;= L &lt;= R &lt;= N), you are asked to find out the period of $s_{L}s_{L+1}\\cdots s_{R}$.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The input begins with an integer T (T &lt;= 20), indicating the number of test case. The first line of each case contains a string S, which consists of N (1 &lt;= N &lt;= 100000) lowercase English letters. The second line contains an integer Q (1 &lt;= N &lt;= 100000), indicating the number of queries. The following Q lines each contain two integers L and R (1 &lt;= L &lt;= R &lt;= N).<br><br>The total length of all the strings is not larger than 500000, and the total number of queries is not larger than 200000.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each case, output &quot;Case #X:&quot; in a line where X is the case number, staring from 1. Then for each query, output the answer in a line.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\naaabaa\n3\n1 3\n1 4\n2 5\nabcabcabc\n1\n1 9</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1:\n1\n4\n3\nCase #2:\n3</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Author","content":"SYSU","type":"source","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2016+Multi-University+Training+Contest+7&amp;source=1&amp;searchmode=source\"> 2016 Multi-University Training Contest 7 </a> ","type":"source","format":"html","require":["katex"]}]}