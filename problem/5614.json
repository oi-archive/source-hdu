{"title":"Baby Ming and Matrix tree","time_limit":5000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5614","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5614&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5614","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5614"},"statement":[{"title":"Problem Description","content":"Give a $2*2$ 01-matrix A, which can deal with the following $2$ kinds of transformation:<br><br>**Rotation transformation**: clockwise rotation. Move $A(i, j)$ to $A(j,1- i)$<br><br>**Replace**: replace the matrix $A$ into matrix $B$.<br><br>Given a tree, there is a matrix $A_i$ in every node of the tree, Baby Ming likes to play the matrix in the tree. Every time, Baby Ming choose two node $a, b$ in the tree and change all the matrixes in the path from $a$ to $b$ into matrix $B$ by the above two kinds of transformation.<br><br>Suppose rotation transformation takes $2$ seconds every time while replace takes $10$. Baby Ming wants to know the minimum time it costs.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"In the first line contains a single positive integer $T$, indicating number of test case.<br><br>For every test case:<br><br>In the first line there is a number $n$ to show the tree has $n$ nodes.<br><br>In the next $n-1$ lines, each line contains $2$ integer $a, b$, indicate the edge between $a$ and $b$.<br><br>In the next $n*2$ lines, each line contains $2$ numbers $01$, indicate the matrix $A_i$ in the node $i$.<br><br>Input a positive integer $q$, indicate the number of queries.<br><br>For each query:<br><br>In the first line there is two positive numbers $a, b$.<br><br>In the second line and third line there is a $2*2$ 01-matrix B, It represents select two nodes $a, b$, transform all the matrix $A_i$ in the path from $a$ to $b$ into matrix $B$<br><br>**(matrix $A_i, B$ consist by $2$ zeros and $2$ ones)**<br><br>$1 \\leq T \\leq 30, 1 &lt; n \\leq 20000, 1 \\leq q \\leq 20000, 1 \\leq a, b \\leq n$ <br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each of $Q$ operation, print one line to show minimum time the change needed.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n5\n3 4\n1 2\n2 5\n1 4\n0 0\n1 1\n0 1\n1 0\n1 1\n0 0\n0 1\n0 1\n1 0\n0 1\n3\n1 5\n0 1\n1 0\n2 3\n0 1\n0 1\n1 2\n0 0\n1 1</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">12\n22\n4</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=BestCoder+Round+%2369+%28div.1%29&amp;source=1&amp;searchmode=source\"> BestCoder Round #69 (div.1) </a> ","type":"source","format":"html","require":["katex"]}]}