{"title":"Hatsune Miku","time_limit":1000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5074","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5074&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5074","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5074"},"statement":[{"title":"Problem Description","content":"Hatsune Miku is a popular virtual singer. It is very popular in both Japan and China. Basically it is a computer software that allows you to compose a song on your own using the vocal package.<br><br>Today you want to compose a song, which is just a sequence of notes. There are only m different notes provided in the package. And you want to make a song with n notes.<br><br><center><img style=\"max-width:100%;\" src=\"../../data/images/C549-1005-1.jpg\"></center><br>Also, you know that there is a system to evaluate the beautifulness of a song. For each two consecutive notes a and b, if b comes after a, then the beautifulness for these two notes is evaluated as score(a, b).<br><br>So the total beautifulness for a song consisting of notes a<sub>1</sub>, a<sub>2</sub>, . . . , a<sub>n</sub>, is simply the sum of score(a<sub>i</sub>, a<sub>i+1</sub>) for 1 &#x2264; i &#x2264; n - 1.<br><br>Now, you find that at some positions, the notes have to be some specific ones, but at other positions you can decide what notes to use. You want to maximize your song&#x2019;s beautifulness. What is the maximum beautifulness you can achieve?","type":"description","format":"html"},{"title":"Input","content":"The first line contains an integer T (T &#x2264; 10), denoting the number of the test cases.<br><br>For each test case, the first line contains two integers n(1 &#x2264; n &#x2264; 100) and m(1 &#x2264; m &#x2264; 50) as mentioned above.  Then m lines follow, each of them consisting of m space-separated integers, the j-th integer in the i-th line for score(i, j)( 0 &#x2264; score(i, j) &#x2264; 100).  The next line contains n integers, a<sub>1</sub>, a<sub>2</sub>, . . . , a<sub>n</sub> (-1 &#x2264; a<sub>i</sub> &#x2264; m, a<sub>i</sub> &#x2260; 0), where positive integers stand for the notes you cannot change, while negative integers are what you can replace with arbitrary notes. The notes are named from 1 to m.","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output the answer in one line.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n5 3\n83 86 77\n15 93 35\n86 92 49\n3 3 3 1 2\n10 5\n36 11 68 67 29\n82 30 62 23 67\n35 29 2 22 58\n69 67 93 56 11\n42 29 73 21 19\n-1 -1 5 -1 4 -1 -1 -1 4 -1</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">270\n625</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2014+Asia+AnShan+Regional+Contest&amp;source=1&amp;searchmode=source\"> 2014 Asia AnShan Regional Contest </a> ","type":"source","format":"html"}]}