{"title":"The Hanged Man","time_limit":1000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6566","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6566&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6566","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6566"},"statement":[{"title":"Problem Description","content":"<i>The Hanged Man shows a man suspended from a t-shaped cross made out of living wood. The man is hanging upside-down, viewing the world from a completely different perspective. His facial expression is calm and serene, suggesting that he is in this hanging position by his own choice.</i><br><br>Bobo has two arrays $a_1$, $a_2$, . . . , $a_n$ and $b_1$, $b_2$, . . . , $b_n$. For each set $S$ $\\subseteq$ {1, 2, . . . , $n$}, he denotes $A(S)$ = $\\sum\\limits_{i \\subseteq S}$ $a_i$ and $B(S)$ = $\\sum\\limits_{i \\subseteq S}$ $b_i$.<br>Bobo also has a tree of $n$ vertices conveniently labeled with 1, 2, . . . , $n$. A set $S$ $\\subseteq$ {1, 2, . . . , $n$} is an <b>independent set</b> if and only if for any two vertices $u$ and $v$ connected directly on the tree, either $u$ $\\notin$ $S$ or $v$ $\\notin$ $S$ holds.<br>For each $x$ $\\subseteq$ {1, 2, . . . , $m$}, Bobo would like to find f(x) which is the number of <b>independnt set</b> S with $A(S)$ = $x$ and $B(S)$ maximized.<br>Formally, f(x) = |{$S$ : $S$ $\\subseteq$ $I$, $A(S)$ = $x$, $B(S)$ = $max^{A(T)=x}_{T \\subseteq I}$ $B(T)$}| where $I$ stands for the family of the independent sets. Suppose there is no $A(S)$ = $x$ for some $i$, then $f(x)$ = 0.<br>Find out the value of f(1), f(2), . . . , f(m).","type":"description","format":"html"},{"title":"Input","content":"The first line of the input contains one integer $T$ &#x2264; 20, denoting the number of testcases. Then $T$ testcases follows, separated with no extra blank lines.<br>The first line of each test case contains two integers $n$ and $m$.<br>The i-th of the following n lines contains two integers $a_i$ and $b_i$.<br>The i-th of the last (n - 1) lines contains two integers $u_i$ and $v_i$ which denotes an edge connected vertices $u_i$ and $v_i$.<br><br><li>1 &#x2264; n &#x2264; 50</li><br><li>1 &#x2264; m &#x2264; 5000</li><br><li>1 &#x2264; $a_i$ &#x2264; m</li><br><li>1 &#x2264; $b_i$ &#x2264; $10^6$</li><br><li>1 &#x2264; $u_i$, $v_i$ &#x2264; $n$</li>","type":"input_format","format":"html"},{"title":"Output","content":"For each testcase, first print &quot;Case $i$:&quot; in one line ($i$ indicates the case number, starting from 1). In the line, print m integers which denote f(1), f(2), . . . , f(m).","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n3 2\n1 1\n1 1\n1 1\n1 2\n1 3\n4 5\n1 1\n2 2\n3 2\n2 1\n1 2\n2 3\n3 4\n5 10\n3 1\n2 2\n4 4\n7 8\n5 16\n1 2\n1 3\n2 4\n2 5</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1:\n3 1\nCase 2:\n1 1 2 2 0\nCase 3:\n0 1 1 1 1 1 1 1 1 1</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2018CCPC%BC%AA%C1%D6%C8%FC%C7%F8%A3%A8%D6%D8%CF%D6%C8%FC%A3%A9-+%B8%D0%D0%BB%B1%B1%BB%AA%B4%F3%D1%A7&amp;source=1&amp;searchmode=source\"> 2018CCPC&#x5409;&#x6797;&#x8D5B;&#x533A;&#xFF08;&#x91CD;&#x73B0;&#x8D5B;&#xFF09;- &#x611F;&#x8C22;&#x5317;&#x534E;&#x5927;&#x5B66; </a> ","type":"source","format":"html"}]}