{"title":"Dihedral groups","time_limit":2000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=1486","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=1486&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=1486","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=1486"},"statement":[{"title":"Problem Description","content":"Consider n points on a unit circle with numbers k = 0, 1, ..., n-1. Initially point k makes an angle of 360 &#xB7; k / n degrees to the x-axis, measured in counter-clockwise direction. We are going to perform two different kind of operations on that set of points:<br><br><li>rotation by 360 / n degrees in clockwise direction</li><br><li>reflection with respect to the x-axis</li><br><br>The following picture shows an example of these operations:<br><br><center><img style=\"max-width:100%;\" src=\"/data/images/1486-1.png\"></center><br><br>Given a sequence of operations, we are interested in the shortest sequence of operations which gives the same result, i.e., the position of every single point is the same after performing either of those sequences of operations. <br><br>The sequence is given as a string consisting of the characters &apos;r&apos; and &apos;m&apos; which represent clockwise rotation and reflection respectively (&quot;to the right&quot; and &quot;mirror&quot;). Multiple consecutive occurrences of the same character are collected into the representation &lt;character&gt;&lt;number&gt;, and for convenience this will also be done for single occurrences. So &quot;rrmrrrrrrrrrrrr&quot; will be abbreviated to &quot;r2 m1 r12&quot;. The representations of different operations are always separated by a single space.<br>","type":"description","format":"html"},{"title":"Input","content":"The input file consists of several test cases. Each test case starts with a line containing n (3 &#x2264; n &#x2264; 10^8), the number of points. The second line of each test case consists of an abbreviated sequence of operations as described above. All numbers will be positive and less than 10^8. There will be no empty line in the input file, and no line will contain more than 100000 characters. The last test case is followed by a line containing 0.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case print one line containing the abbreviated format of the sequence with the minimum number of operations which results in the same configuration of points as the input sequence. In case of multiple optimal solutions, print any solution. Note that the second line of the sample output is a blank line.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">4\nr2\n100\nm1 r100 m1\n54\nr218 m3 r1\n0</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">r2\n\nr1 m1</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2006%2F2007+ACM-ICPC+University+of+Ulm+Local+Contest&amp;source=1&amp;searchmode=source\"> 2006/2007 ACM-ICPC University of Ulm Local Contest </a> ","type":"source","format":"html"}]}