{"title":"Triangle","time_limit":10000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5315","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5315&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5315","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5315"},"statement":[{"title":"Problem Description","content":"Soda has a complete undirected graph with $n$ vertices. He wants to color the edges with $m$ different colors conveniently labeled from $1$ to $m$. He first selects $p$ edges and colors them. Then he will randomly color the rest edges. He wants to know the total number of different good triangles among all possible graphs.<br><br>Let $i, j, k$ $(i &lt; j &lt; k)$ be three vertices in the graph. If there&apos;s an edge between $i$ and $j$, an edge between $j$ and $k$, an edge between $k$ and $i$. Then we call the tuple $(i, j, k)$ $(i &lt; j &lt; k)$ is a triangle in the graph. Let the colors for edge $(i,j)$, $(j,k)$, $(k,j)$ be $x$, $y$ and $z$. If $x \\ne y$ and $x \\ne z$ and $y \\ne z$, then we call the triangle good.<br><br>Two triangles are considered different if at least one of the six numbers $(i, j, k, x, y, z)$ is different.","type":"description","format":"html"},{"title":"Input","content":"There are multiple test cases. The first line of input contains an integer $T$ $(1 \\le T \\le 100)$, indicating the number of test cases. For each test case:<br><br>The first line contains three integers $n$, $m$ and $p$, $(3 \\le n \\le 100000, 1 \\le m, p \\le 200000)$.<br><br>Each of the next $p$ lines contains three integer $u, v, c$ $(1 \\le u &lt; v \\le n, 1 \\le c \\le m)$ which means the edge $(u, v)$ is colored with color $c$.<br><br>Each edge will be given at most once. Most cases are small.","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output the total number of good triangles modulo $2^{32}$.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n4 6 6\n1 2 1\n1 3 2\n1 4 3\n2 3 4\n2 4 5\n3 4 6</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">4\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nHuge input data, scanf is recommended.\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=BestCoder+1st+Anniversary+%28%24%29&amp;source=1&amp;searchmode=source\"> BestCoder 1st Anniversary ($) </a> ","type":"source","format":"html"}]}