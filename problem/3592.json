{"title":"World Exhibition","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3592","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3592&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3592","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3592"},"statement":[{"title":"Problem Description","content":"Nowadays, many people want to go to Shanghai to visit the World Exhibition. So there are always a lot of people who are standing along a straight line waiting for entering. Assume that there are N (2 &lt;= N &lt;= 1,000) people numbered 1..N who are standing in the same order as they are numbered. It is possible that two or more person line up at exactly the same location in the condition that those visit it in a group.<br><br>There is something interesting. Some like each other and want to be within a certain distance of each other in line. Some really dislike each other and want to be separated by at least a certain distance. A list of X (1 &lt;= X &lt;= 10,000) constraints describes which person like each other and the maximum distance by which they may be separated; a subsequent list of Y constraints (1 &lt;= Y &lt;= 10,000) tells which person dislike each other and the minimum distance by which they must be separated.<br><br>Your job is to compute, if possible, the maximum possible distance between person 1 and person N that satisfies the distance constraints.<br>","type":"description","format":"html"},{"title":"Input","content":"First line: An integer T represents the case of test.<br><br>The next line: Three space-separated integers: N, X, and Y. <br><br>The next X lines: Each line contains three space-separated positive integers: A, B, and C, with 1 &lt;= A &lt; B &lt;= N. Person A and B must be at most C (1 &lt;= C &lt;= 1,000,000) apart.<br><br>The next Y lines: Each line contains three space-separated positive integers: A, B, and C, with 1 &lt;= A &lt; B &lt;= C. Person A and B must be at least C (1 &lt;= C &lt;= 1,000,000) apart.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each line: A single integer. If no line-up is possible, output -1. If person 1 and N can be arbitrarily far apart, output -2. Otherwise output the greatest possible distance between person 1 and N.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n4 2 1\n1 3 8\n2 4 15\n2 3 4</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">19</div></pre>","type":"example","format":"html"},{"title":"Author","content":"alpc20","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2010+ACM-ICPC+Multi-University+Training+Contest%A3%A815%A3%A9%A1%AA%A1%AAHost+by+NUDT&amp;source=1&amp;searchmode=source\"> 2010 ACM-ICPC Multi-University Training Contest&#xFFFD;&#xFFFD;15&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;Host by NUDT </a> ","type":"source","format":"html"}]}