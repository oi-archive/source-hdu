{"title":"MAP","time_limit":1000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4329","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4329&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4329","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4329"},"statement":[{"title":"Problem Description","content":"Many people get information from Baidu&#xFFFD;&#xFFFD;Google&#xFFFD;&#xFFFD;Bing and so on. OK, now we will consider how to test the performance of a search system. <br>The testing is based on an annotation file&#xFFFD;&#xFFFD;annotation file consist of some query&#xFFFD;&#xFFFD;every query has a query word and many reference URL. For example&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;MM xxoo.com ooxx.com xoxo.com&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;MM&#xFFFD;&#xFFFD;is the query word and &#xFFFD;&#xFFFD;xxoo.com ooxx.com xoxo.com&#xFFFD;&#xFFFD;is the reference URL.<br>If we search the query word from search system, we can also get a result list, and then we can test the search performance by the result list and annotation file. You job is calculate the MAP of the search performance. The definition of MAP is&#xFFFD;&#xFFFD;<br>       <strong>Rank:</strong>  <br>                  Position of a retrieved URL in the list of retrieved list.<br>       <strong>Precision at a given cut-off rank r for a single query:</strong>  <br>                  P(r) = (number of relevant URL of rank r or less) / r<br>       <strong>Average precision:</strong> defined as follows<br><center><img style=\"max-width:100%;\" src=\"../../data/images/C400-1010-1.jpg\"></center><br>       Where N is the number of retrieved URL, R is the number of relevant URL, and rel(r) = 1 if URL at rank r is relevant, 0 otherwise. <br>       <strong>Mean average precision:</strong>  average precision for a set of queries is defined as follows:<br><center><img style=\"max-width:100%;\" src=\"../../data/images/C400-1010-2.jpg\"></center><br>       Where Q is the number of queries.","type":"description","format":"html"},{"title":"Input","content":"The first line of input contains T, the number of test cases.<br>For each test case start with a number n, the query number of annotation file. Then follows 2n lines, the first n lines are the annotation, every line means a query that has a word in front and the reference URL followed. The next n lines are the search result of the queries in annotation, every line means the search result of a query that has the search word in front and the retrieved URL followed.<br>n &lt;= 100.<br>The length of a line &lt;= 10000.<br>The length of a URL and word &lt;= 50.<br>","type":"input_format","format":"html"},{"title":"Output","content":"Case number ant the MAP value with 6 digits after decimal point.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n3\nBanana banana.com\nApple iphone.com ipad.com\nSoftware Microsoft.com IBM.com Google.com\nBanana asd.com banana.com\nApple gdfgd.com iphone.com ipad.com\nSoftware gdf.com wer.com tre.com</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1: 0.361111</div></pre>","type":"example","format":"html"},{"title":"Author","content":"BJTU","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2012+Multi-University+Training+Contest+3&amp;source=1&amp;searchmode=source\"> 2012 Multi-University Training Contest 3 </a> ","type":"source","format":"html"}]}