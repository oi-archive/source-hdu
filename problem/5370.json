{"title":"Tree Maker","time_limit":3000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5370","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5370&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5370","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5370"},"statement":[{"title":"Problem Description","content":"Tree Lover loves trees crazily.<br><br>One day he invents an interesting game which is named Tree Maker.<br><br>In this game, all trees are <b>binary trees</b>.<br><br>Initially, there is a tree with <b>only one</b> vertex and a cursor on it. Tree Lover can control the cursor to apply 5 operations to build a tree, and their formats are following:<br><br>0  : Jump to the parent of the current vertex.<br><br>1  : Jump to the left child of the current vertex.<br><br>2  : Jump to the right child of the current vertex.<br><br>3 x : Generate a tree with x vertices arbitrarily and make it the left subtree of the current vertex.<br><br>4 x : Generate a tree with x vertices arbitrarily and make it the right subtree of the current vertex.<br><br>When applying an operation, the log system will log down a record of it.<br><br>Tree Lover played this game for a whole day yesterday. As a forgetful man, although Tree Lover knew the shape of the tree  while playing, after a sleep he forgot it.<br><br>All he has now is the logs of operations.<br><br>Tree Lover wants to know: how many possible shapes of the tree can have yesterday according to the logs?<br><br>Can you answer this question?<br>","type":"description","format":"html"},{"title":"Input","content":"The input consists of multiple test cases.<br><br>For each test case:<br><br>The first line is an integer n (1 &lt;= n &lt;= 500), denoting the lines of logs.<br><br>Then follow n lines of logs. The formats of logs are as described above.<br><br>The integer x of operation 3 and 4 is positive.<br><br>In each case, the number of vertices of the tree will never exceed 500.<br><br>You can assume that <b>the cursor will never jump to a non-existent vertex</b>.<br><br>If the left child of a vertex exists, operation 3 will not be applied on this vertex, and operation 4 is similar.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, ouput a single line &#xFFFD;&#xFFFD;Case #x: y&#xFFFD;&#xFFFD;, where x is the case number, starting from 1, and y is the answer to Tree Lover&#xFFFD;&#xFFFD;s question.<br><br>Because the answer can be large, please output the answer mod 1000000007.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n3 3\n4 3\n2\n3 3\n1</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1: 25\nCase #2: 5\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nBecause the tree is a binary tree, if left and right subtrees of a vertex are of different shapes, after swapping them, the new tree is considered different from the original one.</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Author","content":"UESTC","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2015+Multi-University+Training+Contest+7&amp;source=1&amp;searchmode=source\"> 2015 Multi-University Training Contest 7 </a> ","type":"source","format":"html"}]}