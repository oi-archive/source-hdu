{"title":"Palindrome Function","time_limit":4000,"memory_limit":250,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6156","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6156&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6156","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6156"},"statement":[{"title":"Problem Description","content":"As we all know,a palindrome number is the number which reads the same backward as forward,such as 666 or 747.Some numbers are not the palindrome numbers in decimal form,but in other base,they may become the palindrome number.Like 288,it&#xFFFD;&#xFFFD;s not a palindrome number under 10-base.But if we convert it to 17-base number,it&#xFFFD;&#xFFFD;s GG,which becomes a palindrome number.So we define an interesting function f(n,k) as follow:<br>f(n,k)=k if n is a palindrome number under k-base.<br>Otherwise f(n,k)=1.<br>Now given you 4 integers L,R,l,r,you need to caluclate the mathematics expression $ \\sum_{i=L}^{R}\\sum_{j=l}^{r}f(i,j) $  .<br>When representing the k-base(k&gt;10) number,we need to use A to represent 10,B to represent 11,C to repesent 12 and so on.The biggest number is Z(35),so we only discuss about the situation at most 36-base number.","type":"description","format":"html"},{"title":"Input","content":"The first line consists of an integer T,which denotes the number of test cases.<br>In the following T lines,each line consists of 4 integers L,R,l,r.<br>($ 1 \\leq T \\leq 10^5, 1 \\leq L \\leq R \\leq 10^9, 2 \\leq l \\leq r \\leq 36$)","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output the answer in the form of &#xFFFD;&#xFFFD;Case #i: ans&#xFFFD;&#xFFFD; in a seperate line.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n1 1 2 36\n1 982180 10 10\n496690841 524639270 5 20</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1: 665\nCase #2: 1000000\nCase #3: 447525746</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2017%D6%D0%B9%FA%B4%F3%D1%A7%C9%FA%B3%CC%D0%F2%C9%E8%BC%C6%BE%BA%C8%FC+-+%CD%F8%C2%E7%D1%A1%B0%CE%C8%FC&amp;source=1&amp;searchmode=source\"> 2017&#xFFFD;&#x439;&#xFFFD;&#xFFFD;&#xFFFD;&#x467;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#x1BE;&#xFFFD;&#xFFFD;&#xFFFD; - &#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#x461;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD; </a> ","type":"source","format":"html"}]}