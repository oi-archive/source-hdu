{"title":"Rikka with Phi","time_limit":8000,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5634","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5634&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5634","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5634"},"statement":[{"title":"Problem Description","content":"Rikka and Yuta are interested in Phi function (which is known as Euler&apos;s totient function).<br><br>Yuta gives Rikka an array $A[1..n]$ of positive integers,  then Yuta makes $m$ queries.  <br><br>There are three types of queries: <br><br>$ 1   \\; l  \\; r $ <br><br>Change $A[i]$  into $\\varphi(A[i])$, for all $i \\in [l, r]$.<br><br>$ 2   \\; l  \\; r  \\; x$ <br><br>Change $A[i]$ into $x$, for all $i \\in [l, r]$.<br><br>$ 3   \\; l  \\; r $ <br><br>Sum up $A[i]$, for all $i \\in [l, r]$.<br><br>Help Rikka by computing the results of queries of type 3.<br><br>","type":"description","format":"html"},{"title":"Input","content":"The first line contains a number $T(T \\leq 100)$ &#x2014;&#x2014;The number of the testcases. And there are no more than 2 testcases with $n &gt; 10 ^ 5$<br><br>For each testcase, the first line contains two numbers $n,m(n \\leq 3 \\times 10^5, m \\leq 3 \\times 10^5)$&#x3002;<br><br>The second line contains $n$ numbers $A[i]$<br><br>Each of the next $m$ lines contains the description of the query. <br><br>It is guaranteed that $1 \\leq A[i] \\leq 10^7$ At any moment.","type":"input_format","format":"html"},{"title":"Output","content":"For each query of type 3, print one number which represents the answer.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n10 10\n56 90 33 70 91 69 41 22 77 45\n1 3 9\n1 1 10\n3 3 8\n2 5 6 74\n1 1 8\n3 1 9\n1 2 10\n1 4 9\n2 8 8 69\n3 3 9</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">80\n122\n86</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=BestCoder+Round+%2373+%28div.1%29&amp;source=1&amp;searchmode=source\"> BestCoder Round #73 (div.1) </a> ","type":"source","format":"html"}]}