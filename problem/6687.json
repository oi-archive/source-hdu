{"title":"Rikka with Stable Marriage","time_limit":5000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6687","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6687&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6687","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6687"},"statement":[{"title":"Problem Description","content":"People in love always feel humble. Sometimes, Rikka is worried about whether she deserves love from Yuta.<br><br>Stable marriage problem is an interesting theoretical model which has a strong connection with the real world. Given $n$ men and $n$ women, where each person has ranked all members of the opposite sex in order of preference. We use a permutation $p$ of length $n$ to represent a match that the $i$th man gets married with the $p_i$th woman. A match is stable if and only if there are no two people of opposite sexes who would both rather have each other than their current partners, i.e., $\\forall i \\neq j, \\neg (r_i(p_j,p_i) \\wedge r_{p_j}(i,j))$ where $r_a(b,c)$ represents whether person $a$ loves $b$ more than $c$.<br><br>Rikka wants to resolve the confusion in her mind by considering a special case of the stable marriage problem. Rikka uses a feature integer to represents a person&apos;s character, and for two persons with feature integers equal to $x$ and $y$, Rikka defines the suitable index of them as $x \\oplus y$, where $\\oplus$ represents binary exclusive-or.<br><br>Given $n$ men with feature integers $a_1, \\dots, a_n$ and $n$ women with feature integers $b_1, \\dots, b_n$. For the $i$th man, he loves the $j$th woman more than the $k$th woman if and only if $a_i \\oplus b_j &gt; a_i \\oplus b_k$; for the $i$th woman, she loves the $j$th man more than the $k$th man if and only if $b_i \\oplus a_j &gt; b_i \\oplus a_k$. <br><br>Rikka wants to calculate the best stable match for this problem, i.e., let $\\mathbb P$ be the set of all stable match, she wants to calculate $\\max_{p \\in \\mathbb P} \\left(\\sum_{i=1}^n \\left(a_i \\oplus b_{p_i} \\right) \\right)$. Since $n$ is quite large, this problem is too difficult for Rikka, could you please help her find the answer?","type":"description","format":"html"},{"title":"Input","content":"The first line of the input contains a single integer $T(1 \\leq T \\leq 50)$, the number of test cases.<br><br>For each test case, the fisrt line contains a sigle integer $n(1 \\leq n \\leq 10^5)$. <br><br>The second line contains $n$ integers $a_1, \\dots, a_n(1 \\leq a_i \\leq 10^9)$ which represents the feature number of each man. <br><br>The third line contains $n$ integers $b_1, \\dots, b_n(1 \\leq b_i \\leq 10^9)$ which represents the feature number of each woman.<br><br>The input guarantees that there are no more than $5$ test cases with $n &gt; 10^4$, and for any $i,j \\in [1,n], i \\neq j$, $a_i \\neq a_j$ and $b_i \\neq b_j$.","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output a single line with a single integer, the value of the best stable match. If there is no stable match, output $-1$.<br><br><div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>In the first test case, one of the best matches is $(2,1,4,3)$. Therefore the answer is $(1 \\oplus 2) + (2 \\oplus 1) + (3 \\oplus 4) + (4 \\oplus 3) = 20$.</div>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n4\n1 2 3 4\n1 2 3 4\n5\n10 20 30 40 50\n15 25 35 45 55</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">20\n289</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2019+Multi-University+Training+Contest+9&amp;source=1&amp;searchmode=source\"> 2019 Multi-University Training Contest 9 </a> ","type":"source","format":"html"}]}