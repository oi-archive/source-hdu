{"title":"Rebuild","time_limit":1000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5531","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5531&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5531","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5531"},"statement":[{"title":"Problem Description","content":"Archaeologists find ruins of Ancient ACM Civilization, and they want to rebuild it.<br><br>The ruins form a closed path on an x-y plane, which has $n$ endpoints. The endpoints locate on $(x_1,y_1)$, $(x_2,y_2)$, $\\ldots,(x_n,y_n)$ respectively. Endpoint $i$ and endpoint $i-1$ are adjacent for $1&lt;i\\leq n$, also endpoint $1$ and endpoint $n$ are adjacent. Distances between any two adjacent endpoints are positive integers.<br><br>To rebuild, they need to build one cylindrical pillar at each endpoint, the radius of the pillar of endpoint $i$ is $r_i$. All the pillars perpendicular to the x-y plane, and the corresponding endpoint is on the centerline of it. We call two pillars are adjacent if and only if two corresponding endpoints are adjacent. For any two adjacent pillars, one must be tangent externally to another, otherwise it will violate the aesthetics of Ancient ACM Civilization. If two pillars are not adjacent, then there are no constraints, even if they overlap each other.<br><br>Note that $r_i$ must not be less than $0$ since we cannot build a pillar with negative radius and pillars with zero radius are acceptable since those kind of pillars still exist in their neighbors.<br><br>You are given the coordinates of $n$ endpoints. Your task is to find $r_1,r_2,\\ldots,r_n$ which makes sum of base area of all pillars as minimum as possible.<br><br><center><img style=\"max-width:100%;\" src=\"../../data/images/C646-1005-1.jpg\"></center><br><br>For example, if the endpoints are at $(0,0)$, $(11,0)$, $(27,12)$, $(5,12)$, we can choose ($r_1$, $r_2$, $r_3$, $r_4$)$=$($3.75$, $7.25$, $12.75$, $9.25$). The sum of base area equals to $3.75^2\\pi+$$7.25^2\\pi+12.75^2\\pi+9.25^2\\pi=988.816\\ldots$. Note that we count the area of the overlapping parts multiple times.<br><br>If there are several possible to produce the minimum sum of base area, you may output any of them.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line contains an integer $t$ indicating the total number of test cases. The following lines describe a test case.<br><br>The first line of each case contains one positive integer $n$, the size of the closed path. Next $n$ lines, each line consists of two integers $(x_i,y_i)$ indicate the coordinate of the $i$-th endpoint.<br><br>$1 \\le t \\le 100$<br>$3 \\le n \\le 10^4$<br>$|x_i|,|y_i|\\leq 10^4$<br>Distances between any two adjacent endpoints are positive integers.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"If such answer doesn&apos;t exist, then print on a single line &quot;IMPOSSIBLE&quot; (without the quotes). Otherwise, in the first line print the minimum sum of base area, and then print $n$ lines, the $i$-th of them should contain a number $r_i$, rounded to 2 digits after the decimal point.<br><br>If there are several possible ways to produce the minimum sum of base area, you may output any of them.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n4\n0 0\n11 0\n27 12\n5 12\n5\n0 0\n7 0\n7 3\n3 6\n0 6\n5\n0 0\n1 0\n6 12\n3 16\n0 12</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">988.82\n3.75\n7.25\n12.75\n9.25\n157.08\n6.00\n1.00\n2.00\n3.00\n0.00\nIMPOSSIBLE</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2015ACM%2FICPC%D1%C7%D6%DE%C7%F8%B3%A4%B4%BA%D5%BE-%D6%D8%CF%D6%C8%FC%A3%A8%B8%D0%D0%BB%B6%AB%B1%B1%CA%A6%B4%F3%A3%A9&amp;source=1&amp;searchmode=source\"> 2015ACM/ICPC&#x4E9A;&#x6D32;&#x533A;&#x957F;&#x6625;&#x7AD9;-&#x91CD;&#x73B0;&#x8D5B;&#xFF08;&#x611F;&#x8C22;&#x4E1C;&#x5317;&#x5E08;&#x5927;&#xFF09; </a> ","type":"source","format":"html","require":["katex"]}]}