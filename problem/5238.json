{"title":"Calculator","time_limit":5000,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5238","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5238&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5238","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5238"},"statement":[{"title":"Problem Description","content":"Sakura has invented a new kind of calculator that can evaluate expressions. This calculator maintains a serial of operators and numbers inside. All these numbers and operators form an ordered table. For example<br><br>$*4 \\quad  + 2 \\quad \\hat{} 3 \\quad + 8 \\quad * 6$<br><br>is a possible table. The calculator also supports the following two operations.<br><br>1. 1 $x$.<br><br>This corresponds to the evaluation operation. For instance, if $x=2$, together with the table being the one described above, the calculator will output<br><br>$ ((((2*4)+2)^3)+8)*6=6048.$<br><br>As for $x=3$, it will output<br><br>$((((3*4)+2)^3)+8)*6=16512.$<br><br>2. 2 $p$ $cx$.<br><br>This corresponds to the modification operation. The calculator will change the $p$-th term in the expression to $cx$. Here $c$ denotes an operator while $x$ denotes a number.<br><br>For example, if $p=3$ and $cx=*5$, the expression will become<br><br>$*4 \\quad  + 2 \\quad *5 \\quad + 8 \\quad * 6.$<br><br>Now you are asked to implement this calculator. However, for technical reasons, you should just output the result modulo 29393. It is guaranteed that, in all terms appeared in the input data, $c \\in \\{+, *, \\hat{} \\}$, $0 \\le x &lt; 29393$.<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line contains an integer $T$($T \\le 10$), denoting the number of test cases. It is guaranteed that $1 \\le n, m \\le 50000$.<br><br>For each test case, the first line contains two numbers $n, m$. $n$ denotes the number of terms in the expression, $m$ denotes the number of operations.<br><br>In the following $n$ lines, each line contains a term in style of $cx$, denotes each term in the initial table.<br><br>In the following $m$ lines, each line contains an operation. It must in style of &apos;&apos;$1 \\quad x$&apos;&apos; or &apos;&apos;$2\\quad p \\quad cx$&apos;&apos;.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, output Case #t: in a single line to represent the $t$-th case.<br>Then in each test case, output the result modulo 29393 for each evaluation operation.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n5 4\n*4\n+2\n^3\n+8\n*6\n1 2\n1 3\n2 3 *5\n1 3\n4 3\n*4\n^4\n+4\n*10\n1 1\n2 3 ^4\n1 1</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1:\n6048\n16512\n468\nCase #2:\n2600\n4107\nP</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=The+2015+ACM-ICPC+China+Shanghai+Metropolitan+Programming+Contest&amp;source=1&amp;searchmode=source\"> The 2015 ACM-ICPC China Shanghai Metropolitan Programming Contest </a> ","type":"source","format":"html","require":["katex"]}]}