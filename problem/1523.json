{"title":"Decoding Morse Sequences","time_limit":10000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=1523","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=1523&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=1523","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=1523"},"statement":[{"title":"Problem Description","content":"Before the digital age, the most common &quot;binary&quot; code for radio communication was the Morse code. In Morse code, symbols are encoded as sequences of short and long pulses (called dots and dashes respectively). The following table reproduces the Morse code for the alphabet, where dots and dashes are represented as ASCII characters &quot;.&quot; and &quot;-&quot;:<br><br><img style=\"max-width:100%;\" src=\"/data/images/1523-1.gif\"><br>Notice that in the absence of pauses between letters there might be multiple interpretations of a Morse sequence. For example, the sequence -.-..-- could be decoded both as CAT or NXT (among others). A human Morse operator would use other context information (such as a language dictionary) to decide the appropriate decoding. But even provided with such dictionary one can obtain multiple phrases from a single Morse sequence.<br><br>Write a program which for each data set:<br><br>reads a Morse sequence and a list of words (a dictionary),<br><br>computes the number of distinct phrases that can be obtained from the given Morse sequence using words from the dictionary,<br><br>writes the result.<br><br>Notice that we are interested in full matches, i.e. the complete Morse sequence must be matched to words in the dictionary.<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The rst line of the input contains exactly one positive integer d equal to the number of data sets, 1 &lt;= d &lt;= 20. The data sets follow.<br><br>The first line of each data set contains a Morse sequence - a nonempty sequence of at most 10 000 characters &quot;.&quot; and &quot;-&quot; with no spaces in between.<br><br>The second line contains exactly one integer n, 1 &lt;= n &lt;= 10 000, equal to the number of words in a dictionary. Each of the following n lines contains one dictionary word - a nonempty sequence of at most 20 capital letters from &quot;A&quot; to &quot;Z&quot;. No word occurs in the dictionary more than once.<br><br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"The output should consist of exactly d lines, one line for each data set. Line i should contain one integer equal to the number of distinct phrases into which the Morse sequence from the i-th data set can be parsed. You may assume that this number is at most 2 * 10^9 for every single data set.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n.---.--.-.-.-.---...-.---.\n6\nAT\nTACK\nTICK\nATTACK\nDAWN\nDUSK</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=Central+Europe+2001&amp;source=1&amp;searchmode=source\"> Central Europe 2001 </a> ","type":"source","format":"html","require":["katex"]}]}