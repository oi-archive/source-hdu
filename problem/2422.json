{"title":"Essay Scoring System","time_limit":2000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=2422","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=2422&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=2422","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=2422"},"statement":[{"title":"Problem Description","content":"Professor Binns has finally got tired of scoring essays himself and implemented an automatic essay scoring system to help him screen the numerous essays. Strongly against such an idea, you decided to generate a meaningless essay which can get high mark in his system to prove that his system does not work at all. You&apos;ve obtained the rules used by Binns&apos;s system to score the essay, they&apos;re as follows:<br>&#xA0;&#xA0;&#xA0;&#xA0;a)&#xA0;&#xA0;The word in the essay must be from a particular set of words. If not, the essay will receive a score zero and is automatically rejected.<br>&#xA0;&#xA0;&#xA0;&#xA0;b)&#xA0;&#xA0;Every word in the specified set has a positive integer associated with it, indicating the score the submitter will get for using that word once.<br>&#xA0;&#xA0;&#xA0;&#xA0;c)&#xA0;&#xA0;A word can be used in several different ways; for example, in English, the word &#xFFFD;&#xFFFD;word&#xFFFD;&#xFFFD; can be used as both a noun and a verb. Every occurrence of specific patterns (like verb &#xFFFD;C adjective &#xFFFD;C noun) will earn the submitter a particular score.<br>&#xA0;&#xA0;&#xA0;&#xA0;In particular, it is allowed for a word to be interpreted in different ways in different patterns.<br>You&apos;re interested in generating an essay of a specified length with maximum possible score. <br>","type":"description","format":"html"},{"title":"Input","content":"There are multiple test cases in the input file. Each test case starts with three integers N, M and K, (1 &lt;= N &lt;= 100, 0 &lt;= M &lt;= 8, 0 &lt;= K &lt;= 6), the length of the essay to generate, the number of words in the dictionary and the number of patterns, respectively. The following M lines describe the words in the dictionary; each line consists of two integers, W<sub>i</sub>, and T<sub>i</sub>, (0 &lt;= W<sub>i</sub> &lt;= 2000, 1 &lt;= T<sub>i</sub> &lt;= 5), representing the score submitter gets every time he/she uses the word, and the number of ways the word can be used. The next part of the input describes the patterns. Each of the K lines describes one pattern, beginning with two integers, W<sub>i</sub>, and C<sub>i</sub>, (0 &lt;= W<sub>i</sub> &lt;= 2000, 1 &lt;= C<sub>i</sub> &lt;= 6), indicating the score one can get every time the pattern is used, and the number of consecutive parts in the pattern; followed by C<sub>i</sub> integers describing the language parts in the pattern. It is guaranteed that the total number of ways to use a word does not exceed 5; furthermore, the total number of parts contained in all patterns (sum of all C<sub>i</sub>s) will not exceed 25.<br>There is a blank line after each test case. Input ends with End-of-File.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For every test case, you should output one integer on a separate line, the maximum score one can get, in the format as indicated in the sample output.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2 3 2\n4 3 0 1 2\n5 2 2 3\n1 2 0 4\n1 2 1 3\n10 2 4 2\n\n2 3 2\n4 3 0 1 2\n5 2 2 3\n1 2 0 4\n1 2 1 3\n2 2 4 2</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1: 16\nCase 2: 10 </div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2008+Asia+Hangzhou+Regional+Contest+Online&amp;source=1&amp;searchmode=source\"> 2008 Asia Hangzhou Regional Contest Online </a> ","type":"source","format":"html"}]}