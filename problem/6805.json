{"title":"Deliver the Cake","time_limit":2000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6805","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6805&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6805","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6805"},"statement":[{"title":"Problem Description","content":"It is Zhang3&apos;s birthday! Zhang3 has bought a birthday cake and now it&apos;s time to take it home.<br><br>There are $n$ villages, labeled $1, 2, \\ldots, n$. There are $m$ bidirectional roads, the $i^\\mathrm{th}$ of which connects village $a_i$, $b_i$ and it is $d_i$ meter(s) long.<br><br>The bakery locates at village $s$ and Zhang3&apos;s home locates at village $t$. So Zhang3 wants to carry the cake from $s$ to $t$. She can carry the cake either with her left hand or with her right hand. She can switch to the other hand during the trip, which takes extra $x$ second(s) each time (when she&apos;s performing this action, she must stay in her place). Switching is allowed at any place, including the middle of the roads. She can do this as many times as she like, or don&apos;t do it at all. <br><br>Some villages are LEFT. When Zhang3 is at a LEFT village, she must carry the cake with her left hand at the moment. In the same way, some other villages are RIGHT, she must carry with her right hand when she&apos;s at these villages. The rest villages are called MIDDLE. There&apos;s no special rules at MIDDLE villages.<br><br>Zhang3 can start and finish with any hand carrying the cake. However, if $s$ or $t$ is not MIDDLE, their special rules must be followed.<br><br>Please help Zhang3 find a way to take the cake home, with the minimum amount of spent time.<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line of the input gives the number of test cases, $T \\; (1 \\le T \\le 100)$. $T$ test cases follow.<br><br>For each test case, the first line contains five integers $n, m, s, t, x \\; (1 \\le n \\le 10^5, \\; 1 \\le m \\le 2 \\times 10^5, \\; 1 \\le x \\le 10^9)$, representing the number of villages, the number of roads, the bakery&apos;s location, home&apos;s location, and the time spent for each switching.<br><br>The next line contains a string of length $n$, describing the type of each village. The $i^\\mathrm{th}$ character is either $\\text{L}$ representing village $i$ is LEFT, or $\\text{M}$ representing MIDDLE, or $\\text{R}$ representing RIGHT.<br><br>Finally, $m$ lines follow, the $i^\\mathrm{th}$ of which contains three integers $a_i, b_i, d_i \\; (1 \\le d_i \\le 10^9)$, denoting a road connecting village $a_i$ and $b_i$ of length $d_i$.<br><br>It is guaranteed that $t$ can be reached from $s$.<br><br>The sum of $n$ in all test cases doesn&apos;t exceed $2 \\times 10^5$. The sum of $m$ doesn&apos;t exceed $4 \\times 10^5$.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, print a line with an integer, representing the minimum amount of spent time (in seconds).<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n3 3 1 3 100\nLRM\n1 2 10\n2 3 10\n1 3 100</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">100</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2020+Multi-University+Training+Contest+4&amp;source=1&amp;searchmode=source\"> 2020 Multi-University Training Contest 4 </a> ","type":"source","format":"html","require":["katex"]}]}