{"title":"String and String","time_limit":3000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6054","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6054&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6054","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6054"},"statement":[{"title":"Problem Description","content":"You are given two strings S and T ,we define the &quot;Sval&quot; :<br><br>1. consider the substring $T.substring(a_i\\otimes ans,b_i\\otimes ans)$ in the substring $S.substring(c_i\\otimes ans,d_i\\otimes ans)$ perfect matching.<br>2. assume all the positions of matching is $[x_0,y_0],[x_1,y_1]...[x_k,y_k]$ while<br> $T.substring(a_i\\otimes ans,b_i\\otimes ans)$=$S.substring(x_0,y_0)$=$S.substring(x_1,y_1)$=...=$S.substring(x_k,y_k)$   $\\quad (c_i\\otimes ans\\leq x_i,y_i\\leq d_i\\otimes ans)$<br>3. define then $ Sval=\\sum_{i=0}^{k}f[y_i]$<br><br>And Zhu thinks it&apos;s too easy and he can modify the $f[a_i\\otimes ans]$ to $b_i\\otimes ans$.<br><br>note:<br>1. the &quot;$ans$&quot; shows before is the answer of the last query,at first ans=0.<br>2. the symbol &quot;$\\otimes$&quot; is xor in binary system<br>3. the index is 0-based","type":"description","format":"html"},{"title":"Input","content":"The first line is an integer T($1 \\leq T \\leq 10$) describe the number of test cases.<br>Each test case begins with two strings S and T,($|S|,|T|\\leq 100000,\\sum{|S|+|T|}\\leq 400000$,each character is lowercase letters from the alphabet).<br>Then a line contains $|S|$ numbers describe each element of $f$.($0 \\leq f_i \\leq 10000$)<br>The next line contains number of operators Q ($Q\\leq 100000,\\sum{Q}\\leq 200000$).<br>The operators have two types:<br>1.modify the $f[a_i\\otimes ans]$ to $b_i\\otimes ans$ ($0\\leq  b_i\\otimes ans\\leq 10000$)<br>2.query the Sval of $T.substring(a_i\\otimes ans,b_i\\otimes ans)$ in $S.substring(c_i\\otimes ans,d_i\\otimes ans)$ <br>The remaining Q lines contain operators in the form $t_i\\ a_i\\  b_i$ if $t_i=1$;$t_i\\ a_i\\  b_i\\ c_i\\  d_i$ if $t_i=2$ denoting the type of the operators and the parameters respectively.","type":"input_format","format":"html"},{"title":"Output","content":"For each query output one integer which means the answer.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\naaaa\naaaa\n0 1 2 3\n3\n2 0 0 0 3\n1 6 3\n2 6 6 6 5</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">6\n11</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2017+Multi-University+Training+Contest+-+Team+2&amp;source=1&amp;searchmode=source\"> 2017 Multi-University Training Contest - Team 2 </a> ","type":"source","format":"html"}]}