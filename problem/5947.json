{"title":"Fxx and factory","time_limit":4000,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5947","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5947&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5947","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5947"},"statement":[{"title":"Problem Description","content":"Young theoretical computer scientist Fxx goes to a factory.<br><br>In the factory,there are $n$ receiving barrel in a row from left to right.The plan has m operations,and each operation has to be one of the following three ways<br><br>$(1,x,y)\\:$&#xFFFD;&#xFFFD;put $y$ products into $x\\:$th barrel(counted from left to right).<br><br>$(2,x)\\:$&#xFFFD;&#xFFFD;Take out all the products in the $x$th barrel(counted from left to right).<br><br>$(3,x,y)\\:$ Swap the $x$th barrel and $y$th barrel(counted from left to right)<br><br>Then the factory will continue to repeat the $m$ operations in turn,and give $Q$ queries,each query will give an integer $k$, asking after $mk$ operations(repeat the $m$ operations $k$ times),the maximum number of products in the $n$ barrel&#xFFFD;&#xFFFD;<br>","type":"description","format":"html"},{"title":"Input","content":"In the first line, there is an integer $T(T\\leq 5)$ indicating the number of test cases.<br><br>For each case, the first line contains three integers $n,m,Q(n\\leq1000,m\\leq10^5,Q\\leq3\\times10^5)$<br><br>In the next $m$ lines,each line contains an operation.<br><br>In the next $Q$ lines,each line contains an integer $k(k\\leq10^9)$ indicating an query.<br><br>We guarantee that each answer is no more than $10^{18}$.<br><br>We guarantee that the number of operation $2$ is no more than 100, under this condition, all other operations are randomly.<br><br>&lt;b&gt;This problem does not support hack.&lt;/b&gt;<br>","type":"input_format","format":"html"},{"title":"Output","content":"Print a response for each query in a separate line.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n3 6 4\n1 2 7\n1 1 8\n3 1 3\n1 1 4\n2 2\n1 2 2\n1\n3\n5\n12</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">8\n20\n32\n72</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=BestCoder+Round+%2389&amp;source=1&amp;searchmode=source\"> BestCoder Round #89 </a> ","type":"source","format":"html"}]}