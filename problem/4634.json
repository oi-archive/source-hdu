{"title":"Swipe Bo","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4634","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4634&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4634","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4634"},"statement":[{"title":"Problem Description","content":"&#xFFFD;&#xFFFD;Swipe Bo&#xFFFD;&#xFFFD; is a puzzle game that requires foresight and skill. <br>The main character of this game is a square blue tofu called Bo. We can swipe up / down / left / right to move Bo up / down / left / right. Bo always moves in a straight line and nothing can stop it except a wall. You need to help Bo find the way out.<br>The picture A shows that we needs three steps to swipe Bo to the exit (swipe up, swipe left, swipe down). In a similar way, we need only two steps to make Bo disappear from the world (swipe left, swipe up)!<br><center><img style=\"max-width:100%;\" src=\"../../data/images/C457-1003-1.jpg\"></center><br>Look at the picture B. The exit is locked, so we have to swipe Bo to get all the keys to unlock the exit. When Bo get all the keys, the exit will unlock automatically .The exit is considered inexistent if locked. And you may notice that there are some turning signs, Bo will make a turn as soon as it meets a <br><center><img style=\"max-width:100%;\" src=\"../../data/images/C457-1003-2.jpg\"></center><br>turning signs. For example, if we swipe Bo up, it will go along the purple line.<br>Now, your task is to write a program to calculate the minimum number of moves needed for us to swipe Bo to the exit.","type":"description","format":"html"},{"title":"Input","content":"The input contains multiple cases, no more than 40.<br>The first line of each test case contains two integers N and M (1&#xFFFD;&#xFFFD;N, M&#xFFFD;&#xFFFD;200), which denote the sizes of the map. The next N lines give the map&#xFFFD;&#xFFFD;s layout, with each line containing M characters. A character is one of the following: &apos;#&apos;: represents the wall; &apos;S&apos; represents the start point of the Bo; &apos;E&apos; represents the exit; &apos;.&apos; represents an empty block; &#xFFFD;&#xFFFD;K&#xFFFD;&#xFFFD; represents the key, and there are no more than 7 keys in the map; &apos;L&apos;,&apos;U&apos;,&apos;D&apos;,&apos;R&apos; represents the turning sign with the direction of left, up, down, right.","type":"input_format","format":"html"},{"title":"Output","content":"For each test case of the input you have to calculate the minimal amount of moves which are necessary to make Bo move from the starting point to the exit. If Bo cannot reach the exit, output -1. The answer must be written on a single line.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5 6\n######\n#....#\n.E...#\n..S.##\n.#####\n5 6\n######\n#....#\n.....#\nSEK.##\n.#####\n5 6\n######\n#....#\n....K#\nSEK.##\n.#####\n5 6\n######\n#....#\nD...E#\nS...L#\n.#####</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n2\n7\n-1</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2013+Multi-University+Training+Contest+4&amp;source=1&amp;searchmode=source\"> 2013 Multi-University Training Contest 4 </a> ","type":"source","format":"html"}]}