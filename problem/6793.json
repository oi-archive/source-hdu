{"title":"Tokitsukaze and Colorful Tree","time_limit":16000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6793","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6793&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6793","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6793"},"statement":[{"title":"Problem Description","content":"Tokitsukaze has a rooted tree with $n$ nodes, whose nodes are labeled from $1$ to $n$ and whose root is node $1$. Furthermore, each node $i$ has its own color $col_i$ and its own weight $val_i$, where the color is labeled as a number between $1$ and $n$, representing one of $n$ given colors.<br><br>Here are two types of operation:<br><br>&#xA0;&#xA0;&#xA0;&#xA0;&#x25CF; $1$ $x$ $v$ -- set $val_x$ as $v$.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#x25CF; $2$ $x$ $c$ -- set $col_x$ as $c$.<br><br>Tokitsukaze wants to execute $q$ opeations and for $i = 1, 2, \\ldots, q + 1$, after finishing the first $(i - 1)$ operations, she wants to know the value of $$\\sum_{\\substack{1 \\leq u &lt; v \\leq n \\\\ col_u = col_v \\\\ \\text{node }u\\text{ is not an ancestor of node }v \\\\ \\text{node }v\\text{ is not an ancestor of node }u}}{(val_u \\oplus val_v)}$$ where $\\oplus$ is the bitwise exclusive OR operation.<br><br>If you are not familiar with the bitwise exclusive OR, you may refer to <a href=\"http://en.wikipedia.org/wiki/Bitwise_operation#XOR\">http://en.wikipedia.org/wiki/Bitwise_operation#XOR</a> and <a href=\"http://baike.baidu.com/item/xor/64178\">http://baike.baidu.com/item/xor/64178</a>.<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"There are several test cases.<br><br>The first line contains an integer $T$ ($1 \\leq T \\leq 8$), denoting the number of test cases. Then follow all the test cases.<br><br>For each test case, the first line contains an integer $n$ $(1 \\leq n \\leq 10^5)$, denoting the number of nodes.<br><br>The second line contains $n$ integers, where the $i$-th intger is $col_i$ $(1 \\leq col_i \\leq n)$, denoting the color of node $i$ at the beginning.<br><br>The third line contains $n$ integers, where the $i$-th intger is $val_i$ $(0 \\leq val_i &lt; 2^{20})$, denoting the weight of node $i$ at the beginning.<br><br>The next $(n - 1)$ lines describe the tree, where each line contains two integers $u$ and $v$ $(1 \\leq u, v \\leq n)$, representing an edge connecting node $u$ and node $v$.<br><br>The next line contains an integer $q$ $(0 \\leq q \\leq 10^5)$, denoting the number of operations.<br><br>The next $q$ lines describe these operations in chronological order of occurrence, where each line contains three integers such that<br>&#xA0;&#xA0;&#xA0;&#xA0;&#x25CF; if the first integer is $1$, then the following two integers are $x$ and $v$ $(1 \\leq x \\leq n, 0 \\leq v &lt; 2^{20})$, representing an operation of the first type, or<br>&#xA0;&#xA0;&#xA0;&#xA0;&#x25CF; otherwise the first integer is $2$, and the following two integers are $x$ and $c$ $(1 \\leq x, c \\leq n)$, representing an operation of the second type.<br><br>It is guaranteed that the size of the standard input file does not exceed $32$ MiB, so you may need to use a fast approach to read the input data.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, output $(q + 1)$ lines, where the $i$-th line contains an integer, denoting the value Tokitsukaze wants to know after the first $(i - 1)$ operations.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n5\n1 1 1 1 1\n1 2 4 8 16\n1 2\n3 1\n2 4\n2 5\n2\n1 3 32\n2 3 2</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">62\n146\n24\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>For the only sample case:\n&#x25CF; before the first operation, the value is (2 &#x2295; 4) + (4 &#x2295; 8) + (4 &#x2295; 16) + (8 &#x2295; 16) = 6 + 12 + 20 + 24 = 62;\n&#x25CF; before the second operation, the value is (2 &#x2295; 32) + (32 &#x2295; 8) + (32 &#x2295; 16) + (8 &#x2295; 16) = 34 + 40 + 48 + 24 = 146;\n&#x25CF; after all the operations, the value is 8 &#x2295; 16 = 24.</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2020+Multi-University+Training+Contest+3&amp;source=1&amp;searchmode=source\"> 2020 Multi-University Training Contest 3 </a> ","type":"source","format":"html","require":["katex"]}]}