{"title":"Transformation","time_limit":8000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4578","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4578&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4578","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4578"},"statement":[{"title":"Problem Description","content":"Yuanfang is puzzled with the question below: <br>There are n integers, a<sub>1</sub>, a<sub>2</sub>, &#xFFFD;&#xFFFD;, a<sub>n</sub>. The initial values of them are 0. There are four kinds of operations.<br>Operation 1: Add c to each number between a<sub>x</sub> and a<sub>y</sub> inclusive. In other words, do transformation a<sub>k</sub>&lt;---a<sub>k</sub>+c, k = x,x+1,&#xFFFD;&#xFFFD;,y.<br>Operation 2: Multiply c to each number between a<sub>x</sub> and a<sub>y</sub> inclusive. In other words, do transformation a<sub>k</sub>&lt;---a<sub>k</sub>&#xFFFD;&#xFFFD;c, k = x,x+1,&#xFFFD;&#xFFFD;,y.<br>Operation 3: Change the numbers between a<sub>x</sub> and a<sub>y</sub> to c, inclusive. In other words, do transformation a<sub>k</sub>&lt;---c, k = x,x+1,&#xFFFD;&#xFFFD;,y.<br>Operation 4: Get the sum of p power among the numbers between a<sub>x</sub> and a<sub>y</sub> inclusive. In other words, get the result of a<sub>x</sub><sup>p</sup>+a<sub>x+1</sub><sup>p</sup>+&#xFFFD;&#xFFFD;+a<sub>y</sub> <sup>p</sup>.<br>Yuanfang has no idea of how to do it. So he wants to ask you to help him. <br>","type":"description","format":"html"},{"title":"Input","content":"There are no more than 10 test cases.<br>For each case, the first line contains two numbers n and m, meaning that there are n integers and m operations. 1 &lt;= n, m &lt;= 100,000.<br>Each the following m lines contains an operation. Operation 1 to 3 is in this format: &quot;1 x y c&quot; or &quot;2 x y c&quot; or &quot;3 x y c&quot;. Operation 4 is in this format: &quot;4 x y p&quot;. (1 &lt;= x &lt;= y &lt;= n, 1 &lt;= c &lt;= 10,000, 1 &lt;= p &lt;= 3)<br>The input ends with 0 0.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each operation 4, output a single integer in one line representing the result. The answer may be quite large. You just need to calculate the remainder of the answer when divided by 10007.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5 5\n3 3 5 7\n1 2 4 4\n4 1 5 2\n2 2 5 8\n4 3 5 3\n0 0</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">307\n7489</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2013ACM-ICPC%BA%BC%D6%DD%C8%FC%C7%F8%C8%AB%B9%FA%D1%FB%C7%EB%C8%FC&amp;source=1&amp;searchmode=source\"> 2013ACM-ICPC&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#x22B;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD; </a> ","type":"source","format":"html"}]}