{"title":"Florid Banner","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=2877","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=2877&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=2877","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=2877"},"statement":[{"title":"Problem Description","content":"Adam C. Murphy loves shopping. One day, when he was wandering along the avenue, he discovered several stores with florid banners. (A 2*5 example is shown below)<br><center><img style=\"max-width:100%;\" src=\"../../../data/images/convip3-1006-1.JPG\"></center> <br>He found them fantastic and decided to get one in order to decorate his fresh new house. Unfortunately, no one meets Adam&#xFFFD;&#xFFFD;s requirement, after visiting all stores nearby. What was worse, all banners left in the stores only have width 1. So he decided to make one himself by sewing them together.<br>Adam wants to make a banner exactly as he designed. He didn&#xFFFD;&#xFFFD;t want to flip or rotate the materials he had, since he believed that keep it in its original way is more beautiful. And he didn&#xFFFD;&#xFFFD;t want to cut the banners for the same reason.<br>Each material had different prices, so he wants to make his florid banner with minimum cost.","type":"description","format":"html"},{"title":"Input","content":"The input consists of one or more test cases.<br>Each test case contains two parts.<br>The first part of the input describes the banner Mr. Murphy designed.<br>First line: <br>Two integers M (0&lt;M&lt;=10) and N (0&lt;N&lt;=10,000), describes the width and the length of the banner.<br><br>Second line: <br>One integer t states that the banner has t regions.<br><br>Following t lines: <br>Each line has 5 integers x1,y1,x2,y2,c, represents a region from (x1,y1), the left bottom corner, to (x2,y2), the right top corner, and the color type of this region is c.<br>The whole banner is M*N, with its left bottom located at (0, 0). It is guaranteed that t regions can exactly cover the whole banner once. (0&lt;=x1&lt;x2&lt;=M, 0&lt;=y1&lt;y2&lt;=N)<br><br>The second part describes the materials left in the store. No need to worry about the number of them, because they are infinity.<br>The first line: <br>The number of materials fn(0&lt;=fn&lt;=10000)<br><br>Following fn lines: <br>Each line represents one kind of material. Following an integer P(P&gt;0) indicates the price, and an integer L(1&lt;=L&lt;=20) indicates the length of this banner. Then L integers for this material, i-th number indicates the color at position range from (0,i-1) to (1,i).<br><br>You may assume that the number of colors is no more than 30.<br>Input will be terminated by EOF.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output one line represents the minimum cost of the banner, or &#xFFFD;&#xFFFD;impossible&#xFFFD;&#xFFFD; if Adam can&#xFFFD;&#xFFFD;t make one anyhow.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2 5\n7\n0 0 2 1 0\n1 1 2 3 0\n0 1 1 2 1\n0 2 1 3 2\n0 3 2 4 1\n0 4 1 5 3\n1 4 2 5 2\n5\n1 3 0 0 0\n2 3 2 1 3\n2 3 0 1 2\n1 2 1 3\n5 1 0</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">15\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nHint\n\nThe pattern of the sample is as follows:\n<center><img src=\"../../../data/images/convip3-1006-2.JPG\"></center> \n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2009+Multi-University+Training+Contest+8+-+Host+by+BJNU&amp;source=1&amp;searchmode=source\"> 2009 Multi-University Training Contest 8 - Host by BJNU </a> ","type":"source","format":"html"}]}