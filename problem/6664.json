{"title":"Andy and Maze","time_limit":15000,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6664","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6664&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6664","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6664"},"statement":[{"title":"Problem Description","content":"Andy is a famous explorer at Nanjing University second to none. One day he was trapped in a maze. The maze consisted of several rooms, and there was a precious gem in each room. There were also some bidirectional roads connecting some pairs of these rooms. It took some time to travel along the road in either direction.<br><br>Andy was in a room, but he didn&apos;t know which room he was in. Suddenly, he heard a low voice, saying that, &quot;if you want to get out of the maze, you must collect $k$ gems.&quot; Andy wanted to know, what was the maximum possible time to get out of the maze, or it was impossible at all? Note that he couldn&apos;t visit the same room more than once.<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line of input consists of a single integer $T$ $(1 \\leq T \\leq 35)$, denoting the number of test cases. Each test case starts with a line of three integers $n, m, k$ $(2 \\leq n \\leq 10^4, 1 \\leq m \\leq 10^4, 2 \\leq k \\leq 6)$, denoting the number of rooms and the number of roads in the maze, and the number of gems he needed to collect, respectively. Each of the next $m$ lines contains three intergers $u, v, t$ $(1 \\leq u, v \\leq n, u \\neq v, 1 \\leq t \\leq 10^8)$, specifying a road connecting the $u$th and the $v$th rooms, which took $t$ minutes to travel in either direction. No two roads connected the same pair of rooms.<br>There are at most 5 test cases with $\\max\\{n, m\\} &gt; 100$.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, print the maximum possible time in minute to get out of the maze in one line. If it was impossible to get out of the maze, print $\\texttt{impossible}$ instead.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n4 4 3\n1 2 6\n2 3 1\n2 4 4\n1 4 5\n5 3 4\n1 2 2\n2 3 3\n4 5 5</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">11\nimpossible</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2019+Multi-University+Training+Contest+8&amp;source=1&amp;searchmode=source\"> 2019 Multi-University Training Contest 8 </a> ","type":"source","format":"html","require":["katex"]}]}