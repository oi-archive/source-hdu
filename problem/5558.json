{"title":"Alice's Classified Message","time_limit":8000,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5558","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5558&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5558","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5558"},"statement":[{"title":"Problem Description","content":"Alice wants to send a classified message to Bob. She tries to encrypt the message with her original encryption method. The message is a string $S$, which consists of $N$ lowercase letters.<br><br>$S[a&#x2026;b]$ means a substring of S ranging from $S[a]$ to $S[b]$ ($0&#x2264;a&#x2264;b&lt;N$). If the first $i$ letters have been encrypted, Alice will try to find a magic string $P$. Assuming $P$ has $K$ letters, $P$ is the longest string which satisfies $P=S[T...T+K-1]$  ($0&#x2264;T&lt;i$&#xFF0C;$T+K&#x2264;N$) and $P=S[i&#x2026;i+K-1] (i+K&#x2264;N)$. In other words, $P$ is a substring of $S$, of which starting address is within $[0...i-1]$, and $P$ is also a prefix of $S[i...N-1]$. If $P$ exists, Alice will append integer $K$ and $T$ to ciphertext. If $T$ is not unique, Alice would select the minimal one. And then $i$ is incremented by $K$. If $P$ does not exist, Alice will append -1 and the ASCII code of letter $S[i]$ to ciphertext, and then increment $i$ by 1.<br><br>Obviously the first letter cannot be encrypted. That is to say, $P$ does not exist when $i=0$. So the first integer of ciphertext must be -1, and the second integer is the ASCII code of $S[0]$.<br><br>When $i=N$, all letters are encrypted, and Alice gets the final ciphertext, which consists of many pairs of integers. Please help Alice to implement this method.<br>","type":"description","format":"html"},{"title":"Input","content":"The first line of input contains an integer $T$, which represents the number of test cases ($T&#x2264;50$). Each test case contains a line of string, which has no more than 100000 lowercase letters. It is guaranteed that the total length of the strings is not greater than $2&#xD7;10^6$.","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output a single line consisting of &#x201C;<b>Case #X:</b>&#x201D; first. $X$ is the test case number starting from 1. Output the ciphertext in the following lines. Each line contains two integers separated by a single space.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\naaaaaa\naaaaabbbbbaaabbc</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1:\n-1 97\n5 0\nCase #2:\n-1 97\n4 0\n-1 98\n4 5\n5 2\n-1 99</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2015ACM%2FICPC%D1%C7%D6%DE%C7%F8%BA%CF%B7%CA%D5%BE-%D6%D8%CF%D6%C8%FC%A3%A8%B8%D0%D0%BB%D6%D0%BF%C6%B4%F3%A3%A9&amp;source=1&amp;searchmode=source\"> 2015ACM/ICPC&#x4E9A;&#x6D32;&#x533A;&#x5408;&#x80A5;&#x7AD9;-&#x91CD;&#x73B0;&#x8D5B;&#xFF08;&#x611F;&#x8C22;&#x4E2D;&#x79D1;&#x5927;&#xFF09; </a> ","type":"source","format":"html"}]}