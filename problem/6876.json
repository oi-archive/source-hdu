{"title":"Jump","time_limit":15000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6876","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6876&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6876","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6876"},"statement":[{"title":"Problem Description","content":"You are given a rooted tree with $n$ nodes, each edge of the tree has a weight, the nodes of the tree are numbered from $1$ to $n$, the root of the tree is $rt$.<br><br>You are also given an array $a$ with $n$ elements.<br><br>Define $dep(x)$ as the sum of weight of edges on the simple path between $rt$ and $x$.<br><br>Define $fa(x)$ as the father of node $x$, especially, we define $fa(rt)=rt$.<br><br>There are $m$ operations of two types:<br><br>`1 l r`: for each $i$ that satisfies $l \\le i \\le r$, $a_i := fa(a_i)$.<br><br>`2 l r`: for each $i$ that satisfies $l \\le i \\le r$, output the minimum $dep(a_i)$.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The input contains several test cases, and the first line contains a single integer $T$, the number of test cases. <br><br>For each test case:<br><br>The first line contains three integers $n,m,rt$.<br><br>For the following $n-1$ lines, each line contains three integers $u,v,d$, which means that there is an edge between $u,v$, the weight of which is $d$.<br><br>The next line contains $n$ integers, the ith integer is $a_i$.<br><br>For the following $m$ lines, each line contains three integers $opt,l,r$, which means that there is a operation of type $opt$ for $l,r$.<br><br>$1\\le T \\le 4$, $1\\le n,m\\le 2\\cdot 10^5$, the weight of edge is an integer in range $[0,10^9]$.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each operation that $opt=2$, output one line representing the answer.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">4\n5 1 5\n2 5 4\n1 5 4\n3 2 1\n4 2 3\n3 4 3 2 5\n2 3 3\n6 2 1\n6 1 1\n2 1 1\n4 2 3\n5 4 2\n3 2 1\n2 3 6 1 2 6\n2 4 6\n2 3 3\n5 1 5\n4 5 3\n2 4 2\n1 4 2\n3 5 3\n1 1 5 2 5\n2 2 2\n5 4 3\n2 3 1\n1 2 4\n5 2 2\n4 5 4\n1 4 1 1 4\n2 2 5\n1 1 5\n2 2 2\n1 1 4</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5\n0\n1\n5\n5\n3</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2020+Multi-University+Training+Contest+9&amp;source=1&amp;searchmode=source\"> 2020 Multi-University Training Contest 9 </a> ","type":"source","format":"html","require":["katex"]}]}