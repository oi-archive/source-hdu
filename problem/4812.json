{"title":"D Tree","time_limit":5000,"memory_limit":100,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4812","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4812&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4812","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4812"},"statement":[{"title":"Problem Description","content":"There is a skyscraping tree standing on the playground of Nanjing University of Science and Technology. On each branch of the tree is an integer (The tree can be treated as a connected graph with N vertices, while each branch can be treated as a vertex). Today the students under the tree are considering a problem: Can we find such a chain on the tree so that the multiplication of all integers on the chain (mod 10<sup>6</sup> + 3) equals to K?<br>Can you help them in solving this problem?","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"There are several test cases, please process till EOF.<br>Each test case starts with a line containing two integers N(1 &lt;= N &lt;= 10<sup>5</sup>) and K(0 &lt;=K &lt; 10<sup>6</sup> + 3). The following line contains n numbers v<sub>i</sub>(1 &lt;= v<sub>i</sub> &lt; 10<sup>6</sup> + 3), where vi indicates the integer on vertex i. Then follows N - 1 lines. Each line contains two integers x and y, representing an undirected edge between vertex x and vertex y.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, print a single line containing two integers a and b (where a &lt; b), representing the two endpoints of the chain. If multiply solutions exist, please print the lexicographically smallest one. In case no solution exists, print &#x201C;No solution&#x201D;(without quotes) instead.<br>For more information, please refer to the Sample Output below.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5 60\n2 5 2 3 3\n1 2\n1 3\n2 4\n2 5\n5 2\n2 5 2 3 3\n1 2\n1 3\n2 4\n2 5</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3 4\nNo solution\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\n1. &#x201C;please print the lexicographically smallest one.&#x201D;&#x662F;&#x6307;: &#x5148;&#x6309;&#x7167;&#x7B2C;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#x7684;&#x5927;&#x5C0F;&#x8FDB;&#x884C;&#x6BD4;&#x8F83;&#xFF0C;&#x82E5;&#x7B2C;&#x4E00;&#x4E2A;&#x6570;&#x5B57;&#x5927;&#x5C0F;&#x76F8;&#x540C;&#xFF0C;&#x5219;&#x6309;&#x7167;&#x7B2C;&#x4E8C;&#x4E2A;&#x6570;&#x5B57;&#x5927;&#x5C0F;&#x8FDB;&#x884C;&#x6BD4;&#x8F83;&#xFF0C;&#x4F9D;&#x6B21;&#x7C7B;&#x63A8;&#x3002;\n\n2. &#x82E5;&#x51FA;&#x73B0;&#x6808;&#x6EA2;&#x51FA;&#xFF0C;&#x63A8;&#x8350;&#x4F7F;&#x7528;C++&#x8BED;&#x8A00;&#x63D0;&#x4EA4;&#xFF0C;&#x5E76;&#x901A;&#x8FC7;&#x4EE5;&#x4E0B;&#x65B9;&#x5F0F;&#x6269;&#x6808;&#xFF1A;\n#pragma comment(linker,&quot;/STACK:102400000,102400000&quot;)\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2013ACM%2FICPC%D1%C7%D6%DE%C7%F8%C4%CF%BE%A9%D5%BE%CF%D6%B3%A1%C8%FC%A1%AA%A1%AA%CC%E2%C4%BF%D6%D8%CF%D6&amp;source=1&amp;searchmode=source\"> 2013ACM/ICPC&#x4E9A;&#x6D32;&#x533A;&#x5357;&#x4EAC;&#x7AD9;&#x73B0;&#x573A;&#x8D5B;&#x2014;&#x2014;&#x9898;&#x76EE;&#x91CD;&#x73B0; </a> ","type":"source","format":"html","require":["katex"]}]}