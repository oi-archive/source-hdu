{"title":"Generator","time_limit":2000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5850","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5850&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5850","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5850"},"statement":[{"title":"Problem Description","content":"You are given $n$ different integer sequences. Each sequence has the same length  $L$, and also all integers in these sequences are from 1 to $m$ .<br><br>There is a random machine that generates a random number sequence.<br><br>It generates a random number from 1 to $m$ every second.<br>When all  $n$ sequences are generated as a consecutive subsequence of the sequence the machine generated, the machine is stopped immediately.<br><br>Now your task is to calculate the expected stopping time.<br>","type":"description","format":"html"},{"title":"Input","content":"There are multiple test cases.<br><br>The first line of the input contains an integer  $T$, the number of test cases.<br><br>Each test case begins with 3 positive integers$n(1\\leq n\\leq 15),m(1\\leq M\\leq 100,L(1\\leq L\\leq 20000)$, which are described above.<br><br>The next line will contain m positive integers  $a_1,a_2,\\cdots ,a_m$, which describes probability distribution of the dice. This means, the machine will generate 1 with probability $\\frac{a_1}{(a_1+a_2+\\cdots +a_m)}$ , 2 with probability  $\\frac{a_2}{(a_1+a_2+\\cdots +a_m)}$, and so on. The total sum of  $a_i$ does not exceeds 1000000000.<br><br>Each of the next $n$ lines contains a sequence of length $L$.<br><br>The total sum of $n\\times L$ over all test cases will not exceed 777777.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, please calculate the answer as an irreducible fraction  $\\frac{A}{B}$ and output ($A\\times B^{-1}\\ mod\\   1000000007$)  in a single line. Here  $B^{-1}$ is the multiplicative inverse of  $B$ modulo 1000000007.<br><br>The input guarantees that $B$ and 1000000007 is relatively prime.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n1 2 2\n1 1\n1 1</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">6</div></pre>","type":"example","format":"html"},{"title":"Author","content":"&#x91D1;&#x7B56;&#x5DE5;&#x4E1A;&#x7EFC;&#x5408;&#x5927;&#x5B66;&#xFF08;DPRK&#xFF09;","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2016+Multi-University+Training+Contest+9&amp;source=1&amp;searchmode=source\"> 2016 Multi-University Training Contest 9 </a> ","type":"source","format":"html"}]}