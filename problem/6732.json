{"title":"The Tree of Haruhi Suzumiya","time_limit":6000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6732","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6732&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6732","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6732"},"statement":[{"title":"Problem Description","content":"The members in *SOS Dan(**S**ekai o **O**oini Moriageru Tame no **S**uzumiya Haruhi no Dan)* want to assemble a Christmas tree(you know many Christmas trees are decorations not real trees).<br><br>The tree contains $n$ vertices which are numbered from $1$ to $n$. The weight of vertex $i$ is $w_i$. The number of edges on the path from vertex $i$ to vertex $1$(vertex $1$ is important because it&apos;s the top one) is denoted as $d_i$. <br><br>Haruhi says, &quot;I don&apos;t like the vertex pairs $(i,j)$ that $i$ is the ancestor of $j$ and $w_i &gt; w_j$ &quot;.<br><br>Kyon says, &quot;I don&apos;t like the vertex pairs $(i,j)$ that $i$ is the ancestor of $j$ and $w_i &lt; w_j$&quot;.<br><br>Itsuki says, &quot;I don&apos;t like the vertex pairs $(i,j)$ that $i&lt;j$ and neither $i$ nor $j$ is the ancestor of the other one&quot;.<br><br>Mikuru says, &quot;I don&apos;t like the vertices that are far away from vertex $1$&quot;.<br><br>Yuki says nothing.<br><br>Now they are divided into two groups to assemble the tree. Haruhi and Itsuki are in group $A$ while Kyon and Mikuru are in group $B$. Both group choose some vertices to assemble. Each vertex should be chosen by exactly $1$ group.<br><br>Let&apos;s denote the vertices set group $A$  chose as $V(A)$, the vertices set group $B$ chose as $V(B)$. The dislike level of group $A$ is $$|\\lbrace vertex \\; pair \\; (i,j) \\; that \\; is \\; disliked \\; by \\; either \\; Haruhi \\; or \\; Itsuku | i \\in V(A) \\bigwedge j \\in V(A) \\rbrace|$$. The dislike level of group $B$ is $$|\\lbrace vertex \\; pair \\; (i,j) \\; that \\; is \\; disliked \\; by \\; Kyon| i \\in V(B) \\bigwedge j \\in V(B) \\rbrace|+\\sum_{u \\in V(B)} d_u$$.<br><br>Yuki wants to know the minimum value of the sum of dislike level of group $A$ and $B$ when $|V(B)|=1,2,3,\\cdots,n$ respectively.","type":"description","format":"html"},{"title":"Input","content":"The first line contains an integer $n(1\\le n \\le 10^6)$ denoting the number of vertices on the tree.<br><br>The second line contains $n$ integer $w_i(1 \\le w_i \\le 10^6)$ denoting the weight of vertex $i$.<br><br>Next $n-1$ lines each contains two integer $u,v(1\\le u,v \\le n)$, denoting there is an edge between $u$ and $v$.<br><br><div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div><br><b>&#x6837;&#x4F8B;&#x89E3;&#x91CA;</b><br><br>$B=\\emptyset,\\lbrace 3 \\rbrace, \\lbrace 3,4 \\rbrace, \\lbrace 1,3,4 \\rbrace,\\lbrace 1,2,3,4 \\rbrace$ respectively.<br></div>","type":"input_format","format":"html"},{"title":"Output","content":"Output $n$ lines. The $i-th$ of them contains an integer denoting the answer when $|V(B)|=i$.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">4\n4 1 2 3\n1 2\n2 3\n2 4</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">9\n5\n2\n1\n2</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=642ccpcQHD&amp;source=1&amp;searchmode=source\"> 642ccpcQHD </a> ","type":"source","format":"html"}]}