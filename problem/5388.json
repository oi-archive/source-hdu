{"title":"Geometer's Sketchpad","time_limit":15000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5388","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5388&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5388","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5388"},"statement":[{"title":"Problem Description","content":"  The Geometer&apos;s Sketchpad is a popular commercial interactive geometry software program for exploring Euclidean geometry, algebra, calculus, and other areas of mathematics.<br><br>  The Geometer&apos;s Sketchpad can solve most problems of plane geometry and plane analytic geometry, but it&apos;s powerless to solve solid geometry problems. Therefore, the famous mathematician BG, decided to develop a new software, named The Geometer&apos;s Sketchpad 3D.<br><br>  Because of the huge amount of work to do, BG decided to start from basic three-dimensional transformations. Similar to two-dimensional transformations, three-dimensional transformations include three basic types:<br>    1. Translation.<br><center><br><img style=\"max-width:100%;\" src=\"../../data/images/C596-1009-1.png\"><br></center><br>    2. Scaling.<br><center><br><img style=\"max-width:100%;\" src=\"../../data/images/C596-1009-2.png\"><br></center><br>    3. Rotation.<br><center><br><img style=\"max-width:100%;\" src=\"../../data/images/C596-1009-3.png\"><br></center><br><br>  Now there are $n$ points $P_1,P_2,P_3,\\ldots,P_n$ in the three-dimensional space, and BG wanted to implement the following several transformation operations:<br>    1. For given integers $l,r,x,y,z$, translate points $P_l,P_{l+1},P_{l+2},\\ldots,P_r$ by the vector $(x,y,z)$ at the same time;<br>    2. For given integers $l,r,x,y,z$ and the real number $k$, scale points $P_l,P_{l+1},P_{l+2},\\ldots,P_r$ by the scale factor $k$ and the center point $(x,y,z)$ at the same time;<br>    3. For given integers $l,r,x,y,z,x&apos;,y&apos;,z&apos;$ and the real number $\\theta$, rotate points $P_l,P_{l+1},P_{l+2},\\ldots,P_r$ counterclockwise around the axis determined by the point $(x,y,z)$ and the direction vector $(x&apos;,y&apos;,z&apos;)$ through an angle $\\theta$ (in radian) at the same time.<br><br>  In addition, there are some measurement operations:<br>    1. For given integer $i$, calculate the current coordinates of the point $P_i$;<br>    2. For given integers $l,r$, calculate the current length of the polygonal chain $P_{l}P_{l+1}P_{l+2}\\cdots P_{r}$. In other words, just calculate $|P_lP_{l+1}|+|P_{l+1}P_{l+2}|+\\cdots+|P_{r-1}P_r|$, where $|PQ|$ means the Euclidean distance between points $P$ and $Q$.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"  There are multiple test cases.<br><br>  For each test case:<br><br>  The first line contains two positive integers $n,m~(1\\le n,m \\le 222222)$, representing the number of points and the number of operations.<br><br>  Next $n$ lines, each line contains three integers $x,y,z$, representing a point $(x,y,z)$ in the three-dimensional space.<br><br>  Next $m$ lines, each line describes an operation (without quotes):<br>    1. &quot;$\\mathtt{Translation}~l~r~x~y~z$&quot;, translate points;<br>    2. &quot;$\\mathtt{Scaling}~l~r~x~y~z~k$&quot;, scale points;<br>    3. &quot;$\\mathtt{Rotation}~l~r~x~y~z~x&apos;~y&apos;~z&apos;~\\theta$&quot;, rotate points;<br>    4. &quot;$\\mathtt{Coordinates}~i$&quot;, calculate the current coordinates of the point;<br>    5. &quot;$\\mathtt{Length}~l~r$&quot;, calculate the current length of the polygonal chain.<br><br>  There is one blank line between successive tests. Values of $n=m=0$ indicate end of input.<br><br>  For the all of the above variables, $1 \\le l,r,i \\le n$, $-1000 \\le x,y,z,x&apos;,y&apos;,z&apos; \\le 1000$, $0 &lt; k \\le 2$, $-10 \\le \\theta \\le 10$. $k$ and $\\theta$ are real numbers, given with at most $6$ digits after the decimal point, and all other numbers are integers. You can sure that the absolute value of the answer does not exceed $10^{10}$ at any time.<br><br>  It is guaranteed $\\sum n+\\sum m \\le 10^6$.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"  For each test case:<br><br>  First output one line containing &quot;$\\texttt{Case #}i\\texttt{:}$&quot;(without quotes), where $i$ is the test case number (starting from $1$).<br><br>  Then, for each &quot;$\\mathtt{Coordinates}$&quot; operator, output one line containing three space-separated real numbers, representing the current coordinates of the point; for each &quot;$\\mathtt{Length}$&quot; operator, output one line containing a real number, representing the current length of the polygonal chain.<br><br>  Your output will be considered correct if the absolute or relative error of every number does not exceed $10^{-4}$.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5 10\n0 0 0\n2 0 0\n2 1 0\n0 1 0\n0 0 0\nTranslation 1 5 1 1 0\nScaling 2 4 1 1 0 2\nCoordinates 2\nCoordinates 3\nLength 2 3\nRotation 1 5 0 0 0 0 0 1 1.570796\nTranslation 1 2 0 0 100\nCoordinates 2\nCoordinates 3\nLength 2 3\n\n0 0</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1:\n5.0000 1.0000 0.0000\n5.0000 3.0000 0.0000\n2.0000\n-1.0000 5.0000 100.0000\n-3.0000 5.0000 0.0000\n100.0200</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Author","content":"SXYZ","type":"source","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2015+Multi-University+Training+Contest+8&amp;source=1&amp;searchmode=source\"> 2015 Multi-University Training Contest 8 </a> ","type":"source","format":"html","require":["katex"]}]}