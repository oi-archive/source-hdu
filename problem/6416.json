{"title":"Rikka with Seam","time_limit":8000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6416","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6416&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6416","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6416"},"statement":[{"title":"Problem Description","content":"Seam carving is a novel algorithm for resizing images while maintaining as much information as possible from the source image.<br><br>Now, Rikka is going to use seam carving method to deal with an $n \\times m$ black and white picture. We can abstract this picture into an $n \\times m$ 01 matrix $A$.<br><br>A $K$-seam of this picture is an integer sequence $a$ which satisfies the following conditions:<br>1. $|a| = n$, $a_i \\in [1, m]$.<br>2. $|a_i - a_{i+1}| \\leq K$, $\\forall i \\in [1,n)$.<br><br>After choosing a $K$-seam $a$, Rikka reduces the size of the picture by deleting pixels $(i,a_i)$, and then she gets a matrix $A&apos;$ of size $n \\times (m - 1)$.<br><br>For example, if the chosen seam is $[1,2,3]$ and the picture is \\begin{align*} \\begin{bmatrix} 1 &amp;0 &amp;0 \\\\ 1&amp; 1&amp; 1 \\\\ 0 &amp; 0&amp; 0\\end{bmatrix}\\end{align*} the result matrix will be \\begin{align*} \\begin{bmatrix} 0 &amp;0 \\\\ 1&amp;  1 \\\\ 0 &amp; 0\\end{bmatrix}\\end{align*}<br><br>Rikka finds that deleting different seams may get the same result. In the previous example, seam $[1,2,3],[1,2,1],[1,2,2],[1,1,1]$ are equivalent.<br><br>Now Rikka wants to calculate the number of different matrixes she can get by deleting exactly one $K$-seam.","type":"description","format":"html"},{"title":"Input","content":"The first line contains a single integer $t(1 \\leq t \\leq 10^3)$, the numebr of testcases.<br><br>For each testcase, the first line contains three numbers $n,m,K(2 \\leq n,m \\leq 2 \\times 10^3, 1\\leq K \\leq m)$.<br><br>Then $n$ lines follow, each line contains a 01 string of length $m$ which describes one row of the matrix.<br><br>The input guarantees that there are at most $5$ testcases with $\\max (n,m) &gt; 300$.","type":"input_format","format":"html"},{"title":"Output","content":"For each testcase, output a single line with a single number, the answer modulo $998244353$.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n2 2 1\n00\n10\n5 5 1\n00100\n10101\n00100\n01000\n11101\n5 5 2\n00100\n10101\n00100\n01000\n11101</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n70\n199</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2018+Multi-University+Training+Contest+9&amp;source=1&amp;searchmode=source\"> 2018 Multi-University Training Contest 9 </a> ","type":"source","format":"html"}]}