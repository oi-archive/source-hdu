{"title":"Autopilot System","time_limit":3000,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5554","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5554&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5554","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5554"},"statement":[{"title":"Problem Description","content":"Farmer John has just purchased a car equipped with an autopilot system. He is so excited about this high-tech product and can&#x2019;t wait to try it. John plans to travel to another city this weekend, so he decides to let the autopilot system lead the way.<br><br>There are $N$ cities numbered from 1 to $N$ inclusively. John lives in city 1 and he plans to travel to city $N$. The cities are connected by $N-1$ highways. Any two cities are reachable to each other via the highways. Every time John passes through a high way, he needs to pay 1 unit of money as the toll fee.<br><br>Obviously, such a road system is very busy, since there is only one path between two cities. To solve this problem, $M$ cities are selected as transport hubs. For each city $i$ (including the hubs), $M$ new one-way roads are constructed, each of which allows travelling from city $i$ to one of the hubs, but travelling from the hub back to the city is not allowed. More importantly, they are free of charge!<br><br>Now Farmer John has started the autopilot system, waiting for it to lead him from city 1 to city $N$. Unfortunately, something goes wrong with its software, so it would pilot at random. When the car is located in a city, the system will pick the next destination as the following. For the $i-th$ transport hub, the system will select it as the next destination with probability $q_i$, and travel to the hub via the free one-way road. If none of the transport hubs is selected, it drives the car to one of the neighboring city through a highway with uniform probability. In other words, denoting the sum of $q_i$ as $Q$ and the city has $K$ neighbors, the probability of traveling to one of the neighboring cities is $\\frac{(1-Q)}{K}$. The only good news is that the system will stop piloting immediately when the car arrives in city $N$.<br><br>Farmer John is aware of this malfunctioning now. He wants to know the expected amount of money that he needs to pay for the toll fee, if he lets the car travel at random as described above.<br>","type":"description","format":"html"},{"title":"Input","content":"The first line of input contains a number $T$ indicating the number of test cases ($T&#x2264;150$).<br><br>Each test case starts with a line containing two integers $N$ and $M$ ($2&#x2264;N&#x2264;20000,0&#x2264;M&#x2264;200$). The $i-th$ of the next $M$ lines contains two numbers $u_i$ and $q_i$, indicating that $u_i$ is a transport hub and the probability of travelling to it from any city is $q_i$. It is guaranteed that all transport hubs are distinct and the sum of $q_i$ is not greater than 1. Each of the next $N-1$ lines contains two integers $x$ and $y$, indicating that there is a highway between city $x$ and city $y$.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output a single line consisting of &#x201C;<b>Case #X: Y</b>&#x201D;. $X$ is the test case number starting from 1. $Y$ is the expected units of money that is payed as toll fee. Your answer is considered correct if either of its relative error or absolute error is less than $10^{-6}$. If it is impossible to travel to city N, you should output &#x201C;<b>impossible</b>&#x201D; instead.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n6 3\n2 0.2\n3 0.3\n4 0.1\n1 2\n1 3\n2 4\n2 5\n2 6\n6 3\n1 0.2\n3 0.1\n6 0.1\n1 2\n1 3\n2 4\n2 5\n2 6\n3 2\n1 0.5\n2 0.5\n1 2\n1 3</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1: 13.176471\nCase #2: 4.694250\nCase #3: impossible</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2015ACM%2FICPC%D1%C7%D6%DE%C7%F8%BA%CF%B7%CA%D5%BE-%D6%D8%CF%D6%C8%FC%A3%A8%B8%D0%D0%BB%D6%D0%BF%C6%B4%F3%A3%A9&amp;source=1&amp;searchmode=source\"> 2015ACM/ICPC&#x4E9A;&#x6D32;&#x533A;&#x5408;&#x80A5;&#x7AD9;-&#x91CD;&#x73B0;&#x8D5B;&#xFF08;&#x611F;&#x8C22;&#x4E2D;&#x79D1;&#x5927;&#xFF09; </a> ","type":"source","format":"html"}]}