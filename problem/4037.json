{"title":"Development Value","time_limit":3000,"memory_limit":64.2265625,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4037","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4037&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4037","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4037"},"statement":[{"title":"Problem Description","content":"StarCraft 2 (SC2) is a famous game. More and more people fall in love with this game.<br><center><img style=\"max-width:100%;\" src=\"../../data/images/C364-1007-1.jpg\"></center><br>As a crazy fan of SC2, Ahua (flower fairy) play it day and night. Recently, he found that the most important part of being a top player of SC2 is economic development, which means you should get as much mine as possible by training SCVs (space construction vehicle) to collect mine. Train a SCV at ith second costs Ci units of mine. After training, this SCV can collect Di units of mine each second. Training a SCV needs one second of time.<br><br>Based on that, he composes a formula to evaluate the development in a time span from xth second to yth second. Assume at xth second, Ahua has no SCV and mine. He trains one SCV at each second during xth second and yth second (the mount of mine can be negative, so that he always can train SCV). Each SCV will collect some amount of mines for Ahua in each second after it was trained. At ith second Ahua has Mi units of mine in total. The development value is defined as sum(Mi) (x &#xFFFD;&#xFFFD; i &#xFFFD;&#xFFFD; y). Now he asks you to help him calculate the development value. To make it more interesting, Ahua can apply following operations:<br><br>Cost x y z: the cost of training a SCV between xth second to yth second will increase by z units of mine. i.e. Ci for x &#xFFFD;&#xFFFD; i &#xFFFD;&#xFFFD; y will increase by z.<br><br>Collect x y z: each SCV trained between xth second and yth second can collect z more mines every second after it has been trained. i.e. Di for x &#xFFFD;&#xFFFD; i &#xFFFD;&#xFFFD; y will increase by z.<br><br>Query x y: output the development value between xth second and yth second.<br>","type":"description","format":"html"},{"title":"Input","content":"First line of the input is a single integer T (T &#xFFFD;&#xFFFD; 10), indicates there are T test cases.<br>For each test case, the first line is an integer N (1 &#xFFFD;&#xFFFD; N &#xFFFD;&#xFFFD; 100000), means the maximum time you should deal with.<br><br>Following N lines, each contain two integers Ci and Di (0 &#xFFFD;&#xFFFD; Ci, Di &#xFFFD;&#xFFFD; 100000), the cost and collect speed of SCV training in ith second initially as described above.<br><br>The next line is an integer Q (1 &#xFFFD;&#xFFFD; Q &#xFFFD;&#xFFFD; 10000), the number of operations you should deal with. Then Q lines followed, each line will be &#xFFFD;&#xFFFD;Cost x y z&#xFFFD;&#xFFFD;, &quot;Collect x y z&#xFFFD;&#xFFFD; or &#xFFFD;&#xFFFD;Query x y&#xFFFD;&#xFFFD;.<br>1 &#xFFFD;&#xFFFD; x &#xFFFD;&#xFFFD; y &#xFFFD;&#xFFFD; N, 0 &#xFFFD;&#xFFFD; z &#xFFFD;&#xFFFD; 100000<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, first output &#xFFFD;&#xFFFD;Case k: &#xFFFD;&#xFFFD; in a single line, k is the number of the test case, from 1 to T. Then for each &quot;Q x y&quot;, you should output a single line contains the answer mod 20110911.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n5\n1 3\n2 3\n3 1\n2 2\n3 3\n5\nQuery 1 3\nCost 2 2 1\nQuery 1 3\nCollect 1 1 5\nQuery 1 3</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1:\n2\n0\n15</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=The+36th+ACM%2FICPC+Asia+Regional+Chengdu+Site+%A1%AA%A1%AA+Online+Contest&amp;source=1&amp;searchmode=source\"> The 36th ACM/ICPC Asia Regional Chengdu Site &#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD; Online Contest </a> ","type":"source","format":"html"}]}