{"title":"Compress the String","time_limit":5000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4051","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4051&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4051","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4051"},"statement":[{"title":"Problem Description","content":"Dan is playing a game with Ben. Ben gives Dan a long string S, and Dan needs to compress S to a list or short strings: s[1], s[2], ..., s[N]. S only contains lowercase letters. Each s[i] can contain lowercase letters and digits, but only digits between i+1 and N, inclusive, are allowed for s[i]. For example, when N = 4, allowed digits for s[2] will be &apos;3&apos; and &apos;4&apos;. <br><br>In order to decompress such a list of strings into a single string, we&apos;ll apply string decompress algorithm for each string one by one, in reverse order (from s[N] to s[1]). The decompressing algorithm for a string is easy: just replace each digit in the string by the corresponding decompressed string with that digit as index. That is to say, for digit i in the string, it will be replaced by the decompressed string s[i]. Because we are applying decompressing algorithm in reverse order, s[i] will always be decompressed before it is used to replace a digit in other strings. When all the strings are decompressed, the decompressed string of s[1] will be the final result. If the decompressing result is S, we say S can be compressed to this list of strings. <br><br>Now Ben decides the number of short strings Dan can use (N), as well as the length limit for each short string. Dan needs to decide whether it is possible to compress S to N short strings under this limit. <br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"There are multiple test cases (no more than 150). For each case, there will be three lines. The first line gives an integer N (1 &#x2264; N &#x2264; 4), which is the number of short strings Dan can use. The second line gives N integers L[1], ... L[N] (1 &#x2264; L[i] &#x2264; 4), which means the length of string s[i] should be at most L[i]. The third line gives the string S. The length of S will be between 1 and 500, inclusive. S will only contain lowercase letters. <br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each case, if it is possible to compress S into N strings and the length of each string is no more than the limit, output &quot;Yes&quot;. Otherwise, output &quot;No&quot;. <br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n1\naa\n4\n4 4 4 4\nttttttttttttttt</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">No\nYes</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Author","content":"HANG, Hang","type":"source","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2011+Asia+Dalian+Regional+Contest&amp;source=1&amp;searchmode=source\"> 2011 Asia Dalian Regional Contest </a> ","type":"source","format":"html","require":["katex"]}]}