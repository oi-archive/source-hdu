{"title":"Word Game","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=2429","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=2429&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=2429","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=2429"},"statement":[{"title":"Problem Description","content":"&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;It&apos;s a game with two players. Given a dictionary of words, a word S chosen from the dictionary to start with, and a word T also chosen from the dictionary as the winning word, which will be described below, the two players take turns to choose a word from the dictionary, satisfying that the first letter of the chosen word is the same as the last letter of previous word. Each word could be chosen more than once.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;Suppose they play exactly n rounds. At the last round, if the player (the first one if n is odd, the second one otherwise) chooses the winning word T, he wins. To your surprise that, the two players are not so clever that they choose words randomly.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;Here comes the question. How many different ways will the first player win if they play no more than N rounds, among all the possible ways satisfying all the conditions above?<br>","type":"description","format":"html"},{"title":"Input","content":"&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;An integer C, indicates the number of test cases.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;Then comes C blocks, formatted like this:<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;An integer M, indicates the number of words in the dictionary, M &lt;= 30.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;M string consisting of only lowercase letters, represent the words in the dictionary. The length of each word is no more than 10. There are no duplicated words.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;String S, the word to start with.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;String T, the winning word.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;A positive integer N, indicates the maximum number of rounds to play. N fits in a signed 32-bit integer.<br>","type":"input_format","format":"html"},{"title":"Output","content":"&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;For each test case, print a line with an integer W, indicating how many possible ways the first player wins.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;Output the answer modulo 10001.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n3\nabc\ncac\ncde\nabc\ncde\n3</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2008+Asia+Chengdu+Regional+Contest+Online&amp;source=1&amp;searchmode=source\"> 2008 Asia Chengdu Regional Contest Online </a> ","type":"source","format":"html"}]}