{"title":"Little W and Contest","time_limit":2000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6795","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6795&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6795","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6795"},"statement":[{"title":"Problem Description","content":"There are $n$ members in our ACM club. Little W wants to select three persons from our club to form a new team taking part in provincial ACM contests, as it is known by all of us that any ACM contest requires a normal team to have three members.<br><br>Little W has divided our club members into two role groups. The first group contains only readers who dedicate themselves to reading problems during contests, though sometimes they may also prepare drinking and food for the team. For the sake of measurement, we define the power of a reader as $1$. The second part contains only coders who code and test programs all the time, and similarly, we define the power of a coder as $2$.<br><br>Little W thinks it will be a tremendous disaster when a team has two readers because in that case, the total power of this team is less than $5$ and thus it has a high risk to fail the contest. To avoid that, Little W thinks a new team must have at least two coders.<br><br>Additionally, Little W defines the relationship between club members with transitivity. That is, for every three members $A$, $B$, and $C$, if $A$ is familiar with $B$, and $B$ is familiar with $C$, then $A$ will be familiar with $C$ through $B$ instantly. Based on the definition, it is forbidden for the team to have any two members familiar with each other.<br><br>At first, no member of our club is familiar with any other, and then Little W will repeatedly make an introduction between two members who are currently strangers to each other until each member is familiar with all the others. During this process, there will be exactly $(n - 1)$ introductions.<br><br>Now, for $i = 1, 2, \\ldots, n$, Little W wants you to count the combinations of three club members that can form a new team after the first $(i - 1)$ introductions have been made. However, the numbers of combinations may be quite gigantic, so you just need to report each number in modulo $(10^9 + 7)$.<br>","type":"description","format":"html"},{"title":"Input","content":"There are several test cases.<br><br>The first line contains an integer $T$ ($1 \\leq T \\leq 10$), denoting the number of test cases. Then follow all the test cases.<br><br>For each test case, the first line contains an integer $n$ $(1 \\leq n \\leq 10^5)$, denoting the number of members in this club.<br><br>The second line contains $n$ integers consisting of only $1$ and $2$, where the $i$-th integer represents the power of the $i$-th member.<br><br>The next $(n - 1)$ lines describe all introductions in chronological order of occurrence, where each line contains two integers $u$ and $v$ $(1 \\leq u, v \\leq n, u \\neq v)$, representing an introduction between the $u$-th member and the $v$-th member, who are currently strangers to each other.<br><br>It is guaranteed that the sum of $n$ is no larger than $10^6$.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output $n$ lines, where the $i$-th line contains an integer, denoting the number of combinations of three club members, in modulo $(10^9 + 7)$, that can form a new team after the first $(i - 1)$ introductions have been made.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n5\n2 2 2 1 1\n4 5\n1 4\n2 1\n3 2</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">7\n7\n3\n0\n0</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2020+Multi-University+Training+Contest+3&amp;source=1&amp;searchmode=source\"> 2020 Multi-University Training Contest 3 </a> ","type":"source","format":"html"}]}