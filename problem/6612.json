{"title":"Sindar's Art Exhibition","time_limit":3000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6612","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6612&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6612","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6612"},"statement":[{"title":"Problem Description","content":"Sindar is an excellent artist and she has many works. One day she decides to hold an exhibition tour in her country. Her country is a tree, the nodes of which are the cities and the edges between the nodes are the roads between cities. <br>The value of an exhibition are determined by the number of works on the exhibition and the citizens&apos; favorability of art. Generally speaking, if there are $m$ works in the exhibition, and the citizens&apos; favorability is $k$, then the value of the exhibition will be $m*k$. <br>Her tour will begin at city $s$ and end in city $t$. She will begin the tour with $x$ works, but after she holds the exhibition in every city, she will choose $y_i$ suitable works and donate them to the local orphanage, which means that there will be only $x-y_i$ works when she holds the next exhibition, and $x-y_i-y_j$ works in the exhibition after the next, supposing that she will pass city $j$ after city $i$.<br>Now she has many tours and she want to know every tour&apos;s value mod $10^9+7$. And sometimes she may change one city&apos;s favorability.","type":"description","format":"html"},{"title":"Input","content":"There are multiple test cases. The first line of the input contains an integer $T$, indicating the number of test cases. For each test case:<br>The second line contains one interger $n$, indicating the number od cities. $(1\\leq n \\leq 10^5)$<br>It&apos;s guaranteed that $\\Sigma n\\leq 3*10^5$<br>The next line contains $n$ interger $f_i$, the $i-th$ interger indicates the citizens&apos; favorability of art in city $i$.($0\\leq f_i\\leq 2*10^9)$<br>The next line contains $n$ interger $y_i$, the $i-th$ interger indicates the number of works Sindar will donate to the orphanage in city $i$.$(0\\leq y_i\\leq 10^4)$<br>Each of the following $n-1$ lines contains two intergers $u,v$ indicating that there is a road between city $u$ and city $v$. ($1\\leq u,v \\leq n$)<br>The next line contains two interger $q$,indicating the number of tours and the number of works Sindar will donate to the local orphanage.$(1\\leq q \\leq 10^5)$<br>Each of the next $q$ lines contains one instruction. And there are two kinds of instructions:<br>$1\\ s\\ t\\ x$ indicates the start city ,the end city and the number of works Sindar owns at first. $(1\\leq s,t\\leq n , s\\neq t,x\\leq 2*10^9)$<br>$2\\ c\\ v$ indicates Sindar wants to  change the favorability of city $c$ to $v$.$(1\\leq c\\leq n,0\\leq v\\leq 2*10^9)$<br>It is guaranteed that $x \\geq dis(s,t)*y$. $dis(s,t)$ indicates the number of cities you must pass from $s$ to $t$.","type":"input_format","format":"html"},{"title":"Output","content":"For each query, output one interger indicates the tour&apos;s value mod $10^9+7$","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n6\n1 2 1 4 5 6\n1 1 1 2 2 2\n1 2\n2 4\n2 5\n5 6\n1 3\n2\n2 3 3\n1 6 3 10</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">129\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>129=6*10+5*8+2*6+1*5+3*4</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2019+Multi-University+Training+Contest+3&amp;source=1&amp;searchmode=source\"> 2019 Multi-University Training Contest 3 </a> ","type":"source","format":"html"}]}