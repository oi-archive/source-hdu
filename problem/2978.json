{"title":"Difficult Melody","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=2978","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=2978&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=2978","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=2978"},"statement":[{"title":"Problem Description","content":"You&apos;re addicted to a little game called `remember the melody&apos;: you hear some notes, and then you repeat it. In most cases, the longer the melody, the harder to repeat, but it isn&apos;t always true. Also, melodies of the same length are usually not equally easy to remember. To find a way to define the remember difficulty of a melody, you invented a statistics-based model:<br><br><center><img style=\"max-width:100%;\" src=\"../../../data/images/con216-1004-1.JPG\"></center><br><br>Suppose you&apos;re investigating melodies of a particular length. If a melody appeared in p games, among which you successfully repeated q games, the smaller q/p , the more difficult the melody. If there is more than one melody having the minimal ratio, the one with larger p is considered more difficult. But there is an exception: if p is smaller than a threshold m , you simply ignore it (you can&apos;t call it difficult if you haven&apos;t tried it a lot of times, can you?). The melody appears in a game if its string representation is a consecutive substring occurring at least once in that game.<br><br>Write a program to find the most difficult melody of length k , given n games you&apos;ve played. ","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The input contains several test cases. Each case consists of three integers n, m, k  (1&lt;=m&lt;=n&lt;=100, 1&lt;=k&lt;=20 ) , the next n  lines each contain two strings separated by exactly one space: the game, and whether you successfully repeated it. The first string will contain at least one at most 100 upper case letters `C&apos;, `D&apos;, `E&apos;, `F&apos;, `G&apos;, `A&apos;, `B&apos;. The second string will be either `Yes&apos; or `No&apos; (case sensitive). The last test case is followed by a single zero, which should not be processed. ","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, print the case number and the most difficult melody. If there is more than one solution, output the lexicographically smallest one. If there is no solution, output the string `No solution&apos;. ","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3 2 3 \nEEECEG Yes \nBFCEG No \nDEBFCEGEEC No \n3 2 2 \nAAA No \nBBB No \nCCC Yes \n0</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1: BFC \nCase 2: No solution</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2007+Asia+Regional+Beijing+&amp;source=1&amp;searchmode=source\"> 2007 Asia Regional Beijing  </a> ","type":"source","format":"html","require":["katex"]}]}