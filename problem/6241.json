{"title":"Color a Tree","time_limit":1000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6241","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6241&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6241","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6241"},"statement":[{"title":"Problem Description","content":"Bob intends to color the nodes of a tree with a pen. The tree consists of $N$ nodes. These nodes are numbered $1, 2, ..., N$. The root of the tree is node $1$. The initial color of each node is white. Bob can use one unit energy to color one node into black. To prevent Bob being lazy with painting, Alice proposed $A + B$ rules. Each rule is represent by two numbers $x_i$ and $y_i$.<br>For the first $A$ rules, it means that there should be no less than $y_i$ nodes painted black for the subtree of node $x_i$.<br>For the other $B$ rules, it means that there should be no less than $y_i$ nodes painted black for all nodes except the subtree of node $x_i$.<br>You need to help Bob to calculate the minimum energy he needs for the painting with all rules proposed by Alice satisfied.<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line is the number of test cases. For each test case, the first line contains one positive number $N(1 \\leq N \\leq 100000)$, indicating the number of trees nodes.<br><br>The following $N - 1$ lines describe the edges. Each line contains two integers $u, v$($1 \\leq u, v \\leq N$), denoting there is a edge between node $u$ and node $v$.<br><br>The following one line contains one number $A$($A \\leq 100000$), indicating the first $A$ rules.<br><br>The following $A$ lines describe the first $A$ rules. Each line contains two numbers $x_i$ and $y_i$ as  described above.<br><br>The following one line contains one number $B$($B \\leq 100000$), indicating the other $B$ rules.<br><br>The following $B$ lines describe the other $B$ rules. Each line contains two numbers $x_i$ and $y_i$ as  described above.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, output a integer donating the minimum energy Bob needs to use with all rules propose by Alice satisfied. If there is no solution, output $-1$ instead.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2 \n5\n1 2\n2 3\n3 4\n1 5\n2\n2 1\n5 1\n1\n2 1\n5\n1 2\n2 3\n3 4\n1 5\n3\n1 2\n2 2\n5 1\n1\n3 5</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n-1</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2017%D6%D0%B9%FA%B4%F3%D1%A7%C9%FA%B3%CC%D0%F2%C9%E8%BC%C6%BE%BA%C8%FC-%B9%FE%B6%FB%B1%F5%D5%BE-%D6%D8%CF%D6%C8%FC%A3%A8%B8%D0%D0%BB%B9%FE%C0%ED%B9%A4%A3%A9&amp;source=1&amp;searchmode=source\"> 2017&#x4E2D;&#x56FD;&#x5927;&#x5B66;&#x751F;&#x7A0B;&#x5E8F;&#x8BBE;&#x8BA1;&#x7ADE;&#x8D5B;-&#x54C8;&#x5C14;&#x6EE8;&#x7AD9;-&#x91CD;&#x73B0;&#x8D5B;&#xFF08;&#x611F;&#x8C22;&#x54C8;&#x7406;&#x5DE5;&#xFF09; </a> ","type":"source","format":"html","require":["katex"]}]}