{"title":"Jong Hyok and String","time_limit":1500,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5853","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5853&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5853","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5853"},"statement":[{"title":"Problem Description","content":"Jong Hyok loves strings. One day he gives a problem to his friend you. He writes down n strings Pi in front of you, and asks m questions. For i-th question, there is a string Qi. We called strange set(s) = {(i, j) | s occurs in Pi and j is the position of its last character in the current occurence}. And for ith question, you must answer the number of different strings t which satisfies strange set(Qi) = strange set(t) and t is a substring of at least one of the given n strings.","type":"description","format":"html"},{"title":"Input","content":"First line contains T, a number of test cases.<br><br>For each test cases, there two numbers n, m and then there are n strings Pi and m strings Qj.(i = 1&#x2026;n, j = 1&#x2026;m)<br><br><br>1 &lt;= T &lt;= 10<br>1 &lt;= n &lt;= 100000<br>1 &lt;= m&lt;= 500000<br>1 &lt;=|Pi|&lt;=100000<br>1 &lt;=|Qi|&lt;=100000<br> $\\sum_{i=1}^{n} |P_i|\\leq 100000$<br>File size is less than 3.5 megabytes.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, first line contains a line &#x201C;Case #x:&#x201D;, x is the number of the case.<br><br>For each question, you should print one integer in one line.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n2 2\naba\nab\na\nab</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1:\n1\n2\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nstrange set(&#x201C;a&#x201D;) ={(1, 1), (1, 3), (2, 1)}.\nstrange set(&#x201C;ab&#x201D;) ={(1, 2), (2, 2)}.\nstrange set(&#x201C;b&#x201D;) ={(1, 2), (2, 2)}.\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Author","content":"&#x91D1;&#x7B56;&#x5DE5;&#x4E1A;&#x7EFC;&#x5408;&#x5927;&#x5B66;&#xFF08;DPRK&#xFF09;","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2016+Multi-University+Training+Contest+9&amp;source=1&amp;searchmode=source\"> 2016 Multi-University Training Contest 9 </a> ","type":"source","format":"html"}]}