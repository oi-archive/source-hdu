{"title":"Seikimatsu Occult Tonneru","time_limit":6000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4309","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4309&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4309","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4309"},"statement":[{"title":"Problem Description","content":"During the world war, to avoid the upcoming Carpet-bombing from The Third Reich, people in Heaven Empire went to Great Tunnels for sheltering.<br>There are N cities in Heaven Empire, where people live, with 3 kinds of directed edges connected with each other. The 1st kind of edges is one of Great Tunnels( no more than 20 tunnels) where a certain number of people can hide here; people can also go through one tunnel from one city to another. The 2nd kind of edges is the so-called Modern Road, which can only let people go through. The 3rd kind of edges is called Ancient Bridge and all the edges of this kind have different names from others, each of which is named with one of the twelve constellations( such as Libra, Leo and so on); as they were build so long time ago, they can be easily damaged by one person&apos;s pass. Well, for each bridge, you can spend a certain deal of money to fix it. Once repaired, the 3rd kind of edges can let people pass without any limitation, namely, you can use one bridge to transport countless people. As for the former two kinds of edges, people can initially go through them without any limitation.<br>We want to shelter the most people with the least money.<br>Now please tell me the largest number of people who can hide in the Tunnels and the least money we need to spend to realize our objective.<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"Multiple Cases.<br>The first line, two integers: N (N&lt;=100), m (m&lt;=1000). They stands for the number of cities and edges.<br>The next line, N integers, which represent the number of people in the N cities.<br>Then m lines, four intergers each: u, v, w, p (1&lt;=u, v&lt;=N, 0&lt;=w&lt;=50). A directed edge u to v, with p indicating the type of the edge: if it is a Tunnel then p &lt; 0 and w means the maximum number people who can hide in the the tunnel; if p == 0 then it is a Modern Road with w means nothing; otherwise it is an Ancient Bridge with w representing the cost of fixing the bridge. We promise there are no more than one edge from u to v.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"If nobody can hide in the Tunnels, print &#x201C;Poor Heaven Empire&#x201D;, else print two integers: maximum number and minimum cost.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">4 4\n2 1 1 0\n1 2 0 0\n1 3 0 0\n2 4 1 -1\n3 4 3 -1\n\n4 4\n2 1 1 0\n1 2 0 0\n1 3 3 1\n2 4 1 -1\n3 4 3 -1</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">4 0\n4 3</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Author","content":"BUPT","type":"source","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2012+Multi-University+Training+Contest+1&amp;source=1&amp;searchmode=source\"> 2012 Multi-University Training Contest 1 </a> ","type":"source","format":"html","require":["katex"]}]}