{"title":"Clarke and hunger games","time_limit":3000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5467","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5467&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5467","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5467"},"statement":[{"title":"Problem Description","content":"Clarke is a patient with multiple personality disorder. One day, Clarke split into a lot of guys, live in $n$ communities.  <br>Clarkes are so boring, so they play a game called hunger games.  <br>They live in a city in the sky, so they connect each other by the bridge between communities.  <br>Clarkes are very economical, so there is only one path between any two communities if they can reach each other.  <br>The rules of the hunger games are like this: each community elects two guys, then send them to participate this death game.  <br>Clarkes want to know how many combinations to elect guys to participate the game, any two combinations are same if and only if the guys selected are same.  <br>Clarkes are so boring, so they have $q$ operations:  <br>1. $u$ $v$: build a bridge between $u$ and $v$. If $u$ and $v$ already have a path connected or $u=v$, ignore.  <br>2. $u$ $v$: remove the bridge between $u$ and $v$. If there is no bridge between $u$ and $v$ or $u=v$, ignore.  <br>3. $h$: back to the state that end of operation $h$. If $h=0$, the state should roll back to the initial state, which has no bridge connecting any two communities.  <br>4. $u$ $v$: ask how many combinations to elect guys from the communities on the path $u$ to $v$(including $u$ and $v$) to participate the game. Since the answer is very large, you only need to output the answer modulo $10^9+7$.  <br>5. $u$ $s$: change the number of the community $u$ to $s$.  <br><br>At beginning, there is no edge between any two communities.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line contains a integer $T(1 \\le T \\le 5)$, the number of test cases.  <br>For each test case:  <br>The first line contains two integers $u, q(1 \\le n, q \\le 3*10^5)$.  <br>The second line contains $n$ integers, the $ith$ integer $a_i(0 \\le a_i \\le 10^4)$denotes the number of the $ith$ communities.  <br>Then $q$ lines follow, the first number is $opt$:  <br>If $opt=1$, then two integers $u_i, v_i$ follow, represent operation $1$  <br>If $opt=2$, then two integers $u_i, v_i$ follow, represent operation $2$  <br>If $opt=3$, then one integer $h_i$ follow, represent operation $3$  <br>If $opt=4$, then two integers $u_i, v_i$ follow, represent operation $4$  <br>If $opt=5$, then two integers $u_i, s_i$ follow, represent operation $5$  <br>$1 \\le u_i, v_i \\le n, 0 \\le h_i &lt; i, 0 \\le s_i \\le 10^4$  ","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each testcase, for each $opt=4$, print the answer.  ","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n3 5\n1 2 3\n1 1 2\n2 1 2\n3 1\n5 1 3\n4 1 2</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n\nHint:\nAt the beginning, community $1$ has 1 guy, $2$ has 2 guys, $3$ has 3 guys.\nOperation 1: build a bridge between $1$ and $2$\nOperation 2: remove the bridge between $1$ and $2$.\nOperation 3: back to state $1$, which has bridge between $1$ and $2$.\nOperation 4: change the number of community $1$ from $1$ to $5$.\nOperation 5: enquire the combinations of community $1$ and $2$. Obviously, the answer is 3.</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=BestCoder+Round+%2356+%28div.1%29+%28%24%29&amp;source=1&amp;searchmode=source\"> BestCoder Round #56 (div.1) ($) </a> ","type":"source","format":"html","require":["katex"]}]}