{"title":"Tunnel Warfare","time_limit":2000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=1540","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=1540&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=1540","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=1540"},"statement":[{"title":"Problem Description","content":"During the War of Resistance Against Japan, tunnel warfare was carried out extensively in the vast areas of north China Plain. Generally speaking, villages connected by tunnels lay in a line. Except the two at the ends, every village was directly connected with two neighboring ones.<br><br>Frequently the invaders launched attack on some of the villages and destroyed the parts of tunnels in them. The Eighth Route Army commanders requested the latest connection state of the tunnels and villages. If some villages are severely isolated, restoration of connection must be done immediately!<br>","type":"description","format":"html"},{"title":"Input","content":"The first line of the input contains two positive integers n and m (n, m &#x2264; 50,000) indicating the number of villages and events. Each of the next m lines describes an event.<br><br>There are three different events described in different format shown below:<br><br>D x: The x-th village was destroyed.<br><br>Q x: The Army commands requested the number of villages that x-th village was directly or indirectly connected with including itself.<br><br>R: The village destroyed last was rebuilt.<br>","type":"input_format","format":"html"},{"title":"Output","content":"Output the answer to each of the Army commanders&#x2019; request in order on a separate line.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">7 9\nD 3\nD 6\nD 5\nQ 4\nQ 5\nR\nQ 4\nR\nQ 4</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n0\n2\n4</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=POJ+Monthly&amp;source=1&amp;searchmode=source\"> POJ Monthly </a> ","type":"source","format":"html"}]}