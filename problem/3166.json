{"title":"Classified","time_limit":2000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3166","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3166&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3166","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3166"},"statement":[{"title":"Problem Description","content":"Classification levels like Secret and Top Secret are well-known features of military documents. Less well known are <i>integrity levels</i>, which correspond to how <i>reliable</i> information is.<br><br>In the <b>Dynamic Biba integrity model</b>, every user and every document is assigned an integrity level. If a user writes to a document that has a higher integrity level than the user does, the document&#x2019;s integrity level goes down. Similarly, if a user reads a document that has a lower integrity level than the user does, the user&#x2019;s integrity level goes down.<br><br>Your job is to keep track of the integrity levels of a number of users and documents. Complicating the matter is the fact that integrity levels aren&#x2019;t simply numbers; a document might contain very trusworthy information about operations in Afganistan, while at the same time containing less trustworthy information about operations in Iraq.<br><br>Integrity levels are speficied by arbitrary labels, along with rules of the form <i>A</i> &#x2192; <i>B</i>, indicating that integrity level <i>A</i> is at most as trustworthy as integrity level <i>B</i>. The rules satisfy a number of conditions:<br><br><li>For any label <i>A</i>, <i>A</i> &#x2192; <i>A</i> is always true, and need not be specified.</li> <br><li>If <i>A</i> and <i>B</i> are two different labels, then it can never be the case that both <i>A</i> &#x2192; <i>B</i> and <i>B</i> &#x2192; <i>A</i> are true. However, it can be the case that neither <i>A</i> &#x2192; <i>B</i> nor <i>B</i> &#x2192; <i>A</i> are true. </li><br><li>For any labels <i>A</i>, <i>B</i>, and <i>C</i>, if it is the case that <i>A</i> &#x2192; <i>B</i> and <i>B</i> &#x2192; <i>C</i> are both true, you can conclude (without it being explicitly specified) that <i>A</i> &#x2192; <i>C</i> is true. </li><br><li>For any two labels <i>A</i> and <i>B</i>, there is a label <i>G = glb(A,B)</i> called the greatest lower bound of <i>A</i> and <i>B</i> such that <i>G</i> &#x2192; <i>A</i> and <i>G</i> &#x2192; <i>B</i> are both true. Further, for any label <i>L</i> such that <i>L</i> &#x2192; <i>A</i> and <i>L</i> &#x2192; <i>B</i> are both true, it is also the case that <i>L</i> &#x2192; <i>G</i> is true. </li><br>You will be given as input the labels and rules defining the integrity levels, as well as the initial integrity level of a number of users and a number of documents. The format will be as follows:<br><br><li>The first line of the input will contain five integers separated by spaces. These integers are the number of integrity levels <i>l</i>, the number of rules <i>r</i>, the number of users <i>u</i>, the number of documents <i>d</i>, and the number of actions <i>a</i>, in that order. None of these five integers will be greater than 10000. The integrity levels are numbered from 1 to <i>l</i>; the users from 1 to <i>u</i>, and the documents from 1 to <i>d</i>. </li><br><li>The next <i>r</i> lines specify the rules. Each line will consist of two integers between 1 and <i>l</i>, separated by a space. The line &#x201C;<i>x y</i>&#x201D; indicates that integrity level <i>x</i> is at most as trustworthy as integrity level <i>y</i> (i.e. <i>x</i> &#x2192; <i>y</i>)</li> <br><li>The next <i>u</i> lines specify the initial integrity levels for user number 1, 2, &#x2026;, <i>u</i>. Each line will be an integrity level number, from 1 to <i>l</i>. </li><br><li>The next <i>d</i> lines specify the initial integrity levels for document number 1, 2, &#x2026;, <i>d</i>. Each line will be an integrity level number, from 1 to <i>l</i>. </li><br><li>The next <i>a</i> lines specify the actions; each action will be of one of the following two forms (here, <i>user</i> is an integer between 1 and <i>u</i>, and document is an integer between 1 and <i>d</i>): </li><ul><li><i>user reads document</i>: The given user is reading the given document. The integrity level for the user should be changed to the <i>glb</i> of the old integrity level for the user and the integrity level of the document. Output the new integrity level for the user on a line by itself. </li><br><li><i>user writes document</i>: The given user is writing to the given document. The integrity level for the document should be changed to the <i>glb</i> of the integrity level for the user and the old integrity level of the document. Output the new integrity level for the document on a line by itself.</li></ul>.","type":"description","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">9 11 2 3 5\n6 9\n2 6\n9 4\n7 5\n3 8\n7 2\n5 3\n8 4\n5 1\n6 1\n1 8\n4\n2\n5\n9\n8\n1 reads 3\n1 writes 2\n2 reads 2\n1 reads 1\n2 writes 1</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">8\n6\n2\n5\n7</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=University+of+Waterloo+Local+Contest+2008.06&amp;source=1&amp;searchmode=source\"> University of Waterloo Local Contest 2008.06 </a> ","type":"source","format":"html"}]}