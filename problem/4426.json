{"title":"Palindromic Substring","time_limit":10000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4426","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4426&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4426","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4426"},"statement":[{"title":"Problem Description","content":"           In the kingdom of string, people like palindromic strings very much. They like only palindromic strings and dislike all other strings. There is a unified formula to calculate the score of a palindromic string. The score is calculated by applying the following three steps.<br>      <strong>1.</strong>   Since a palindromic string is symmetric, the second half (excluding the middle of the string if the length is odd) is got rid of, and only the rest is considered. For example, &quot;abba&quot; becomes &quot;ab&quot;, &quot;aba&quot; becomes &quot;ab&quot; and &quot;abacaba&quot; becomes &quot;abac&quot;.<br>      <strong>2.</strong>   Define some integer values for &apos;a&apos; to &apos;z&apos;.<br>      <strong>3.</strong>   Treat the rest part as a 26-based number M and the score is M modulo 777,777,777.<br>       However, different person may have different values for &apos;a&apos; to &apos;z&apos;. For example, if &apos;a&apos; is defined as 3, &apos;b&apos; is defined as 1 and c is defined as 4, then the string &quot;accbcca&quot; has the score (3&#xD7;26<sup>3</sup>+4&#xD7;26<sup>2</sup>+4&#xD7;26+1) modulo 777777777=55537.<br>       One day, a very long string S is discovered and everyone in the kingdom wants to know that among all the palindromic substrings of S, what the one with the K-th smallest score is.<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"       The first line contains an integer T(1 &#x2264; T &#x2264; 20), the number of test cases.<br>       The first line in each case contains two integers n, m (1 &#x2264; n &#x2264; 100000, 1 &#x2264; m &#x2264; 20) where n is the length of S and m is the number of people in the kingdom. The second line is the string S consisting of only lowercase letters. The next m lines each containing 27 integers describes a person in the following format.<br><center>K<sub>i</sub> va vb ... vz</center><br>        Where va is the value of &apos;a&apos; for the person, vb is the value of &apos;b&apos; and so on. It is ensured that the K<sub>i</sub>-th smallest palindromic substring exists and va, vb, ..., vz are in the range of [0, 26). But the values may coincide.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"        For each person, output the score of the K-th smallest palindromic substring in one line. Print a blank line after each case.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n6 2\nabcdca\n3 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n7 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 0\n4 10\nzzzz\n1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 14\n2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 14\n3 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 14\n4 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 14\n5 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 14\n6 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 14\n7 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 14\n8 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 14\n9 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 14\n10 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 14\n51 4\nabcdefghijklmnopqrstuvwxyzyxwvutsrqponmlkjihgfedcba\n1 1 3 3 25 20 25 21 7 0 9 7 3 16 15 14 19 5 19 19 19 22 8 23 2 4 1\n25 1 3 3 25 20 25 21 7 0 9 7 3 16 15 14 19 5 19 19 19 22 8 23 2 4 1\n26 1 3 3 25 20 25 21 7 0 9 7 3 16 15 14 19 5 19 19 19 22 8 23 2 4 1\n76 1 3 3 25 20 25 21 7 0 9 7 3 16 15 14 19 5 19 19 19 22 8 23 2 4 1</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n620\n\n14\n14\n14\n14\n14\n14\n14\n378\n378\n378\n\n0\n9\n14\n733665286\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nThere are 7 palindromic substrings {&quot;a&quot;, &quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;c&quot;, &quot;d&quot;, &quot;cdc&quot;} in the first case. For \nthe first person, the corresponding scores are {1, 1, 1, 1, 1, 1, 27}. For the second person, the corresponding scores are {25, 25, 24, 23, 23, 22, 620}.\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2012+Asia+ChangChun+Regional+Contest&amp;source=1&amp;searchmode=source\"> 2012 Asia ChangChun Regional Contest </a> ","type":"source","format":"html","require":["katex"]}]}