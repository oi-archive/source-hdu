{"title":"Warfare","time_limit":3000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=2904","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=2904&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=2904","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=2904"},"statement":[{"title":"Problem Description","content":"In the year 2240 a great war is taking place between the Earth Allied Forces (EAF) and the Mars Federation (MF). Until recently, none of the two major factions could gain the upper hand in the war. Because of a recent  nancial crisis, both factions&apos; resources are thinning out, and it appears that the MF is using this to their advantage to claim more territories over the EAF. In response to this, the EAF have decided to carry out its greatest operation since the start of the war: it will launch a simultaneous attack against all the MF bases that are scattered over the planet Mars. The EAF&apos;s forces mostly consist of mechs, which are huge bipedal, limbed vehicles with  ying capabilities.<br> A typical MF base is built up as follows: The buildings that make up the base are positioned over one or multiple territories. Each of these territories is protected against outside attacks by impenetrable energy  elds that are generated by shield towers. These shield towers are positioned around the territories they&apos;re supposed to protect. <br>Each shield tower is connected to at least one other tower via channels that are constructed above the ground. When these connected towers form a cycle, they generate an energy  eld. However,if a channel in a cycle is destroyed so that the cycle is broken, the energy  eld will disappear. The MF knows that if all energy  elds disappear, the base will be easily overrun by the EAF forces. Therefore, the two towers that are connected by a channel protect the channel against armed forces. Each tower has defenses that can take down a given number of enemy mechs. Each channel can handle an attack by a certain number of enemy mechs before it collapses. This number  is given by the amount of mechs that both towers, that the channel connects, can take down. Two towers cannot be connected by more than one channel.<br><br><br><center><img style=\"max-width:100%;\" src=\"../../../data/images/contest199-e-1.JPG\"></center><br>(a) Two towers that are connected by a channel. The vertices represent the towers while the line is the channel that connects the towers. The amount of mechs needed to destroy the channel is the combined amount of mechs that the connected towers can take down.<br><br><br>However, attacking a channel on one side of the tower does not diminish the amount of mechs that it can take down on the other side of the tower. <br>Because the operation is a surprise attack, all attacks on the channels must happen simultaneously: all channels are taken down at the same moment.<br><br><center><img style=\"max-width:100%;\" src=\"../../../data/images/contest199-e-2.JPG\"></center> <br>(b) MF base with multiple energy  elds. The vertices represent the towers while the lines are the channels that connect the towers. The numbers indicate how many mechs a tower can take down.<br><br><br><center><img style=\"max-width:100%;\" src=\"../../../data/images/contest199-e-3.JPG\"></center> <br>(c) In this case, the destruction of two channels will make all energy  elds disappear. Four mechs will be lost in the battle.<br><br><br><br>All energy  elds must be disabled in order to destroy a MF base. Tearing down all channels would make this happen, but would also require a lot of mechs to be sacri ced. The EAF has very little forces to spare and must therefore deploy its mechs as e cient as possible.<br> You have been tasked to write a program that will lead the EAF to victory. Given a graph of shield towers, determine which channels must be destroyed to make all energy  elds disappear, in such a way that the least number of EAF mechs are lost during the battle.<br>","type":"description","format":"html"},{"title":"Input","content":"  The  first line of input consists of the positive integer number n, the number of test cases;<br>Then, for each test case: <br>A line containing the positive integer number m (2 &lt; m  &lt;=100), the number of towers in the base;<br>Per tower two lines:<br>A line containing three positive integer numbers i (0 &lt;= i &lt;= m-1), ui(1&lt;= ui &lt;=50) and ci (1  &lt;= ci &lt;=  m -1): the (identification) number of the tower, the amount of mechs that the tower can take down and the number of channels respectively. The numbers are separated by a space;<br>A line containing ci  different positive integers, the towers that are connected to tower i. A tower cannot be connected to itself. The integers are separated by a space.<br>A given base will always be able to generate at least one energy  field.<br><br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, the output contains a line with one number: the minimum number of EAF mechs that will be lost during the battle to make all energy \u001celds disappear.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n3\n0 1 2\n1 2\n1 2 2\n0 2\n2 3 2\n0 1</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=BAPC+2008&amp;source=1&amp;searchmode=source\"> BAPC 2008 </a> ","type":"source","format":"html"}]}