{"title":"About set","time_limit":5000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4680","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4680&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4680","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4680"},"statement":[{"title":"Problem Description","content":"Today Zhanyl (sister Zhan as you know)  receives a task about set operation. Although she is very good at this task, <br>but you know she is very lazy so that she wants you to help her write a program to complete this task. Surly<br>Zhanyl is able to solve this question, but you know, she is just lazy ...<br>Here is the problem, you are given n numbers, each number i has a value A<sub>i</sub>, initially they are in different set. <br>Following there are m operations/querys.<br>The following is 5 possible kinds of oprations/querys:<br>1 u v: Union the set u belongs to and the set v belongs to.<br>2 u v: Delete u from its original set and add it to the set v belongs to.<br>3 u x: change the value of u to x.&#xA0;&#xA0;1&lt;=x&lt;=10<sup>9</sup><br>4 u: query how many numbers you can choose most in set which u belongs to, so no three numbers can form a triangle.<br>5 u l r: query the gcd of the numbers between [l,r] in the set u belongs to, if there is no number between [l,r],you can suppose the answer is -1.&#xA0;&#xA0;<strong>1&lt;=l&lt;=r&lt;=10<sup>9</sup></strong><br>Because Zhanyl is a good person, so she guarantee 1&lt;=u,v&lt;=n above.<br>You need to tell Zhanyl the answer to each query.","type":"description","format":"html"},{"title":"Input","content":"The first line of the input is a single integer T which is the number of test cases.Then comes the T test cases .<br>For each test case, the first line contains two integer n and m, n is the number of set initially, m is the number <br>of operations/querys.<br>Following line contains n integers, A<sub>1</sub>, A<sub>2</sub>, ... , A<sub>n</sub>, the value of i-th number.<br>Following m lines, each line is a operation or query.<br><br>Note that 1&lt;=n,m&lt;=10<sup>5</sup>, 1&lt;=A<sub>i</sub>&lt;=10<sup>9</sup>","type":"input_format","format":"html"},{"title":"Output","content":"For each case,output &quot;Case #X:&quot; in one line first, X is the case number starting from 1. Following you should output all the querys, each query a line.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n5 5\n1 2 3 4 5\n1 2 4\n5 2 1 5\n2 1 4\n3 2 3\n4 2</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1:\n2\n3</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2013+Multi-University+Training+Contest+8&amp;source=1&amp;searchmode=source\"> 2013 Multi-University Training Contest 8 </a> ","type":"source","format":"html"}]}