{"title":"Ants","time_limit":10000,"memory_limit":320,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4776","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4776&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4776","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4776"},"statement":[{"title":"Problem Description","content":"&#x3000;&#x3000;There are some apple trees in a farm. An apple tree can be described as a connected graph which has n nodes and n-1 edges. The apples are the nodes and the branches are the edges. Every edge is assigned a value denoting the length of the branch. <br>&#x3000;&#x3000;Now in the farm come a lot of ants, which are going to enjoy the delicious apples. The ants climb the tree one by one. Every ant would choose a node as the starting node and another node as the ending node, then it would crawl alone the unique path from the starting node to the ending node. The distance between two nodes is defined as the XOR sum of lengths of all the edges in the unique path between them. Every ant wants to crawl along such a path which the distance is as large as possible. But two ants cannot crawl from the same starting node to the same ending node. You should calculate the distance which the k-th ant crawled.<br>&#x3000;&#x3000;Note that the starting node and the ending node cannot be the same for an ant.<br>","type":"description","format":"html"},{"title":"Input","content":"&#x3000;&#x3000;The input consists of several test case.<br>&#x3000;&#x3000;For each test case, the first line contain an integer n denoting the number of nodes.<br>&#x3000;&#x3000;The next n-1 lines each contains three integers x,y,z, denoting that there exists an edge between node x and node y and its length is z. The nodes are numbered from 1 to n.<br>&#x3000;&#x3000;The next line contain a integer m denoting the number of queries.<br>&#x3000;&#x3000;In the next m lines, each line contains an integer k denoting that you need to calculate the distance of the k-th ant.<br>&#x3000;&#x3000;The input ends with n = 0.<br>&#x3000;&#x3000;(1 &lt;= n, m &lt;= 100000, 1 &lt;= x, y &lt;= n, 0 &lt;= z &lt;= 10<sup>18</sup>, 1 &lt;= k &lt;= 200000)","type":"input_format","format":"html"},{"title":"Output","content":"&#x3000;&#x3000;For each query, output the answer. If such path does not exist, just output -1.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n1 2 2\n3 2 3\n3\n1\n2\n5\n5\n1 3 7\n2 1 3\n4 3 6\n5 3 1\n3\n1\n8\n1000\n0</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n3\n1\n7\n6\n-1\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\n&#x3000;&#x3000;In the first test case, the first ant may crawl from node 2 to node 3, and the second ant may crawl from node 3 to node 2, and the 5-th ant may crawl from node 1 to node 3.\n&#x3000;&#x3000;The distance of the 5-th ant can be calculated by 2 xor 3 = 1.\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2013+Asia+Hangzhou+Regional+Contest+&amp;source=1&amp;searchmode=source\"> 2013 Asia Hangzhou Regional Contest  </a> ","type":"source","format":"html"}]}