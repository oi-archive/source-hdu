{"title":"Chess Puzzle","time_limit":8000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5535","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5535&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5535","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5535"},"statement":[{"title":"Problem Description","content":"Andrew is a puzzle lover, he is interested in creating interesting puzzles. One day he creates a new puzzle, following are the rules of the game:<br><br>The game is played on a big chessboard, it has $n$ rows and $m$ columns. The coordination $(i,j)$ ($1 \\le i \\le n$ ,$1 \\le j \\le m$) indicates the square on $i$-th row and $j$-th column.<br><br>There are two kinds of chesses, black chess and white chess in this game. Some of the chesses are putted on some squares at the initial of the game, and other squares are empty.<br><br>The player has to put chesses on <b>all</b> the empty squares. Both black and white chesses are sufficient enough to be putted on all the squares.<br><br>After all the squares on chessboard are full of chess. Andrew begins to calculate the score that player gets. The score is calculated using the following algorithm - For every two squares $(x_1, y_1)$ and $(x_2,y_2)$, the player gets $1$ point if the following $3$ conditions are satisifed:<br><br>    - There is a black chess on $(x_1, y_1)$.<br>    - And a white chess on $(x_2, y_2)$.<br>    - $|x_1 - x_2|=a$ and $|y_1 - y_2| = b$, which $a$ and $b$ are two constants defined by Andrew before the game starts.<br><br>But Andrew is confused because he doesn&apos;t know what is the highest possiple score in the game. Can you help him find the best way to solve the puzzle?","type":"description","format":"html"},{"title":"Input","content":"The first line of input contains an integer $T$ indicating the total number of test cases.<br><br>The first line of each test case has 4 integers $n, m, a, b$, indicating the number of rows, number of columns and two integers decided by Andrew. The $n$ lines that follow describe the puzzle, the $i$-th of these lines is a string with $m$ characters $c_{i,1}, c_{i,2},..., c_{i,m}$, which $c_{i,j}$ indicates the type of chess that putted on $(i,j)$ at the begin of game. Black chesses are represented by uppercase (&apos;B&apos;), white chesses by uppercase (&apos;W&apos;), and empty squares by period (&apos;.&apos;).<br><br>$1 \\le T \\le 1000$<br>$1 \\le n,m \\le 100$<br>$1 \\le a \\le n$, $1 \\le b \\le m$<br>There are at most $20$ testcases with $n &gt; 30$ or $m &gt; 30$","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, please output an integer in the first line indicating the highest score that player can get. Then following $n$ lines, each line with $m$ characters indicating the chess type on each square to get the higgest score. The output format is same as input format.<br><br>Note that if there are mutiple ways to get the highest score, you should output the one with smallest lexicographical order in ASCII. (&apos;B&apos; is smaller than &apos;W&apos;)","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n2 2 1 1\n..\n..\n2 2 1 1\n.W\n.B</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\nBB\nWW\n2\nWW\nBB</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2015ACM%2FICPC%D1%C7%D6%DE%C7%F8%B3%A4%B4%BA%D5%BE-%D6%D8%CF%D6%C8%FC%A3%A8%B8%D0%D0%BB%B6%AB%B1%B1%CA%A6%B4%F3%A3%A9&amp;source=1&amp;searchmode=source\"> 2015ACM/ICPC&#x4E9A;&#x6D32;&#x533A;&#x957F;&#x6625;&#x7AD9;-&#x91CD;&#x73B0;&#x8D5B;&#xFF08;&#x611F;&#x8C22;&#x4E1C;&#x5317;&#x5E08;&#x5927;&#xFF09; </a> ","type":"source","format":"html"}]}