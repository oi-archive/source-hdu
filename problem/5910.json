{"title":"Advanced Traffic System","time_limit":2500,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5910","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5910&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5910","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5910"},"statement":[{"title":"Problem Description","content":"Byteland is a beautiful country with $n\\times m$ cities, conveniently labeled with $1,2,3,...,n\\times m$. The map of Byteland can be represented as a matrix with $n$ rows and $m$ columns, and the label of city $(i,j)$ is $id[i][j]$.<br><br>Byteasar is proud of Byteland&apos;s advanced traffic system. The traffic system of Byteland can be compressed to $e$ information. Each information contains $9$ integers $L,R,A,B,dx,C,D,dy,w$, which can be decoded using the program below:<br><br>&lt;pre&gt;<br>for(i = L;i &lt;= R;i ++)<br>    for(x = A;x &lt;= B;x += dx)<br>        for(y = C;y &lt;= D;y += dy)<br>            addedge(i, id[x][y], w);<br><br>&lt;/pre&gt;<br><br>where $addedge(x, y, z)$ means adding an one-way edge with length $w$, which starts at the $x$-th city and ends at the $y$-th city.<br><br>Byteasar lives in $(sx,sy)$, he wants to know the shortest path from his position to every city, can you help him?","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line of the input contains an integer $T(1\\leq T\\leq10)$, denoting the number of test cases.<br><br>In each test case, the first line of the input contains $5$ integers $n,m,e,sx,sy$ $(1\\leq n,m\\leq 300,0\\leq e\\leq 50000,1\\leq sx\\leq n,1\\leq sy\\leq m)$.<br><br>Each of the following $n$ lines contains $m$ integers, the $j$-th number of the $i$-th line denotes $id[i][j](1\\leq id[i][j]\\leq n\\times m)$.<br><br>It is guarenteed that $id[i][j]$ forms a permutation from $1$ to $n\\times m$.<br><br>Each of the following $e$ lines contains $9$ integers $L,R,A,B,dx,C,D,dy,w$, denoting each information.<br><br>$1\\leq L\\leq R\\leq n\\times m$.<br><br>$1\\leq A\\leq B\\leq n,1\\leq dx\\leq n$.<br><br>$1\\leq C\\leq D\\leq m,1\\leq dy\\leq m$.<br><br>$1\\leq w\\leq 1000$.<br><br>There are no more than $3$ test cases satisfying $e\\geq 2000$.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, print a line with $n\\times m$ integers, the $i$-th number denotes the shortest distance from Byteasar&apos;s position to the $i$-th city.<br><br>If the city is unreachable, please print $-1$ instead.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n2 3 4 2 1\n3 1 6\n4 5 2\n2 6 1 1 1 2 3 2 4\n3 5 1 2 1 3 3 1 2\n5 6 1 2 2 2 2 2 5\n1 3 1 2 2 1 1 1 4\n3 4 5 1 2\n10 7 2 3\n4 5 9 6\n8 12 1 11\n2 10 2 3 1 2 4 1 1\n1 1 1 2 1 1 2 2 5\n4 10 1 3 1 2 3 2 5\n5 7 2 3 1 3 3 2 4\n5 7 1 2 1 3 3 1 4</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">4 2 6 0 -1 2\n1 4 -1 6 1 1 0 -1 1 6 1 1</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=BestCoder+Round+%2388&amp;source=1&amp;searchmode=source\"> BestCoder Round #88 </a> ","type":"source","format":"html","require":["katex"]}]}