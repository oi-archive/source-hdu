{"title":"Tree","time_limit":1000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6867","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6867&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6867","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6867"},"statement":[{"title":"Problem Description","content":"You are given a tree consisting of $n$ vertices numbered $1$ to $n$ rooted at node $1$. The parent of the $i$-th vertices is $p_i$. You can move from a vertex to any of its children. What&apos;s more, you can add one directed edge between any two different vertices, and you can move through this edge too. You need to maximize the number of pairs $(x,y)$ such that $x$ can move to $y$ through the edges after adding the edge. Note that $x$ can also move to $x$.","type":"description","format":"html"},{"title":"Input","content":"The first line contains one integer $T$ $(1\\leq T\\leq 100000)$ &#x2014; the number of test cases.<br><br>The first line of each test case contains only one integer $n(1\\leq n\\leq 5\\times 10^5)$ &#x2014; the number of vertices in the tree.<br><br>The second line of each test case contains $n-1$ integers $p_2,p_3,\\dots,p_n (1\\leq p_i&lt;i)$ &#x2014; the parent of each non-root node.<br><br>The sum of $n$ over all test cases does not exceed $10^6$.","type":"input_format","format":"html"},{"title":"Output","content":"Print $T$ integers &#x2014; for each test case output the maximum number of pairs $(x,y)$ that vertices $x$ can move to $y$ after adding one edge.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n5\n1 1 2 2\n6\n1 2 3 1 3</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">17\n26</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2020+Multi-University+Training+Contest+9&amp;source=1&amp;searchmode=source\"> 2020 Multi-University Training Contest 9 </a> ","type":"source","format":"html"}]}