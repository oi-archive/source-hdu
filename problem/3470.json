{"title":"Chinese Paper Folding","time_limit":5000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3470","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3470&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3470","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3470"},"statement":[{"title":"Problem Description","content":"Chinese Paper Folding, or Zhezhi, is the art of folding paper that originated in China. It is the predecessor of origami.<br><br>Here we only consider a simplified problem. You are given a paper L cm by W cm in size and a list of operations to fold it.<br><br>Four types of operation are listed below: <br>1.&#xA0;&#xA0;L v , fold the left part of paper along the straight line x = v.<br>2.&#xA0;&#xA0;R v , fold the right part of paper along the straight line x = v.<br>3.&#xA0;&#xA0;U v , fold the upper part of paper along the straight line y = v.<br>4.&#xA0;&#xA0;D v , fold the lower part of paper along the straight line y = v.<br>Note that v is always an integer.<br><br><center><img style=\"max-width:100%;\" src=\"../../data/images/C284-1002-1.jpg\"></center> <br><br>We define the left-lower corner of current paper as (0, 0) at every step (refer to the picture below). It is guaranteed that each operation is legal, that is, each operation is asked to fold paper of a positive area.<br><br><center><img style=\"max-width:100%;\" src=\"../../data/images/C284-1002-2.jpg\"></center> <br><br>It is obvious that folding will make the straight lines into creases. We wonder the total length of all creases when paper is completely unfolded.","type":"description","format":"html"},{"title":"Input","content":"In the first line there is an integer T, indicates the number of test cases. (T &lt;= 50)<br><br>For each case, the first line is a pair of integers L and W (1 &lt;= L, W &lt;= 1,000,000), which stands for the length and width of the paper. In the second line, an integer K stands for the number of operations. (K &lt;= 100000) Then K lines follow, each stands for an operation described above.<br><br>","type":"input_format","format":"html"},{"title":"Output","content":"For each case, output &#xFFFD;&#xFFFD;Case x: R&quot; on a single line, in which x is the case number counted from one, R is the total length of all creases.<br><br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n50 50\n4\nL 30\nD 5\nR 3\nU 5\n65536 1\n16\nL 32768\nL 16384\nR 8192\nR 4096\nL 2048\nR 1024\nL 512\nR 256\nR 128\nL 64\nR 32\nR 16\nL 8\nR 4\nL 2\nR 1</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1: 250\nCase 2: 65535</div></pre>","type":"example","format":"html"},{"title":"Author","content":"love8909","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2010+ACM-ICPC+Multi-University+Training+Contest%A3%A84%A3%A9%A1%AA%A1%AAHost+by+UESTC&amp;source=1&amp;searchmode=source\"> 2010 ACM-ICPC Multi-University Training Contest&#xFFFD;&#xFFFD;4&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;Host by UESTC </a> ","type":"source","format":"html"}]}