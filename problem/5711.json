{"title":"Ingress","time_limit":1000,"memory_limit":63.9990234375,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5711","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5711&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5711","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5711"},"statement":[{"title":"Problem Description","content":"Brickgao, who profited from your accurate calculating last year, made a great deal of money by moving bricks. Now he became ``gay shy fool&apos;&apos; again and recently he bought an iphone and was deeply addicted into a cellphone game called Ingress. Now he is faced with a problem so he turns to you for help again. We make some slight modifications based on the original rules, so please draw attention to the details below.<br><br>There are $N$ portals (indexed from 1 to $N$) around Brickgao&apos;s home, and he can get some substances called XM by hacking the portals. It&apos;s known that for each portal $i$, he can get $A_i$ XM during the first hack, and after each hack, the amount of XM he will get during the next hack will decrease by $B_i$. If the amount of XM he can get is less than or equal to zero, Brickgao can&apos;t get XM from that portal anymore. For the $i$-th portal, if $A_i = 10, B_i = 2$ and he hacks 3 times, he will get 10, 8, 6 XM during each hack.<br><br>There are $M$ bidirectional roads between some pairs of portals and between Brickgao&apos;s home and some portals. Now he is eager to start his Ingress journey from home and finally return home, but due to the extremely hot weather, Brickgao will feel sick when you hack more than $K$ times or the distance he covers is more than $L$. So how much XM he can get at most during this journey?<br><br>","type":"description","format":"html"},{"title":"Input","content":"The first line contains a single integer $T(T\\leq 20)$, indicating the number of test cases.<br><br>The first line of each case are four integers $N(1\\leq N \\leq 16), M(0 \\leq M \\leq \\frac{N(N+1)}{2}), K(1 \\leq K \\leq 50)$ and $L(2 \\leq L \\leq 2000)$.<br>The second line of each case contains $N$ non-negative integers where the $i$-th denotes $A_i(A_i \\leq 500)$.<br>The third line of each case contains $N$ non-negative integers where the $i$-th denotes $B_i(B_i \\leq 50)$.<br>Each of next $M$ line contains 3 non-negative integers $u, v ( 0\\leq u,v\\leq n)$ and $c (0\\leq c\\leq 1000)$ , denotes that there is a road with the length of $c$ between the $u$-th and the $v$-th portal. If $u$ or $v$ equals to 0, it means Brickgao&apos;s home.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output the case number first, then the amount of maximum XM Brickgao can get.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n1 1 3 2\n5\n3\n0 1 1\n3 6 3 5\n10 7 5\n2 3 1\n0 1 3\n0 2 1\n0 3 1\n1 2 2\n2 3 3\n1 3 4</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1: 7\nCase 2: 16</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=%26quot%3B%B0%CD%BF%A8%CB%B9%B1%AD%26quot%3B+%D6%D0%B9%FA%B4%F3%D1%A7%C9%FA%B3%CC%D0%F2%C9%E8%BC%C6%BE%BA%C8%FC+-+%C5%AE%C9%FA%D7%A8%B3%A1&amp;source=1&amp;searchmode=source\"> &quot;&#x5DF4;&#x5361;&#x65AF;&#x676F;&quot; &#x4E2D;&#x56FD;&#x5927;&#x5B66;&#x751F;&#x7A0B;&#x5E8F;&#x8BBE;&#x8BA1;&#x7ADE;&#x8D5B; - &#x5973;&#x751F;&#x4E13;&#x573A; </a> ","type":"source","format":"html"}]}