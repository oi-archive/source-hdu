{"title":"How Many HouGong","time_limit":2000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3801","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3801&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3801","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3801"},"statement":[{"title":"Problem Description","content":"<center><img style=\"max-width:100%;\" src=\"../../../data/images/C331-1002-1.jpg\"></center><br>There are N rooms in the palace of &#x201C;Hou&#x201D;. (Obviously Roba is the master!) There are Ai girls in the i-th room and their value of charm is 1, 2... Ai,  respectively.<br>Roba will pick out one girl in one room (randomly). Obviously, only N girl could meet Roba in a single day! Every girl has her value of charm. Now Roba wants to know the number of grils whose value of charm is exactly x! So F(Girl_Selected, x) is defined as the number of grils whose value of charm is exactly x in Girl_Selected.<br>For example, when N = 3, and Roba pick out three grils whose value of charm is 2, 3, 2 respectively, that is to say, Girl_Selected = {2,3,2},  so F({2,3,2}, 2) = 2, F({2,3,2},3) = 1, F({2,3,2},1) = 0.<br>Now Roba has Q queries. Each query will be one of the following operations:<br>1 val : Output the sum of F(Girl_Selected _possible_way, val) for all possible combination. As we know, there must be <center><img style=\"max-width:100%;\" src=\"../../../data/images/C331-1002-2.png\"></center> different ways for Roba to pick out the N grils in a single day! Since the answer may be huge, you should output the answer mod P.<br>2 pos val : rearrange room pos from ( Apos ) to val, which means Roba maybe sometimes Friends Old and New! After arrangement, val grils in room pos and their value of charm is 1,2,&#x2026; val respectively ! Note that 1&lt;=val&lt;=10<sup>9</sup> and 0&lt;=pos&lt;N.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line is an integer T indicates the number of the test cases. (T &lt;= 40)<br>Each case begins with one line containing three integers N (1&lt;=N&lt;=10<sup>5</sup>), P (2 &lt;= P &lt;= 10<sup>9</sup>, P is a prime) and Q(1&lt;= Q &lt;= 10<sup>5</sup>), representing the number of rooms of palace of &#x201C;Hou&#x201D;, the mod number and the number of queries respectively. Then one line contains N numbers, the i-th number indicating the initial Ai. In the next Q line, each line contains one operation fits the description. (1 &lt;= Ai &lt;= 10<sup>9</sup>)","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"Output one line for each type-1 query.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n4 7 5\n1 2 3 4\n1 2\n2 0 7\n1 4\n2 0 5\n1 3</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5\n3\n3\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nHint: If you solve this problem, Roba will give you some grils in the palace of &#x201C;Hou&#x201D;! \n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Author","content":"code6 &amp;&amp; yayamao","type":"source","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=ACM-DIY+Group+Contest+2011+Spring&amp;source=1&amp;searchmode=source\"> ACM-DIY Group Contest 2011 Spring </a> ","type":"source","format":"html","require":["katex"]}]}