{"title":"Clumsy Algorithm","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4783","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4783&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4783","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4783"},"statement":[{"title":"Problem Description","content":"&#x3000;&#x3000;Sorted Lists are thought beautiful while permutations are considered elegant. So what about sequence (1, 2, ... , n) ? It is the oracle from god. Now Coach Pang finds a permutation (p<sub>1</sub>, p<sub>2</sub>, ... , p<sub>n</sub>) over {1, 2, ... , n} which has been shuffled by some evil guys. To show Coach Pang&#x2019;s best regards to the oracle, Coach Pang decides to rearrange the sequence such that it is the same as (1, 2, 3, ... , n). The time cost of swapping p<sub>i</sub> and p<sub>j</sub> is 2|i- j| - 1. Of course, the minimum time cost will be paid since Coach Pang is lazy and busy. Denote the minimum time cost of the task as f(p). But Coach Pang is not good at maths. He finally works out a clumsy algorithm to get f(p) as following:<br><center><img style=\"max-width:100%;\" src=\"../../data/images/C487-1003-1.jpg\"></center> <br>&#x3000;&#x3000;Coach Pang&#x2019;s algorithm is clearly wrong. For example, n = 3 and (3, 2, 1) is the permutation. In this case, f(p) = 3 but g(p) = 0 + 0 + 2 = 2. The question is that how many permutations p of {1, 2, ... , n}  such that f(p) = g(p). To make the problem more challenge, we also restrict the prefix of p to (a<sub>1</sub>, a<sub>2</sub>, ... ,  a<sub>k</sub>). To sum up, you need to answer the question that how many permutations p of {1, 2, ... , n}  with the fixed prefix p<sub>1</sub> = a<sub>1</sub>, p<sub>2</sub> = a<sub>2</sub>, ... , p<sub>k</sub> = a<sub>k</sub> such that f(p) = g(p). Since the answer may be very large, for convenience, you are only asked to output the remainder divided by (10<sup>9</sup> + 7).","type":"description","format":"html"},{"title":"Input","content":"&#x3000;&#x3000;The first line contains a positive integer T(1 &lt;= T &lt;= 100), which indicates the number of test cases. T lines follow. Each line contains n, k, a<sub>1</sub>, a<sub>2</sub>, a<sub>3</sub>, ... , a<sub>k</sub>. (1 &lt;= n &lt;= 100, 0 &lt;= k &lt;= n, 1 &lt;= a<sub>i</sub> &lt;= n and all a<sub>i</sub> are distinct.)<br>","type":"input_format","format":"html"},{"title":"Output","content":"&#x3000;&#x3000;For each test case, output one line &#x201C;Case #x: y&#x201D;, where x is the case number (starting from 1) and y is the answer to each test case.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n3 0\n5 2 1 4</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1: 5\nCase #2: 3\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nAmong all permutations over {1, 2, 3}, {3, 2, 1} is the only counter-example.\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2013+Asia+Chengdu+Regional+Contest+&amp;source=1&amp;searchmode=source\"> 2013 Asia Chengdu Regional Contest  </a> ","type":"source","format":"html"}]}