{"title":"Speedy Escape","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3143","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3143&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3143","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3143"},"statement":[{"title":"Problem Description","content":"<br><center><img style=\"max-width:100%;\" src=\"../../../data/images/3143-1.jpg\"></center><br>The Newton brothers are planning to rob a bank in the city of Alviso and want to figure out a way to escape the city&apos;s only police car. They know that their car is faster than the police car so if they could just reach one of the highways exiting the city they will be able to speed away from the police.<br><br>The police car has a maximum speed of 160 km/h. Luckily, the brothers know where the police car will start (it&apos;s parked at the police station). To be on the safe side they assume that the police car will start moving as soon as they leave the bank and start their car (this is when the alarm goes off).<br><br>The brothers want to find a fixed route that ensures that they are able to leave the city no matter what route the police car take and at what speed it drives. However, since the brothers are not very confident drivers they don&apos;t want to drive faster than necessary. Luckily they have recently invested in a new hi-tech in-car police escape system that you have constructed. This system will tell them what the minimal top speed needed to escape is (and probably other useful things like what route to take).<br><br>Let&apos;s turn the clock back a bit to the time when you were constructing the escape system and focused on finding the minimal required speed. Can you get it right?<br><br><i>You may treat all roads as infinitesimally narrow and both cars as point objects. If the brothers ever end up at the same point (on any road or intersection) at the same time as the police car they will be caught and by Murphy&apos;s law if there is any possibility of this happening it will happen. The two cars start simultaneously and can accelerate/decelerate instantaneously at any time to any speed below or equal to its maximum speed. They can also change roads at intersections or direction anywhere on a road instantaneously no matter what speed they are traveling at.</i><br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line of the input consists of three integers <i>n</i>, <i>m</i> and <i>e</i>, where 2 &lt;= <i>n</i> &lt;= 100 describe the number of intersections, 1 &lt;= <i>m</i> &lt;= 5000 describes the number of roads in the city and 1 &lt;= <i>e</i> &lt;= <i>n</i> describes the number of highway exits. Then follow <i>m</i> lines, each consisting of three integers <i>a</i>, <i>b</i>, <i>l</i> such that 1 &lt;= <i>a</i> &lt; <i>b</i> &lt;= <i>n</i> and 1 &lt;= <i>l</i> &lt;= 100 describing a road of length <i>l</i> hundred meters from intersection <i>a</i> to intersection <i>b</i>. Then follows a line of <i>e</i> integers, each one a number in 1, ..., <i>n</i> describing which intersections are connected to highway exits. Finally there is a line with two integers <i>b</i> and <i>p</i> (1 &lt;= <i>b</i>, <i>p</i> &lt;= <i>n</i> and <i>b</i> != <i>p</i>) describing the intersections where the brothers and the police cars start, respectively.<br><br><i>It will always be possible to travel from any intersection to any other intersection. Roads are only connected at intersection points (although they may cross using bridges or tunnels at others points). Roads can be used in both directions but there cannot be more than one road between two intersections.</i>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"The minimal speed in km/h required to escape or the word <b>IMPOSSIBLE</b> if it is impossible. In the first case any answer with either absolute or relative error smaller than 10<sup>-6</sup> is acceptable.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3 2 1\n1 2 7\n2 3 8\n1\n3 2\n3 2 1\n1 2 7\n2 3 8\n1\n2 3\n4 4 2\n1 4 1\n1 3 4\n3 4 10\n2 3 30\n1 2\n3 4</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">IMPOSSIBLE\n74.6666666667\n137.142857143</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=NCPC+2009&amp;source=1&amp;searchmode=source\"> NCPC 2009 </a> ","type":"source","format":"html","require":["katex"]}]}