{"title":"Mathematics problem ","time_limit":6000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5161","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5161&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5161","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5161"},"statement":[{"title":"Problem Description","content":"Vivid is good at higher mathematics. So his classmates call him the little prince of higher mathematics. However, during the final exam of higher mathematics, he was got stuck with the last problem. So he may turn to you for help, if you do a good job you may get a generous remuneration. <br>Here is the statement of that problem.<br>Here is a differential equation about f(x), $\\left\\{\\begin{matrix}{f{\\left( x \\right)}}^{&quot;}=f{\\left( x \\right)}\\\\ {f{\\left( 0 \\right)}=f{\\left( 0 \\right)}}^{&apos;}=1\\end{matrix}\\right.$<br><br> , and  $g\\left( x \\right) = \\frac{x}{{f\\left( x \\right) - 1}}$ , you are expected to calculate $\\mathop {\\lim }\\limits_{x \\to 0} {\\kern 1pt} {\\kern 1pt} {\\kern 1pt} g{\\left( x \\right)^{\\left( n \\right)}}$ .$g{\\left( x \\right)^{\\left( n \\right)}}$ is the N derivative of   $g\\left( x \\right)$  , i.e. $\\left\\{ \\begin{array}{l}<br>g{\\left( x \\right)^{\\left( 0 \\right)}} = g\\left( x \\right)\\\\<br>g{\\left( x \\right)^{\\left( n \\right)}} = {\\left[ {g{{\\left( x \\right)}^{\\left( {n - 1} \\right)}}} \\right]^\\prime }{\\kern 1pt} {\\kern 1pt} {\\kern 1pt} for{\\kern 1pt} {\\kern 1pt} {\\kern 1pt} n{\\kern 1pt} {\\kern 1pt}  \\ge 1<br>\\end{array} \\right.$ .<br>The result may be a fraction, but Vivid loves integer very much. So he designs a function ftoi(x) to turn a fraction into an integer.<br><br>ftoi(x)<br>{<br>&#xA0;&#xA0;MOD=1000000007;<br>&#xA0;&#xA0;sign=1;<br>&#xA0;&#xA0;if(x&lt;0)<br>&#xA0;&#xA0;{<br>&#xA0;&#xA0;&#xA0;&#xA0;x=-x;<br>&#xA0;&#xA0;&#xA0;&#xA0;sign=-1;<br>&#xA0;&#xA0;}<br>&#xA0;&#xA0;if(x is not simplest fraction)set x to the simplest fraction which equals to x;<br>&#xA0;&#xA0;up=numerator of x;<br>&#xA0;&#xA0;down=denominator of x;<br>&#xA0;&#xA0;<br>&#xA0;&#xA0;inv is the minimun non-negative integer which makes inv*down%MOD=1 hold;<br>&#xA0;&#xA0;(sometimes inv may not exist, but in this problem you can assume that there is no such case.)<br>&#xA0;&#xA0;return (inv*up*sign%MOD+MOD)%MOD;<br>}<br>For example ftoi(1)=1, ftoi(-1)= 1000000006, ftoi(-2/4)=ftoi(-1/2)= 500000003, ftoi(6/12)=ftoi(1/2)= 500000004","type":"description","format":"html"},{"title":"Input","content":"Multi test cases (about 60000), each case will give n in a single line.<br>Process to the end of file.<br><br>[Technical Specification]<br>0&lt;=n&lt;65536","type":"input_format","format":"html"},{"title":"Output","content":"For each n, output $ftoi{\\left( \\mathop {\\lim }\\limits_{x \\to 0} {\\kern 1pt} {\\kern 1pt} {\\kern 1pt} g{\\left( x \\right)^{\\left( n \\right)}} \\right)}$ in a single line.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">0\n1</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n500000003</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=BestCoder+Round+%2326&amp;source=1&amp;searchmode=source\"> BestCoder Round #26 </a> ","type":"source","format":"html"}]}