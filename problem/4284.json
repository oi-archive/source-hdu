{"title":"Travel","time_limit":5000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4284","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4284&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4284","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4284"},"statement":[{"title":"Problem Description","content":"&#x3000;&#x3000;PP loves travel. Her dream is to travel around country A which consists of N cities and M roads connecting them. PP has measured the money each road costs. But she still has one more problem: she doesn&apos;t have enough money. So she must work during her travel. She has chosen some cities that she must visit and stay to work. In City_i she can do some work to earn Ci money, but before that she has to pay Di money to get the work license. She can&apos;t work in that city if she doesn&apos;t get the license but she can go through the city without license. In each chosen city, PP can only earn money and get license once. In other cities, she will not earn or pay money so that you can consider Ci=Di=0. Please help her make a plan to visit all chosen cities and get license in all of them under all rules above.<br>&#x3000;&#x3000;PP lives in city 1, and she will start her journey from city 1. and end her journey at city 1 too.<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"&#x3000;&#x3000;The first line of input consists of one integer T which means T cases will follow.<br>&#x3000;&#x3000;Then follows T cases, each of which begins with three integers: the number of cities N (N &lt;= 100) , number of roads M (M &lt;= 5000) and her initiative money Money (Money &lt;= 10^5) .<br>&#x3000;&#x3000;Then follows M lines. Each contains three integers u, v, w, which means there is a road between city u and city v and the cost is w. u and v are between 1 and N (inclusive), w &lt;= 10^5.<br>&#x3000;&#x3000;Then follows a integer H (H &lt;= 15) , which is the number of chosen cities.<br>&#x3000;&#x3000;Then follows H lines. Each contains three integers Num, Ci, Di, which means the i_th chosen city number and Ci, Di described above.(Ci, Di &lt;= 10^5)<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"&#x3000;&#x3000;If PP can visit all chosen cities and get all licenses, output &quot;YES&quot;, otherwise output &quot;NO&quot;.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n4 5 10\n1 2 1\n2 3 2\n1 3 2\n1 4 1\n3 4 2\n3\n1 8 5\n2 5 2\n3 10 1\n2 1 100\n1 2 10000\n1\n2 100000 1</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">YES\nNO</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2012+ACM%2FICPC+Asia+Regional+Tianjin+Online&amp;source=1&amp;searchmode=source\"> 2012 ACM/ICPC Asia Regional Tianjin Online </a> ","type":"source","format":"html","require":["katex"]}]}