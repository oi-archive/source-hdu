{"title":"GCDispower","time_limit":5000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6102","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6102&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6102","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6102"},"statement":[{"title":"Problem Description","content":"There is a mysterious organization called GCD. They get a permutation P, permutation is a sequence of length N, only consists of number 1 to N and each number appears only once.<br>They want to gain magic power from this permutation. For the interval [L, R] they can get power:<br>$\\sum\\limits_{i=L}^R\\sum\\limits_{j=i+1}^R\\sum\\limits_{k=j+1}^R (gcd(P[i], P[j]) == P[k]) \\cdot P[k]$<br>Now they have M queries, for each query can you help them calculate how many power they can get&#xFF1F;<br>","type":"description","format":"html"},{"title":"Input","content":"The first line is an integer T which indicates the case number.<br>And as for each case, first line is two integer N and M which indicates the length of permutation and number of query.<br>Next line is N integer which indicate the permutation P<br>Next M line, for each line is two integer L and R which indicate each query.<br><br>Limit<br>$1 \\leq T \\leq 100$<br>$1 \\leq N, M \\leq100000$<br>$1 \\leq Pi \\leq N$, for any pair $(i, j)$, $Pi \\neq Pj$<br>$1 \\leq Li \\leq Ri \\leq N$<br><br>About 95% test case: $1 \\leq N \\leq 1000$<br>Other test case: $1 \\leq N \\leq 100000$<br>","type":"input_format","format":"html"},{"title":"Output","content":"As for each case, you need to output M integer which indicate the answer of each query.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n3 1\n3 2 1\n1 3\n6 3\n6 5 4 3 2 1\n1 6\n2 6\n3 5</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n8\n5\n0</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2017+Multi-University+Training+Contest+-+Team+6&amp;source=1&amp;searchmode=source\"> 2017 Multi-University Training Contest - Team 6 </a> ","type":"source","format":"html"}]}