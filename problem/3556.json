{"title":"Continued Fraction","time_limit":1000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3556","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3556&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3556","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3556"},"statement":[{"title":"Problem Description","content":"Dumbear loves numbers very much.<br>One day Dumbear found that each number can be expressed as a continued fraction. See below.<br><img style=\"max-width:100%;\" src=\"../../data/images/C300-1003-1.jpg\"><br>Formally, we say a number k can be expressed as a continued faction if<br><img style=\"max-width:100%;\" src=\"../../data/images/C300-1003-2.jpg\"><br>where a<sub>0</sub>, a<sub>1</sub>, &#x2026;, a<sub>n</sub> are positive integers except that a<sub>0</sub> maybe be 0 and a<sub>n</sub> cannot be 1.<br>Dumbear also found a sequence which looks like the Farey sequence. Initially the sequence<img style=\"max-width:100%;\" src=\"../../data/images/C300-1003-3.jpg\">and if we insert an element<img style=\"max-width:100%;\" src=\"../../data/images/C300-1003-4.jpg\">between all the two adjacent element<img style=\"max-width:100%;\" src=\"../../data/images/C300-1003-5.jpg\">,<img style=\"max-width:100%;\" src=\"../../data/images/C300-1003-6.jpg\">in D<sub>i</sub>, then we get a sequence D<sub>i+1</sub>. So you can see<img style=\"max-width:100%;\" src=\"../../data/images/C300-1003-7.jpg\">and<img style=\"max-width:100%;\" src=\"../../data/images/C300-1003-8.jpg\">Assume initially you are on the element<img style=\"max-width:100%;\" src=\"../../data/images/C300-1003-11.jpg\">in D<sub>0</sub>, and if now you are on the element k in D<sub>i</sub>, then if you go left(&#x2018;L&#x2019;)(or right(&#x2018;R&#x2019;)) you will be on the left(or right) element of k in D<sub>i+1</sub>. So a sequence composed of &#x2018;L&#x2019; and &#x2018;R&#x2019; denotes a number. Such as &#x2018;RL&#x2019; denotes the number <img style=\"max-width:100%;\" src=\"../../data/images/C300-1003-9.jpg\"><br><br>Now give you a sequence composed of &#x2018;L&#x2019; and &#x2018;R&#x2019;, you should print the continued fraction form of the number. You should use &#x2018;-&#x2018; to show the vinculum(the horizontal line), you should print one space both in front and back of &#x2018;+&#x2019;, and all parts up or down the vinculum should be right aligned. You should not print unnecessary space, &#x2018;-&#x2018; or other character. See details in sample.<br>","type":"description","format":"html"},{"title":"Input","content":"There are several test cases in the input.<br>For each test case, there is a single line contains only a sequence composed of &#x2018;L&#x2019; and &#x2018;R&#x2019;. The length of the sequence will not exceed 10000.<br>The input terminates by end of file marker.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output the continued fraction form of the number which the input sequence denotes. The total amount of output will not exceed 4MB.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">LR\nRL</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">        1 \n0 + ----- \n        1\n    1 + -\n        2\n    1\n1 + -\n    2</div></pre>","type":"example","format":"html"},{"title":"Author","content":"Dumbear@WHU","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2010+ACM-ICPC+Multi-University+Training+Contest%A3%A812%A3%A9%A1%AA%A1%AAHost+by+WHU&amp;source=1&amp;searchmode=source\"> 2010 ACM-ICPC Multi-University Training Contest&#xFF08;12&#xFF09;&#x2014;&#x2014;Host by WHU </a> ","type":"source","format":"html"}]}