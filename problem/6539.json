{"title":"Neko and sequence","time_limit":1000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6539","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6539&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6539","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6539"},"statement":[{"title":"Problem Description","content":"One day, Inu asked Neko a question:  <br>Give you a sequence with $n$ elements. The index for the first element is $0$, the last is $n-1$.  <br>They are arranged in rings. $0$ and $n-1$ are next to each other.  <br>The $i$-th element has a character $s[i]$ which is &apos;(&apos; or &apos;)&apos;.    <br>Let $f(i, d)$ means the last place to arrive by starting with $i$ and taking $d$ steps.  <br>If you are in $i$-th element now and $s[i] = $&apos;(&apos;, you will arrive $(i-k+n)\\%n$-th element in next step, or you will arrive $(i+k)\\%n$-th element.  <br>And there are $q$ questions.Each question has three integers $l, r, d$. You have to calculate $\\sum_{i = l}^{r} f(i,d)$  <br>","type":"description","format":"html"},{"title":"Input","content":"The first line contains three integers $n, q, k(1 \\leq n, q \\leq 10^{5}, 1 \\leq k &lt; n)$ .<br>The second line contains a sequence, the $i$-th element means $s[i]$ .<br>The next $q$ line, each line contains three integers $l,r,d(0 \\leq l \\leq r &lt; n, 1 \\leq d \\leq 10^{9})$ .  <br>","type":"input_format","format":"html"},{"title":"Output","content":"For each question output the sum in one line.    <br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">6 5 1\n())()(\n0 1 3\n1 3 2\n1 4 3\n2 5 6\n0 3 4</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">7\n8\n12\n14\n12</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2019CCPC%BA%FE%C4%CF%C8%AB%B9%FA%D1%FB%C7%EB%C8%FC%A3%A8%B9%E3%B6%AB%CA%A1%C8%FC%A1%A2%BD%AD%CB%D5%CA%A1%C8%FC%A3%A9%D6%D8%CF%D6%C8%FC&amp;source=1&amp;searchmode=source\"> 2019CCPC&#x6E56;&#x5357;&#x5168;&#x56FD;&#x9080;&#x8BF7;&#x8D5B;&#xFF08;&#x5E7F;&#x4E1C;&#x7701;&#x8D5B;&#x3001;&#x6C5F;&#x82CF;&#x7701;&#x8D5B;&#xFF09;&#x91CD;&#x73B0;&#x8D5B; </a> ","type":"source","format":"html"}]}