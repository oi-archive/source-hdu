{"title":"Jerboas","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=2437","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=2437&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=2437","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=2437"},"statement":[{"title":"Problem Description","content":"&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;Jerboas are small desert-living animals, which resemble mice with a long tufted tail and very long hind legs. Jerboas shelter in well-hidden burrows. They create two types of burrow: temporary and permanent. The temporary burrows are plain tubes while the permanent burrows are sealed with a plug of sand to keep heat out and moisture in. <br><br><center> <img style=\"max-width:100%;\" src=\"../../../data/images/C143-1010-1.jpg\"></center> <br><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;As far as we know, jerboa burrows in the desert are connected with one-way tunnels. What&apos;s more, for some unknown reasons, it&apos;s true that start from any burrow, follows the tunnels you can not go back to the starting burrow.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;Summer means last-minute of offers on good times, so of course jerboas could not stay behind. One day, a little jerboa Alice who lived in a temporary burrow S wants to migrate to a permanent one. There are different routes she can take, but Alice is so odd that she only selects those whose total travel distances is a multiple of K. Among all routes that Alice may select, we are interested in the shortest one. Can you help to find it out?  Of course different routes may lead to different destinations.<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;On the first line of input, there is a single positive integer T &lt;= 20 specifying the number of test cases to follow. <br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;Each test case starts with four integers in the first line: N, M, S, K. <br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;N is the number of burrows in the desert (burrows are numbered with 1, 2, &#x2026;, N); <br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;M is the number of tunnels connecting the burrows; <br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;S is where Alice lived and K is as described above. <br>(0 &lt; N &lt;= 1000, 0 &lt;= M &lt;= 20000, 0 &lt; S &lt;= N, 0 &lt; K &lt;= 1000)<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;The second line contains N characters each could be &#x2018;T&#x2019; or &#x2018;P&#x2019;. The i-th character specifying the type of the burrow i. &#x2018;T&#x2019; means temporary burrow, &#x2018;P&#x2019; means permanent burrow. It&#x2019;s guaranteed that the S-th character is &#x2018;T&#x2019;.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;Next follow M lines, each line with 3 integers A, B, C. Specifying that there is a tunnel from burrow A to burrow B, and its length is C. <br>(0 &lt; A, B &lt;= N, A != B, 0 &lt; C &lt; 40000)<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;For each test case you should output a single line containing &quot;Case X: Y Z&quot; (quotes for clarity) where X is the number of the test case (starting at 1) and Y is the length of the shortest route Alice can select and Z is the destination of the selected route.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;Notice that burrow Z should be a permanent burrow.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;In case there&#x2019;s more than one solution, Z should be the minimum. <br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;In case there&apos;s no solution, Y and Z should be both equal to -1.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n5 5 1 7\nTPPTP\n1 2 8\n1 4 7\n4 3 9\n2 3 6\n1 5 3\n5 5 1 7\nTPTTP\n1 2 8\n1 4 7\n4 3 9\n2 3 6\n1 5 3</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1: 14 3\nCase 2: -1 -1</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2008+Asia+Chengdu+Regional+Contest+Online&amp;source=1&amp;searchmode=source\"> 2008 Asia Chengdu Regional Contest Online </a> ","type":"source","format":"html","require":["katex"]}]}