{"title":"Random Function","time_limit":4000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3965","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3965&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3965","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3965"},"statement":[{"title":"Problem Description","content":"Cover is an admin of HOJ, MUT is coming and he needs to generate passwords for every team of MUT. Thus he needs a pesudo-random number generator.<br><br>As we know, random numbers are usually gernerated by a random number table and a random seed. The random table is an large array. Using random seed to calculate a subscript, we can use the corresponding number in the talbe as a pesudo-random number.<br><br>But Cover is a geek and he won&apos;t do this as others did. He uses a circle array of length N as random table and three numbers ( a, b, c) as random seed. The random nubmer is defined as the product of table[a], table[(a+b-1)%N+1], table[(a+2b-1)%N+1] ... table[c] ( see Sample Input for more details). Of course this product P may be too large, so Cover use P % 1000000007 as the result.<br><br>Now it&apos;s your task, given the table and a query( a, b, c), help Cover find out the pesudo-random number. ","type":"description","format":"html"},{"title":"Input","content":"Multiple test cases, at most 20. Process to the end of the file.<br><br>The first line of input contains three numbers, N, Q, (1 &#x2264; N &#x2264; 50000, 1 &#x2264; Q &#x2264; 50000) descripting the length of the circle array, the number of queries, and M mentioned above. The second line contains N positive integers less than 10^9, denotes the (1..N)th numbers of the circle array. Then comes Q lines, each line contains three number, means a query of a, b, c ( 1 &#x2264; a, b, c &#x2264; N). It&apos;s guaranteed that there&apos;s an interger i makes c = a + b * i or c + N = a + b * i; ","type":"input_format","format":"html"},{"title":"Output","content":"Print Q lines for each test case, one number per line, which is the pesudo-random number. ","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">6 5\n1 2 3 4 5 6\n1 1 6\n1 3 1\n1 3 4\n2 4 6\n3 5 2</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">720\n1\n4\n12\n6</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2011+Multi-University+Training+Contest+13+-+Host+by+HIT+&amp;source=1&amp;searchmode=source\"> 2011 Multi-University Training Contest 13 - Host by HIT  </a> ","type":"source","format":"html"}]}