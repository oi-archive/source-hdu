{"title":"Matrix","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4313","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4313&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4313","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4313"},"statement":[{"title":"Problem Description","content":"Machines have once again attacked the kingdom of Xions. The kingdom of Xions has N cities and N-1 bidirectional roads. The road network is such that there is a<br>unique path between any pair of cities.<br><br>Morpheus has the news that K Machines are planning to destroy the whole kingdom. These Machines are initially living in K different cities of the kingdom and<br>anytime from now they can plan and launch an attack. So he has asked Neo to destroy some of the roads to disrupt the connection among Machines. i.e after destroying those roads there should not be any path between any two Machines.<br><br>Since the attack can be at any time from now, Neo has to do this task as fast as possible. Each road in the kingdom takes certain time to get destroyed and they<br>can be destroyed only one at a time. <br><br>You need to write a program that tells Neo the minimum amount of time he will require to disrupt the connection among machines.<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line is an integer T represents there are T test cases. (0&lt;T &lt;=10)<br>For each test case the first line input contains two, space-separated integers, N and K. Cities are numbered 0 to N-1. Then follow N-1 lines, each containing three, space-separated integers, x y z, which means there is a bidirectional road connecting city x and city y, and to destroy this road it takes z units of time.Then follow K lines each containing an integer. The ith integer is the id of city in which ith Machine is currently located.<br>2 &lt;= N &lt;= 100,000<br>2 &lt;= K &lt;= N<br>1 &lt;= time to destroy a road &lt;= 1000,000<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case print the minimum time required to disrupt the connection among Machines.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n5 3\n2 1 8\n1 0 5\n2 4 5\n1 3 4\n2\n4\n0</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">10\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nNeo can destroy the road connecting city 2 and city 4 of weight 5 , and the road connecting city 0 and city 1 of weight 5. As only one road can be destroyed at a\ntime, the total minimum time taken is 10 units of time. After destroying these roads none of the Machines can reach other Machine via any path.\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Author","content":"TJU","type":"source","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2012+Multi-University+Training+Contest+2&amp;source=1&amp;searchmode=source\"> 2012 Multi-University Training Contest 2 </a> ","type":"source","format":"html","require":["katex"]}]}