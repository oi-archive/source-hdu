{"title":"Walk Through Squares","time_limit":2000,"memory_limit":63.9990234375,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4758","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4758&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4758","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4758"},"statement":[{"title":"Problem Description","content":"<center><img style=\"max-width:100%;\" src=\"../../data/images/C479-1011-1.jpg\"></center> <br>&#xA0;&#xA0;On the beaming day of 60th anniversary of NJUST, as a military college which was Second Artillery Academy of Harbin Military Engineering Institute before, queue phalanx is a special landscape.<br>&#xA0;&#xA0;<br>&#xA0;&#xA0;Here is a M*N rectangle, and this one can be divided into M*N squares which are of the same size. As shown in the figure below:<br>&#xA0;&#xA0;01--02--03--04<br>&#xA0;&#xA0;||  ||  ||  ||<br>&#xA0;&#xA0;05--06--07--08<br>&#xA0;&#xA0;||  ||  ||  ||<br>&#xA0;&#xA0;09--10--11--12<br>&#xA0;&#xA0;Consequently, we have (M+1)*(N+1) nodes, which are all connected to their adjacent nodes. And actual queue phalanx will go along the edges.<br>&#xA0;&#xA0;The ID of the first node,the one in top-left corner,is 1. And the ID increases line by line first ,and then by column in turn ,as shown in the figure above.<br>&#xA0;&#xA0;For every node,there are two viable paths:<br>&#xA0;&#xA0;(1)go downward, indicated by &apos;D&apos;;<br>&#xA0;&#xA0;(2)go right, indicated by &apos;R&apos;;<br>&#xA0;&#xA0;The current mission is that, each queue phalanx has to walk from the left-top node No.1 to the right-bottom node whose id is (M+1)*(N+1).<br>    In order to make a more aesthetic marching, each queue phalanx has to conduct two necessary actions. Let&apos;s define the action:<br>&#xA0;&#xA0;An action is started from a node to go for a specified travel mode.<br>&#xA0;&#xA0;So, two actions must show up in the way from 1 to (M+1)*(N+1).<br><br>&#xA0;&#xA0;For example, as to a 3*2 rectangle, figure below:<br>&#xA0;&#xA0;&#xA0;&#xA0;01--02--03--04<br>&#xA0;&#xA0;&#xA0;&#xA0;||  ||  ||  ||<br>&#xA0;&#xA0;&#xA0;&#xA0;05--06--07--08<br>&#xA0;&#xA0;&#xA0;&#xA0;||  ||  ||  ||<br>&#xA0;&#xA0;&#xA0;&#xA0;09--10--11--12<br>&#xA0;&#xA0;Assume that the two actions are (1)RRD  (2)DDR<br><br>&#xA0;&#xA0;As a result , there is only one way : RRDDR. Briefly, you can not find another sequence containing these two strings at the same time.<br>&#xA0;&#xA0;If given the N, M and two actions, can you calculate the total ways of walking from node No.1 to the right-bottom node ?","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"&#xA0;&#xA0;The first line contains a number T,(T is about 100, including 90 small test cases and 10 large ones) denoting the number of the test cases.<br>&#xA0;&#xA0;For each test cases,the first line contains two positive integers M and N(For large test cases,1&lt;=M,N&lt;=100, and for small ones 1&lt;=M,N&lt;=40). M denotes the row number and N denotes the column number.<br>&#xA0;&#xA0;The next two lines each contains a string which contains only &apos;R&apos; and &apos;D&apos;. The length of string will not exceed 100. We ensure there are no empty strings and the two strings are different.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"&#xA0;&#xA0;For each test cases,print the answer MOD 1000000007 in one line.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n3 2\nRRD\nDDR\n3 2\nR\nD</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n10</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2013+ACM%2FICPC+Asia+Regional+Nanjing+Online&amp;source=1&amp;searchmode=source\"> 2013 ACM/ICPC Asia Regional Nanjing Online </a> ","type":"source","format":"html","require":["katex"]}]}