{"title":"Tom and game","time_limit":3000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5227","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5227&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5227","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5227"},"statement":[{"title":"Problem Description","content":"Tom love to play games with Tony.<br><br>They think a orderly tetrad (t,i,j,k) is valid, when it satisfy,<br><br>1. $1\\leq i,j,k\\leq t$<br><br>2. Exist a positive integer s, which can divide both i and j, and is not smaller than k.<br><br>They prepare some tetrads, take turns to operate. When one can&apos;t operate, he loses. A valid operate is,<br><br>1. Choose a tetrad.<br><br>2. Change it to another valid tetrad which is smaller than it on dictionary order.<br><br>When compare two tetrads, compare the first element. If equal, compare the second element, and so on.<br><br>They think that prepare tetrads every time they want to play is troublesome. So they paint a tree, there is a tetrad on each point. When they want to play, Tom random choose a point P, Tony random choose a point Q. Then they copy down tetrads on points which are on the route connect P and Q (include P and Q), start the game.<br><br>Tom always operate first, he wants to know the probability of he wins.","type":"description","format":"html"},{"title":"Input","content":"Multi test cases(about 8). For each case, the first line contains a positive integer n, indicates the number of points in the tree. In the next n-1 lines, each line contains two integers i and j, indicates there is an edge connect point i and point j. In the next n lines, the i-th line contains four integers, a&#x3001;b&#x3001;c&#x3001;d, indicates the orderly tetrad on point i is (a,b,c,d).<br><br>$1\\leq n\\leq 10000;1\\leq i,j\\leq n;1\\leq a,b,c,d\\leq 10000$<br><br>It&apos;s assured that the tetrad on each point is valid.","type":"input_format","format":"html"},{"title":"Output","content":"For each case, output a fraction &quot;x/y&quot;, indicates the probability of Tom wins, x and y should be co-prime. If Tom is bound to fail, output &quot;0/1&quot;.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n1 2\n1 1 1 1\n2 1 2 1\n5\n1 2\n2 3\n3 4\n4 5\n1 1 1 1\n2 1 1 1\n2 1 2 1\n2 2 1 1\n1 1 1 1</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3/4\n3/5</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=BestCoder+Round+%2340&amp;source=1&amp;searchmode=source\"> BestCoder Round #40 </a> ","type":"source","format":"html"}]}