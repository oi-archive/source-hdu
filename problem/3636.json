{"title":"Escape from Zirong forest","time_limit":10000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3636","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3636&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3636","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3636"},"statement":[{"title":"Problem Description","content":"Now SuSu and his companions arrived at Xiangling&apos;s hometown - ZiRong Forest. To drive SuSu out of these area, &quot;Piaorou Bro&quot; Lingduan set the forest on fire. To prevent the trees from burning down, SuSu must find the exit of the forest as quickly as possible and kill Lingduan. If he could not kill Lingduan in TIME seconds, the forest will suffer too much damage to be recovered. What was worse, there are some horrible monsters in the forest. SuSu would suffer a certain damage when he kill a monster on his way to the exit. For the purpose of save energy and to kill Lingduan more easily, the damage SuSu suffer from the monsters should be the fewer the better. Please help SuSu to find a reasonable path which can lead him to the exit in TIME seconds, and suffers the minimum damage at the same time.<br><center><img style=\"max-width:100%;\" src=\"../../../data/images/C308_1005_1.png\"></center><br>To represents the ZiRong forest, we use a n * m maze:<br>&apos;S&apos; and &apos;L&apos; represents the position of SuSu and Lingduan at the very beginning. Each of them appears in the maze once and only once.<br>&apos;F&apos; represents fire where SuSu can not step into.<br>A number (from 0 to 9) indicates there is one monster in this grid ,and it&apos;s attack is the corresponding number.<br><br>Every second SuSu can choose a direction and go forward 1 ~ K steps, and for all monsters&apos; attack in the grids he passed by(if the grid do exist a monster), we accumulate them and get a sum. The damage SuSu will suffer is the square of this sum.","type":"description","format":"html"},{"title":"Input","content":"The first line of input should give the number of cases, T(1&lt;=T&lt;=50).<br>The first line of each case are four numbers N, M, TIME, K. (2 &lt;= N, M &lt;= 100, 1 &lt;= TIME, K &lt;= 100)<br>Followed by N lines each with M characters, described the ZiRong forest.","type":"input_format","format":"html"},{"title":"Output","content":"If SuSu can reach the position &quot;Piaorou Bro&quot; stands in time, output the minimum damage.<br>Otherwise output &quot;&#x80DC;&#x8D25;&#x5175;&#x5BB6;&#x4E8B;&#x4E0D;&#x671F; &#x5377;&#x571F;&#x91CD;&#x6765;&#x662F;&#x5927;&#x4FA0;&quot;.<br>Following the case number (start with 1).","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5\n3 3 2 2\nS19\n111\nF1L\n3 3 3 2\nS19\n111\nF1L\n5 4 5 1\nS111\n9FF1\n9FF1\n9111\nFFLF\n5 4 4 100\nS111\n9FF1\n9FF1\n9111\nFFLF\n5 4 100 1\nS111\n9FF1\n9FF1\n9111\nFFLF</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1: 101\nCase 2: 5\nCase 3: &#x80DC;&#x8D25;&#x5175;&#x5BB6;&#x4E8B;&#x4E0D;&#x671F; &#x5377;&#x571F;&#x91CD;&#x6765;&#x662F;&#x5927;&#x4FA0;\nCase 4: 19\nCase 5: 7</div></pre>","type":"example","format":"html"},{"title":"Author","content":"NotOnlySuccess","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2010+ACM-ICPC+Multi-University+Training+Contest%A3%A819%A3%A9%A1%AA%A1%AAHost+by+HDU&amp;source=1&amp;searchmode=source\"> 2010 ACM-ICPC Multi-University Training Contest&#xFF08;19&#xFF09;&#x2014;&#x2014;Host by HDU </a> ","type":"source","format":"html"}]}