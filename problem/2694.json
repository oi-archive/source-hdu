{"title":"Cipher ","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=2694","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=2694&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=2694","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=2694"},"statement":[{"title":"Problem Description","content":"The Playfair cipher or Playfair square is a manual symmetric encryption technique and was the first literal digraph  <br>substitution cipher. The technique encrypts pairs of letters (digraphs), instead of single letters as in the simple  <br>substitution cipher and rather more complex Vigen&#xE8;re cipher systems then in use. The Playfair is thus significantly harder  <br>to break since the frequency analysis used for simple substitution ciphers does not work with it. Frequency analysis can still  <br>be undertaken, but on the 600 possible digraphs rather than the 26 possible monographs. The frequency analysis of digraphs  <br>is possible, but considerably more difficult and it generally requires a much larger ciphertext in order to be useful. <br><br>Despite its invention by Wheatstone, it became known as the Playfair cipher after Lord Playfair, who heavily promoted its  <br>use. The first recorded description of the Playfair cipher was in a document signed by Wheatstone on 26 March 1854.It was  <br>used for tactical purposes by British forces in the Second Boer War and in World War I and for the same purpose by the  <br>Australians and Germans during World War II. This was because Playfair is reasonably fast to use and requires no special  <br>equipment. A typical scenario for Playfair use would be to protect important but non-critical secrets during actual combat. <br> By the time the enemy cryptanalysts could break the message, the information was useless to them. <br><br>However Playfair is no longer used by military forces because of the advent of digital encryption devices. Playfair is now  <br>regarded as insecure for any purpose because modern hand-held computers could easily break the cipher within seconds. <br><br>The Playfair cipher uses a 5 by 5 table containing a keyword or phrase. Memorization of the keyword and some simple  <br>rules was all that was required to create the 5 by 5 table and use the cipher. <br>To generate the key table, one would first  <br>fill in the spaces in the table with the letters of the keyword (dropping any duplicate letters), then fill the remaining  <br>spaces with the rest of the letters of the alphabet in order (combine &apos;I&apos; and &apos;J&apos; to reduce the alphabet to fit). <br><br>To encrypt a message, one would change the lowercase to uppercase, break the message into digraphs (groups of 2 letters  <br>and throw away spaces) such that, for example, &quot;Hello World&quot; becomes &quot;HE LL OW OR LD&quot;, and map them out on the key table.  <br>The two letters of the digraph look like the corners of a rectangle in the key  <br>table. Note the relative position of the corners of this rectangle. Then apply the following rules, in order, to each pair  <br>of letters in the plaintext: <br>If both letters are the same (or only one letter is left), add an &apos;X&apos; after the first letter. Encrypt the new pair and continue. <br><br>If the letters appear on the same row of your table, replace them with the letters to their immediate right respectively  <br>(wrapping around to the left side of the row if a letter in the original pair was on the right side of the row). <br><br>If the letters appear on the same column of your table, replace them with the letters immediately below respectively  <br>(wrapping around to the top side of the column if a letter in the original pair was on the bottom side of the column). <br><br>If the letters are not on the same row or column, replace them with the letters on the same row respectively but at the <br> other pair of corners of the rectangle defined by the original pair. <br>The order is important-the first encrypted letter of the pair is the one that lies on the same row as the first plaintext letter. <br>","type":"description","format":"html"},{"title":"Input","content":"The input consists of multiple test cases. The first line of input contains an integer T, which is the number of test cases. <br>Each test case containing two lines: the key and the message. <br>The length of the key and the message will  <br>not exceed 500. <br>You may assume that the message does not contain substring such as &quot;XX&quot;, &quot;IJ&quot; , &quot;JI&quot;, and does not end with &quot;X&quot;. ","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, print one line containing the encrypted message. <br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\nCharles \nMeet me at the Hammersmith Bridge tonight \nDeath \nLaboulaye Lady \nto go to jail together \nto stand up for freedom together </div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">GDVBYTBCQYPRSCRKYKDCDIMPASHMEMDOUGKIRP \nMEIKQOTXCQTEZY \nOGNITUMPQDIEKHHWDPADOGOHGLHB \n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>Hint1. \nUsing &quot;Death&quot; as the key, the table becomes: \nD E A T H \nB C F G I / J \nK L M N O \nP Q R S U \nV W X Y Z \n\nNOTE that &apos;J&apos; is in same place with &apos;I&apos;! \n\nEncrypting the message &quot;Laboulaye Lady&quot;: \nLA BO UL AY EL AD YX \n\nThe pair LA forms a rectangle, replace it with ME. \nThe pair BO forms a rectangle, replace it with IK. \nThe pair UL forms a rectangle, replace it with QO. \nThe pair AY forms a rectangle, replace it with TX. \nThe pair EL in a column, replace it with CQ. \nThe pair AD in a row, replace it with TE. \nThe pair YX in a row, replace it with ZY. \n\nME IK QO TX CQ TE ZY \nThus the message becomes &quot;MEIKQOTXCQTEZY&quot;. \n2. \nAssume one wants to encrypt the digraph OR. There are three general cases: \n1)                   2)                   3) \n* * * * *            * * O * *            Z * * O * \n* O Y R Z            * * B * *            * * * * * \n* * * * *            * * * * *            * * * * * \n* * * * *            * * R * *            R * * X * \n* * * * *            * * Y * *            * * * * * \nHence, OR -&gt; YZ      Hence, OR -&gt; BY      Hence, OR -&gt; ZX</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=The+4th+Baidu+Cup+Central+China+Invitational+Programming+Contest&amp;source=1&amp;searchmode=source\"> The 4th Baidu Cup Central China Invitational Programming Contest </a> ","type":"source","format":"html"}]}