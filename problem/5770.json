{"title":"Treasure ","time_limit":4000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5770","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5770&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5770","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5770"},"statement":[{"title":"Problem Description","content":"?? has got a treasure map,the treasure map consists of N nodes,there are N-1 bidirectional roads, Each of them connects a pair of nodes,the N nodes are all connected by the N-1 bidirectional roads.?? can travel through the roads.<br>There are M treasures in some node. Each treasure has a value, treasures are put into boxs,each treasure corresponds to a box and each box corresponds to a key which is also in some node. Now ?? wants to plan a simple path, the path&#x2019;s start point is node A,and the path&#x2019;s destination is node B,?? will go from node A to node B. When ?? goes through a node(including node A and node B), he must first collects all keys, and then must open the boxes he can open in this node. The keys he got never disappear during the travel. Now ?? wants to know the maximum value he could get if he plan a best path.Can you help him? <br><br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line of the input gives the number of case T,T test cases follow.<br>Each case first line contains two integer n,m(n,m&lt;=100000)indicating the number of nodes and the number of treasures.<br>Next n-1 lines each line contains two numbers ui and vi(1&lt;=ui,vi&lt;=n) indicates that there&#x2019;s one road connecting node ui node vi.<br>Next m lines each line contains three number ui,vi,wi(1&lt;=ui,vi&lt;=n,-1000&lt;=wi&lt;=1000) indicates the position of ith-box&#x2019;s key and the position of ith-box, and the value of treasure in the ith-box.<br><br>T&lt;=30<br>The sum of n in all the test cases is no more than 600000<br>The sum of m in all the test cases is no more than 600000<br><br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each that case output&#x201D;Case #x: y&#x201D;,where x is the test case number(starting from 1),and y is the answer you get for that case.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n4 2\n1 2\n2 3\n3 4\n1 1 100\n2 4 -5\n4 3\n1 2\n1 3\n1 4\n2 1 1\n1 3 2\n1 3 5</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1: 100\nCase #2: 8</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Author","content":"FZU","type":"source","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2016+Multi-University+Training+Contest+4&amp;source=1&amp;searchmode=source\"> 2016 Multi-University Training Contest 4 </a> ","type":"source","format":"html","require":["katex"]}]}