{"title":"Bribery","time_limit":4000,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5368","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5368&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5368","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5368"},"statement":[{"title":"Problem Description","content":"ZJiaQ is a solider. In his army,every solider have a boss who is also a solider . Now, AFA want to bribe some solider to attack ZJiaQ .Every solider have a ID, and evry day ,they will get a new ID.ZJiaQ want to avoid been attacked. The only way is that he bribe the boss of the solider or the boss of the boss of the solider or...<br>Once he bribe a boss ,the boss can stop one solider who is branch of him.In this army,everybody only can send money to his boss,if ZJiaQ want to send money to the boss of his boss.The money should pass through his boss and his boss will get 1 coin.<br>Now ZJiaQ want to know how much will he cost.<br>","type":"description","format":"html"},{"title":"Input","content":"There are multiply test case . For each case , first line contains a integer n (3 &lt; = n &lt; = 40000) the number of node is from 0 to n-1. next line contains n integers a0,a2&#xFFFD;&#xFFFD;an-1 ( 1&lt;= ai &lt;= 100000 ) . Ai is the money of bribery for the solider whose ID is i . next line contains n-1 integers f1, f2 &#xFFFD;&#xFFFD;fn-1 ( 0 &lt;= fi &lt; n ) . fi is the boss of solider i. next line contains a integer m (1&lt;= m&lt;=40000). Next q lines contain 3 integers l ,r ,p (0 &lt; l &lt; = r &lt; n,p &lt; l or p&gt;r),l,r means that AFA bribe soliders whose Id are between l and r.p is ZJiaQ&apos;s ID Now.","type":"input_format","format":"html"},{"title":"Output","content":"Output the Ans mod 10000007 of each query.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n2 2 2\n0 0\n2\n1 1 2\n2 2 1\n\n\n10\n52 30 56 13 98 53 75 80 7 34\n3 0 0 3 2 2 9 1 0\n5\n2 9 1\n5 5 8\n2 2 1\n2 6 7\n2 7 1</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n2\n\n\n331\n54\n53\n265\n278</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=BestCoder+Round+%2350+%28div.1%29+%28%24%29&amp;source=1&amp;searchmode=source\"> BestCoder Round #50 (div.1) ($) </a> ","type":"source","format":"html"}]}