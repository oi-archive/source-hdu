{"title":"Island Transport","time_limit":10000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4280","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4280&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4280","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4280"},"statement":[{"title":"Problem Description","content":"&#x3000;&#x3000;In the vast waters far far away, there are many islands. People are living on the islands, and all the transport among the islands relies on the ships.<br>&#x3000;&#x3000;You have a transportation company there. Some routes are opened for passengers. Each route is a straight line connecting two different islands, and it is bidirectional. Within an hour, a route can transport a certain number of passengers in one direction. For safety, no two routes are cross or overlap and no routes will pass an island except the departing island and the arriving island. Each island can be treated as a point on the XY plane coordinate system. X coordinate increase from west to east, and Y coordinate increase from south to north.<br>&#x3000;&#x3000;The transport capacity is important to you. Suppose many passengers depart from the westernmost island and would like to arrive at the easternmost island, the maximum number of passengers arrive at the latter within every hour is the transport capacity. Please calculate it.<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"&#x3000;&#x3000;The first line contains one integer T (1&lt;=T&lt;=20), the number of test cases.<br>&#x3000;&#x3000;Then T test cases follow. The first line of each test case contains two integers N and M (2&lt;=N,M&lt;=100000), the number of islands and the number of routes. Islands are number from 1 to N.<br>&#x3000;&#x3000;Then N lines follow. Each line contain two integers, the X and Y coordinate of an island. The K-th line in the N lines describes the island K. The absolute values of all the coordinates are no more than 100000.<br>&#x3000;&#x3000;Then M lines follow. Each line contains three integers I1, I2 (1&lt;=I1,I2&lt;=N) and C (1&lt;=C&lt;=10000) . It means there is a route connecting island I1 and island I2, and it can transport C passengers in one direction within an hour.<br>&#x3000;&#x3000;It is guaranteed that the routes obey the rules described above. There is only one island is westernmost and only one island is easternmost. No two islands would have the same coordinates. Each island can go to any other island by the routes.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"&#x3000;&#x3000;For each test case, output an integer in one line, the transport capacity.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n5 7\n3 3\n3 0\n3 1\n0 0\n4 5\n1 3 3\n2 3 4\n2 4 3\n1 5 6\n4 5 3\n1 4 4\n3 4 2\n6 7\n-1 -1\n0 1\n0 2\n1 0\n1 1\n2 3\n1 2 1\n2 3 6\n4 5 5\n5 6 3\n1 4 6\n2 5 5\n3 6 4</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">9\n6</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2012+ACM%2FICPC+Asia+Regional+Tianjin+Online&amp;source=1&amp;searchmode=source\"> 2012 ACM/ICPC Asia Regional Tianjin Online </a> ","type":"source","format":"html","require":["katex"]}]}