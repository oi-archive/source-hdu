{"title":"SNIBB","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3271","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3271&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3271","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3271"},"statement":[{"title":"Problem Description","content":"&#xA0;&#xA0;As we know, some numbers have interesting property. For example, any even number has the property that could be divided by 2. However, this is too simple. <br>&#xA0;&#xA0;One day our small HH finds some more interesting property of some numbers. He names it the &#xFFFD;&#xFFFD;Special Numbers In Base B&#xFFFD;&#xFFFD; (SNIBB). Small HH is very good at math, so he considers the numbers in Base B. In Base B, we could express any decimal numbers. Let&#xFFFD;&#xFFFD;s define an expression which describe a number&#xFFFD;&#xFFFD;s &#xFFFD;&#xFFFD;SNIBB value&#xFFFD;&#xFFFD;.(Note that all the &#xFFFD;&#xFFFD;SNIBB value&#xFFFD;&#xFFFD; is in Base 10)<br>&#xA0;&#xA0; <center><img style=\"max-width:100%;\" src=\"../../../data/images/C217-1002.png\"></center><br>&#xA0;&#xA0;&#xA0;&#xA0;Here N is a non-negative integer; B is the value of Base.<br>&#xA0;&#xA0;For example, the &#xFFFD;&#xFFFD;SNIBB value&#xFFFD;&#xFFFD; of &#xFFFD;&#xFFFD;1023&#xFFFD;&#xFFFD; in Base &#xFFFD;&#xFFFD;2&#xFFFD;&#xFFFD; is exactly:10<br>(As we know (1111111111)2=(1023)(10))<br>&#xA0;&#xA0;Now it is not so difficult to calculate the &#xFFFD;&#xFFFD;SNIBB value&#xFFFD;&#xFFFD; of the given N and B.<br>But small HH thinks that must be tedious if we just calculate it. So small HH give us some challenge. He would like to tell you B, the &#xFFFD;&#xFFFD;SNIBB value&#xFFFD;&#xFFFD; of N , and he wants you to do two kinds of operation:<br>1.&#xA0;&#xA0;What is the number of numbers (whose &#xFFFD;&#xFFFD;SNIBB value&#xFFFD;&#xFFFD; is exactly M) in the range [A,B];<br>2.&#xA0;&#xA0;What it the k-th number whose &#xFFFD;&#xFFFD;SNIBB value&#xFFFD;&#xFFFD; is exactly M in the range [A,B]; (note that the first one is 1-th but not 0-th)<br><br>Here M is given.","type":"description","format":"html"},{"title":"Input","content":"&#xA0;&#xA0;There are no more than 30 cases.<br>&#xA0;&#xA0;For each case, there is one integer Q,which indicates the mode of operation;<br>&#xA0;&#xA0;If Q=1 then follows four integers X,Y,B,M, indicating the number is between X and Y, the value of base and the &#xFFFD;&#xFFFD;SNIBB value&#xFFFD;&#xFFFD;.<br>(0&lt;=X,Y&lt;=2000000000,2&lt;=B&lt;=64,0&lt;=M&lt;=300)<br>&#xA0;&#xA0;If Q=2 then follows five integers X,Y,B,M,K, the first four integer has the same meaning as above, K indicates small HH want to know the k-th number whose &#xFFFD;&#xFFFD;SNIBB value&#xFFFD;&#xFFFD; is exactly M.<br>(1&lt;=K&lt;=1000000000)","type":"input_format","format":"html"},{"title":"Output","content":"&#xA0;&#xA0;Output contains two lines for each cases.<br>&#xA0;&#xA0;The first line is the case number, the format is exactly &#xFFFD;&#xFFFD;Case x:&#xFFFD;&#xFFFD;, here x stands for the case index (start from 1.).<br>&#xA0;&#xA0;Then follows the answer.<br>&#xA0;&#xA0;If Q=2 and there is no such number in the range, just output &#xFFFD;&#xFFFD;Could not find the Number!&#xFFFD;&#xFFFD; (without quote!) in a single line.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1 0 10 10 3\n2 0 10 10 1 2\n1 0 10 2 1</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1:\n1\nCase 2:\n10\nCase 3:\n4\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nIn case 1, the number in the range [0,10] whose &#xFFFD;&#xFFFD;SNIBB value&#xFFFD;&#xFFFD; is exactly 3 is 3(in Base 10);\nIn case 2, the numbers in the range [0,10] whose &#xFFFD;&#xFFFD;SNIBB value&#xFFFD;&#xFFFD; is exactly 1 are 1 and 10; Of course the 2-th number is 10.\nIn case 3, the number in the range [0,10] whose &#xFFFD;&#xFFFD;SNIBB value&#xFFFD;&#xFFFD; is exactly 1 is 1,10,100,1000(in Base 2);\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Author","content":"AekdyCoin","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=HDOJ+Monthly+Contest+%A8C+2010.01.02&amp;source=1&amp;searchmode=source\"> HDOJ Monthly Contest &#xFFFD;C 2010.01.02 </a> ","type":"source","format":"html"}]}