{"title":"Instrusive","time_limit":1500,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5040","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5040&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5040","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5040"},"statement":[{"title":"Problem Description","content":"   The legendary mercenary Solid Matt gets a classic mission: infiltrate a military base.<br><br>   The military base can be seen as an N * N grid. Matt&apos;s target is in one of the grids and Matt is now in another grid.<br><br>   In normal case, Matt can move from a grid to one of the four neighbor grids in a second. But this mission is not easy.<br><br>   Around the military base there are fences, Matt can&apos;t get out of the base.<br><br>   There are some grids filled with obstacles and Matt can&apos;t move into these grids.<br><br>   There are also some surveillance cameras in the grids. Every camera is facing one of the four direction at first, but for every second, they will rotate 90 degree clockwisely. Every camera&apos;s sight range is 2, which means that if Matt is in the same grid as the camera, or in the grid that the camera is facing, he will be seen immediately and the mission will fail.<br><br>   Matt has a special equipment to sneak: a cardbox. Matt can hide himself in the card box and move without being noticed. But In this situation, Matt will have to use 3 seconds to move 1 grid. Matt can also just hide in the cardbox without moving. The time to hide and the time to get out of the cardbox can be ignored.<br><br>   Matt can&apos;t take the risk of being noticed, so he can&apos;t move without cardbox into a grid which is now insight of cameras or from a grid which is now insight of cameras. What&apos;s more, Matt may be in the cardbox at the beginning.<br><br>   As a live legend, Matt wants to complete the mission in the shortest time.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"   The first line of the input contains an integer T, denoting the number of testcases. Then T test cases follow.<br><br>   For each test cases, the first line contains one integer:N(1&lt;=N&lt;=500)<br><br>   In the following N lines, each line contains N characters, indicating the grids.<br><br>   There will be the following characters:<br><br>    &#x25CF; &apos;.&apos; for empty <br>    &#x25CF; &apos;#&apos; for obstacle <br>    &#x25CF; &apos;N&apos; for camera facing north <br>    &#x25CF; &apos;W&apos; for camera facing west <br>    &#x25CF; &apos;S&apos; for camera facing south <br>    &#x25CF; &apos;E&apos; for camera facing east <br>    &#x25CF; &apos;T&apos; for target <br>    &#x25CF; &apos;M&apos; for Matt ","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"   For each test case, output one line &quot;Case #x: y&quot;, where x is the case number (starting from 1) and y is the answer.<br><br>   If Matt cannot complete the mission, output &apos;-1&apos;.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n3\nM..\n.N.\n..T\n3\nM.. \n###\n..T</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1: 5\nCase #2: -1</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2014+ACM%2FICPC+Asia+Regional+Beijing+Online&amp;source=1&amp;searchmode=source\"> 2014 ACM/ICPC Asia Regional Beijing Online </a> ","type":"source","format":"html","require":["katex"]}]}