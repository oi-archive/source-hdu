{"title":"Heart","time_limit":20000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6851","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6851&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6851","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6851"},"statement":[{"title":"Problem Description","content":"Notice&#xFFFD;&#xFFFD;Don&apos;t output extra spaces at the end of one line.<br><br>Koishi loves her heart.<br><br>Koishi&apos;s heart are divided into 21 pieces, indexed from $0$ to $20$. She has $n$ kinds of danmaku, using the $i$-th danmaku needs the help of a subset $b_i$ of her heart pieces and has aggressivity $p_i$. Suppose $A$ is a subset of her $n$ danmakus. If for any two different kinds of danmaku $u,v\\in A,u\\neq v$, it guarantees $b_u\\cap b_v=\\emptyset$, then we call $A$ a spellcard(because danmaku in the same spellcard must be released simultaneously, and one piece of heart can only supply one kind of damaku at the same time). The aggressivity of the spellcard $A$ is product of aggressivities of all danmakus belongs to $A$. Obviously, using spellcard $A$ needs the help of heart pieces. The related pieces subset is $S(A)=\\cup_{u\\in A}b_u$.<br><br>Koishi wants to know some details about her spellcards. She will ask $m$ questions, in the $i$-th question, she wants to know the sum of aggressivities of all her spellcard $A$ whose $S(A)=x_i$, $x_i$ is a subset of heart pieces. You must answer all the questions correctly. modulo 998244353","type":"description","format":"html"},{"title":"Input","content":"There are only one test case.<br><br>First line contains a positive integer $n(1\\leq n\\leq 10^6)$, the number of danmakus.<br><br>The $i$-th line of the following $n$ lines contains two non-negative integers $p_i,b_i(0\\leq p_i&lt;998244353,0\\leq b_i&lt;2^{21})$, describing the $i$-th danmaku, writing integer $b_i$ as binary string will get the subset $b_i$<br><br>The following integer contains a positive $m(1\\leq m\\leq 10^6)$, the number of questions.<br><br>The $i$-th line of the following $m$ lines contains a non-negative integer $x_i(0\\leq x_i&lt;2^{21})$, describing the $i$-th question.<br>","type":"input_format","format":"html"},{"title":"Output","content":"Output $m$ lines, and the $i$-th line should contain a non-negative integer as the answer of the $i$-th question","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n1 1\n1 2\n1 3\n3\n1\n2\n3</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n1\n2</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2020+Multi-University+Training+Contest+7&amp;source=1&amp;searchmode=source\"> 2020 Multi-University Training Contest 7 </a> ","type":"source","format":"html"}]}