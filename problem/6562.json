{"title":"Lovers","time_limit":15000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6562","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6562&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6562","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6562"},"statement":[{"title":"Problem Description","content":"<i>The Fool comes to a cross-road, filled with energy, confidence and purpose, knowing exactly where he wants to go and what he wants to do. But he comes to a dead stop. A flowering tree marks the path he wants to take, the one he&#x2019;s been planning on taking. But standing before a fruit tree marking the other path is a woman. The Fool has met and had relationships with women before, some far more beautiful and alluring. But she is different. Seeing her, he feels as though he&#x2019;s just been shot in the heart with cupid&#x2019;s arrow.</i><br><br>There are $n$ empty strings:<br><center>$s_1$, $s_2$, . . . , $s_n$.</center><br>You are required to perform two kinds of operations:<br><br><li>wrap $l$ $r$ $d$: change $s_i$ to $dsid$ for all l &#x2264; i &#x2264; r, where d is a digit character.</li><br><li>query $l$ $r$: query $\\sum\\limits_{i=l}^{r}$ value($s_i$) (mod $10^9$ + 7), where $value(s)$ is the number that string $s$ represents.</li><br><br>Note that the value of an empty string is 0.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line contains one integer $T$, which denote the number of cases.<br>For each case, the first line contains two integer $n$ and $m$ where $n$ is the number of strings and $m$ is the number of operations.<br>Each line of the following m lines contains an operation with format<br><center>$wrap$ $l$ $r$ $d$</center><br>or<br><center>$query$ $l$ $r$</center>.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each case, you should output &quot;Case $i$:&quot;in a line, where $i$ is the case number starting from 1.<br>Then for each query operation in that case, output a line that contains a single integer that representing the answer for that query operation.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n3 2\nwrap 1 3 1\nquery 1 2\n4 4\nwrap 1 3 0\nwrap 2 4 3\nquery 1 4\nquery 2 3</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1:\n22\nCase 2:\n6039\n6006\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\n1 &#x2264; T &#x2264; 5, 1 &#x2264; n, m &#x2264; 1e5, 1 &#x2264; l &#x2264; r &#x2264; n.\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2018CCPC%BC%AA%C1%D6%C8%FC%C7%F8%A3%A8%D6%D8%CF%D6%C8%FC%A3%A9-+%B8%D0%D0%BB%B1%B1%BB%AA%B4%F3%D1%A7&amp;source=1&amp;searchmode=source\"> 2018CCPC&#x5409;&#x6797;&#x8D5B;&#x533A;&#xFF08;&#x91CD;&#x73B0;&#x8D5B;&#xFF09;- &#x611F;&#x8C22;&#x5317;&#x534E;&#x5927;&#x5B66; </a> ","type":"source","format":"html","require":["katex"]}]}