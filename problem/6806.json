{"title":"Equal Sentences","time_limit":1000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6806","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6806&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6806","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6806"},"statement":[{"title":"Problem Description","content":"Sometimes, changing the order of the words in a sentence doesn&apos;t influence understanding. For example, if we change &quot;what time is it&quot;, into &quot;what time it is&quot;; or change &quot;orz zhang three ak world final&quot;, into &quot;zhang orz three world ak final&quot;, the meaning of the whole sentence doesn&apos;t change a lot, and most people can also understand the changed sentences well.<br><br>Formally, we define a sentence as a sequence of words. Two sentences $S$ and $T$ are almost-equal if the two conditions holds:<br><br>1. The multiset of the words in $S$ is the same as the multiset of the words in $T$.<br>2. For a word $\\alpha$, its $i^\\mathrm{th}$ occurrence in $S$ and its $i^\\mathrm{th}$ occurrence in $T$ have indexes differing no more than $1$. (The $k^\\mathrm{th}$ word in the sentence has index $k$.) This holds for all $\\alpha$ and $i$, as long as the word $\\alpha$ appears at least $i$ times in both sentences.<br><br>Please notice that &quot;almost-equal&quot; is not a equivalence relation, unlike its name. That is, if sentences $A$ and $B$ are almost-equal, $B$ and $C$ are almost-equal, it is possible that $A$ and $C$ are not almost-equal.<br><br>Zhang3 has a sentence $S$ consisting of $n$ words. She wants to know how many different sentences there are, which are almost-equal to $S$, including $S$ itself. Two sentences are considered different, if and only if there is a number $i$ such that the $i^\\mathrm{th}$ word in the two sentences are different. As the answer can be very large, please help her calculate the answer modulo $10^9 + 7$.<br>","type":"description","format":"html"},{"title":"Input","content":"The first line of the input gives the number of test cases, $T \\; (1 \\le T \\le 100)$. $T$ test cases follow.<br><br>For each test case, the first line contains an integer $n \\; (1 \\le n \\le 10^5)$, the number of words in the sentence.<br><br>The second line contains the sentence $S$ consisting of $n$ words separated by spaces. Each word consists of no more than $10$ lowercase English letters.<br><br>The sum of $n$ in all test cases doesn&apos;t exceed $2 \\times 10^5$.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, print a line with an integer, representing the answer, modulo $10^9 + 7$.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n6\nhe he zhou is watching you\n13\nyi yi si wu yi si yi jiu yi jiu ba yao ling</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">8\n233</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2020+Multi-University+Training+Contest+4&amp;source=1&amp;searchmode=source\"> 2020 Multi-University Training Contest 4 </a> ","type":"source","format":"html"}]}