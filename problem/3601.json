{"title":"A pungent problem","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3601","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3601&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3601","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3601"},"statement":[{"title":"Problem Description","content":"One day, a couple of friends J and F were playing the game called &#x201C;RiskCraft&#x201D;. But J was so confused by what F told him that F almost wanted to bully him. At that time, the occurrence of cheat had exactly prevented J from being mistreated any longer.<br>     Now it&apos;s the time for F to make the strategy. There are several forts on the map, and each of the two forts has only one route to connect them. What&apos;s more, F had been doing something quiet beyond the expectation. He just got each of the forts armed with a large amount of soldiers. But it seemed apparently that F knew J was cheating. So, F determined to alter the proportion of the army. J was definitely getting really misleading By F&apos;s distorted strategies. So, he was really anxious of seeking the help of you.<br>     Please number the forts from 1 to n. For instance, the fort ith number of solider is w(i) ( ps. w(i) may be a negative number as F likes. How rediculous!!), there are several tips of instructions that J hope s could help you work out this dilemma problem.<br><b>1. CHANGE u t:</b>  this means that F has the intention that he really want to change present group of the soldiers in fort u to t.<br><b>2. QMAX &#xA0;&#xA0; u v :</b>  this actually indicates that J is curious about what is the max number of the soldiers of a certain forts on the way from u to v.<br><b>3. QSUM &#xA0;&#xA0; u v :</b>  this absolutely expressed that J furiously have the temptation to know the whole number of the army from fort u to fort v.<br>","type":"description","format":"html"},{"title":"Input","content":"There are several test cases.<br>In each test case, the first line is a positive integer n (1 &lt;=n&lt;=30000) means the number of fort.<br>The next n-1 lines include two numbers a, b (1&lt;=a, b&lt;=n) indicating there is a path between fort a and fort b.<br>The next line has n numbers, the i th number w(i) (-30000&lt;=w(i)&lt;=30000) means the amount of the army in fort i.<br>The following lines has a unique number q (0&lt;=q&lt;=200000), means the total operations in this test case.<br>Above all, q lines will be definitely displayed on screen, each line offers a string like &apos;CHANGE u t&apos;, &apos;QMAX u v&apos; or &apos;QSUM u v&apos;.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each string &apos;QMAX&apos; or &apos;QSUM&apos;, give a number express the result of this request.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">4\n1 2\n2 3\n4 1\n4 2 1 3\n12 \nQMAX 3 4 \nQMAX 3 3\nQMAX 3 2\nQMAX 2 3\nQSUM 3 4\nQSUM 2 1\nCHANGE 1 5\nQMAX 3 4\nCHANGE 3 6\nQMAX 3 4\nQMAX 2 4\nQSUM 3 4</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">4\n1\n2\n2\n10\n6\n5\n6\n5\n16\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>The existence of the lines is impossible to be found between each test case.</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Author","content":"YuanYifan","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2010+ACM-ICPC+Multi-University+Training+Contest%A3%A816%A3%A9%A1%AA%A1%AAHost+by+NUDT&amp;source=1&amp;searchmode=source\"> 2010 ACM-ICPC Multi-University Training Contest&#xFF08;16&#xFF09;&#x2014;&#x2014;Host by NUDT </a> ","type":"source","format":"html"}]}