{"title":"Arrange","time_limit":4000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5719","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5719&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5719","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5719"},"statement":[{"title":"Problem Description","content":"Accidentally, Cupid, god of desire has hurt himself with his own dart and fallen in love with Psyche. <br><br>This has drawn the fury of his mother, Venus. The goddess then throws before Psyche a great mass of mixed crops.<br><br>There are $ n $ heaps of crops in total, numbered from $ 1 $ to $ n $. <br><br>Psyche needs to arrange them in a certain order, assume crops on the $ i $-th position is $ A_i $.<br><br>She is given some information about the final order of the crops:<br><br>1. the minimum value of $ A_1, A_2, ..., A_i $ is $ B_i $.<br><br>2. the maximum value of $ A_1, A_2, ..., A_i $ is $ C_i $.<br><br>She wants to know the number of valid permutations. As this number can be large, output it modulo $ 998244353 $.<br><br>Note that if there is no valid permutation, the answer is $ 0 $.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line of input contains an integer $ T $ $ (1 \\le T \\le 15) $, which denotes the number of testcases.<br><br>For each test case, the first line of input contains single integer $ n $ $ (1 \\le n \\le 10 ^ 5) $.<br><br>The second line contains $ n $ integers, the $ i $-th integer denotes $ B_i $ $ (1 \\le B_i \\le n) $.<br><br>The third line contains $ n $ integers, the $ i $-th integer denotes $ C_i $ $ (1 \\le C_i \\le n) $.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each testcase, print the number of valid permutations modulo $ 998244353 $.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n3\n2 1 1\n2 2 3\n5\n5 4 3 2 1\n1 2 3 4 5</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n0\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nIn the first example, there is only one valid permutation (2,1,3) .\n\nIn the second example, it is obvious that there is no valid permutation.\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=BestCoder+2nd+Anniversary&amp;source=1&amp;searchmode=source\"> BestCoder 2nd Anniversary </a> ","type":"source","format":"html","require":["katex"]}]}