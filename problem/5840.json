{"title":"This world need more Zhu","time_limit":6000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5840","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5840&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5840","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5840"},"statement":[{"title":"Problem Description","content":"As we all know, Zhu is the most powerful man. He has the infinite power to protest the world. We need more men like Zhu!<br><br>In Duoladuo, this place is like a tree. There are $n$ vertices and $n-1$ edges. And the root is $1$. Each vertex can reached by any other vertices. Each vertex has a people with value $A_i$ named Zhu&apos;s believer.<br><br>Liao is a curious baby, he has $m$ questions to ask Zhu. But now Zhu is busy, he wants you to help him answer Liao&apos;s questions.<br><br>Liao&apos;s question will be like &quot;u v k&quot;.<br><br>That means Liao want to know the answer from following code:<br><br>&#xA0;&#xA0;ans = 0;    cnt = 0;<br><br>&#xA0;&#xA0;for x in the shortest path from u to v {<br><br>&#xA0;&#xA0;&#xA0;&#xA0;cnt++;<br>&#xA0;&#xA0;&#xA0;&#xA0;<br>&#xA0;&#xA0;&#xA0;&#xA0;if(cnt mod k == 0) ans = max(ans,a[x]);<br><br>&#xA0;&#xA0;}<br><br>&#xA0;&#xA0;print(ans).<br><br>Please read the hints for more details.","type":"description","format":"html"},{"title":"Input","content":"In the first line contains a single positive integer $T$, indicating number of test case.<br><br>In the second line there are two numbers $n$, $m$. $n$ is the size of Duoladuo, $m$ is the number of Liao&apos;s questions.<br><br>The next line contains $n$ integers $A_1, A_2, ...A_n$, means the value of ith vertex.<br><br>In the next $n-1$ line contains tow numbers $u$, $v$. It means there is an edge between vertex $u$ and vertex $v$.<br><br>The next $m$ lines will be the Liao&apos;s question: <br><br>u v k<br><br>$1 \\leq T \\leq 10,1 \\leq n \\leq 100000,1 \\leq m \\leq 100000,1 \\leq u,v \\leq n,1 \\leq k,\\ A_i \\leq 1000000000$.","type":"input_format","format":"html"},{"title":"Output","content":"For each case, output Case #i: (i is the number of the test case, from 1 to $T$). <br><br>Then, you need to output the answer for every Liao&apos;s questions.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n5 5\n1 2 4 1 2\n1 2\n2 3\n3 4\n4 5\n1 1 1\n1 3 2\n1 3 100\n1 5 2\n1 3 1</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1:\n1\n2\n0\n2\n4\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nIn query 1,there are only one vertex in the path,so the answer is 1.\n\nIn query 2,there are three vertices in the path.But only the vertex 2 mod 2 equals to 0.\n\nIn query 3,there are three vertices in the path.But no vertices mod 100 equal to 0.\n\nIn query 4,there are five vertices in the path.There are two vertices mod 2 equal to 0.So the answer is max(a[2],a[4]) = 2.\n\nIn query 5,there are three vertices in the path.And all the vertices mod 1 equal to 0. So the answer is a[3] = 4.\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Author","content":"UESTC","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2016%D6%D0%B9%FA%B4%F3%D1%A7%C9%FA%B3%CC%D0%F2%C9%E8%BC%C6%BE%BA%C8%FC+-+%CD%F8%C2%E7%D1%A1%B0%CE%C8%FC&amp;source=1&amp;searchmode=source\"> 2016&#x4E2D;&#x56FD;&#x5927;&#x5B66;&#x751F;&#x7A0B;&#x5E8F;&#x8BBE;&#x8BA1;&#x7ADE;&#x8D5B; - &#x7F51;&#x7EDC;&#x9009;&#x62D4;&#x8D5B; </a> ","type":"source","format":"html"}]}