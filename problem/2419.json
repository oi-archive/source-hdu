{"title":"Boring Game","time_limit":2000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=2419","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=2419&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=2419","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=2419"},"statement":[{"title":"Problem Description","content":"Brian&apos;s little sister Mary is fond of strange games involving lots of calculation. Unfortunately she&apos;s not so good at mathematics so Brian&apos;s often asked to calculate the values needed for her. Recently Brian&apos;s facing another such problem:<br>An undirected graph with N vertexes and M edges is first drawn by Mary. Then, Mary randomly assigns an integer value to each of the vertexes. After that, Mary will perform a sequence of operations on the graph, each operation being of one of the following type:<br>&#xA0;&#xA0;&#xA0;&#xA0;a)&#xA0;&#xA0;Among all vertexes connecting with vertex X via some edges, find the least value that is no less than value K. If such value cannot be found, zero will be returned instead.<br>&#xA0;&#xA0;&#xA0;&#xA0;b)&#xA0;&#xA0;Updates the value assigned to vertex X to K.<br>&#xA0;&#xA0;&#xA0;&#xA0;c)&#xA0;&#xA0;Erases an edge connecting vertex A and B from the graph.<br>Mary&#xFFFD;&#xFFFD;s interested in the average value of all answers to type a) operations. Would you please help Brian to finish this boring task? <br>","type":"description","format":"html"},{"title":"Input","content":"There are multiple test cases in the input file. Each case starts with three integers, N, M, and Q (1 &lt;= N &lt;= 2 * 10<sup>4</sup>, 0 &lt;= M &lt;= 6 * 10<sup>4</sup>, 1 &lt;= Q &lt;= 3 * 10<sup>5</sup>). The next N lines describe the initial value assigned to each vertex. The next part of each test case consists of M lines, and describes the edges in the graph at the beginning. Vertexes are numbered from 1 to N. The last part of each test case describes the operations to be performed on the tree. For operations of a) type, a line similar to &#xFFFD;&#xFFFD;F X K&#xFFFD;&#xFFFD; will be given; for operations of b) type, a line with the format of &#xFFFD;&#xFFFD;U X K&#xFFFD;&#xFFFD; will be given; and for c) type, the description will be given in the format similar to &#xFFFD;&#xFFFD;E A B&#xFFFD;&#xFFFD;. You can assume that there will always be at least one a) type query. The absolute value assigned to any vertex at any time will not exceed 10000.<br>There is a blank line between two successive cases. Input ends with End-of-File. <br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output one real number &#xFFFD;C the requested value with precision up to 0.001, in the format as indicated in the sample output. <br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3 3 8\n4\n5\n8\n1 2\n2 3\n1 3\nF 1 4 \nE 1 3\nF 2 7\nE 2 3\nE 1 2\nF 2 7\nU 3 6\nF 3 3\n\n1 0 1\n0\nF 1 0</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1: 4.500\nCase 2: 0.000\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nFor case 1, the answers for the queries are 4, 8, 0 and 6 respectively.\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2008+Asia+Hangzhou+Regional+Contest+Online&amp;source=1&amp;searchmode=source\"> 2008 Asia Hangzhou Regional Contest Online </a> ","type":"source","format":"html"}]}