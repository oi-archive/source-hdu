{"title":"Ridiculous Netizens","time_limit":6000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6643","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6643&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6643","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6643"},"statement":[{"title":"Problem Description","content":"Mr. Bread has a tree $T$ with $n$ vertices, labeled by $1,2,\\dots,n$. Each vertex of the tree has a positive integer value $w_i$.<br><br>The value of a non-empty tree $T$ is equal to $w_1\\times w_2\\times\\dots\\times w_n$. A subtree of $T$ is a connected subgraph of $T$ that is also a tree.<br><br>Please write a program to calculate the number of non-empty subtrees of $T$ whose values are not larger than a given number $m$.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line of the input contains an integer $T(1\\leq T\\leq 10)$, denoting the number of test cases.<br><br>In each test case, there are two integers $n,m(1\\leq n\\leq 2000,1\\leq m\\leq 10^6)$ in the first line, denoting the number of vertices and the upper bound.<br><br>In the second line, there are $n$ integers $w_1,w_2,\\dots,w_n(1\\leq w_i\\leq m)$, denoting the value of each vertex.<br><br>Each of the following $n-1$ lines contains two integers $u_i,v_i(1\\leq u_i,v_i\\leq n,u_i\\neq v_i)$, denoting an bidirectional edge between vertices $u_i$ and $v_i$.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, print a single line containing an integer, denoting the number of valid non-empty subtrees. As the answer can be very large, output it modulo $10^9 + 7$.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n5 6\n1 2 1 2 3\n1 2\n1 3\n2 4\n2 5</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">14</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2019+Multi-University+Training+Contest+6&amp;source=1&amp;searchmode=source\"> 2019 Multi-University Training Contest 6 </a> ","type":"source","format":"html","require":["katex"]}]}