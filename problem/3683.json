{"title":"Gomoku","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3683","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3683&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3683","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3683"},"statement":[{"title":"Problem Description","content":"You are probably not familiar with the title, &#x201C;Gomoku&#x201D;, but you must have played it a lot. Gomoku is an abstract strategy board game and is also called Five in a Row, or GoBang. It is traditionally played with go pieces (black and white stones) on a go board (19x19 intersections). Nowadays, standard chessboard of Gomoku has 15x15 intersections. Black plays first, and players alternate in placing a stone of their color on an empty intersection. The winner is the first player to get an unbroken row of five or more stones horizontally, vertically, or diagonally. <br><center><img style=\"max-width:100%;\" src=\"../../data/images/3683-1.gif\"></center>  <br> For convenience, we coordinate the chessboard as illustrated above. The left-bottom intersection is (0,0). And the bottom horizontal edge is x-axis, while the left vertical line is y-axis. <br><br>I am a fan of this game, actually. However, I have to admit that I don&#x2019;t have a sharp mind. So I need a computer program to help me. What I want is quite simple. Given a chess layout, I want to know whether someone can win within 3 moves, assuming both players are clever enough. Take the picture above for example. There are 31 stones on it already, 16 black ones and 15 white ones. Then we know it is white turn. The white player must place a white stone at (5,8). Otherwise, the black player will win next turn. After that, however, the white player also gets a perfect situation that no matter how his opponent moves, he will win at the 3rd move. <br><br>So I want a program to do similar things for me. Given the number of stones and positions of them, the program should tell me whose turn it is, and what will happen within 3 moves.<br>","type":"description","format":"html"},{"title":"Input","content":"The input contains no more than 20 cases.<br>Each case contains n+1 lines which are formatted as follows.<br>n<br>x<sub>1</sub> y<sub>1</sub> c<sub>1</sub><br>x<sub>2</sub> y<sub>2</sub> c<sub>2</sub><br>......<br>x<sub>n</sub> y<sub>n</sub> c<sub>n</sub><br>The first integer n indicates the number of all stones. n&lt;=222 which means players have enough space to place stones. Then n lines follow. Each line contains three integers: x<sub>i</sub> and y<sub>i</sub> and c<sub>i</sub>. x<sub>i</sub> and y<sub>i</sub> are coordinates of the stone, and c<sub>i</sub> means the color of the stone. If c<sub>i</sub>=0 the stone is white. If c<sub>i</sub>=1 the stone is black. It is guaranteed that 0&lt;=x<sub>i</sub>,y<sub>i</sub>&lt;=14, and c<sub>i</sub>=0 or 1. No two stones are placed at the same position. It is also guaranteed that there is no five in a row already, in the given cases.<br>The input is ended by n=0.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case:<br><br>First of all, the program should check whose turn next. Let&#x2019;s call the player who will move next &#x201C;Mr. Lucky&#x201D;. Obviously, if the number of the black stone equals to the number of white, Mr. Lucky is the black player. If the number of the black stone    equals to one plus the numbers of white, Mr. Lucky is the white player. If it is not the first situation or the second, print &#x201C;Invalid.&#x201D; <br><br>A valid chess layout leads to four situations below:<br><br>1)Mr. Lucky wins at the 1<sup>st</sup> move. In this situation, print :<br><br>Place TURN at (x,y) to win in 1 move.<br><br> &#x201C;TURN&#x201D; must be replaced by &#x201C;black&#x201D; or &#x201C;white&#x201D; according to the situation and (x,y) is the position of the move. If there are different moves to win, choose the one where x is the smallest. If there are still different moves, choose the one where y is the smallest.<br><br>2)Mr. Lucky&#x2019;s opponent wins at the 2<sup>nd</sup> move. In this situation, print:<br><br>Lose in 2 moves.<br><br>3)Mr. Lucky wins at the 3<sup>rd</sup> move. If so, print:<br><br>Place TURN at (x,y) to win in 3 moves.<br><br>&#x201C;TURN&#x201D; should replaced by &#x201C;black&#x201D; or &#x201C;white&#x201D;, (x,y) is the position where the Mr. Lucky should place a stone at the 1<sup>st</sup> move. After he place a stone at (x,y), no matter what his opponent does, Mr. Lucky will win at the 3[sup]rd[sup] step. If there are multiple choices, do the same thing as described in situation 1. <br><br>4)Nobody wins within 3 moves. If so, print:<br><br>Cannot win in 3 moves.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">31\n3 3 1\n3 4 0\n3 5 0\n3 6 0\n4 4 1\n4 5 1\n4 7 0\n5 3 0\n5 4 0\n5 5 1\n5 6 1\n5 7 1\n5 9 1\n6 4 1\n6 5 1\n6 6 0\n6 7 1\n6 8 0\n6 9 0\n7 5 1\n7 6 0\n7 7 1\n7 8 1\n7 9 0\n8 5 0\n8 6 1\n8 7 0\n8 8 1\n8 9 0\n9 7 1\n10 8 0\n1\n7 7 1\n1\n7 7 0\n0</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Place white at (5,8) to win in 3 moves.\nCannot win in 3 moves.\nInvalid.</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2010+Asia+Hangzhou+Regional+Contest+&amp;source=1&amp;searchmode=source\"> 2010 Asia Hangzhou Regional Contest  </a> ","type":"source","format":"html"}]}