{"title":"Writing Robot","time_limit":1000,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3505","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3505&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3505","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3505"},"statement":[{"title":"Problem Description","content":"Word&apos;s combination is an interesting thing.<br>Given a set of words S={s1, s2, ..., sn}, where si is a word only consists lowercase letter and its length is less than 50. When si merges in a text, its effect on reader&apos;s mood is both positive and negative. A word&apos;s positive effect is measured in love level li and negative effect is in hate level hi.<br>At the same time, given a set paragraph P={P1, P2, ..., Pn} and Pj is a string whose length is less than 1000. For each word si in S, there is two conditions in Pj as follows:<br>Related : si is a substring of Pj, and li units of love level is added to Pj, if si occurs several times in Pj, every occurrence is counted.<br>Unrelated : si never occurs in Pj and this condition bring Pj nothing.<br>Text T is defined as a subset of P. T&apos;s love level is defined as sum of Pj&apos;s love level where Pj belongs to T minus words?hate level. Because a strange psychology phenomenon, hate level of a word which occurs in T is only counted once no matter how many times it occurs. <br>Given the set of S and P, writing robot&apos;s job is to select a subset T to maximum the love level.<br>","type":"description","format":"html"},{"title":"Input","content":"The first line of the input contains a single integer T (1 &#x2264; T &#x2264; 15), the number of test cases. Then T cases follow. <br>First line of each case contains 2 integers, S, P. (1&#x2264;S, P&#x2264;150), then S lines follows, each line contains 2 integers, li, hi, (1&#x2264;li&#x2264;100, 1&#x2264;hi&#x2264;1000), and a string si with length less than 50. Next P lines, each contains a string Pi with length less than 1000. It guarantees that the answer will not exceed 32-bit signed integer.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For the x-th test case, print &quot;Case x: &quot; and maximum T&apos;s profit in a line.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n3 2\n2 2 hit\n1 2 it\n3 1 song\nhitman\nsingasong\n2 2\n2 3 ab\n1 6 ba\nababab\nbababa</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1: 2\nCase 2: 6\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>In the first case, T maybe {&quot;&quot;}, {&quot;hitman&quot;}, {&quot;singasong&quot;},{&quot;hitman&quot;, &quot;singasong&quot;} and their love level is 0, -1, 2, 1. So &quot;singasong&quot; is chosen.\nIn the second case, cause &quot;ab&quot; and &quot;ba&quot; all occurs in P1 and P2, obviously choosing them both as T={&quot;ababab&quot;, &quot;bababa&quot;} will get most love level.</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Author","content":"Oneplus","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2010+ACM-ICPC+Multi-University+Training+Contest%A3%A87%A3%A9%A1%AA%A1%AAHost+by+HIT+&amp;source=1&amp;searchmode=source\"> 2010 ACM-ICPC Multi-University Training Contest&#xFF08;7&#xFF09;&#x2014;&#x2014;Host by HIT  </a> ","type":"source","format":"html"}]}