{"title":"Andy and Data Structure","time_limit":20000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6663","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6663&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6663","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6663"},"statement":[{"title":"Problem Description","content":"Andy is a famous data structure expert at Nanjing University second to none. One day he throws a plain dry data structure problem to his friends, but none of them can solve. How about you?<br><br>Given a tree rooted at node 1. Each node has a weight which is 0 initially. Define the distance between two nodes as the number of edges in the unique simple path between the two nodes. You need to perform these two types of operations:<br><br>- Type 1: given $a, x, y, z$, add $z$ to the weights of all $a$&apos;s descendants (including $a$ itself) whose distances to $a$ are $y$ modulo $x$;<br>- Type 2: given $a$, return the weight of node $a$.<br>","type":"description","format":"html"},{"title":"Input","content":"The first line of the input is a single integer $T$ $(1 \\leq T \\leq 4)$, the number of test cases.<br><br>Each test cases starts with two integers $n, m$ $(1 \\leq n, m \\leq 300000)$, denoting that there are $n$ nodes (numbered $1$ through $n$) in the tree and you need to perform $m$ operations. The next line contains $n-1$ integers, $f_1, f_2, \\cdots, f_{n-1}$ $(1 \\leq f_i \\leq i)$, specifying the edges of the trees; the $i$th integer denotes the parent of node $i+1$. The next $m$ lines describe the operations. Each line is either $\\texttt{1 a x y z}$ $(1 \\leq a \\leq n, 1 \\leq x \\leq n, 0 \\leq y &lt; x, 0 \\leq z \\leq 500)$, denoting an operation of type 1, or $\\texttt{2 a}$ $(1 \\leq a \\leq n)$, denoting an operation of type 2.","type":"input_format","format":"html"},{"title":"Output","content":"For each operation of type 2 in each test case, print the answer in one line.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n5 5\n1 1 2 1\n1 1 5 4 1\n1 1 4 1 5\n1 2 1 0 4\n2 3\n2 1</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5\n0</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2019+Multi-University+Training+Contest+8&amp;source=1&amp;searchmode=source\"> 2019 Multi-University Training Contest 8 </a> ","type":"source","format":"html"}]}