{"title":"Pattern","time_limit":1000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5989","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5989&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5989","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5989"},"statement":[{"title":"Problem Description","content":"Alice and Bob are playing a game. Alice takes a paper with $N \\times M$ points arranging in $N$ rows and $M$ columns. First, Alice colors some points with one of $5$ colors: $c_0, c_1, c_2, c_3, c_4$. And then, Bob draws some lines between adjacent points which own a common edge. If the color of a point is $c_i$, Bob must draw exactly $i$ lines linking this point. Otherwise, Bob can draw any number of lines linking it. At last, Alice would color the rest points, with the same rules that the point which links $i$ lines should be painted the color $c_i$. After the game, Alice might get different patterns of the colors. Suppose the initial colored paper can lead to totally $K$ patterns, and there are $P_i$ ways for Bob to draw lines for the $i$-th patterns. Alice wants to know $\\sum_{i=1}^K P_i^2$. ","type":"description","format":"html"},{"title":"Input","content":"The first line of input contains an integer t which is the number of test cases. Then t test cases follow.<br>For each test case, the first line consists of two integers N(N &#xFFFD;&#xFFFD; 66), and M(M &#xFFFD;&#xFFFD; 6). The i-th line of the next N lines contains M integers, and among them the j-th integer donates the point (i, j). If the point is panted color $c_i$ , the integer is i, otherwise it is -1.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test cases, output $\\sum_{i=1}^{K} P_i^2$ modulo 10007.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n2 2\n-1 -1\n-1 -1\n3 3\n1 1 1\n1 0 1\n1 1 1</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">18\n4\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\n<center><img src=\"../../../data/images/C737-1008-1.jpg\"></center>\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2016ACM%2FICPC%D1%C7%D6%DE%C7%F8%C7%E0%B5%BA%D5%BE-%D6%D8%CF%D6%C8%FC%A3%A8%B8%D0%D0%BB%D6%D0%B9%FA%CA%AF%D3%CD%B4%F3%D1%A7%A3%A9&amp;source=1&amp;searchmode=source\"> 2016ACM/ICPC&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xD7A;&#x57E;-&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#x43B;&#xFFFD;&#x439;&#xFFFD;&#x2AF;&#xFFFD;&#x374;&#xFFFD;&#x467;&#xFFFD;&#xFFFD; </a> ","type":"source","format":"html"}]}