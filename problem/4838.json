{"title":" The Patterns","time_limit":5000,"memory_limit":63.9990234375,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4838","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4838&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4838","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4838"},"statement":[{"title":"Problem Description","content":"&#x5BF9;&#x4E8E;&#x4E00;&#x4E2A;1&#x5230;n&#x7684;&#x5168;&#x6392;&#x5217;Q&#xFF0C;&#x6211;&#x4EEC;&#x5B9A;&#x4E49;Q&#x5BF9;&#x5E94;&#x7684;&#x5B57;&#x7B26;&#x4E32;S<sub>Q</sub>,&#x5176;&#x4E2D;:<br><center><img style=\"max-width:100%;\" src=\"../../data/images/C515-4004-1.jpg\"></center><br>&#x4F8B;&#x5982;&#x5BF9;&#x4E8E;n=5,Q=32154, S<sub>Q</sub>=DDUD&#x3002;<br>&#x672C;&#x4EFB;&#x52A1;&#x4E3A;&#x7ED9;&#x5B9A;&#x4E00;&#x4E2A;&#x4EC5;&#x5305;&#x542B;&#x5B57;&#x7B26;&#x2019;U&#x2019;&#x4E0E;&#x2019;D&#x2019;&#x957F;&#x5EA6;&#x4E3A;m&#x7684;&#x6A21;&#x5F0F;&#x4E32;P&#x4EE5;&#x53CA;&#x4E00;&#x4E2A;&#x6B63;&#x6574;&#x6570;n&#xFF0C;&#x6C42;&#x89E3;1&#x5230;n&#x7684;&#x4EFB;&#x610F;&#x5168;&#x6392;&#x5217;&#x4E2D;&#x6A21;&#x5F0F;&#x4E32;&#x51FA;&#x73B0;&#x6B21;&#x6570;&#x7684;&#x671F;&#x671B;&#x503C;&#x3002;&#x4F8B;&#x5982;&#x67D0;&#x4E2A;S<sub>Q</sub>=UUU,P=UU,&#x5219;P&#x51FA;&#x73B0;&#x6B21;&#x6570;&#x4E3A;2&#x6B21;&#x3002;<br>&#x4F8B;&#x5982;n=3,P=U,&#x5219;1&#x5230;n&#x7684;&#x6240;&#x6709;&#x5168;&#x6392;&#x5217;&#x65B9;&#x6848;&#x5BF9;&#x5E94;&#x7684;&#x6A21;&#x5F0F;&#x4E32;P&#x51FA;&#x73B0;&#x6B21;&#x6570;&#x5206;&#x522B;&#x4E3A;:<br><center><img style=\"max-width:100%;\" src=\"../../data/images/C515-4004-2.jpg\"></center><br><br>&#x5219;1&#x5230;n&#x7684;&#x4EFB;&#x610F;&#x5168;&#x6392;&#x5217;&#x4E2D;&#x6A21;&#x5F0F;&#x4E32;&#x51FA;&#x73B0;&#x6B21;&#x6570;&#x7684;&#x671F;&#x671B;&#x503C;<br>E=(2+1+1+1+1+0)/6=1.0<br><br>&#x4E3A;&#x4E86;&#x907F;&#x514D;&#x6D6E;&#x70B9;&#x6570;&#x7CBE;&#x5EA6;&#x8BEF;&#x5DEE;&#xFF0C;&#x8BF7;&#x8F93;&#x51FA;(E*n!) mod (10<sup>9</sup> +7)&#xFF0C; &#x5176;&#x4E2D;mod&#x4E3A;&#x53D6;&#x6A21;&#x64CD;&#x4F5C;&#xFF0C;&#x5177;&#x4F53;&#x5B9A;&#x4E49;&#x4EE5;&#x53CA;&#x8FD0;&#x7B97;&#x89C4;&#x5219;&#x53C2;&#x89C1;&#xFF1A;<a href=\"http://baike.baidu.com/link?url=l1LdjXppildztdomz-tXdpjYhGLGcfW8jU-gUDeZXHnJJ8v3sIXZSQ3CyuGKlttqpL5nh0xmb3VOuUyXT7-Kx_\"> &#x94FE;&#x63A5;&#x5730;&#x5740; </a><br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"&#x8F93;&#x5165;&#x6570;&#x636E;&#x7B2C;&#x4E00;&#x884C;&#x4E3A;&#x4E00;&#x4E2A;&#x6574;&#x6570;T&#xFF08;1 &lt;= T &lt;= 3333&#xFF09;&#xFF0C;&#x8868;&#x793A;&#x6709; T &#x7EC4;&#x6D4B;&#x8BD5;&#x6570;&#x636E;&#x3002;<br>&#x4E0B;&#x9762;T&#x7EC4;&#x6570;&#x636E;&#xFF0C;&#x6BCF;&#x7EC4;&#x6570;&#x636E;&#x7B2C;&#x4E00;&#x884C;&#x5305;&#x542B;2&#x4E2A;&#x6B63;&#x6574;&#x6570;n, m&#xFF0C;&#x63A5;&#x4E0B;&#x6765;&#x4E00;&#x884C;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;P(&#x4EC5;&#x5305;&#x542B;&#x5B57;&#x7B26;&#x2019;U&#x2019;&#x4E0E;&#x2019;D&#x2019;)<br><br>&#x6570;&#x636E;&#x89C4;&#x6A21;:<br>1 &lt;= m &lt;= 1000&#xA0;&#xA0;<br>m&lt;n&lt;=1000000","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"&#x5BF9;&#x4E8E;&#x7B2C;k&#x7EC4;&#x6570;&#x636E;&#xFF0C;&#x7B2C;&#x4E00;&#x884C;&#x8F93;&#x51FA;Case #k:&#xFF0C;&#x7B2C;&#x4E8C;&#x884C;&#x8F93;&#x51FA;(E * n!) mod (10^9 + 7)&#x3002;<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5\n4 3\nUUU\n4 2\nUU\n10 8 \nUUUUDDDD\n2 1\nU\n2 1\nD</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1:\n1\nCase #2:\n8\nCase #3:\n1400\nCase #4:\n1\nCase #5:\n1</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2014%C4%EA%B0%D9%B6%C8%D6%AE%D0%C7%B3%CC%D0%F2%C9%E8%BC%C6%B4%F3%C8%FC+-+%B8%B4%C8%FC&amp;source=1&amp;searchmode=source\"> 2014&#x5E74;&#x767E;&#x5EA6;&#x4E4B;&#x661F;&#x7A0B;&#x5E8F;&#x8BBE;&#x8BA1;&#x5927;&#x8D5B; - &#x590D;&#x8D5B; </a> ","type":"source","format":"html","require":["katex"]}]}