{"title":"Being a Hero","time_limit":10000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3251","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3251&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3251","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3251"},"statement":[{"title":"Problem Description","content":"You are the hero who saved your country. As promised, the king will give you some cities of the country, and you can choose which ones to own!<br><br>But don&apos;t get too excited. The cities you take should NOT be reachable from the capital -- the king does not want to accidentally enter your area. In order to satisfy this condition, you have to destroy some roads. What&apos;s worse, you have to pay for that -- each road is associated with some positive cost. That is, your final income is the total value of the cities you take, minus the total cost of destroyed roads.<br><br>Note that each road is a unidirectional, i.e only one direction is available. Some cities are reserved for the king, so you cannot take any of them even if they&apos;re unreachable from the capital. The capital city is always the city number 1.<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line contains a single integer T (T &lt;= 20), the number of test cases. Each case begins with three integers n, m, f (1 &lt;= f &lt; n &lt;= 1000, 1 &lt;= m &lt; 100000), the number of cities, number of roads, and number of cities that you can take. Cities are numbered 1 to n. Each of the following m lines contains three integers u, v, w, denoting a road from city u to city v, with cost w. Each of the following f lines contains two integers u and w, denoting an available city u, with value w. ","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, print the case number and the best final income in the first line. In the second line, print e, the number of roads you should destroy, followed by e integers, the IDs of the destroyed roads. Roads are numbered 1 to m in the same order they appear in the input. If there are more than one solution, any one will do. ","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n4 4 2\n1 2 2\n1 3 3\n3 2 4\n2 4 1\n2 3\n4 4\n4 4 2\n1 2 2\n1 3 3\n3 2 1\n2 4 1\n2 3\n4 4</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1: 3\n1 4\nCase 2: 4\n2 1 3</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2009+Asia+Regional+Ningbo+Online&amp;source=1&amp;searchmode=source\"> 2009 Asia Regional Ningbo Online </a> ","type":"source","format":"html","require":["katex"]}]}