{"title":"Double Tree","time_limit":15000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6594","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6594&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6594","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6594"},"statement":[{"title":"Problem Description","content":"You are given two trees, both with $N$ vertices, numbered from 1 to $N$. <br><br>At the beginning, the weights of edges of both trees and the values of vertices of the first tree are given.<br><br>There are $Q$ operations. In each operation, the value of a vertice of the first tree will be modified. Please output $max_{1 \\leq u &lt; v \\leq n}\\left\\{T_1.dis(u, v) + T_2.dis(u, v) + val(u) + val(v)\\right\\}$ after every operation. <br><br>Note that the symbol $T_{id}.dis(u,v)$ denotes the distance between vertice $u$ and vertice $v$ in the tree $id$. <br><br>Note that the distance between two vertices in some tree is defined as the sum of the weights in the simple path between the two vertices.<br><br>Note that the symbol $val(u)$ denotes the value of the vertice $u$ in the first tree.<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"There are multiple test cases.<br><br>Each case starts with a line containing two positive integers $N, Q(2 \\leq N \\leq 10^5, 1 \\leq Q \\leq 10^5)$.<br><br>The second line contains $N$ integers $a_1, a_2, ..., a_N(1 \\leq a_i \\leq 10^9)$ denoting the values of vertices of the first tree.<br><br>Then follow $N - 1$ lines. Each line contains three integers $u, v, w(1 \\leq u, v \\leq n, 1 \\leq w \\leq 10^9)$ describing the first tree. Namely, $u, v, w$ means that there is an edge weighted $w$ between vertice $u$ and vertice $v$.<br><br>Then follow $N - 1$ lines. Each line contains three integers $u, v, w(1 \\leq u, v \\leq n, 1 \\leq w \\leq 10^9)$ describing the second tree.<br><br>Then follow $Q$ lines. Each line contains two integers $u, w(1 \\leq u \\leq n, 1 \\leq w \\leq 10^9)$, denoting the value of vertice $u$ of the first tree will be modified to $w$.<br><br>It is guaranteed that the sum of $N$s and the sum of $Q$s in all test cases are both no larger than $2 \\times 10^5$.<br><br>There is only one test case which contains $N$ and $Q$ that are both larger than  $2 \\times 10^4$.<br><br>It is guaranteed that $N$ and $Q$ in every other test case are all no larger than $2 \\times 10^4$.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, output $Q$ lines. Each line contains an integer denoting the answer.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5 3\n1 2 3 4 5\n1 2 1\n1 3 2\n1 4 3\n1 5 4\n1 2 1\n1 3 2\n1 4 3\n1 5 4\n1 100\n1 1\n2 100</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">113\n23\n115</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2019+Multi-University+Training+Contest+2&amp;source=1&amp;searchmode=source\"> 2019 Multi-University Training Contest 2 </a> ","type":"source","format":"html","require":["katex"]}]}