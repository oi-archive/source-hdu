{"title":"Rikka with Line Graph","time_limit":4000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6422","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6422&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6422","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6422"},"statement":[{"title":"Problem Description","content":"Line Graph $L(G)$ can be considered as an operator on an undirected graph $G$ just like Complementary Graph and Dual Graph.<br><br>Rikka generalizes Line Graph to edge-weighted undirected graphs. For a graph $G=\\langle V,E\\rangle$, $L(G)$ is still an edge-weighted undirected graph which is constructed in the following way:<br>1. $L(G)$ has $|E|$ vertices and the $i$th vertex corresponds to the $i$th edge in $G$.<br>2. There is an edge between $i,j$ in $L(G)$ if and only if edge $i$ and $j$ have at least one common vertices in $G$. And the edge weight is equal to the sum of the weights of edge $i$ and $j$ in $G$. <br><br>For example, in the following picture, the right graph is the line graph of the left one. Vertex $1,2,3,4$ in $L(G)$ correspond to edge $(1,2),(1,4),(1,3),(3,4)$ in $G$. And if all edges in the left graph have weight $1$, the edges in the right graph will have weight $2$.<br><center><img style=\"max-width:100%;\" src=\"../../../data/images/C642-1008-1.png\"></center><br><br>Now, Rikka has an edge-weighted tree $T$ with $n$ vertices. And she constructs a graph $G=L(L(T))$. It is clear that $G$ is connected.<br><br>Let $d(i,j)$ be the length of the shortest path between vertex $i,j$ in $G$(the length of each edge is equal to the weight), $m$ be the number of vertices in $G$, Rikka wants you to calculate $\\sum_{i=1}^m \\sum_{j=i+1}^m d(i,j)$.","type":"description","format":"html"},{"title":"Input","content":"The first line contains a single number $t(1 \\leq t \\leq 100)$, the number of the testcases.<br><br>For each testcase, the first line contains one single integer $n(1 \\leq n \\leq 10^5)$. <br><br>Then $n-1$ lines follow, each line contains three integers $u_i,v_i,w_i(1 \\leq u_i,v_i \\leq 10^5, 1 \\leq w_i \\leq 10^9)$, describe an edge with weight $w_i$ between $u_i$ and $v_i$.<br><br>The input guarantees that $G$ has at least one vertices and there are at most $5$ testcases with $n&gt;10^3$.","type":"input_format","format":"html"},{"title":"Output","content":"For each testcase, output a single line with a single number, the answer modulo $998244353$.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n4\n1 2 1\n1 3 2\n1 4 3\n5\n1 2 1\n2 3 10\n2 5 7\n3 4 2\n10\n1 2 1\n1 3 1\n2 4 1\n2 5 1\n2 6 1\n3 7 1\n7 8 1\n5 9 1\n6 10 1</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">24\n166\n420</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2018+Multi-University+Training+Contest+9&amp;source=1&amp;searchmode=source\"> 2018 Multi-University Training Contest 9 </a> ","type":"source","format":"html"}]}