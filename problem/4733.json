{"title":"G(x)","time_limit":500,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4733","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4733&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4733","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4733"},"statement":[{"title":"Problem Description","content":"For a binary number x with n digits (A<sub>n</sub>A<sub>n-1</sub>A<sub>n-2</sub> ... A<sub>2</sub>A<sub>1</sub>), we encode it as <img style=\"max-width:100%;\" src=\"../../data/images/C477-1006-1.jpg\"><br>Where &quot;<img style=\"max-width:100%;\" src=\"../../data/images/C477-1006-2.jpg\">&quot; is bitwise XOR operation and &quot;<img style=\"max-width:100%;\" src=\"../../data/images/C477-1001-2.jpg\">&quot; indicates the largest integer which is not greater than x.<br>Due to some reasons, Mzry1992 encode his password P into G(P), and additionally, he encode P + 1 into G(P + 1) too, and write G(P) and G(P + 1) into his diary.<br>This story happened many years ago and now you hold the diary with these numbers in your hands. Unfortunately, some digits are unreadable now. Could you determine the values of these digits using the readable digits?","type":"description","format":"html"},{"title":"Input","content":"The first line has a number T (T &lt;= 100) , indicating the number of test cases.<br>For every test case, it has 2 lines of same number of digits describe G(P) and G(P + 1), In every line, it only contains 1, 0 and ?. Unreadable digits are denoted with symbol ?, The length of every line in the input is up to 10<sup>5</sup>.","type":"input_format","format":"html"},{"title":"Output","content":"For every case, you should output &quot;Case #t: &quot; at first, without quotes. The <i>t</i> is the case number starting from 1.<br>Then, if there is impossible to restore G(P) and G(P + 1), you should  output &quot;Impossible&quot; in the second line.<br>Otherwise, if G(P) is unique, you should output restored G(P) and G(P +1) in the same format.<br>Otherwise, you should output &quot;Ambiguous&quot; and the number of possible G(P) in the second line.<br><b>The number may be very large so the answer should modulo 10^9 + 7.</b><br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n10??\n10??\n0010\n0110\n1?01\n0?01</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1:\nAmbiguous 3\nCase #2:\n0010\n0110\nCase #3:\nImpossible\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nIn the first sample case, the three possible situations are:\n1. \nG(12) = 1010\nG(13) = 1011\n2.  \nG(13) = 1011\nG(14) = 1001\n3.  \nG(14) = 1001\nG(15) = 1000\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2013+ACM%2FICPC+Asia+Regional+Chengdu+Online&amp;source=1&amp;searchmode=source\"> 2013 ACM/ICPC Asia Regional Chengdu Online </a> ","type":"source","format":"html"}]}