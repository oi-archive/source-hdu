{"title":"Permutation Counting","time_limit":6000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6880","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6880&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6880","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6880"},"statement":[{"title":"Problem Description","content":"For a given permutation $a_1, a_2, \\cdots, a_n$ of length $n$, we defined the neighbor sequence $b$ of $a$, the length of which is $n - 1$, as following:<br><br>$$<br>\\begin{equation}<br><br>b_i=<br><br>\\begin{cases}<br><br>0 &amp; a_i &lt; a_{i + 1}\\\\<br>1 &amp; a_i &gt; a_{i + 1}<br>\\end{cases}<br><br>\\end{equation}<br>$$. <br><br>For example, the neighbor sequence of permutation $1, 2, 3, 6, 4, 5$ is $0, 0, 0, 1, 0$. <br><br>Now we give you an integer $n$ and a sequence $b_1, b_2, \\cdots, b_{n - 1}$ of length $n - 1$, you should calculate the number of permutations of length $n$ whose neighbor sequence equals to $b$.<br><br><br>To avoid calculation of big number, you should output the answer module $10^9 + 7$. ","type":"description","format":"html"},{"title":"Input","content":"The first line contains one positive integer $T$ ($1\\le T \\le 50$), denoting the number of test cases. For each test case:<br><br>The first line of the input contains one integer $n, (2 \\le n \\le 5000)$. <br><br>The second line of the input contains $n - 1$ integer: $b_1, b_2, \\cdots, b_{n - 1}$<br><br>There are no more than $20$ cases with $n &gt; 300$.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case:<br><br>Output one integer indicating the answer module $10^9 + 7$. ","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n3\n1 0\n5\n1 0 0 1</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n11</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2020+Multi-University+Training+Contest+10&amp;source=1&amp;searchmode=source\"> 2020 Multi-University Training Contest 10 </a> ","type":"source","format":"html"}]}