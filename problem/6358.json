{"title":"Innocence","time_limit":1000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6358","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6358&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6358","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6358"},"statement":[{"title":"Problem Description","content":"David is a young child. He likes playing combinatorial games, for example, the Nim game. He is just an amateur but he is sophisticated with game theory. This time he has prepared a problem for you.<br>Given integers $N, L, R$ and $K$, you are asked to count in how many ways one can arrange an integer array of length $N$ such that all its elements are ranged from $L$ to $R$ (inclusive) and the bitwise exclusive-OR of them equals to $K$. To avoid calculations of huge integers, print the number of ways in modulo $(10^9 + 7)$.<br>In addition, David would like you to answer with several integers $K$ in order to ensure your solution is completely correct.<br>","type":"description","format":"html"},{"title":"Input","content":"The first line contains one integer $T$, indicating the number of test cases.<br>The following lines describe all the test cases. For each test case:<br>The first line contains four space-separated integers $N, L, R$ and $Q$, indicating there are $Q$ queries with the same $N, L, R$ but different $K$.<br>The second line contains $Q$ space-separated integers, indicating several integers $K$.<br>$1 \\leq T \\leq 1000$, $1 \\leq N \\leq 10^9$, $0 \\leq L \\leq R &lt; 2^{30}$, $1 \\leq Q \\leq 100$, $0 \\leq K &lt; 2^{30}$.<br>It is guaranteed that no more than $100$ test cases do not satisfy $1 \\leq N \\leq 15$, $0 \\leq L, R, K &lt; 2^{15}$.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each query, print the answer modulo $(10^9 + 7)$ in one line.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n2 3 4 2\n0 7\n3 3 4 2\n3 4\n5 5 7 4\n5 6 7 8</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n2\n4\n4\n61\n61\n61\n0\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nIn the first sample, there are two ways to select one number 3 and one number 4 such that the exclusive-OR of them is 7.\nIn the second sample, there are three ways to select one number 3 and two numbers 4 and one way to select three numbers 3 such that the exclusive-OR of them is 3.\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2018+Multi-University+Training+Contest+5&amp;source=1&amp;searchmode=source\"> 2018 Multi-University Training Contest 5 </a> ","type":"source","format":"html"}]}