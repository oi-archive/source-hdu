{"title":"Problem E. TeaTree","time_limit":4000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6430","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6430&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6430","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6430"},"statement":[{"title":"Problem Description","content":"Recently, TeaTree acquire new knoledge gcd (Greatest Common Divisor), now she want to test you.<br>As we know, TeaTree is a tree and her root is node 1, she have n nodes and n-1 edge, for each node i, it has it&#x2019;s value v[i].<br>For every two nodes i and j (i is not equal to j), they will tell their Lowest Common Ancestors (LCA) a number : gcd(v[i],v[j]).<br>For each node, you have to calculate the max number that it heard. some definition:<br>In graph theory and computer science, the lowest common ancestor (LCA) of two nodes u and v in a tree is the lowest (deepest) node that has both u and v as descendants, where we define each node to be a descendant of itself.","type":"description","format":"html"},{"title":"Input","content":"On the first line, there is a positive integer n, which describe the number of nodes.<br>Next line there are n-1 positive integers f[2] ,f[3], &#x2026;, f[n], f[i] describe the father of node i on tree.<br>Next line there are n positive integers v[2] ,v[3], &#x2026;, v[n], v[i] describe the value of node i.<br>n&lt;=100000, f[i]&lt;i, v[i]&lt;=100000","type":"input_format","format":"html"},{"title":"Output","content":"Your output should include n lines, for i-th line, output the max number that node i heard.<br>For the nodes who heard nothing, output -1.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">4\n1 1 3\n4 1 6 9</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n-1\n3\n-1</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2018+Multi-University+Training+Contest+10&amp;source=1&amp;searchmode=source\"> 2018 Multi-University Training Contest 10 </a> ","type":"source","format":"html"}]}