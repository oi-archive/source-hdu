{"title":"Maze","time_limit":1000,"memory_limit":97.65625,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5094","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5094&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5094","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5094"},"statement":[{"title":"Problem Description","content":"   This story happened on the background of Star Trek.<br><br>   Spock, the deputy captain of Starship Enterprise, fell into Klingon&#xFFFD;&#xFFFD;s trick and was held as prisoner on their mother planet Qo&#xFFFD;&#xFFFD;noS.<br><br>   The captain of Enterprise, James T. Kirk, had to fly to Qo&#xFFFD;&#xFFFD;noS to rescue his deputy. Fortunately, he stole a map of the maze where Spock was put in exactly.<br><br>   The maze is a rectangle, which has n rows vertically and m columns horizontally, in another words, that it is divided into n*m locations. An ordered pair (Row No., Column No.) represents a location in the maze. Kirk moves from current location to next costs 1 second. And he is able to move to next location if and only if:<br><br>   Next location is adjacent to current Kirk&#xFFFD;&#xFFFD;s location on up or down or left or right(4 directions)<br>   Open door is passable, but locked door is not.<br>   Kirk cannot pass a wall<br><br>   There are p types of doors which are locked by default. A key is only capable of opening the same type of doors. Kirk has to get the key before opening corresponding doors, which wastes little time.<br><br>   Initial location of Kirk was (1, 1) while Spock was on location of (n, m). Your task is to help Kirk find Spock as soon as possible.","type":"description","format":"html"},{"title":"Input","content":"   The input contains many test cases.<br><br>   Each test case consists of several lines. Three integers are in the first line, which represent n, m and p respectively (1&lt;= n, m &lt;=50, 0&lt;= p &lt;=10). <br>Only one integer k is listed in the second line, means the sum number of gates and walls, (0&lt;= k &lt;=500).<br><br>   There are 5 integers in the following k lines, represents x<sub>i1</sub>, y<sub>i1</sub>, x<sub>i2</sub>, y<sub>i2</sub>, g<sub>i</sub>; when g<sub>i</sub> &gt;=1, represents there is a gate of type gi between location (x<sub>i1</sub>, y<sub>i1</sub>) and (x<sub>i2</sub>, y<sub>i2</sub>); when g<sub>i</sub> = 0, represents there is a wall between location (x<sub>i1</sub>, y<sub>i1</sub>) and (x<sub>i2</sub>, y<sub>i2</sub>),  ( | x<sub>i1</sub> - x<sub>i2</sub> | + | y<sub>i1</sub> - y<sub>i2</sub> |=1, 0&lt;= g<sub>i</sub> &lt;=p )<br><br>   Following line is an integer S, represent the total number of keys in maze. (0&lt;= S &lt;=50).<br><br>   There are three integers in the following S lines, represents x<sub>i1</sub>, y<sub>i1</sub> and q<sub>i</sub> respectively. That means the key type of q<sub>i</sub> locates on location (x<sub>i1</sub>, y<sub>i1</sub>),  (1&lt;= q<sub>i</sub>&lt;=p).","type":"input_format","format":"html"},{"title":"Output","content":"   Output the possible minimal second that Kirk could reach Spock. <br><br>   If there is no possible plan, output -1. <br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">4 4 9\n9\n1 2 1 3 2\n1 2 2 2 0\n2 1 2 2 0\n2 1 3 1 0\n2 3 3 3 0\n2 4 3 4 1\n3 2 3 3 0\n3 3 4 3 0\n4 3 4 4 0\n2\n2 1 2\n4 2 1</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">14</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2014%C9%CF%BA%A3%C8%AB%B9%FA%D1%FB%C7%EB%C8%FC%A1%AA%A1%AA%CC%E2%C4%BF%D6%D8%CF%D6%A3%A8%B8%D0%D0%BB%C9%CF%BA%A3%B4%F3%D1%A7%CC%E1%B9%A9%CC%E2%C4%BF%A3%A9&amp;source=1&amp;searchmode=source\"> 2014&#xFFFD;&#x3FA;&#xFFFD;&#x22B;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#x13F;&#xFFFD;&#xFFFD;&#xFFFD;&#x5A3;&#xFFFD;&#xFFFD;&#xFFFD;&#x43B;&#xFFFD;&#x3FA;&#xFFFD;&#xFFFD;&#xFFFD;&#x467;&#xFFFD;&#x1E69;&#xFFFD;&#xFFFD;&#x13F;&#xFFFD;&#xFFFD; </a> ","type":"source","format":"html"}]}