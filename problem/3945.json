{"title":"The irRegularGame of Life","time_limit":2000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3945","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3945&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3945","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3945"},"statement":[{"title":"Problem Description","content":"The irRegularGame of Life(http://www.bilibili.tv/video/av94917/) is an interesting game, it&#x2019;s based on the same cell rules as Conway&apos;s original, with the addition of limitations on initial conditions, and goals for completing levels.<br><br>The Conway&#x2019;s original game of life rules is a &quot;2-Dimensional cellular automaton&quot;. It was invented by British mathematician John Conway in 1970.It is not a game in the video game sense, but consists of a 2-D grid of cells. The game of life shouldn&apos;t to be confused with Milton Bradley&apos;s Board game of the same name.<br>Cells in the grid follow a few simple mathematical rules that determine whether they will live, die or multiply in the next generation. <br>Specifically, each cell interacts with its 8 horizontal, vertical, and diagonal neighbours, according to these 4 simple rules below:<br>1. Any live cell with fewer than 2 live neighbours dies through loneliness.<br>2. Any live cell with more than 3 live neighbours dies through overcrowding.<br>3. Any live cell with 2 or 3 live neighbours lives to the next generation.<br>4. Any dead cell with exactly 3 live neighbours comes to live. <br><center><img style=\"max-width:100%;\" src=\"../../data/images/C363-1006-1.jpg\"></center> <br>Despite having such simple rules, the patterns that evolve are remarkable and can vary greatly from only small differences in initial conditions. <br>The game of life has fascinated mathematicians, computer scientists and nerdy types for decades. <br><center><img style=\"max-width:100%;\" src=\"../../data/images/C363-1006-2.jpg\"></center> <br>This picture shows the rule of The irRegularGame of Life.<br><br>Sakuya thought this game is too simple, so he added some rules.<br>1.We have K (1&lt;=K&lt;=10) independent boxes in every level, and each box contains 4*4 grids.<br>2.The goal to pass a level is the sum of live cells in all boxes are exactly N (0&lt;=N&lt;=20) after T (0&lt;=T&lt;=200000) generations.<br>3.For those boxes, we can add at most M (0&lt;=M&lt;=20) cells.<br><br>Sakuya want know how many ways to pass one level?<br><br>As an example, initially we have one box as below.<br><img style=\"max-width:100%;\" src=\"../../data/images/C363-1006-3.jpg\"><br>The goal is to have exactly 5 live cells after 10 generations, and we can add at most one cell into the box.<br>There are 9 different ways to pass this level.<br><center><img style=\"max-width:100%;\" src=\"../../data/images/c363-1006-4.jpg\"></center> ","type":"description","format":"html"},{"title":"Input","content":"First an integer L (L &lt;= 50), indicates there are L different levels.<br>For every level, the first line contains 4 integers, they are K, M, T and N which mentioned above.<br>Then, there are K 4*4 01-matrices follow, indicating the initial state of each box, 0 stands for an empty cell and 1 stands for an alive cell.","type":"input_format","format":"html"},{"title":"Output","content":"For each level, you should output &quot;Case #C: &quot; first, where C indicates the level number and counts from 1. Then output the answer. There may be a great deal of ways, just mod 1000000009","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n\n1 1 10 5\n0 0 0 0\n0 1 0 0\n1 0 1 0\n0 1 0 0\n\n2 3 0 3\n0 0 0 0\n0 0 0 0\n0 0 0 0\n0 0 0 0\n0 0 0 0\n0 0 0 0\n0 0 0 0\n0 0 0 0</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1: 9\nCase #2: 4960\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nATTENTION: It is to ALL the box that at most M cells are available to be add into, not to EACH box. \nIn the second sample, we can add 3 cells into two empty boxes and the goal is the sum of live cells in all boxes are exactly 3 after 0 generation, so we have C(32,3) = 4960 different ways.\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Author","content":"UESTC_Mzry1992","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2011+Multi-University+Training+Contest+11+-+Host+by+UESTC&amp;source=1&amp;searchmode=source\"> 2011 Multi-University Training Contest 11 - Host by UESTC </a> ","type":"source","format":"html"}]}