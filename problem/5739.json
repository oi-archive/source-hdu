{"title":"Fantasia","time_limit":5000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5739","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5739&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5739","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5739"},"statement":[{"title":"Problem Description","content":"Professor Zhang has an undirected graph $G$ with $n$ vertices and $m$ edges. Each vertex is attached with a weight $w_i$. Let $G_i$ be the graph after deleting the $i$-th vertex from graph $G$. Professor Zhang wants to find the weight of $G_1, G_2, ..., G_n$.<br><br>The weight of a graph $G$ is defined as follows:<br><br>1. If $G$ is connected, then the weight of $G$ is the product of the weight of each vertex in $G$.<br>2. Otherwise, the weight of $G$ is the sum of the weight of all the connected components of $G$.<br><br>A connected component of an undirected graph $G$ is a subgraph in which any two vertices are connected to each other by paths, and which is connected to no additional vertices in $G$.","type":"description","format":"html"},{"title":"Input","content":"There are multiple test cases. The first line of input contains an integer $T$, indicating the number of test cases. For each test case:<br><br>The first line contains two integers $n$ and $m$ $(2 \\le n \\le 10^5, 1 \\le m \\le 2 \\times 10^5)$ -- the number of vertices and the number of edges.<br><br>The second line contains $n$ integers $w_1, w_2, ..., w_n$ $(1 \\le w_i \\le 10^9)$, denoting the weight of each vertex.<br><br>In the next m lines, each contains two integers $x_i$ and $y_i$ $(1 \\le x_i, y_i \\le n, x_i \\ne y_i)$, denoting an undirected edge.<br><br>There are at most $1000$ test cases and $\\sum n, \\sum m \\le 1.5 \\times 10^6$.","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output an integer $S = (\\sum\\limits_{i=1}^{n}i\\cdot z_i) \\text{ mod } (10^9 + 7)$, where $z_i$ is the weight of $G_i$.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n3 2\n1 2 3\n1 2\n2 3</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">20</div></pre>","type":"example","format":"html"},{"title":"Author","content":"zimpha","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2016+Multi-University+Training+Contest+2&amp;source=1&amp;searchmode=source\"> 2016 Multi-University Training Contest 2 </a> ","type":"source","format":"html"}]}