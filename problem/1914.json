{"title":"The Stable Marriage Problem","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=1914","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=1914&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=1914","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=1914"},"statement":[{"title":"Problem Description","content":"The stable marriage problem consists of matching members of two different sets according to the member&#x2019;s preferences for the other set&#x2019;s members. The input for our problem consists of:<br><br>   a set M of n males;<br>   a set F of n females;<br><br>for each male and female we have a list of all the members of the opposite gender in order of preference (from the most preferable to the least).<br>A marriage is a one-to-one mapping between males and females. A marriage is called stable, if there is no pair (m, f) such that f &#x2208; F prefers m &#x2208; M to her current partner and m prefers f over his current partner. The stable marriage A is called male-optimal if there is no other stable marriage B, where any male matches a female he prefers more than the one assigned in A.<br><br>Given preferable lists of males and females, you must find the male-optimal stable marriage.<br><br>","type":"description","format":"html"},{"title":"Input","content":"The first line gives you the number of tests. The first line of each test case contains integer n (0 &lt; n &lt; 27). Next line describes n male and n female names. Male name is a lowercase letter, female name is an upper-case letter. Then go n lines, that describe preferable lists for males. Next n lines describe preferable lists for females.<br><br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case find and print the pairs of the stable marriage, which is male-optimal. The pairs in each test case must be printed in lexicographical order of their male names as shown in sample output. Output an empty line between test cases.<br><br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n3\na b c A B C\na:BAC\nb:BAC\nc:ACB\nA:acb\nB:bac\nC:cab\n3\na b c A B C\na:ABC\nb:ABC\nc:BCA\nA:bac\nB:acb\nC:abc</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">a A\nb B\nc C\n\na B\nb A\nc C</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=Southeastern+Europe+2007&amp;source=1&amp;searchmode=source\"> Southeastern Europe 2007 </a> ","type":"source","format":"html"}]}