{"title":"Period Sequence","time_limit":6000,"memory_limit":63.9990234375,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6303","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6303&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6303","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6303"},"statement":[{"title":"Problem Description","content":"Chiaki has $n$ integers $s_0,s_1,\\dots,s_{n-1}$. She has defined an infinite sequence $S$ in the following way: $S_k = s_{k \\bmod n} + n \\cdot \\lfloor \\frac{k}{n} \\rfloor$, where $k$ is a zero based index.<br><br>For a continuous subsequence $S[l..r]$, let $cnt_x$ be the number of occurrence of $x$ in the subsequence $S[l..r]$. Then the value of $S[l..r]$ is defined as follows $$f(l,r)=\\sum\\limits_{x}x \\cdot cnt^2_x$$<br><br>For two integers $a$ and $b$ ($a \\le b$), Chiaki would like to find the value of $$(\\sum\\limits_{a \\le l \\le r \\le b} f(l,r)) \\bmod (10^9+7)$$<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"There are multiple test cases. The first line of input contains an integer $T$, indicating the number of test cases. For each test case:<br>The first line contains three integers $n$, $a$ and $b$ ($1 \\le n \\le 2000, 0 \\le a \\le b \\le 10^{18}$).<br>The second line contains $n$ integers $s_0,s_1,\\dots,s_{n-1}$ ($0 \\le s_i \\le 10^9$).<br>It is guaranteed that the sum of all $n$ does not exceed $20000$.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, output an integer denoting the answer.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">4\n3 2 6\n2 1 3\n5 2 7\n2 1 5 1 2\n4 4 8\n2 1 5 17\n3 5 9\n2 5 2</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">179\n268\n369\n437</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2018+Multi-University+Training+Contest+1&amp;source=1&amp;searchmode=source\"> 2018 Multi-University Training Contest 1 </a> ","type":"source","format":"html","require":["katex"]}]}