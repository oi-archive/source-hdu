{"title":"Land of Farms","time_limit":1000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5556","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5556&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5556","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5556"},"statement":[{"title":"Problem Description","content":"Farmer John and his brothers have found a new land. They are so excited and decide to build new farms on the land. The land is a rectangle and consists of $N&#xFFFD;&#xFFFD;M$ grids. A farm consists of one or more connected grids. Two grids are adjacent if they share a common border, i.e. their Manhattan distance is exactly 1. In a farm, two grids are considered connected if there exist a series of adjacent grids, which also belong to that farm, between them.<br><br>Farmer John wants to build as many farms as possible on the new land. It is required that any two farms should not be adjacent. Otherwise, sheep from different farms would fight on the border. This should be an easy task until several ancient farms are discovered.<br><br>Each of the ancient farms also consists of one or more connected grids. Due to the respect to the ancient farmers, Farmer John do not want to divide any ancient farm. If a grid from an ancient farm is selected in a new farm, other grids from the ancient farm should also be selected in the new farm. Note that the ancient farms may be adjacent, because ancient sheep do not fight each other.<br><br>The problem is a little complicated now. Can you help Farmer John to find a plan with the maximum number of farms?<br>","type":"description","format":"html"},{"title":"Input","content":"The first line of input contains a number $T$ indicating the number of test cases ($T&#xFFFD;&#xFFFD;200$).<br><br>Each test case starts with a line containing two integers $N$ and $M$, indicating the size of the land. Each of the following $N$ lines contains $M$ characters, describing the map of the land ($1&#xFFFD;&#xFFFD;N,M&#xFFFD;&#xFFFD;10$). A grid of an ancient farm is indicated by a single digit (0-9). Grids with the same digit belong to the same ancient farm. Other grids are denoted with a single character &#xFFFD;&#xFFFD;<b>.</b>&#xFFFD;&#xFFFD;. It is guaranteed that all test cases are valid.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output a single line consisting of &#xFFFD;&#xFFFD;<b>Case #X: Y</b>&#xFFFD;&#xFFFD;. $X$ is the test case number starting from 1. $Y$ is the maximum number of new farms.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n3 4\n..3.\n023.\n.211\n2 3\n...\n...\n4 4\n1111\n1..1\n1991\n1111</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1: 4\nCase #2: 3\nCase #3: 1</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2015ACM%2FICPC%D1%C7%D6%DE%C7%F8%BA%CF%B7%CA%D5%BE-%D6%D8%CF%D6%C8%FC%A3%A8%B8%D0%D0%BB%D6%D0%BF%C6%B4%F3%A3%A9&amp;source=1&amp;searchmode=source\"> 2015ACM/ICPC&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#x3F7;&#xFFFD;&#x57E;-&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#x43B;&#xFFFD;&#x43F;&#x1B4;&#xFFFD; </a> ","type":"source","format":"html"}]}