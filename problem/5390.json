{"title":"tree","time_limit":8000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5390","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5390&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5390","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5390"},"statement":[{"title":"Problem Description","content":"Given a rooted tree(node 1 is the root) with $n$ nodes. The $i^{th}$node has a positive value $v_i$ at beginning.<br>We define the universal set $S$ includes all nodes.<br>There are two types of Memphis&apos;s operation.<br>First, Memphis may change the value of one node. It&apos;s the first type operation:<br>$$0~~u~~v~~~(u\\in S,0\\leq v\\leq 10^9)$$<br>What&apos;s more, Memphis wants to know what&apos;s the maxinum of $v_u\\otimes v_t(t\\in path(u,root),\\otimes~~means~~xor)$ . It&apos;s the second type operation:<br>$$1~~u~~~(u\\in S)$$","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"This problem has multi test cases(no more than $3$). <br>The first line contains a single integer $T$, which denotes the number of test cases.<br>For each test case,the first line contains two non-negative integer $n,m(1\\leq n,m\\leq 100000)$ - the number of nodes and operations.<br>The second line contains $n-1$ non-negative integer $f_2\\sim f_n(f_i &lt; i)$ - the father of $i^{th}$node.<br>The third line contains $n$ non-negative integer $v_1\\sim v_n(0\\leq v_i \\leq 10^9)$ - the value of nodes at beginning.<br>Follow $m$ lines describe each operation.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test cases,for each second operation print a non-negative integer.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n10 10\n1 1 2 2 3 1 2 3 5\n23512 460943 835901 491571 399045 97756 413210 800843 283274 106134\n0 7 369164\n0 7 296167\n0 6 488033\n0 7 187367\n0 9 734984\n1 6\n0 5 329287\n1 5\n0 7 798656\n1 10</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">766812\n351647\n431641</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Author","content":"SXYZ","type":"source","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2015+Multi-University+Training+Contest+8&amp;source=1&amp;searchmode=source\"> 2015 Multi-University Training Contest 8 </a> ","type":"source","format":"html","require":["katex"]}]}