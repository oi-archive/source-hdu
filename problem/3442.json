{"title":"Three Kingdoms","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3442","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3442&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3442","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3442"},"statement":[{"title":"Problem Description","content":"Three Kingdoms is a funny game. Often Liu Bei is weak and has to run away,so in the game Liu Bei has a skill called &quot;Dunzou&quot;. This time you are playing the role of Liu Bei.As Cao Cao&apos;s power is so strong, there is nothing  you can do but escaping. Please select an optimal path to achieve the purpose .<center><img style=\"max-width:100%;\" src=\"../../data/images/3442-1.jpg\"></center>To simplify the problem, Liu Bei can only move in one of the four direction (up, down,right,left) each time. The map contains the following characters:<br>&#x2018;A&#x2019; : Representative of watchtower, which has an attack range of  2(measured by Manhattan distance),and an attack damage of 1.<br>&#x2018;B&#x2019; : Representative of Fort, which has an attack range of 3(measured by Manhattan distance),and an attack damage of 2.<br>&#x2018;C&#x2019; : Representative of Flame, which has an attack damage of 3 to those who step onto it. <br>&#x2018;D&#x2019; : Representative of Archer, which has anattack range of 2(measured by Manhattan distance), and an attack damage of 4.<br>&#x2018;E&#x2019; : Representative of Ordinary soldier, which has anattack range of 1(measured by Manhattan distance), and an attack damage of 5.<br>&#x2018;$&#x2019; : Representative of Liu Bei.<br>&#x2018;!&#x2019; : Representative of Destination.<br>&apos;#&apos; : Representative of obstacles<br>&#x2018;.&#x2019; : Representative of floor.<br>Liu Bei can not enter watchtower, forts, Archers, ordinary soldiers,But he can step onto flame or floor.<br>Some important rules you should note:<br>1.&#xA0;&#xA0;Liu Bei will not be hurt by the same thing twice.For example,if Liu Bei has been hurt by one watchtower before,then he step into the attack range of some watchtower later,he will not be hurt. <br>2.&#xA0;&#xA0;When Liu Bei reach the destination,you should first judge the attack damage at the destination then finish the game.<br>3.&#xA0;&#xA0;You needn&#x2019;t judge the attack damage at the start position.<br> Please choose a path which LiuBei would cost the least HP.<br>","type":"description","format":"html"},{"title":"Input","content":"In the first line there is an integer T, indicates the number of test cases.(T&lt;=60)<br>In each case,the first line of the input contains two integer n,m(1&lt;=n,m&lt;=50),reperesenting the size of map(n*m).Then follow n lines,each line contain m characters.<br>There may be some blank lines between each case.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case , output &#x201C;Case d:  &#x201C; where d is the case number counted from one.If Liu Bei can reach the destination then output the minimum HP LiuBei may lose, otherwise output -1.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n4 3\n.$.\nACB\nACB\n.!.</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1: 6</div></pre>","type":"example","format":"html"},{"title":"Author","content":"jwq","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2010+ACM-ICPC+Multi-University+Training+Contest%A3%A81%A3%A9%A1%AA%A1%AAHost+by+FZU&amp;source=1&amp;searchmode=source\"> 2010 ACM-ICPC Multi-University Training Contest&#xFF08;1&#xFF09;&#x2014;&#x2014;Host by FZU </a> ","type":"source","format":"html"}]}