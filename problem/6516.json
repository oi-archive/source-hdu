{"title":"Network","time_limit":4000,"memory_limit":20,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6516","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6516&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6516","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6516"},"statement":[{"title":"Problem Description","content":"Mr. X is a network administrator, though the network structure is pretty complicated, in this problem, we just simply think of it as a tree. So we can think there are $~n~$ network nodes, and between them, there are $~n-1~$ edges, each edge connects two nodes, and have a transfer speed $~Speed_i~$.<br><br>According to the definition of the tree structure, we know that there is a unique path between any two nodes $~u~$ and $~v~$, when node $~u~$ want to send some messages to $~v~$ over the network, the messages will be transmitted along this simple path, and the total transmission speed is determind by the speed of the slowest edge of the path, while the speed of other edge doesn&apos;t matter, so we can define the <i>&apos;waste speed&apos;</i> of path $Path(u, v)$ as $Waste(u, v) = max(Speed_i) - min(Speed_i)$.<br><br>There are some resource nodes in the network, and others are user nodes, for every user node $~u~$, we can define it&apos;s <i>&apos;maximum waste resource node&apos;</i><br><br>$$MWRN(u) = argmax_{v \\in resource\\_node}(Waste(u, v))$$<br><br>And we use $~min(Waste(u, MWRN(u)))~$ as &apos;network evaluation value&apos; to evaluate a network structure, the worse we think the network structure is. If there is no user node, the value will be zero, the higher this value is.<br><br>Now, Mr. X knows that the campany wants to turn a user node into a resource node, but he didn&apos;t know which one will be changed. In order to prepare for the worst situation, he wants to know, if the company choose the worst node to change, how worse the network structure will be. Which means you need to give the maximum value of the <i>&apos;network evaluation value&apos;</i> among all possible situations.","type":"description","format":"html"},{"title":"Input","content":"The first line contains one integer $~n(1 \\leq n \\leq 10^5)~$<br><br>The second line contains $~n~$ integer, the $~i_{th}~$ integer show the node type for the $i_{th}$ node, $~0~$ for user node and $~1~$ for resource node.<br><br>Then follow $~n-1~$ lines, each line contains three integers $~u, v, t~$, means there is a edge connects the $~u_{th}~$ node and the $~v_{th}~$ node, and the transfer speed is $~t(1 \\leq t \\leq 10^9)~$.","type":"input_format","format":"html"},{"title":"Output","content":"One line contains two integers $~a~$ and $~b~$, which means if the company choose the $~a_{th}~$ node, the situation will be the worst, and in this case, the \\emph{`network evaluation value&apos;} is $~b~$. If there are multiple solutions, output one with smallest $~a~$.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">10 \n0 0 0 0 0 0 1 0 0 0 \n2 1 10 \n3 1 7 \n4 1 3 \n5 2 18 \n6 4 5 \n7 4 18 \n8 7 19 \n9 2 6 \n10 7 20</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5 16\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>the data guarantee that there is at least one user node.\nthe arguments of the maxima (abbreviated argmax) are the points of the domain of some function at which the function values are maximized.</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2019%D6%D0%C9%BD%B4%F3%D1%A7%B3%CC%D0%F2%C9%E8%BC%C6%BE%BA%C8%FC%A3%A8%D6%D8%CF%D6%C8%FC%A3%A9&amp;source=1&amp;searchmode=source\"> 2019&#xFFFD;&#xFFFD;&#x27D;&#xFFFD;&#xFFFD;&#x467;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#x1BE;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD; </a> ","type":"source","format":"html"}]}