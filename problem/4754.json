{"title":"Spacecraft Monitoring","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4754","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4754&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4754","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4754"},"statement":[{"title":"Problem Description","content":"&#xA0;&#xA0;In recent years, China&apos;s space industry has made rapid development, and recently launched the manned spacecraft shenzhou 10. Beauty Astronaut Wang Yaping even made a lesson in the spacecraft to the whole world. It means a lot to China&apos;s space communication. And the Nanjing University of Science and Technology also contribute their strength in communication, radar and detecting guidance.<br>&#xA0;&#xA0;Today, there have been many aircrafts in space, they are communicating with each other in air, or with the ground monitoring points in ground (including fixed and mobile monitoring point). To simplify the problem, we assume that all the aircrafts and ground monitoring points are all in the equatorial plane. Aircrafts are all in synchronous orbit, suppose the earth&#xFFFD;&#xFFFD;s core as point (0, 0). We already know:<br>&#xA0;&#xA0;Every aircraft&#xFFFD;&#xFFFD;s or ground monitoring point&#xFFFD;&#xFFFD;s height R relative to the earth&#xFFFD;&#xFFFD;s core, initial angle A (rad), and some communication relationship between them. <br>&#xA0;&#xA0;Also every aircraft&#xFFFD;&#xFFFD;s or ground monitoring point&#xFFFD;&#xFFFD;s cost price P.<br>&#xA0;&#xA0;And the ground-to-ground price per unit distance: dd, ground-to-air price per unit distance: dk (air-to-ground the same), air-to-air price per unit distance: kk.<br>&#xA0;&#xA0;In order to know the general condition of the system, you should calculate the maximal average cost price of some aircrafts or ground monitoring points. The average cost price = (the sum of aircrafts&#xFFFD;&#xFFFD; or ground monitoring points&#xFFFD;&#xFFFD; cost price + communication cost price between them if it&apos;s existing)/(the amount of the aircrafts or ground monitoring points)<br>","type":"description","format":"html"},{"title":"Input","content":"&#xA0;&#xA0;Multiple cases, end with EOF;<br>&#xA0;&#xA0;The first line, 4 positive integers, n, dd, dk, kk, there is n aircrafts or ground monitoring points, dd, dk, kk is the same with description above. Remember that we first calculate the distance between two objects into integer, four to five homes in rounding, then calculate the communication cost price.<br><br>&#xA0;&#xA0;Next n lines, each represents an aircraft or ground monitoring point, <br>if the first letter is &#xFFFD;&#xFFFD;d&#xFFFD;&#xFFFD;, it means &#xFFFD;&#xFFFD;ground monitoring point&#xFFFD;&#xFFFD; in ground, <br>if the first letter is &#xFFFD;&#xFFFD;k&#xFFFD;&#xFFFD;, it means &#xFFFD;&#xFFFD;aircraft&#xFFFD;&#xFFFD;in air, <br>then R,A,P, described above.<br><br>&#xA0;&#xA0;Next an integer m, the amount of communication relationship.<br>&#xA0;&#xA0;Next m lines, each line is like x, B, y, C (1&lt;=B, C&lt;=n,  x, y = &#xFFFD;&#xFFFD;d&#xFFFD;&#xFFFD; or &#xFFFD;&#xFFFD;k&#xFFFD;&#xFFFD;), represents object B is communicated with object C, B&#xFFFD;&#xFFFD;s type is x, C&#xFFFD;&#xFFFD;s type is y; B,C is the sequence number in particular kind (&apos;d&apos; or &apos;k&apos;) listed above, starts from 1.<br>&#xA0;&#xA0;1&lt;=n&lt;=300, 0&lt;=m&lt;=n*n, 1&lt;=dd,dk,kk&lt;=10^6, R&#xFFFD;&#xFFFD;A are floating numbers, 0&lt;=R&lt;=1000, <br>0&lt;=A&lt;2*PI, 1&lt;=P&lt;=10^6&#xFFFD;&#xFFFD;<br>&#xA0;&#xA0;PS: communication between two points is considered as a segment.<br>","type":"input_format","format":"html"},{"title":"Output","content":"&#xA0;&#xA0;After &#xFFFD;&#xFFFD;Case #&#xFFFD;&#xFFFD; + case number + &#xFFFD;&#xFFFD;: &#xFFFD;&#xFFFD;, case number starts from 1, Output 2 numbers, separated by a blank space, first is the maximal average cost price, next is the amount of this part. The result should be corrected to four decimal places.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2 1000 2000 3000\nd 2 0 1\nd 3 0 4\n1\nd 1 d 2</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1: 502.5000 2</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2013+ACM%2FICPC+Asia+Regional+Nanjing+Online&amp;source=1&amp;searchmode=source\"> 2013 ACM/ICPC Asia Regional Nanjing Online </a> ","type":"source","format":"html"}]}