{"title":"Problem G. Depth-First Search","time_limit":5000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6338","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6338&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6338","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6338"},"statement":[{"title":"Problem Description","content":"Kazari is learning <b>depth-first search</b>. More precisely, she is doing an experiment about it.<br>Consider an unrooted tree with $n$ vertices and an empty array called $A$.<br>She randomly chooses a vertex $s$ as root and starts from $s$ to walk around, following the rules below.<br>* When she enters a vertex $x$ for the first time, she append $x$ to $A$ at once.<br>* If some adjacent vertex has not been visited, she randomly chooses one and walks into it.<br>* If all adjacent vertices have been visited,<br>  * If she is at root, the experiment is done.<br>  * If she is not at root, she walks into the vertex which is the most nearest to root.<br>Among all possible arrays that $A$ is likely to be finally, Kazari wishes to count how many of them is lexicographically smaller than the given array $B$. Since the answer is too large, print it modulo $10 ^ 9 + 7$.","type":"description","format":"html"},{"title":"Input","content":"The first line of the input contains an integer $T$ denoting the number of test cases.<br>Each test case starts with a positive integer $n$ $(\\sum{n} \\le 10 ^ 6)$, denoting the number of vertices.<br>The second line contains $n$ integers $B_1, B_2, ..., B_n$ $(1 \\le B_i \\le n, \\forall i \\neq j, B_i \\neq B_j)$.<br>Each of next $n - 1$ lines contains two integers $u, v$, representing an edge $(u, v)$ on the tree.","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, print a non-negative integer denoting the answer modulo $10 ^ 9 + 7$.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\t\t\t\t\t\n5\t\t\t\t\t\n2 1 3 5 4\t\n1 2\t\t\t\t\n2 3\t\t\t\t\n2 4\t\t\t\t\n4 5\t\t\t\t\n6\t\t\n6 4 5 3 2 1\n1 2\t\t\t\t\n2 3\t\t\t\t\n3 4\t\t\t\t\n4 5\t\t\t\t\n5 6</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n9</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2018+Multi-University+Training+Contest+4&amp;source=1&amp;searchmode=source\"> 2018 Multi-University Training Contest 4 </a> ","type":"source","format":"html"}]}