{"title":"A new Graph Game","time_limit":4000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3435","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3435&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3435","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3435"},"statement":[{"title":"Problem Description","content":"An undirected graph is a graph in which the nodes are connected by undirected arcs. An undirected arc is an edge that has no arrow. Both ends of an undirected arc are equivalent--there is no head or tail. Therefore, we represent an edge in an undirected graph as a set rather than an ordered pair.<br>Now given an undirected graph, you could delete any number of edges as you wish. Then you will get one or more connected sub graph from the original one (Any of them should have more than one vertex).<br>You goal is to make all the connected sub graphs exist the Hamiltonian circuit after the delete operation. What&#x2019;s more, you want to know the minimum sum of all the weight of the edges on the &#x201C;Hamiltonian circuit&#x201D; of all the connected sub graphs (Only one &#x201C;Hamiltonian circuit&#x201D; will be calculated in one connected sub graph! That is to say if there exist more than one &#x201C;Hamiltonian circuit&#x201D; in one connected sub graph, you could only choose the one in which the sum of weight of these edges is minimum).<br>&#xA0;&#xA0;For example, we may get two possible sums:<br><center><img style=\"max-width:100%;\" src=\"../../data/images/3435-1.jpg\"></center> <br>(1)&#xA0;&#xA0;7 + 10 + 5 = 22<br>(2)&#xA0;&#xA0;7 + 10 + 2 = 19<br>(There are two &#x201C;Hamiltonian circuit&#x201D; in this graph!)","type":"description","format":"html"},{"title":"Input","content":"In the first line there is an integer T, indicates the number of test cases. (T &lt;= 20)<br>In each case, the first line contains two integers n and m, indicates the number of vertices and the number of edges. (1 &lt;= n &lt;=1000, 0 &lt;= m &lt;= 10000)<br>Then m lines, each line contains three integers a,b,c ,indicates that there is one edge between a and b, and the weight of it is c . (1 &lt;= a,b &lt;= n, a is not equal to b in any way, 1 &lt;= c &lt;= 10000)<br>","type":"input_format","format":"html"},{"title":"Output","content":"Output &#x201C;Case %d: &#x201C;first where d is the case number counted from one. Then output &#x201C;NO&#x201D; if there is no way to get some connected sub graphs that any of them exists the Hamiltonian circuit after the delete operation. Otherwise, output the minimum sum of weight you may get if you delete the edges in the optimal strategy.<br><br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n\n3 4\n1 2 5\n2 1 2\n2 3 10\n3 1 7 \n\n3 2\n1 2 3\n1 2 4\n\n2 2\n1 2 3\n1 2 4</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1: 19\nCase 2: NO\nCase 3: 6\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>In Case 1:\nYou could delete edge between 1 and 2 whose weight is 5. \n\nIn Case 2:\nIt&#x2019;s impossible to get some connected sub graphs that any of them exists the Hamiltonian circuit after the delete operation.</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Author","content":"AekdyCoin","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2010+ACM-ICPC+Multi-University+Training+Contest%A3%A81%A3%A9%A1%AA%A1%AAHost+by+FZU&amp;source=1&amp;searchmode=source\"> 2010 ACM-ICPC Multi-University Training Contest&#xFF08;1&#xFF09;&#x2014;&#x2014;Host by FZU </a> ","type":"source","format":"html"}]}