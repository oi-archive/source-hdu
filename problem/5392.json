{"title":"Infoplane in Tina Town","time_limit":7000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5392","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5392&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5392","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5392"},"statement":[{"title":"Problem Description","content":"There is a big stone with smooth surface in Tina Town. When people go towards it, the stone surface will be lighted and show its usage. This stone was a legacy and also the center of Tina Town&#x2019;s calculation and control system. also, it can display events in Tina Town and contents that pedestrians are interested in, and it can be used as public computer. It makes people&#x2019;s life more convenient (especially for who forget to take a device).<br><br>Tina and Town were playing a game on this stone. First, a permutation of numbers from $1$ to $n$ were displayed on the stone. Town exchanged some numbers randomly and Town recorded this process by macros. Town asked Tine,&#x201D;Do you know how many times it need to turn these numbers into the original permutation by executing this macro? Tina didn&#x2019;t know the answer so she asked you to find out the answer for her.<br><br>Since the answer may be very large, you only need to output the answer modulo $3*{2}^{30}+1=3221225473$ (a prime).<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line is an integer $T$ representing the number of test cases. $ T \\leq 5$<br><br>For each test case, the first line is an integer $n$ representing the length of permutation. $ n \\leq 3*{10}^{6} $<br><br>The second line contains $n$ integers representing a permutation $A_1...A_n$. It is guaranteed that numbers are different each other and all $A_i$ satisfies  ( $1 \\leq A_i \\leq n$ ).<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, print a number $ans$ representing the answer.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n3\n1 3 2\n6\n2 3 4 5 6 1</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n6</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=BestCoder+Round+%2351+%28div.2%29&amp;source=1&amp;searchmode=source\"> BestCoder Round #51 (div.2) </a> ","type":"source","format":"html","require":["katex"]}]}