{"title":"T9","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=1298","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=1298&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=1298","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=1298"},"statement":[{"title":"Problem Description","content":"A while ago it was quite cumbersome to create a message for the Short Message Service (SMS) on a mobile phone. This was because you only have nine keys and the alphabet has more than nine letters, so most characters could only be entered by pressing one key several times. For example, if you wanted to type &quot;hello&quot; you had to press key 4 twice, key 3 twice, key 5 three times, again key 5 three times, and finally key 6 three times. This procedure is very tedious and keeps many people from using the Short Message Service.<br><br>This led manufacturers of mobile phones to try and find an easier way to enter text on a mobile phone. The solution they developed is called T9 text input. The &quot;9&quot; in the name means that you can enter almost arbitrary words with just nine keys and without pressing them more than once per character. The idea of the solution is that you simply start typing the keys without repetition, and the software uses a built-in dictionary to look for the &quot;most probable&quot; word matching the input. For example, to enter &quot;hello&quot; you simply press keys 4, 3, 5, 5, and 6 once. Of course, this could also be the input for the word &quot;gdjjm&quot;, but since this is no sensible English word, it can safely be ignored. By ruling out all other &quot;improbable&quot; solutions and only taking proper English words into account, this method can speed up writing of short messages considerably. Of course, if the word is not in the dictionary (like a name) then it has to be typed in manually using key repetition again.<br><br><center><img style=\"max-width:100%;\" src=\"/data/images/1298-1.gif\"><br>Figure 8: The Number-keys of a mobile phone.</center><br><br>More precisely, with every character typed, the phone will show the most probable combination of characters it has found up to that point. Let us assume that the phone knows about the words &quot;idea&quot; and &quot;hello&quot;, with &quot;idea&quot; occurring more often. Pressing the keys 4, 3, 5, 5, and 6, one after the other, the phone offers you &quot;i&quot;, &quot;id&quot;, then switches to &quot;hel&quot;, &quot;hell&quot;, and finally shows &quot;hello&quot;.<br><br>Write an implementation of the T9 text input which offers the most probable character combination after every keystroke. The probability of a character combination is defined to be the sum of the probabilities of all words in the dictionary that begin with this character combination. For example, if the dictionary contains three words &quot;hell&quot;, &quot;hello&quot;, and &quot;hellfire&quot;, the probability of the character combination &quot;hell&quot; is the sum of the probabilities of these words. If some combinations have the same probability, your program is to select the first one in alphabetic order. The user should also be able to type the beginning of words. For example, if the word &quot;hello&quot; is in the dictionary, the user can also enter the word &quot;he&quot; by pressing the keys 4 and 3 even if this word is not listed in the dictionary.<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line contains the number of scenarios.<br><br>Each scenario begins with a line containing the number w of distinct words in the dictionary (0&lt;=w&lt;=1000). These words are given in the next w lines. (They are not guaranteed in ascending alphabetic order, although it&apos;s a dictionary.) Every line starts with the word which is a sequence of lowercase letters from the alphabet without whitespace, followed by a space and an integer p, 1&lt;=p&lt;=100, representing the probability of that word. No word will contain more than 100 letters.<br><br>Following the dictionary, there is a line containing a single integer m. Next follow m lines, each consisting of a sequence of at most 100 decimal digits 2-9, followed by a single 1 meaning &quot;next word&quot;.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"The output for each scenario begins with a line containing &quot;Scenario #i:&quot;, where i is the number of the scenario starting at 1.<br><br>For every number sequence s of the scenario, print one line for every keystroke stored in s, except for the 1 at the end. In this line, print the most probable word prefix defined by the probabilities in the dictionary and the T9 selection rules explained above. Whenever none of the words in the dictionary match the given number sequence, print &quot;MANUALLY&quot; instead of a prefix.<br><br>Terminate the output for every number sequence with a blank line, and print an additional blank line at the end of every scenario.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n5\nhell 3\nhello 4\nidea 8\nnext 8\nsuper 3\n2\n435561\n43321\n7\nanother 5\ncontest 6\nfollow 3\ngive 13\ninteger 6\nnew 14\nprogram 4\n5\n77647261\n6391\n4681\n26684371\n77771</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Scenario #1:\ni\nid\nhel\nhell\nhello\n\ni\nid\nide\nidea\n\n\nScenario #2:\np\npr\npro\nprog\nprogr\nprogra\nprogram\n\nn\nne\nnew\n\ng\nin\nint\n\nc\nco\ncon\ncont\nanoth\nanothe\nanother\n\np\npr\nMANUALLY\nMANUALLY</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=Northwestern+Europe+2001&amp;source=1&amp;searchmode=source\"> Northwestern Europe 2001 </a> ","type":"source","format":"html","require":["katex"]}]}