{"title":"A Hard Journey","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3865","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3865&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3865","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3865"},"statement":[{"title":"Problem Description","content":"ChenX was taken away by the arch devil, so the sharp shooter Brother Zheng was going to rescue him. The enemy&#xFFFD;&#xFFFD;s army was distributed in an N * N grid, and each grid also can be divided in M * M small grids.<br><br>Brother Zheng&apos;s army has two kinds of attack form : from top to bottom, or from left to right. The weapon they use is Break-Cloud arrow, so each arrow will cost P fighting strength to eliminate a row or a column enemies in a big grid.<br><br>Notice that they can change the attack form at any time, and when they once change their attack form, they will use Q fighting strength.<br><br>The initial position of Brother Zheng is at the top-left corner, and ChenX was locked by arch devil at the right-bottom corner. When once make a move, Brother Zheng should eliminate all the enemies in the current big grid. If the current attack form is from top to bottom, then they can move onto the right grid of the big grid; if the current attack form is from left to right, then they can move onto the bottom grid of the big grid. The initial attack form can be either of the two.<br><br>Now Brother Zheng want to know how much the least fighting strength is so that can rescue ChenX.<br><br>For the case as the followed picture, N = 2, M = 3, P = 2, Q = 1.<br>Brother Zheng choices to start with the attack form: from top to bottom. It takes P * 1 fighting strength to eliminate all the enemies at grid[1][1]. Then Brother Zheng changed attack form to &#xFFFD;&#xFFFD;from left to right&#xFFFD;&#xFFFD; using Q fighting strength, and moved to the bottom grid[2][1]. To eliminate all the enemies, it takes P * 2 fighting strength. Then Brother Zheng changed attack form to &#xFFFD;&#xFFFD;from top to bottom&#xFFFD;&#xFFFD; using Q fighting strength, and moved to the right grid[2][2], after used P * 3 fighting strength to eliminate this grid, ChenX was rescue with P * 1 + Q + P * 2 + Q + P * 3 = 14 fighting strength.<br><center><img style=\"max-width:100%;\" src=\"../../data/images/C352-1007-1.jpg\"></center>","type":"description","format":"html"},{"title":"Input","content":"For each case, the first line contains 4 integers: N, M, P, Q(0 &lt; N &lt;= 20, 0 &lt; M &lt;= 15, 0 &lt;= P &lt;= 20, 0 &lt;= Q &lt;= 20), the next N * N blocks, each block contains M * M matrixes, rows first.","type":"input_format","format":"html"},{"title":"Output","content":"For each case, output one integer which indicates the least fighting strength.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2 3 2 1\n0 0 1\n0 0 1\n0 0 1\n1 1 1\n1 1 1\n1 1 1\n0 1 1\n0 0 0\n1 1 1\n1 0 0\n0 1 0\n0 0 1\n1 3 3 1\n0 0 1\n0 0 1\n1 1 1</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">14\n7</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2011+Multi-University+Training+Contest+3+-+Host+by+BIT&amp;source=1&amp;searchmode=source\"> 2011 Multi-University Training Contest 3 - Host by BIT </a> ","type":"source","format":"html"}]}