{"title":"Diameter of a Tree","time_limit":10000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6451","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6451&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6451","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6451"},"statement":[{"title":"Problem Description","content":"Given a weighted tree $T_0$, we define its diameter as the length of the longest path between two vertices on it, where the length of a path is equal to the sum of weights of edges in the path.<br><br>If the tree stretches like a spider or a yawning tiger, its diameter will change.<br>Let&apos;s use $T_i$ to denote the state of the tree after $i$ seconds, at which time the weight of each edge has been increased by exactly $i$ units from $T_0$.<br><br>You will be presented with several different queries, and you should calculate the tree&apos;s diameter at some specified time for each query.<br>","type":"description","format":"html"},{"title":"Input","content":"The input contains several test cases, and the first line contains a positive integer $T$ indicating the number of test cases which is up to $60$.<br><br>For each test case, the first line contains two integers $n$ and $m$ indicating the number of vertices in the tree and the number of given queries respectively, where $2 \\le n \\le 2 \\times 10^5$ and $1 \\le m \\le 2 \\times 10^5$.<br><br>Each of the following $(n - 1)$ lines contains three integers $u, v$ and $w$ which represent an edge in the original tree between the $u$-th vertex and the $v$-th one of weight $w$, where $1 \\le u, v \\le n$, $u \\ne v$ and $1 \\le w \\le 10^8$.<br><br>Each of the following $m$ lines describes a query containing only one integer $k$ that asks you to calculate the diameter of the tree $T_k$, where $0 \\le k \\le 10^9$.<br><br>We guarantee that the sum of $n$ in all test cases is no larger than $10^6$, and the sum of $m$ in all test cases is no larger than $10^6$ as well.<br><br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output a line containing &quot;Case #x:&quot; (without quotes) at first, where $x$ is the test case number starting from $1$.<br><br>Then output $m$ lines corresponding to all queries.<br>The $i$-th line of them contains an integer indicating the answer to the $i$-th query","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n3 3\n1 2 1\n1 3 5\n5\n10\n100\n5 6\n1 2 100\n2 3 5\n2 4 1\n4 5 1\n0\n1\n2\n3\n4\n5</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1:\n16\n26\n206\nCase #2:\n105\n107\n109\n111\n114\n117\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nIn the second sample case:\nthe diameter of T0 is 105, which is the length of the path 1 - 2 - 3 and \nthe diameter of T5 is 117, which is the length of the path 1 - 2 - 4 - 5.\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=The+43rd+ACM+International+Collegiate+Programming+Contest+Asia+Shenyang+Regional+Contest&amp;source=1&amp;searchmode=source\"> The 43rd ACM International Collegiate Programming Contest Asia Shenyang Regional Contest </a> ","type":"source","format":"html"}]}