{"title":"Porcelain Exhibitions","time_limit":2000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4129","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4129&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4129","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4129"},"statement":[{"title":"Problem Description","content":"Recently, the Chinese government is going to hold a porcelain exhibition in every province.<br>For fascinating citizens, each exhibition should put at least MIN_K porcelains on show. And by the restriction of conditions, at most MAX_K porcelains can be shown in an exhibition.<br><br>The number of porcelains in a province is in direct proportion to the area of that province. So some small provinces may don&apos;t have enough porcelains, and some big provinces may have more porcelains than it can show(having too much porcelains is not a problem for holding an exhibition, just don&#x2019;t show some of them). The government decides to transport some porcelains between provinces so that every province can hold an exhibition.<br><br>Because of the limitation of traffic, the amount of porcelains passing a boundary between two provinces is limited. So the government asks you to write a program to manage the transportation.<br><br>The map of China can be seen as a connected planar graph embedded on a plane. Each face of the graph represents a province. This graph has N vertices and M edges. A vertex of the graph is also a point on the map, and an edge is also a line segment connecting two points, meaning a boundary between two provinces.<br>","type":"description","format":"html"},{"title":"Input","content":"The input will consist of multiply test cases. For each case, The first line contains five positive integers --- above mentioned N, M, MIN_K,MAX_K and P( N &lt;= 1000,M &lt;= 10000, MIN_K &lt; MAX_K) . P means that if the area of a province is A, then there are A&#xD7;P porcelains in that province. P is guaranteed to be even so that the amount of porcelains in each province will be a positive integer.<br><br>The next N lines, each gives two integer x, y, representing the coordinate of a vertex(Vertexes have distinct coordinates). The vertexes are numbered from 0 to N-1 and the coordinates are given in the order of vertex No. <br><br>The next M lines, each gives three integers u,v, and w. It means that there is an edge connecting vertex u and vertex v. The edge is also a boundary between two provinces. w means that the boundary can&#x2019;t let more than w porcelains to pass through. (w for the boundary of China is 0, and boundaries don&apos;t overlap). The number of province is less than 2000.<br>Unsigned int is enough for this problem. The input ends with 0 0 0 0 0.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, print one integer in a line representing the maximal number of porcelains can be exhibited in whole country. If one or more province can&#x2019;t hold an exhibition, print -1.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">8 9 5 8 2\n0 0\n0 3\n3 3\n3 0\n1 1\n1 2\n2 2\n2 1\n0 1 0\n1 2 0\n2 3 0\n3 0 0\n4 5 1\n5 6 1\n6 7 1\n7 4 1\n0 4 1\n8 9 7 8 2\n0 0\n0 3\n3 3\n3 0\n1 1\n1 2\n2 2\n2 1\n0 1 0\n1 2 0\n2 3 0\n3 0 0\n4 5 1\n5 6 1\n6 7 1\n7 4 1\n0 4 1\n0 0 0 0 0</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">14\n-1</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2011+Asia+Fuzhou+Regional+Contest+&amp;source=1&amp;searchmode=source\"> 2011 Asia Fuzhou Regional Contest  </a> ","type":"source","format":"html"}]}