{"title":"Problem J. Rectangle Radar Scanner","time_limit":15000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6328","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6328&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6328","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6328"},"statement":[{"title":"Problem Description","content":"There are $n$ houses on the ground, labeled by $1$ to $n$. The $i$-th house is located at $(i,y_i)$, and there is a spy transmitter with energy $w_i$ inside the $i$-th house.<br>Little Q has a rectangle radar scanner, which can find all the transmitters within the range $[xl,xr]\\times[yl,yr]$. That means a transmitter located at $(x,y)$ can be found if $xl\\leq x\\leq xr$ and $yl\\leq y\\leq yr$.<br>Your task is to achieve the scanner efficiently.<br>Given $m$ queries $xl_i,xr_i,yl_i,yr_i$, for each query, please find all the transmitters within the range, then report the product of their energy and the maximum/minimum energy among them.<br>To reduce the large input, we will use the following generator. The numbers $a_0,b_0,c_0,d_0,p,q,r$ and $MOD$ are given initially. The values $a_i,b_i,c_i,d_i,xl_i,xr_i,yl_i,yr_i$ are then produced as follows :<br>\\begin{eqnarray*}<br>a_i&amp;=&amp;(p\\times a_{i-1}+q\\times b_{i-1}+r)\\bmod MOD\\\\<br>b_i&amp;=&amp;(p\\times b_{i-1}+q\\times a_{i-1}+r)\\bmod MOD\\\\<br>c_i&amp;=&amp;(p\\times c_{i-1}+q\\times d_{i-1}+r)\\bmod MOD\\\\<br>d_i&amp;=&amp;(p\\times d_{i-1}+q\\times c_{i-1}+r)\\bmod MOD\\\\<br>xl_i&amp;=&amp;\\min(a_i\\bmod n,b_i\\bmod n)+1\\\\<br>xr_i&amp;=&amp;\\max(a_i\\bmod n,b_i\\bmod n)+1\\\\<br>yl_i&amp;=&amp;\\min(c_i\\bmod n,d_i\\bmod n)+1\\\\<br>yr_i&amp;=&amp;\\max(c_i\\bmod n,d_i\\bmod n)+1<br>\\end{eqnarray*}<br>","type":"description","format":"html"},{"title":"Input","content":"The first line of the input contains an integer $T(1\\leq T\\leq3)$, denoting the number of test cases.<br>In each test case, there is an integer $n(1\\leq n\\leq 100000)$ in the first line, denoting the number of houses.<br>In the next $n$ lines, each line contains $2$ integers $y_i,w_i(1\\leq y_i\\leq n,1\\leq w_i\\leq 10^9)$, describing a house.<br>Then in the next line, there are $10$ integers $m,a_0,b_0,c_0,d_0,p,q,r,MOD,k$, describing the queries. It is guaranteed that $1\\leq m\\leq 10^6$ and $5\\leq a_0,b_0,c_0,d_0,p,q,r,MOD,k\\leq 10^9$.<br>","type":"input_format","format":"html"},{"title":"Output","content":"Since the output file may be very large, let&apos;s denote $prod_i$ as the product of of the $i$-th query, $max_i$ as the maximum energy of the $i$-th query, and denote $min_i$ as the minimum energy of the $i$-th query. Note that when there are no avaliable transmitters, then $prod_i=max_i=min_i=0$.<br>For each test case, you need to print a single line containing an integer $answer$, where :<br>\\begin{eqnarray*}<br>answer&amp;=&amp;\\sum_{i=1}^{m} ((prod_i\\bmod k)\\oplus max_i\\oplus min_i)<br>\\end{eqnarray*}<br>Note that ``$\\oplus$&apos;&apos; denotes binary XOR operation.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\t\t\t\t\t\t\t\t\t\n5\t\t\t\t\t\t\t\t\t\n2 6\t\t\t\t\t\t\t\t\n1 8\t\t\t\t\t\t\t\t\n5 2\t\t\t\t\t\t\t\t\n4 9\t\t\t\t\t\t\t\t\n2 4\t\t\t\t\t\t\t\t\n3 5 6 7 8 9 8 7 998244353 10007</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">68</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2018+Multi-University+Training+Contest+3&amp;source=1&amp;searchmode=source\"> 2018 Multi-University Training Contest 3 </a> ","type":"source","format":"html"}]}