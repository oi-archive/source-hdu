{"title":"Funny String","time_limit":15000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6815","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6815&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6815","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6815"},"statement":[{"title":"Problem Description","content":"You are given a string $S$ with length $n$. And it is guaranteed that <b> $S_i$ $\\in$ $[1,m]$ </b> for $i$ from $1$ to $n$.<br><br>Denote $suf(S,i)$ as the suffix of $S$ with length $n-i+1$. In other words,$suf(S,i)=S_iS_{i+1}...S_n$.<br><br>Each time you will be asked one of the following questions:<br><br>1.Given a character $c$ and an integer $i$. Then you will obtain a new string $T$ by inserting the character $c$ to the <b>front</b> of $S$ (namely $T=cS_1S_2...S_n$ ). What is the rank of $suf(T,i)$ among all the $suf(T,k)$ ($k\\in[1,n+1]$) in lexicographical order.<br><br>2.Given a character $c$ and an integer $i$. Then you will obtain a new string $T$ by inserting the character $c$ to the <b>back</b> of $S$ (namely $T=S_1S_2...S_nc$ ). What is the rank of $suf(T,i)$ among all the $suf(T,k)$ ($k\\in[1,n+1]$) in lexicographical order.<br><br>Notice, we just want to find the answer of each question and won&apos;t really add the character $c$ to the string $S$. In other words, each question is <b>independent</b>.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line contains a single integer $T(1 \\leq T \\leq 30)$ , the number of test cases.<br><br>For each test case, the first line gives three integers $n$, $m$ and $q$ ($1 \\leq n,m,q \\leq 10^6$). $n$ is the length of string $S$, each character $S_i$ $\\in$ $[1,m]$ and $q$ is the number of questions.<br><br>The next line gives the string $S$ that consists of $n$ positive integers which are in $[1,m]$.<br><br>Each of the following $q$ lines consists of three integers $t,c,i(1 \\leq t \\leq 2,1 \\leq c \\leq m,1 \\leq i \\leq n+1)$, representing the type of this question is $1$ if $t=1$ and $2$ if $t=2$.<br><br><b>Note that $c$ and $i$ is encrypted.</b> Assuming $last$ is the previous query answer, the actual values of $c$ and $i$ are $c \\oplus last$ and $i \\oplus last$ ($\\oplus$ denotes the exclusive or operation). For the first query , $last = 0$.<br><br>It is guaranteed that both $\\sum$ $n$ and $\\sum$ $q$ don&apos;t exceed $3 \\times 10^6$.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, you should print $q$ lines, each containing an integer, indicating the query answer.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n8 50 5\n10 20 30 10 20 30 10 20\n2 40 5\n2 45 1\n2 42 1\n1 2 15\n1 13 4</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5\n2\n7\n2\n6</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2020+Multi-University+Training+Contest+5&amp;source=1&amp;searchmode=source\"> 2020 Multi-University Training Contest 5 </a> ","type":"source","format":"html","require":["katex"]}]}