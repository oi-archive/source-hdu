{"title":"Forgiveness","time_limit":7000,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6028","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6028&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6028","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6028"},"statement":[{"title":"Problem Description","content":"Little Q is now checking whether string $A$ matches $B$. Two strings are considered matched if they have the same length, and there are no position $i$ that $A_i$ is different from $B_i$.<br>However, Little Q is a kind man, he forgives every person hurt him. What&apos;s more, he even forgives strings! He gives the string 3 opportunities, if there are no more than 3 positions $i$ that $A_i$ is different from $B_i$, then Little Q will also consider the two strings matched.<br>For a string $S$, $S[l,r]$ means the substring combined by $S_l, S_{l+1}, ..., S_r$. And the function $occ(A,B)$ returns the number of substrings in string $B$ which matches $A$.<br>Little Q now has a long numeric 1-based string $S$, and his job is to deal with $m$ operations:<br><br>   1.   + $l$ $r$ $k$, for every positions from $l$ to $r$, change $S_i$ to $(S_i+k)\\bmod 10$.<br>   2.   ? $l$ $r$ $T$, report $occ(T,S[l,r])$.<br><br>After lots of work, Little Q is very tired now, please write a program to help him deal with these operations.","type":"description","format":"html"},{"title":"Input","content":"The first line of the input contains an integer $T(1\\leq T\\leq15)$, denoting the number of test cases.<br>In each test case, there are two integers $n(1\\leq n\\leq 50000)$ and $m(1\\leq m\\leq 50000)$ in the first line, denoting the length of string $S$ and the number of operations.<br>The second line of the input contains a numeric string $S$ with $n$ integers, each number $S_i$ is in the range of 0 to 9.<br>In the following $m$ lines, each line describes an operation.<br>If it is a modification, then it is in the format of &apos;&apos;+ $l$ $r$ $k$&apos;&apos;, where $1\\leq l\\leq r\\leq n$ and $1\\leq k\\leq 9$.<br>If it is a query, then it is in the format of &apos;&apos;? $l$ $r$ $T$&apos;&apos;, where $1\\leq l\\leq r\\leq n$ and $T$ is a numeric string composed of integers from 0 to 9.<br>It is guaranteed that $\\sum|T|\\leq 100000$ in each test case, and there are no more than $4$ test cases satisfying $\\min(n,m)&gt;1000$.","type":"input_format","format":"html"},{"title":"Output","content":"For each query, print a single line with an integer, denoting the answer.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n5 5\n01234\n? 2 5 1234\n? 2 5 1777\n? 2 5 9999\n+ 1 5 5\n? 1 5 56789</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n1\n0\n1</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2017%D6%D0%B9%FA%B4%F3%D1%A7%C9%FA%B3%CC%D0%F2%C9%E8%BC%C6%BE%BA%C8%FC+-+%C5%AE%C9%FA%D7%A8%B3%A1&amp;source=1&amp;searchmode=source\"> 2017&#xFFFD;&#x439;&#xFFFD;&#xFFFD;&#xFFFD;&#x467;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#x1BE;&#xFFFD;&#xFFFD;&#xFFFD; - &#x16E;&#xFFFD;&#xFFFD;&#x5E8;&#xFFFD;&#xFFFD; </a> ","type":"source","format":"html"}]}