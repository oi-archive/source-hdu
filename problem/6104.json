{"title":"Influence","time_limit":4000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6104","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6104&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6104","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6104"},"statement":[{"title":"Problem Description","content":"You are given a rooted tree with N vertices, numbered from 1 to n, the root is 1.<br>The weight of edges is 1, the value of vertices is 0 at the beginning.<br>There are 3 type of operation:<br>    1 x : query the value of vertex x<br>    2 x y : modify the weight of edge to y whose child node is x<br>    3 x y : for every vertex i in the tree, value of it add ($y \\cdot dis(x , i)$),<br>            $dis(x , i)$ means the shortest distance between x and i in tree<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line of the input gives the number of test cases T; T test cases follow.<br>Each case begins with one line with one integer N : the size of the tree.<br>The next one line contains N-1 integers, ith number Pi denotes there is an edge between i+1 and Pi.<br>The next line contains one integer M : times of operation.<br>The next M line, each line contains one operation mentioned above.<br><br>Limits<br>$T \\leq 10$<br>$2 \\leq N \\leq 100000$<br>$0 \\leq M \\leq 200000$<br>$1 \\leq Pi \\leq i$ , for $1 \\leq i &lt; N$<br>operation 1 : $1 \\leq x \\leq N$<br>operation 2 : $2 \\leq x \\leq N$ , $1 \\leq y \\leq 100$<br>operation 3 : $1 \\leq x \\leq N$ , $1 \\leq y \\leq 100$<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each operation 1 output one integer denotes the answer.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n3\n1 1\n7\n3 1 1\n1 2\n1 3\n2 2 2\n3 1 2\n1 2\n1 3\n10\n1 1 3 4 4 3 1 1 9\n7\n2 9 74\n3 7 96\n1 6\n3 7 87\n2 5 69\n3 10 6\n1 5</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n1\n5\n3\n288\n1425</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2017+Multi-University+Training+Contest+-+Team+6&amp;source=1&amp;searchmode=source\"> 2017 Multi-University Training Contest - Team 6 </a> ","type":"source","format":"html","require":["katex"]}]}