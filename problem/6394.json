{"title":"Tree","time_limit":1000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6394","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6394&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6394","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6394"},"statement":[{"title":"Problem Description","content":"Alice and Bob are playing with a magic tree This magic tree has $n$ nodes,with $n - 1$ magic paths connecting them into a connected block. Node $1$ is at the top of the magic tree (layer $0$). Node $i$ is at the $\\text{kth}$ layer, where $k$ is the distance from the node $i$ to the node $1$. Alice and Bob give a mana value on each node. If a magic stone falls on node $i$, it will be sent up to the $k$ layer and appear on the $\\text{kth}$ ancestor node of the $i$ layer($k$ is the mana value of node $i$). This node will continue to send up it, and so on. If the layer of node $i$ is less than $k$, this stone will be sent out of the magic tree. Alice is curious, she will modify the magic value of a node, and ask Bob: If you drop a magic stone on the node $x$, how many times does it take to transfer it out of the magic tree?","type":"description","format":"html"},{"title":"Input","content":"Input contains multiple tests<br>The first line contains one integer $T(T \\leq 4)$, indicating the number of test cases.<br>The following lines describe all the test cases<br>For each test case: The first line contains an integer $n(n \\leq 100000)$, indicating the size of the magic tree.<br>The second line has $n - 1$ numbers, and the ith number represents the father of the node $i+1$.<br>The third row has $n$ numbers, and the $\\text{ith}$ number represents the initial mana $a_{i}(a_{i} \\leq n)$ value of each node.<br>In the fourth line, a number $m(m \\leq 100000)$ represents the number of operations.<br>The next $m$ lines, one operation per line.<br>First a number $\\text{op}(1 \\leq \\text{op} \\leq 2)$ represents the type of operation.<br>If $\\text{op} = = 1$, a number $x$ will be read immediately, indicating that a magic stone is thrown to the node $x$.<br>If $\\text{op} = = 2$, it will immediately read in two numbers $x$ and $\\text{new_a}$, indicating that the magic value of node $x$ is modified to $\\text{new_a}(\\text{new_a} \\leq n)$.","type":"input_format","format":"html"},{"title":"Output","content":"For each query with $\\text{op} = = 1$, output the answer","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n4\n1 2 3\n1 1 1 1\n3\n1 4\n2 3 2\n1 4</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">4\n3\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nFor the first query: 4-\\&gt;3-\\&gt;2-\\&gt;1-\\&gt;out\nFor the second query:4-\\&gt;3-\\&gt;1-\\&gt;out\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2018+Multi-University+Training+Contest+7&amp;source=1&amp;searchmode=source\"> 2018 Multi-University Training Contest 7 </a> ","type":"source","format":"html"}]}