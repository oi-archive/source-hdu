{"title":"Snake","time_limit":6000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=2605","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=2605&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=2605","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=2605"},"statement":[{"title":"Problem Description","content":"Snake is a popular game , and I believe most of us had played it . The Original game is that you can control a snake to eat the magic bean and after the snake eat one magic bean , the length of the snake&#x2019;s body will get longer .But today we are talking about a new game. These are the rules of the new Snake Game :<br>1. The length of the snake&#x2019;s body won&#x2019;t change even though it eat a magic bean.<br>2. Some pairs of the beans have a relation , that is, one of them can not be eaten until another one had been eaten . We call the latter &#x201C;the key bean&#x201D; . For example , if A can&#x2019;t be eaten until B had been eaten ,we say &#x201C;B is the key bean of A&#x201D;. (That means when A can&#x2019;t be eaten , the snake can not move into the grid where A is.)<br>3. The snake could not move to a wall or its body.Befor it move,it will chooses an adjacent vacant square of its head,which is neither a stone nor occupied by its body.<br><center>Figure 1 and figure2 shows how the snake move</center><br><center><img style=\"max-width:100%;\" src=\"../../../data/images/C154-1006-1.jpg\"> </center><br><center>Figure 1</center><br><center><img style=\"max-width:100%;\" src=\"../../../data/images/C154-1006-2.jpg\"> </center><br><center>Figure 2</center><br><br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line contain a integer T (T &lt;= 10).Followed by T cases. Each case contain five parts.<br>The first part: six integers ,H,W,L,K,R,N,(H &lt;= 20 , W &lt;= 20 , L &lt;= 8 , K &lt;= 7 ) means the height of the map , the width of the map , the length of the snake&#x2019;s body, the number of the magic beans . the number of the relations , the number of the wall respectively.<br>The second part: L lines , each line contain two integer h<sub>i</sub> ,w<sub>i</sub>, indicating the original position of each block of snake&apos;s body, from B<sub>1</sub>(h<sub>1</sub>,w<sub>1</sub>) to B<sub>L</sub>(h<sub>L</sub>,w<sub>L</sub>) orderly, where 1&lt;=h<sub>i</sub>&lt;=H, and 1&lt;=w<sub>i</sub>&lt;=W,1&lt;=i&lt;=L.<br>The third part: K lines ,each line contain two integer h<sub>i</sub> ,w<sub>i</sub> , indicating the position of each magic bean , from MB<sub>1</sub>(h<sub>1</sub>,w<sub>1</sub>) to MB<sub>K</sub>(h<sub>K</sub>,w<sub>K</sub>) orderly, where 1&lt;=h<sub>i</sub>&lt;=H, and 1&lt;=w<sub>i</sub>&lt;=W,1&lt;=i&lt;=K.<br>The fourth part : R lines , each line contain two integer A ,B means &#x201C;A is the key bean of B &#x201D;. The A and B may appear several times , but &#x201C;one bean will have only one key bean&#x201D;.<br>The fifth part: N lines , each line contain two integer h<sub>i</sub> ,w<sub>i</sub> , indicating the position of each wall , from W<sub>1</sub>(h<sub>1</sub>,w<sub>1</sub>) to W<sub>N</sub>(h<sub>N</sub>,w<sub>N</sub>) orderly, where 1&lt;=h<sub>i</sub>&lt;=H, and 1&lt;=w<sub>i</sub>&lt;=W,1&lt;=i&lt;=N.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each case , if the snake could eat all the magic beans , output the minimum step it took. If the snake could not , just output &#x201C;-1&#x201D; (without the quotation marks) .<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n8 9\n5 2\n1 8\n5 2\n6 2\n6 3\n6 4\n6 5\n4 2\n2 6\n2 1\n2 5\n3 5\n4 4\n4 5\n4 6\n5 6\n5 7\n6 7</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">21</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Author","content":"Teddy","type":"source","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=HDU+1st+%A1%B0Vegetable-Birds+Cup%A1%B1+Programming+Open+Contest&amp;source=1&amp;searchmode=source\"> HDU 1st &#x201C;Vegetable-Birds Cup&#x201D; Programming Open Contest </a> ","type":"source","format":"html","require":["katex"]}]}