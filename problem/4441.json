{"title":" Queue Sequence","time_limit":4000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4441","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4441&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4441","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4441"},"statement":[{"title":"Problem Description","content":"There&apos;s a queue obeying the first in first out rule. Each time you can either push a number into the queue (+i), or pop a number out from the queue (-i). After a series of operation, you get a sequence (e.g. +1 -1 +2 +4 -2 -4). We call this sequence a queue sequence.<br><br>Now you are given a queue sequence and asked to perform several operations:<br><br>1. insert p<br>First you should find the smallest positive number (e.g. i) that does not appear in the current queue sequence, then you are asked to insert the +i at position p (position starts from 0). For -i, insert it into the right most position that result in a valid queue sequence (i.e. when encountered with element -x, the front of the queue should be exactly x).<br>For example, (+1 -1 +3 +4 -3 -4) would become (+1 +2 -1 +3 +4 -2 -3 -4) after operation &apos;insert 1&apos;.<br>2. remove i<br>Remove +i and -i from the sequence.<br>For example, (+1 +2 -1 +3 +4 -2 -3 -4) would become (+1 +2 -1 +4 -2 -4) after operation &apos;remove 3&apos;.<br>3. query i<br>Output the sum of elements between +i and -i. For example, the result of query 1, query 2, query 4 in sequence (+1 +2 -1 +4 -2 -4) is 2, 3(obtained by -1 + 4), -2 correspond.<br>","type":"description","format":"html"},{"title":"Input","content":"There are less than 25 test cases. Each case begins with a number indicating the number of operations n (1 &#xFFFD;&#xFFFD; n &#xFFFD;&#xFFFD; 100000). The following n lines with be &apos;insert p&apos;, &apos;remove i&apos; or &apos;query i&apos;(0 &#xFFFD;&#xFFFD; p &#xFFFD;&#xFFFD; length (current sequence), 1 &#xFFFD;&#xFFFD; i, i is granted to be in the sequence).<br>In each case, the sequence is empty initially.<br>The input is terminated by EOF.<br>","type":"input_format","format":"html"},{"title":"Output","content":"Before each case, print a line &quot;Case #d:&quot; indicating the id of the test case.<br>After each operation, output the sum of elements between +i and -i.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">10\ninsert 0\ninsert 1\nquery 1\nquery 2\ninsert 2\nquery 2\nremove 1\nremove 2\ninsert 2\nquery 3\n6\ninsert 0\ninsert 0\nremove 2\nquery 1\ninsert 1\nquery 2</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1:\n2\n-1\n2\n0\nCase #2:\n0\n-1</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2012+Asia+Tianjin+Regional+Contest&amp;source=1&amp;searchmode=source\"> 2012 Asia Tianjin Regional Contest </a> ","type":"source","format":"html"}]}