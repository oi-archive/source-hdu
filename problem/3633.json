{"title":"Black and white","time_limit":10000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3633","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3633&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3633","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3633"},"statement":[{"title":"Problem Description","content":"Given a partially filled grid with N rows and M columns and each gird with a number.We define <b>sumBlack</b> is the sum of all Black gird and <b>sumWhite</b> is the sum of all White gird.<br>You are to calculate how many ways there are to fill the remaining part of the grid under the constraints stated below to make the <b>absolute of (sumBlack - sumWhite)</b> minimum and output one of these ways (if any exist). <br>Each cell in the grid should be colored either black or white.<br>All black cells in the grid should be connected with each other, and all white cells should also be connected with each other.The pictures below show two filled grids where this constraint is only fulfilled in the picture2.<br><center><img style=\"max-width:100%;\" src=\"../../../data/images/C308_1002_1.png\"></center><br>There must be no <b>2x2</b> blocks in the grid which consists of only white cells, or of only black cells.<br>The picture3 shows a grid with a black and a white <b>2x2</b> block, while the picture4 contains no such <b>2x2</b> block. <br><center><img style=\"max-width:100%;\" src=\"../../../data/images/C308_1002_2.png\"></center><br>You are not allowed to change the color of any of the cells whose color has already been assigned in the input, and all cells must be colored.","type":"description","format":"html"},{"title":"Input","content":"The first line in the input contains an integer T (1&lt;=T&lt;=30), the number of cases to follow.<br>Each case starts with two integers, N and M (2 &#x2264; N, M &#x2264; 8), the number of rows and columns respectively in the grid.<br>The next N lines contains M characters each and describes the grid using the following characters:<br>&#xA0;&#xA0;# - a cell which is colored black<br>&#xA0;&#xA0;o - a cell which is colored white<br>&#xA0;&#xA0;. - a cell which color has not yet been assigned<br>The next N lines contains M integers (-1 or 0 or 1) each indicating the number of this gird.","type":"input_format","format":"html"},{"title":"Output","content":"For each case, first line output the number of case(as shown in the sample output)<br>If there are at least one way, then output the minimum <b>absolute of (sumBlack - sumWhite)</b> and the number of ways to fill the grid make it minimum in a line and output one of these ways, using the same format for the grid as in the input.(anyone is ok)<br>If there is no way to fill the gird under the constraints stated , just output two zero.<br>Output a blank line after each case.(Special judge.If you not output a blank line after each case, you may get Wrong Answer)","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">4\n2 3\nxxx\noox\n1 1 0\n0 1 0\n\n2 3\n...\n...\n1 1 0\n0 1 -1\n\n5 5\n..x..\n.....\n....o\no....\n.x...\n1 1 0 0 1\n0 -1 -1 0 1\n1 1 0 -1 0\n1 0 1 -1 -1\n-1 -1 1 -1 0\n\n4 5\n.....\n.....\n.....\n.....\n1 1 0 0 1\n0 -1 -1 0 1\n1 1 0 -1 0\n1 0 1 -1 -1</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1: 1 1\nxxx\noox\n\nCase 2: 0 8\nxxx\nxox\n\nCase 3: 0 0\n\nCase 4: 1 54\nxxxxx\nxoxox\noooox\noxxxx</div></pre>","type":"example","format":"html"},{"title":"Author","content":"NotOnlySuccess","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2010+ACM-ICPC+Multi-University+Training+Contest%A3%A819%A3%A9%A1%AA%A1%AAHost+by+HDU&amp;source=1&amp;searchmode=source\"> 2010 ACM-ICPC Multi-University Training Contest&#xFF08;19&#xFF09;&#x2014;&#x2014;Host by HDU </a> ","type":"source","format":"html"}]}