{"title":"Color the Simple Cycle","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3869","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3869&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3869","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3869"},"statement":[{"title":"Problem Description","content":"Consider a simple cycle with N vertices numbered from 1 to N. Each vertex and Each edge has an integer value. We use v[k] to represent the kth vertex&apos;s value, and e[k] to represent the kth edge&apos;s value. The kth edge is the edge of the kth and the (k+1)th vertex (the (N+m)th vertex is the mth vertex). Now we will use C different colors to color the graph. Every vertice will be colored by one of the C colors. If there exists some integer number k which satisfies v[i]=v[i+k] and e[i]=e[i+k] for each i from 1 to N(v[N+t]=v[t] and e[N+t]=e[t]), we call the graph is the same under k rotation.<br>If two ways of coloring the cycle can be the same with some rotation and under that rotation the color of the corresponding vertices are also the same, we consider the two ways are the same ways. Given the simple cycle and the number of colors we will use, how many different ways to color the cycle?<br>","type":"description","format":"html"},{"title":"Input","content":"First comes an integer T representing the number of test cases. Each case consists of three lines. First line contains N(1&lt;=N&lt;=100000)  and C (1&lt;=C&lt;=1000000). Second line contains N integer numbers representing the vertex&apos;s values. The last line of each case contains N integer numbers representing the edge values. Each value is between 1 and 1000000.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each case, print a line with the different ways of coloring the cycle mod 1000000007.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2 \n3 1 \n1 1 1 \n2 2 2 \n3 2 \n1 1 1 \n2 2 2</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n4</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2011+Multi-University+Training+Contest+4+-+Host+by+SDU&amp;source=1&amp;searchmode=source\"> 2011 Multi-University Training Contest 4 - Host by SDU </a> ","type":"source","format":"html"}]}