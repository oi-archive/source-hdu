{"title":"Make ZYB Happy","time_limit":2000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6405","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6405&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6405","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6405"},"statement":[{"title":"Problem Description","content":"It&apos;s known to all that ZYB is godlike, so obviously he has a large number of titles, such as $\\texttt{jsking}$, $\\texttt{bijingzyb}$ and $\\texttt{nbazyb}$. ZYB likes his titles very much.<br><br>Each of ZYB&apos;s titles is a string consisting of lower case letters $\\texttt{&apos;a&apos;-&apos;z&apos;}$ associated with a happiness value $h_i$, which shows how much ZYB likes this title. If you say any substring of some title with happiness value $x$, he will get $x$ happiness points. Moreover, a string may appear in more than one title. In this case, the happiness points ZYB gets are multiplied. If the string you say is not the substring of any of his titles, he gets no happiness point.<br><br><center><img style=\"max-width:100%;\" src=\"../../../data/images/6405-1.jpg\"></center><br><br>For example, let&apos;s say ZYB has two titles: $\\texttt{zybnb}$ (with happiness value 3) and $\\texttt{ybyb}$ (with happiness value 5). If you say $\\texttt{y}$, $\\texttt{b}$ or $\\texttt{yb}$, ZYB will get 15 happiness points; if you say $\\texttt{z}$, $\\texttt{zy}$ or $\\texttt{zyb}$, ZYB will only get 3 happiness points; if you say $\\texttt{ybz}$ or $\\texttt{ybac}$ he will get 0 happiness points.<br><br>One day, you find ZYB pretty sad. As a big fan of ZYB, you want to say a word to ZYB to cheer him up. However, ZYB is really busy, so you can only say no more than $m$ letters. As you haven&apos;t seen ZYB for a long time, you are so excited that you forget what you want to say, so you decide to choose to say a nonempty string no longer than $m$ and only containing $\\texttt{&apos;a&apos;-&apos;z&apos;}$ with equal probability. You want to know the expectations of happiness points you will bring to ZYB for different $m$.","type":"description","format":"html"},{"title":"Input","content":"The first line contains an integer $n$ $(1 \\leq n \\leq 10^4)$, the number of titles ZYB has.<br><br>The $i$-th of the next $n$ lines contains a nonempty string $t_i$, which only contains lower case letters $\\texttt{&apos;a&apos;-&apos;z&apos;}$, representing the $i$-th title. The sum of lengths of all titles does not exceed $3 \\times 10^5$.<br><br>Then follows a line with $n$ integers $h_i$ $(1\\leq h_i \\leq 10^6)$, the happiness value of $i$-th title.<br><br>The next line is a single integer $Q$ $(1 \\leq Q \\leq 3 \\times 10^5)$, the number of queries.<br><br>For the next $Q$ lines, each contains a single integer $m$ $(1 \\leq m \\leq 10^6)$, meaning that you can say no more than $m$ letters to ZYB.<br><br>The input data contains only one test case.","type":"input_format","format":"html"},{"title":"Output","content":"For each query, display a single line of integer, representing the answer. It can be proved that the answer can be uniquely written as $p/q$ where $p$ and $q$ are non-negative integers with $\\gcd(p, q) = \\gcd(q, 10^9 + 7) = 1$, and you should display $p \\cdot q^{-1} \\bmod (10^9 + 7)$, where $q^{-1}$ means the multiplicative inverse of $q$ modulo $10^9 + 7$.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\nzybnb\nybyb\n3 5\n4\n1\n2\n3\n4</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">769230776\n425925929\n891125950\n633120399\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nFor the first query, you can bring him 3 happiness points if you say &quot;z&quot; or &quot;n&quot;, and 15 happiness points if you say &quot;y&quot; or &quot;b&quot;; all other strings of length 1 bring no \nhappiness point to ZYB. Therefore, the expectation is (2&#xFFFD;&#xFFFD;3+2&#xFFFD;&#xFFFD;15)/26 = 18/13, and the answer is 18&#xFFFD;&#xFFFD;13^(-1) mod (10^9+7) = 769230776.\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2018+Multi-University+Training+Contest+8&amp;source=1&amp;searchmode=source\"> 2018 Multi-University Training Contest 8 </a> ","type":"source","format":"html"}]}