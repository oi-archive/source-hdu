{"title":"Magic boy Bi Luo with his excited tree","time_limit":4000,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5834","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5834&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5834","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5834"},"statement":[{"title":"Problem Description","content":"Bi Luo is a magic boy, he also has a migic tree, the tree has $N$ nodes , in each node , there is a treasure, it&apos;s value is $V[i]$, and for each edge, there is a cost $C[i]$, which means every time you pass the edge $i$ , you need to pay $C[i]$.<br><br>You may attention that every $V[i]$ can be taken only once, but for some $C[i]$ , you may cost severial times.<br><br>Now, Bi Luo define $ans[i]$ as the most value can Bi Luo gets if Bi Luo starts at node $i$.<br><br>Bi Luo is also an excited boy, now he wants to know every $ans[i]$, can you help him?","type":"description","format":"html"},{"title":"Input","content":"First line is a positive integer $T( T \\leq 10^4)$ , represents there are $T$ test cases.<br><br>Four each test&#xFFFD;&#xFFFD;<br><br>The first line contain an integer $N$$( N \\leq 10^5 )$.<br><br>The next line contains $N$ integers $V[i]$, which means the treasure&#xFFFD;&#xFFFD;s value of node $i ( 1 \\leq V[i] \\leq 10^4 )$.<br><br>For the next $N - 1$ lines, each contains three integers $u , v , c$ , which means node $u$ and node $v$ are connected by an edge, it&apos;s cost is $c (1 \\leq c \\leq 10^4 )$.<br><br>You can assume that the sum of $N$ will not exceed $10^6$.","type":"input_format","format":"html"},{"title":"Output","content":"For the i-th test case , first output Case #i: in a single line , then output $N$ lines , for the i-th line , output $ans[i]$ in a single line.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n5\n4 1 7 7 7 \n1 2 6\n1 3 1\n2 4 8\n3 5 2</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1:\n15\n10\n14\n9\n15</div></pre>","type":"example","format":"html"},{"title":"Author","content":"UESTC","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2016%D6%D0%B9%FA%B4%F3%D1%A7%C9%FA%B3%CC%D0%F2%C9%E8%BC%C6%BE%BA%C8%FC+-+%CD%F8%C2%E7%D1%A1%B0%CE%C8%FC&amp;source=1&amp;searchmode=source\"> 2016&#xFFFD;&#x439;&#xFFFD;&#xFFFD;&#xFFFD;&#x467;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#x1BE;&#xFFFD;&#xFFFD;&#xFFFD; - &#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#x461;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD; </a> ","type":"source","format":"html"}]}