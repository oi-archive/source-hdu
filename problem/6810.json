{"title":"Imperative Meeting","time_limit":2000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6810","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6810&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6810","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6810"},"statement":[{"title":"Problem Description","content":"Some rumors about Zhang3 have been spread on the Internet. Zhang3 needs to dispel the rumors, but she&apos;s busy preparing her birthday party, so she asks her $m$ classmates for help. Her classmates decide to have a meeting for discussion.<br><br>The $m$ classmates live in the same community. There are $n$ houses in the community, labeled $1, 2, \\ldots, n$. There are $(n - 1)$ roads connecting the houses, the $i^\\mathrm{th}$ of which connects house $(i + 1)$ and $f_{i + 1}$, forming a tree. Each road is 1 km long.<br><br>The $m$ classmates live in $m$ different houses. They always choose such a house to have the meeting, that the total distance to travel for the $m$ classmates is minimized. The optimal total distance (in km) to travel  is called the cost of the meeting.<br><br>Zhang3 doesn&apos;t know which houses her classmates live in, so there are $\\binom{n}{m}$ different cases of that. Zhang3 wants to know the sum of the cost in all cases. As the answer can be very large, please help her calculate the answer modulo $10^9 + 7$.","type":"description","format":"html"},{"title":"Input","content":"The first line of the input gives the number of test cases, $T \\; (1 \\le T \\le 1000)$. $T$ test cases follow.<br><br>For each test case, the first line contains two integers $n, m \\; (1 \\le n \\le 10^6, \\; 1 \\le m \\le n)$, the number of houses in the community and the number of classmates.<br><br>The second line contains $(n - 1)$ integers $f_2, \\ldots, f_n \\; (1 \\le f_i &lt; i)$, separated by spaces, describing the roads.<br><br>The sum of $n$ in all test cases doesn&apos;t exceed $2 \\times 10^6$.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, print a line with an integer, representing the answer modulo $10^9 + 7$.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n4 3\n1 1 1\n5 3\n1 2 3 3</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">9\n27</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2020+Multi-University+Training+Contest+4&amp;source=1&amp;searchmode=source\"> 2020 Multi-University Training Contest 4 </a> ","type":"source","format":"html"}]}