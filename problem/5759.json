{"title":"Gardener Bo","time_limit":8000,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5759","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5759&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5759","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5759"},"statement":[{"title":"Problem Description","content":" Gardener Bo loves Trees.Now he asks you to help him take care of his lovely tree.<br><br>    A rooted tree with root=1 is given.Every node on the tree has a value $w_i$.Let $fa[u]$ be the father of $u$.<br><br>    Let $LCA(u,v)$ be the least common ancestor of $u$ and $v$.The expression $[condition]$ is 1 when $condition$ is True,is 0 when $condition$ is False.<br><br>    Define<br><br>    \\[f(u)=\\sum_{i=1}^n\\sum_{j=i}^n(w_i+w_j)*[LCA(i,j)=u]\\]<br><br>    Now there are $Q$ events happening.Each event has one of two types:<br><br>    $1~u~x$:pick out all $v$ that satisfies $v=u$ or $fa[v]=u$ or $fa[fa[v]]=u$,and add $x$ to $w_v$.<br><br>    $2~u$:query $f(u)\\bmod 2^{32}$.","type":"description","format":"html"},{"title":"Input","content":"There are several test cases.<br><br>    The first line contains two integers $n,Q$.<br><br>    The second line contains $n-1$ integers,i-th indicates $fa[i+1]$.<br><br>    The third line contains $n$ integers,the i-th indicates the initial $w_i$.<br><br>    Following $Q$ lines each describes an event.<br><br>    $1\\leq n,Q\\leq 3\\times 10^5,|w_i|,|x|&lt;10^9$","type":"input_format","format":"html"},{"title":"Output","content":"For every event with type 2,you should print a number indicating the answer.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5 3\n1 1 3 3\n-5 2 0 7 -6\n1 5 2\n2 3\n2 2\n10 5\n1 2 3 3 1 2 6 2 2 \n-2 5 8 -6 0 -4 6 6 8 9\n2 10\n1 3 4\n1 6 -2\n2 9\n2 4</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">6\n4\n18\n16\n4294967292</div></pre>","type":"example","format":"html"},{"title":"Author","content":"&#x7ECD;&#x5174;&#x4E00;&#x4E2D;","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2016+Multi-University+Training+Contest+3&amp;source=1&amp;searchmode=source\"> 2016 Multi-University Training Contest 3 </a> ","type":"source","format":"html"}]}