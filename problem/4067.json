{"title":"Random Maze","time_limit":3000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4067","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4067&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4067","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4067"},"statement":[{"title":"Problem Description","content":"In the game &#x201C;A Chinese Ghost Story&#x201D;, there are many random mazes which have some characteristic&#xFF1A;<br>1.There is only one entrance and one exit.<br>2.All the road in the maze are unidirectional.<br>3.For the entrance, its out-degree = its in-degree + 1.<br>4.For the exit, its in-degree = its out-degree + 1.<br>5.For other node except entrance and exit, its out-degree = its in-degree.<br><center><img style=\"max-width:100%;\" src=\"../../data/images/C348-1007-1.jpg\"></center> <br>There is an directed graph, your task is removing some edge so that it becomes a random maze. For every edge in the graph, there are two values a and b, if you remove the edge, you should cost b, otherwise cost a.<br>Now, give you the information of the graph, your task if tell me the minimum cost should pay to make it becomes a random maze. <br><br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line of the input file is a single integer T.<br>The rest of the test file contains T blocks. <br>For each test case, there is a line with four integers, n, m, s and t, means that there are n nodes and m edges, s is the entrance&apos;s index, and t is the exit&apos;s index. Then m lines follow, each line consists of four integers, u, v, a and b, means that there is an edge from u to v. <br>2&lt;=n&lt;=100, 1&lt;=m&lt;=2000, 1&lt;=s, t&lt;=n, s != t. 1&lt;=u, v&lt;=n. 1&lt;=a, b&lt;=100000<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each case, if it is impossible to work out the random maze, just output the word &#x201C;impossible&#x201D;, otherwise output the minimum cost.(as shown in the sample output)<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n2 1 1 2\n2 1 2 3\n5 6 1 4\n1 2 3 1\n2 5 4 5\n5 3 2 3\n3 2 6 7\n2 4 7 6\n3 4 10 5</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1: impossible\nCase 2: 27</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=The+36th+ACM%2FICPC+Asia+Regional+Fuzhou+Site+%A1%AA%A1%AA+Online+Contest&amp;source=1&amp;searchmode=source\"> The 36th ACM/ICPC Asia Regional Fuzhou Site &#x2014;&#x2014; Online Contest </a> ","type":"source","format":"html","require":["katex"]}]}