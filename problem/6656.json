{"title":"Kejin Player","time_limit":5000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6656","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6656&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6656","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6656"},"statement":[{"title":"Problem Description","content":"Cuber QQ always envies those Kejin players, who pay a lot of RMB to get a higher level in the game. So he worked so hard that you are now the game designer of this game. He decided to annoy these Kejin players a little bit, and give them the lesson that RMB does not always work.<br><br>This game follows a traditional Kejin rule of &quot;when you are level $i$, you have to pay $a_i$ RMB to get to level $i+1$&quot;. Cuber QQ now changed it a little bit: &quot;when you are level $i$, you pay $a_i$ RMB, are you get to level $i+1$ with probability $p_i$; otherwise you will turn into level $x_i$ ($x_i \\le i$)&quot;.<br><br>Cuber QQ still needs to know how much money expected the Kejin players needs to ``ke&apos;&apos; so that they can upgrade from level $l$ to level $r$, because you worry if this is too high, these players might just quit and never return again.<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line of the input is an integer $t$, denoting the number of test cases.<br><br>For each test case, there is two space-separated integers $n$ ($1 \\le n \\le 500~000$) and $q$ ($1 \\le q \\le 500~000$) in the first line, meaning the total number of levels and the number of queries.<br><br>Then follows $n$ lines, each containing integers $r_i$, $s_i$, $x_i$, $a_i$ ($1 \\le r_i \\le s_i \\le 10^9$, $1 \\le x_i \\le i$, $0 \\le a_i \\le 10^9$), space separated. Note that $p_i$ is given in the form of a fraction $\\frac{r_i}{s_i}$.<br><br>The next $q$ lines are $q$ queries. Each of these queries are two space-separated integers $l$ and $r$ ($1 \\le l &lt; r \\le n + 1$).<br><br>The sum of $n$ and sum of $q$ from all $t$ test cases both does not exceed $10^6$.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each query, output answer in the fraction form modulo $10^9+7$, that is, if the answer is $\\frac{P}{Q}$, you should output $P \\cdot Q^{-1}$ modulo $10^9+7$, where $Q^{-1}$ denotes the multiplicative inverse of $Q$ modulo $10^9+7$.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n3 2\n1 1 1 2\n1 2 1 3\n1 3 3 4\n1 4\n3 4</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">22\n12\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nHuge IO (Over 40MB)! IO optimization is preferred.\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2019+Multi-University+Training+Contest+7&amp;source=1&amp;searchmode=source\"> 2019 Multi-University Training Contest 7 </a> ","type":"source","format":"html","require":["katex"]}]}