{"title":"Transmigration tree","time_limit":5000,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5436","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5436&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5436","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5436"},"statement":[{"title":"Problem Description","content":"There is a tree, $n$ nodes, numbered from $1$ to $n$, each node has a weight, but each leaf node is the father of the root,<br><br>we call such a tree as Transmigration tree, The root of each tree is node $1$.<br><br>We need to minimize the sum of weights that node $u$ to node $v$ and know who is the biggest weights node in this path.","type":"description","format":"html"},{"title":"Input","content":"The first line of the input is a single integer $T (T \\leq 10)$, indicating the number of testcases. <br><br>Then $T$ testcases follow.In each testcase,<br><br>The first line contains two integers $n,q$, the number of nodes and inquiry$(2 \\leq n \\leq 50000, 1 \\leq q &lt; 100000)$.<br><br>The second line contains $n - 1$ integers $A_i ( 1 \\leq A_i \\leq i )$ represent the node $i + 1$&apos;s father is node $A_i$.<br><br>The third line contains $n$ integers $B_i ( 1 \\leq i \\leq n, 0 \\leq B_i \\leq 1000)$ represent the node $i$&apos;s weight is $B_i$.<br><br>Then $q$ line follow,each line contains two integers $u,v$,it represents a query$(1 \\leq u,v \\leq n)$.","type":"input_format","format":"html"},{"title":"Output","content":"For each query,we should output one line &quot;$x \\ y$&quot;, where $x$ is the smallest the sum of weights that node $u$ to node $v$ and $y$ is the weight of the biggest weights node in this path.(If there are multiple paths, please calculating the maximum node weights largest)<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n5 1\n1 2 3 4\n413 127 263 869 960\n1 5</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1373 960</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=BestCoder+Round+%2355+%28%24%29&amp;source=1&amp;searchmode=source\"> BestCoder Round #55 ($) </a> ","type":"source","format":"html"}]}