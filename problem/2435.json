{"title":"There is a war","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=2435","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=2435&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=2435","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=2435"},"statement":[{"title":"Problem Description","content":"&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;There is a sea.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;There are N islands in the sea.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;There are some directional bridges connecting these islands.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;There is a country called Country One located in Island 1.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;There is another country called Country Another located in Island N. <br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;There is a war against Country Another, which launched by Country One.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;There is a strategy which can help Country Another to defend this war by destroying the bridges for the purpose of making Island 1 and Island n disconnected.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;There are some different destroying costs of the bridges.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;There is a prophet in Country Another who is clever enough to find the minimum total destroying costs to achieve the strategy.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;There is an architecture in Country One who is capable enough to rebuild a bridge to make it unbeatable or build a new invincible directional bridge between any two countries from the subset of island 2 to island n-1.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;There is not enough time for Country One, so it can only build one new bridge, or rebuild one existing bridge before the Country Another starts destroying, or do nothing if happy.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;There is a problem: Country One wants to maximize the minimum total destroying costs Country Another needed to achieve the strategy by making the best choice. Then what&#x2019;s the maximum possible result?<br>","type":"description","format":"html"},{"title":"Input","content":"&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;There are multiple cases in this problem.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;There is a line with an integer telling you the number of cases at the beginning.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;The are two numbers in the first line of every case, N(4&lt;=N&lt;=100) and M(0&lt;=M&lt;=n*(n-1)/2), indicating the number of islands and the number of bridges.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;There are M lines following, each one of which contains three integers a, b and c, with 1&lt;=a, b&lt;=N and 1&lt;=c&lt;=10000, meaning that there is a directional bridge from a to b with c being the destroying cost.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;There are no two lines containing the same a and b.<br>","type":"input_format","format":"html"},{"title":"Output","content":"&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;There is one line with one integer for each test case, telling the maximun possible result.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">4\n4 0\n4 2\n1 2 2\n3 4 2\n4 3\n1 2 1\n2 3 1\n3 4 10\n4 3\n1 2 5\n2 3 2\n3 4 3</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">0\n2\n1\n3</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2008+Asia+Chengdu+Regional+Contest+Online&amp;source=1&amp;searchmode=source\"> 2008 Asia Chengdu Regional Contest Online </a> ","type":"source","format":"html"}]}