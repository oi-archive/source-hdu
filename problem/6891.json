{"title":"Chess Class","time_limit":2000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6891","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6891&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6891","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6891"},"statement":[{"title":"Problem Description","content":"This class is on chess. Baby Volcano is playing a special chess game with his friend, Baby Evil. <br><br>In this chess game, there is a directed graph $G = (V,E)$. Vertices are indexed from $1$ to $n$. It is guaranteed that every vertex has at least one out-going edge, i.e. $\\forall v\\in V, \\exists w\\in V, (v,w)\\in E$, Baby Volcano takes control of a subset of vertices $X\\subseteq V$, Baby Evil takes control of $V\\setminus X$. Every vertex $v$ is assigned a weight $W(v)$. <br><br>There is a chess, positioning at $s\\in V$ initially. The game consists of three phases.<br><br>1. For every $p\\in X$, Baby Volcano chooses an out-going edge $(p,q)\\in E$ and delete other out-going edges of vertex $p$. <br><br>2. After Volcano&apos;s operation, Baby Evil would similarly choose an out-going edge $(p&apos;,q&apos;)\\in E$ and delete other out-going edges of $p&apos;$ for every $p&apos; \\notin X$. Both two babies make decisions based on chess&apos;s initial position $s$.<br><br>3. After two processes above, every vertex would remain only one out-going edge. The chess starts moving along the unique path in the processed graph, resulting in an infinite path $L = v_0v_1v_2\\cdots$, where $v_0=s$. Baby Volcano gains score $CV$ at last, which is computed below:<br>$$CV:= \\max\\left\\{W\\left(v_i\\right) \\ |\\  v_i \\text{ appears in }L\\right\\}$$ <br><br>Baby Volcano wants to maximize $CV$, while Baby Evil wants to minimize it. <br><br>Your task is to determine, for every $s,1\\leq s\\leq n$, compute $CV$ under the circumstance that the chess is put at $s$ initially. ","type":"description","format":"html"},{"title":"Input","content":"In the first line there is a number $T$, denotes the number of test cases.<br><br>Then there are $T$ parts of input, each part describes a test case. Each parts begins with $n,m,R,B$, denotes the number of vertices, edges, the range of $W(v)$, and the size of $X$, the set which baby volcano takes control.<br><br>Then there is a line consists of $B$ numbers, denotes elements in $X$.<br><br>Then there is a line with $n$ numbers, the $i$-th number, denotes $W(i), 1\\leq W(i)\\leq R$.<br><br>Then there are $m$ lines, each line consists of $2$ numbers, $u,v$, showing that there is an edge from $u$ to $v$ in $G$.<br><br>$1\\leq T\\leq 100$<br><br>$1\\leq m,R\\leq 5\\times 10^5$<br><br>$1\\leq B\\leq n\\leq 5\\times 10^5$<br><br>$1\\leq \\sum{n},\\sum{m},\\sum{R}\\leq 10^6$<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, you should first output &apos;&apos;Case #t:&apos;&apos;(without quotes), denotes the test number.<br><br>Then you need to output $n$ numbers in the next line, the $i$-th number is $CV$ under the circumstance that the chess is put at $i$ initially. ","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n3 3 2 1\n3\n1 1 2\n1 2\n2 3\n3 3\n4 6 10 1\n4\n8 7 3 2\n1 3\n2 4\n3 2\n4 2\n2 1\n2 2</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1:\n2 2 2\nCase #2:\n8 7 7 7</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2020%D6%D0%B9%FA%B4%F3%D1%A7%C9%FA%B3%CC%D0%F2%C9%E8%BC%C6%BE%BA%C8%FC%A3%A8CCPC%A3%A9+-+%CD%F8%C2%E7%D1%A1%B0%CE%C8%FC&amp;source=1&amp;searchmode=source\"> 2020&#xFFFD;&#x439;&#xFFFD;&#xFFFD;&#xFFFD;&#x467;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#x1BE;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;CCPC&#xFFFD;&#xFFFD; - &#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#x461;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD; </a> ","type":"source","format":"html"}]}