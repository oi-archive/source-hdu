{"title":"Mr. Panda and Crystal","time_limit":2000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6007","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6007&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6007","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6007"},"statement":[{"title":"Problem Description","content":"Long long time ago, there is a magic continent far far away.<br>There are N types of magic crystals that contain ancient magic powers. Each of the type of magic crystal has its own price for one piece in the market. As the most powerful magician, Mr. Panda could synthesize some types of crystals by collecting some amount of other types of crystals. He could also create some types of crystals by using some number of his magic powers.<br>Now, Mr Panda can create any number of crystals as he wish by using no more than M magic powers. He want to know the maximum amount of money he can make by sell all the crytals he creates and synthesizes.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line of the input gives the number of test cases, T. T test cases follow.<br>Each test case starts with 3 positive intergers, M, N and K represent the amount of magic powers Mr. Panda had, the number of crystal types on the magic continent and the number of crystal synthesis equations.<br>Then N lines follows, each of them starts with one 0 or 1 which indicates whehter Mr. Panda could create this type of crystal.<br>If the $i^{th}$ line starts with 0, which means Mr. Panda couldn&#x2019;t create crystal type i. Then there is one integer $p_i$ in this line which is the price for each piece of crystal type i.<br>If the $i^{th}$ line starts with 1, which means Mr. Panda could create crystal type i. Then there are two positive integers $c_i$ and $p_i$ in this line, the first is the amout of magic power cost when creates one piece of crystal type i, and the second is is the price for each piece of crystal type i.<br>The following K lines each start with two interger $x_i$ and $y_i$ , which means for synthesizing one piece of crystal type $x_i$ , $y_i$ rules should be satisfied. Then there are $y_i$ pair of positive intergers $u_j$ and $v_j$ means for one piece of $x^{th}_{i}$ type cristal, we have to collect $v_i$ piece of crystal type $u_i$. Only when all the rules of $u_i$ and $v_i$ are satisfied, Mr. Panda could synthesize one piece $x^{th}_{i}$ type cristal.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, output one line containing &#x201C;Case #x: y&#x201D;, where x is the test case number (starting from 1) and y is the maximum amout of money Mr. Panda could make.<br><h2>limits</h2><br>$\\bullet 1 &#x2264; T &#x2264; 100.$<br>$\\bullet 1 &#x2264; M &#x2264; 10000.$<br>$\\bullet 1 &#x2264; N &#x2264; 200.$<br>$\\bullet 1 &#x2264; K &#x2264; 200.$<br>$\\bullet 1 &#x2264; x_i, u_j &#x2264; N.$<br>$\\bullet for each crystal synthesis equation, all uj are different.$<br>$\\bullet 1 &#x2264; v_j &#x2264; 100.$<br>$\\bullet 1 &#x2264; c_i , p_i &#x2264; 10000.$<br><br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n100 3 2\n0 20\n1 15 10\n1 2 1\n1 2 2 1 3 1\n2 1 3 2\n100 3 2\n1 3 1\n1 4 1\n0 10\n3 1 1 3\n3 1 2 2</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1: 330\nCase #2: 121</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2016+CCPC-Final&amp;source=1&amp;searchmode=source\"> 2016 CCPC-Final </a> ","type":"source","format":"html","require":["katex"]}]}