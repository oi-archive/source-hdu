{"title":"Rainbow Island","time_limit":1000,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4936","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4936&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4936","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4936"},"statement":[{"title":"Problem Description","content":"   Recently, a new emerging game has become popular in Hogwarts. <br><br>   The goal of the game is to connect all islands in the ground with rainbows. At the beginning, n islands are isolated and the player arrive at the first island. There is a red magic set and a blue magic set on each island. Once the players of the game arrive at one of the islands, they will follow the sequence, which is firstly entering the red magic set, then the blue one. When a player enters the red magic set, he/she has the possibility of p to gain a rainbow, thereby two random island of all will be connected by the rainbow(including which two have been connected). When a player enters the blue magic set, he/she will be sent to one of the s islands with same possibility. One unit of total magic volume will be expended when the player uses the blue magic. At the end of the game, the winner is the one who consumes the least of total magic volume. <br><br>    However, the brilliant Hermione despises the game, she wants to know the expected magic volume to be taken away the goal of the game was achieved. ","type":"description","format":"html"},{"title":"Input","content":"   There are multiply test cases.<br><br>   The first line contains an integer T(T&lt;=100), indicates the number of cases. <br>For each case the first line contains an integer n, indicates the number of the islands. (1&lt;=n&lt;=20)<br><br>   Then there will be n numbers, pi indicates the possibility to gain a rainbow for the i-th island. (0&lt;pi&lt;1)<br><br>   The next n lines, each line firstly contains an integer s, then followed by s integers, indicates the number of which the i-th island can arrive at. (1 &lt;= s &lt;= n)","type":"input_format","format":"html"},{"title":"Output","content":"   For each test case, you should output &#xFFFD;&#xFFFD;Case #K: &#xFFFD;&#xFFFD; first, where K indicates the case number and counts from 1. Then output the answer. Round the answer to the sixth digit after the decimal point.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n3\n0.123 0.984 0.63\n2 1 2\n2 2 3\n2 1 3\n2\n0.75 0.34\n2 1 2\n2 1 2</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1: 4.931167\nCase #2: 1.458716\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>If the player achieve the goal of the game, he/she won&apos;t enter the blue magic set anymore.</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Author","content":"UESTC","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2014+Multi-University+Training+Contest+7&amp;source=1&amp;searchmode=source\"> 2014 Multi-University Training Contest 7 </a> ","type":"source","format":"html"}]}