{"title":"As long as Binbin loves Sangsang","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4360","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4360&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4360","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4360"},"statement":[{"title":"Problem Description","content":"Binbin misses Sangsang so much. He wants to meet with Sangsang as soon as possible.<br>Now Binbin downloads a map from ELGOOG.There are N (1&lt;=N&lt;=1,314) cities in the map and these cities are connected by M(0&lt;=M&lt;=13,520) bi-direct roads. Each road has a length L (1&lt;=L&lt;=1,314,520)and is marked using a unique ID, which is a letter fromthe string &#x201C;LOVE&#x201D;!<br>Binbin rides a DONKEY, the donkey is so strange that it has to walk in the following sequence &#x2018;L&#x2019;-&gt;&#x2019;O&#x2019;-&gt;&#x2019;V&#x2019;-&gt;&#x2019;E&#x2019;-&gt;&#x2019;L&#x2019;-&gt;&#x2019;O&#x2019;-&gt;&#x2019;V&#x2019;-&gt;&#x2019;E&#x2019;-&gt;.... etc.<br>Can you tell Binbin how far the donkey has to walk in order to meet with Sangsang?<br>WARNING: Sangsang will feel unhappy if Binbin ride the donkey without a complete&#x201D;LOVE&#x201D; string.<br>Binbin is at node 1 and Sangsang is at node N.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line has an integer T(1&lt;=T&lt;=520), indicate how many test cases bellow.<br>Each test case begins with two integers N, M (N cities marked using an integer from 1&#x2026;N and M roads).<br>Then following M lines, each line has four variables&#x201C;U V L letter&#x201D;, means that there is a road between city U,V(1&lt;=U,V&lt;=N) with length L and the letter marked is&#x2018;L&#x2019;,&#x2019;O&#x2019;,&#x2019;V&#x2019; or &#x2018;E&#x2019;<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, output a string<br><strong>1.</strong>&#xA0;&#xA0;&#x201C;Case ?: Binbin you disappoint Sangsang again, damn it!&#x201D;<br>If Binbin failed to meet with Sangsang or the donkey can&#x2019;t finish a path withthe full &#x201C;LOVE&#x201D; string.<br><strong>2.</strong>&#xA0;&#xA0;&#x201C;Case ?: Cute Sangsang, Binbin will come with a donkey after travelling ? meters and finding ? LOVE strings at last.&#x201D;<br>Of cause, the travel distance should be as short as possible, and at the same time the &#x201C;LOVE&#x201D; string should be as long as possible.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n4 4\n1 2 1 L\n2 1 1 O\n1 3 1 V\n3 4 1 E\n4 4\n1 2 1 L\n2 3 1 O\n3 4 1 V\n4 1 1 E</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1: Cute Sangsang, Binbin will come with a donkey after travelling 4 meters and finding 1 LOVE strings at last.\nCase 2: Binbin you disappoint Sangsang again, damn it!</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Author","content":"FZU","type":"source","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2012+Multi-University+Training+Contest+7&amp;source=1&amp;searchmode=source\"> 2012 Multi-University Training Contest 7 </a> ","type":"source","format":"html","require":["katex"]}]}