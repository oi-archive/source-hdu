{"title":"Missile","time_limit":2000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4354","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4354&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4354","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4354"},"statement":[{"title":"Problem Description","content":"Long long ago,there is a strange area where all the C cities are located in a straight line.To make things easy,lets regard the line as X axis.<br>Even more strangely,cities belonging to the same country are not necessarily adjacent to each other.<br>But people of these countries are still living happily with their friends.<br>However,their enemies are preparing for a disastrous attack.Recently they have invented a new weapon called missile,which can destroy any city if they have enough power.If they want to destroy a set of cities,the power required is max{xi}-min{xj},where i and j are all from the city set they want to destroy.Now the enenies are wondering the minimum power needed to destroy some cities which are from at least K different countries.This is an easy task.The problem is that some countries are strangely protected.That means ,if country A and country B has a special relationship,you can destroy at most one country&apos;s cities.A good news is that the relationships will not form circles.But the enemies regard it as helpless,so they order you to write a programme to calculate the specific power.In this task,you can assume that once the missile is launched with certain power,it will destroy the cities from as more countries as possible.","type":"description","format":"html"},{"title":"Input","content":"There is an integer T (1&lt;=T&lt;=60) indicating the cases you have to solve.Then the following T cases,each one begins with four integers C,N,K,M.C is the number of cities.N is the number of different countries.K is the number of distinct countries the enemies want to destroy.M is the number of the strange relationships. Then comes the next C lines,each line has two integers.The first one is the city&apos;s position x(-10<sup>9</sup>&lt;=x&lt;=10<sup>9</sup>),and the second one is the country Y it belongs to(1&lt;=Y&lt;=N).<br>No two cities are located in the same position.In last M lines, each line contains two integers A and B (1 &lt;= A, B &lt;= N) which means country A and country B has a special relationship.(1&lt;=C&lt;=5000,1&lt;=N&lt;=2000,1&lt;=K&lt;=N,0&lt;=M&lt;=1000)","type":"input_format","format":"html"},{"title":"Output","content":"First you should output &quot;Case #X:&quot; ,without quote.X means the case number you are dealing with.After that ,you should output a blank and the answer.If it&apos;s impossible,then the answer should be -1.See sample for more details.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n3 3 2 1\n0 1\n2 2\n5 3\n1 2\n\n3 3 3 1\n0 1\n2 2\n5 3\n1 2</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1: 3\nCase #2: -1\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nNot all the cases are big ones.\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Author","content":"1guangnian@UESTC03","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2012+Multi-University+Training+Contest+6&amp;source=1&amp;searchmode=source\"> 2012 Multi-University Training Contest 6 </a> ","type":"source","format":"html"}]}