{"title":"Ene's problem","time_limit":3000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5022","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5022&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5022","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5022"},"statement":[{"title":"Problem Description","content":"   Ene was a girl lives in computer systems. When she was studying the periodic sequence b<sub>n</sub> = B<sup>n</sup> mod P (B is an integer and P is a prime number, n &gt;= 0), she chose a contiguous subsequence b<sub>s</sub>, b<sub>s + 1</sub>, &#x2026;, b<sub>t</sub>, and marked them as special numbers. Then she began to investigate another sequence a<sub>n</sub> = M &#xD7; A<sup>n</sup> mod P, (M and A are integers) and incidentally such a problem came to her mind: what is the minimum non-negative integer k such that a<sub>k</sub> is a special number(k starts from 0) ?<br> <br>   As a result of Ene&apos;s ability to control a computer, she soon answered the question of herself. But as she had never taken any computer science courses, she could only enumerate all possible solutions to get the answer. Your task is to solve her questions faster, so your algorithm should possess a lot higher performance than hers.","type":"description","format":"html"},{"title":"Input","content":"   There are no more than 100 test cases in the input. In each case, you are given six integers M, A, B, s, t, P, satisfying 2 &#x2264; A, B, M &lt; P &#x2264; 10<sup>9</sup>&#xFF0C;0 &#x2264; s &#x2264; t &lt; P - 1, and P is a prime number. The input ends by 0 0 0 0 0 0.","type":"input_format","format":"html"},{"title":"Output","content":"   For each test case, output your answer k in one line. If there&apos;s no solution, output &quot;impossible&quot; (no quotes).","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2 3 5 1 6 11\n2 3 8 1 6 11\n0 0 0 0 0 0</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">impossible\n1\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>   In the first test case, b1 = 5, b2 = 3, b3 = 4, b4 = 9, b5 = 1, b6 = 5, and a0 = 2, a1 = 6, a2 = 7, a3 = 10, a4 = 8, a5 = 2, it makes a cycle.\n   On the other hand, in the second test case, b1 = 8, b2 = 9, b3 = 6, b4 = 4, b5 = 10, b6 = 3, and a0 = 2, a1 = 6 = b3. So that answer is 1.\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2014+ACM%2FICPC+Asia+Regional+Guangzhou+Online&amp;source=1&amp;searchmode=source\"> 2014 ACM/ICPC Asia Regional Guangzhou Online </a> ","type":"source","format":"html"}]}