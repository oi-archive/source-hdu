{"title":"Join The Future","time_limit":5000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5743","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5743&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5743","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5743"},"statement":[{"title":"Problem Description","content":"Professor Zhang has an array of $n$ integers. He writes down some properties about the array in the paper. Each property is described by three integers $l_i$, $r_i$ and $s_i$, which means that the sum of elements modulo 2 on interval $[l_i, r_i]$ of the array is equal to $s_i$.<br><br>After that, he tries to recover the array only using the above properties. Apparently, there are many such arrays. So, Professor Zhang decides to limits the lower bound and upper bound of each integer in the array.<br><br>Given the properties, the lower bounds and the upper bounds, find the number of possible arrays and the lexicographically smallest array.","type":"description","format":"html"},{"title":"Input","content":"There are multiple test cases. The first line of input contains an integer $T$, indicating the number of test cases. For each test case:<br><br>The first line contains two integers $n$ and $m$ $(1 \\le n \\le 40, 0 \\le m \\le \\frac{n(n+1)}{2})$ -- the length off array and the number of properties.<br><br>Each of the next $n$ lines contains two integers $x_i$ and $y_i$ $(0 \\le x_i \\le y_i \\le 10^9)$ -- the lower bound and upper bound of the $i$-th integer.<br><br>Each of the next $m$ lines contains three integers $l_i$, $r_i$ and $s_i$ $(1 \\le l_i \\le r_i \\le n, 0 \\le s_i \\le 1)$ denoting the $i$-th property.","type":"input_format","format":"html"},{"title":"Output","content":"For each case, output the number of possible arrays in the first line. As the value could be very large, print it modulo $10^9 + 7$. Then, output the lexicographically smallest array in the second line. If the number of possible arrays equals to zero, just output &quot;-1&quot; (without the quotes) in the second line.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n3 3\n1 10\n0 21\n3 15\n2 2 1\n3 3 0\n2 3 1\n3 0\n0 1\n1 3\n3 4\n3 3\n1 10\n0 21\n3 3\n2 2 1\n3 3 0\n2 3 1</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">660\n1 1 4\n12\n0 1 3\n0\n-1</div></pre>","type":"example","format":"html"},{"title":"Author","content":"zimpha","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2016+Multi-University+Training+Contest+2&amp;source=1&amp;searchmode=source\"> 2016 Multi-University Training Contest 2 </a> ","type":"source","format":"html"}]}