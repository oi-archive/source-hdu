{"title":"Typewriter","time_limit":3000,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5470","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5470&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5470","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5470"},"statement":[{"title":"Problem Description","content":"Nowadays, our senior is typewriting an article for her graduation. But as you know our senior is foolish sometimes, so she needs your help. You can assume senior&#x2019;s article is a string, and senior&#x2019;s typewriter provides two operations to typewrite it:<br>1)&#xA0;&#xA0;Assume you have typewritten a string s, then you can add a character after s, and the cost of adding each character is given to you.<br>2)&#xA0;&#xA0;Assume you have typewritten a string s, you can select a substring of s and copy it, then you can paste it after s once. The cost to select a character is A&#xFF0C;and the cost to copy and paste a string are all equal B.<br>Now, you should help senior to typewrite the article by using the minimum cost, can you help her?<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"In the first line there is an integer T($1 \\leq T \\leq 100$), indicating the number of test cases.<br>For each test case:<br>The first line includes a string s ($1 \\leq |s| \\leq 10^5$) composed by lowercase letters, indicating the article senior want to typewrite.<br>The second line includes 26 integers, indicating the cost to add character &#x2018;a&#x2019;, &#x2018;b&#x2019;, &#x2018;c&#x2019;&#x2026;, and so on.<br>The third line includes two integers A and B.<br>All the integers in the input are in the range of $[1, 10^9]$. It is guaranteed that the total length of s doesn&apos;t exceed $1.2 \\times 10^6$.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case:<br>Please output &#x201C;Case #k: answer&#x201D;(without quotes) one line, where k means the case number count from 1, and the answer is the minimum cost to typewrite the article.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\nabc\n1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n2 2\naaaa\n10 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n1 1</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1: 3\nCase #2: 17</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2015+ACM%2FICPC+Asia+Regional+Shanghai+Online&amp;source=1&amp;searchmode=source\"> 2015 ACM/ICPC Asia Regional Shanghai Online </a> ","type":"source","format":"html","require":["katex"]}]}