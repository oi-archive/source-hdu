{"title":"Residual Polynomial","time_limit":3000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6900","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6900&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6900","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6900"},"statement":[{"title":"Problem Description","content":"Kanade has $n$ polynomials $f_1(x)...f_n(x)$. These polynomials satisfy the following conditions:<br><br>1. $f_1(x)=\\sum_{i=0}^{n}a_ix^i$<br><br>2. $\\forall i\\in [2,n], f_i(x)=b_i(f_{i-1}(x))&apos;+c_if_{i-1}(x)$<br><br>Given $a_0,a_1,\\cdots,a_n,b_2,b_3,\\cdots,b_n,c_2,c_3,\\cdots,c_n$, Kanade wants to know $f_n(x)$<br><br>Because the coefficients of $f_n(x)$ may be very large, you only need to output them module $998244353$","type":"description","format":"html"},{"title":"Input","content":"There are $T$ test cases.<br><br>The first line has 1 integer $T$.<br><br>Then for every test case:<br><br>The first line has 1 integer $n$.<br><br>The second line has $n+1$ integers $a_{0...n}$<br><br>The third line has $n-1$ integers $b_{2...n}$<br><br>The fourth line has $n-1$ integers $c_{2...n}$ <br><br>$1\\leq T\\leq 100$<br><br>$3\\leq n\\leq 10^5$<br><br>$0\\leq a_i,b_i,c_i &lt; 998244353$<br><br>There are at most $3$ test cases satisfy that $n&gt;1000$","type":"input_format","format":"html"},{"title":"Output","content":"For every test case, if $f_n(x)=\\sum_{i=0}^{n}w_ix^i$, then output $n+1$ integers $w_{0...n}$ in a line and separate them by spaces.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n3\n0 0 0 1\n1 1\n1 1\n4\n1 1 1 1 1\n1 2 1\n2 3 2\n5\n3 4 5 6 5 4\n4 1 6 0\n6 9 2 7</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">0 6 6 1\n66 166 204 92 12\n37940 117264 204708 207256 60900 3024</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2020%D6%D0%B9%FA%B4%F3%D1%A7%C9%FA%B3%CC%D0%F2%C9%E8%BC%C6%BE%BA%C8%FC%A3%A8CCPC%A3%A9+-+%CD%F8%C2%E7%D1%A1%B0%CE%C8%FC&amp;source=1&amp;searchmode=source\"> 2020&#x4E2D;&#x56FD;&#x5927;&#x5B66;&#x751F;&#x7A0B;&#x5E8F;&#x8BBE;&#x8BA1;&#x7ADE;&#x8D5B;&#xFF08;CCPC&#xFF09; - &#x7F51;&#x7EDC;&#x9009;&#x62D4;&#x8D5B; </a> ","type":"source","format":"html"}]}