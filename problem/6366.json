{"title":"black-and-white","time_limit":12000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6366","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6366&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6366","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6366"},"statement":[{"title":"Problem Description","content":"Patrick Star found a world consist of N * N girds. Every gird is either black or write.<br><br>If one black gird $a$ is not &quot;reachable&quot; from another one black gird $b$, we said that the pair of $(a, b)$ is &quot;special pair&quot; ! What&apos;s more, Patrick Star regards the score of this pair as the Manhattan Distance between the two girds.<br><br>For every two girds, if there exist an path begin from one and end at another one, also this path consists only black girds and turns at most once, then the two girds are &quot;reachable&quot; from each other.<br><br>For better understanding of possible paths, every pair of gird (a, b) has only two possible paths while ignore the other limits, marked by \\#, and both paths include &quot;a&quot; and &quot;b&quot;.<br><br><br>========<br><br>=a#####=<br><br>=#====#=<br><br>=#####b=<br><br><br>And see the text-picture below to get better understanding about &apos;reachable&apos;, we use &quot;1&quot; to stand for black gird and &quot;0&quot; to the white.<br><br>11111111<br><br>10110000<br><br>10011110<br><br>11111111<br><br>pair of [(2, 4), (4, 8)] : reachable. by path (2, 4) -&gt; (4, 4) -&gt; (4, 8).<br><br>pair of [(1, 5), (4, 8)] : not reachable, Manhattan Distance is |1 - 4| + |5 - 8| = 6.<br><br>pair of [(1, 5), (4, 4)] : reachable. by path (1, 5) -&gt; (1, 4) -&gt; (4, 4).<br><br>pair of [(1, 5), (4, 3)] : not reachable, Manhattan Distance is |1 - 4| + |5 - 3| = 5.<br>...<br><br><br>Now Patrick Star wants to know the max score among all special pairs.<br><br>If there is not any special pair , just output &quot;Opps!&quot;.<br><br>Moreover, assume that the maximum score described above is $D$ (if exist), Patrick Star wants know how many special pair has score of $D$. (unordered, that is to say $pair(a, b)$ is the same as $pair(b, a)$).<br><br>It is guaranteed that the two answers no more than 2147483647.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line contain a integer $T$(no more than 10), the following is $T$ test case, for each test case:<br><br>The first line contains one integers $N(1 \\le N \\le 2000)$.<br><br>The following $N$ lines show an $N$ * $N$ girds. <br><br>each line contain a string of length $N$ consist of &quot;0&quot; or &quot;1&quot; which mean &quot;white&quot; or &quot;black&quot;<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case , output one line :<br><br>1. If no exist special pair, just output &quot;Opps!&quot;.<br><br>2. Else output two integers separated by white space, the first one is the maximum score, and the second one is the number of special pairs reach the maximun score.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n4\n1011\n1001\n1001\n1111</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5 3</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2018+Multi-University+Training+Contest+6&amp;source=1&amp;searchmode=source\"> 2018 Multi-University Training Contest 6 </a> ","type":"source","format":"html","require":["katex"]}]}