{"title":"Crystal mine","time_limit":1500,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3630","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3630&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3630","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3630"},"statement":[{"title":"Problem Description","content":"Legends always begin with the sentence &#x201C;Long long ago......&#x201D;<br>Long long ago, there is a kingdom. The border of this kingdom is rectangular, and some lakes in it. Old king divides land to N * M areas. So, we can regard this kingdom as a matrix. Every element of matrix is an area. This kingdom is famous for crystal mine, because every land contains an ocean of crystal underground, except lakes.<br>Now, the old king wants to build a large rectangular mine field in a rectangular range which is decide by him. What&#x2019;s more, he wants to build a special area in mine field, which can produce crystal manyfold. Notice that mine field can&apos;t contain lakes. Unfortunately, the old king is too old to remember something. He always asks his adviser this question with different range.<br>Adviser is tired of answering those questions day by day. So, you are assigned to solve this problem. You get the kingdom map, and the amount of crystal of every area (as A[][]) has been marked on this map. You should find out the best plan to build this mine field which can produce most crystal. Old king never care the details of plan. The only thing he wants know is the number of crystal the mine field can produce.<br>","type":"description","format":"html"},{"title":"Input","content":"There are several test cases in the input file.<br>The first line of input file contains a number T, representing the number of test cases. For each test case:<br>First line contains four integers separated by a single blank, N (1 &lt;= N &lt;= 150), M (1 &lt;= M &lt;= 150), Q (1&lt;= Q &lt;= 200), S (1 &lt;= S &lt;= 10). The size of matrix is N * M. Q indicates the number of questions of old king. S indicates that, if you set the special area in (i,j), (i,j) will produce S * A[i][j] instead of A[i][j].<br>The following N lines, each line contains M number, the j-th number of i-th line represent A[i][j] (-1 &lt;= A[i][j] &lt; 100 ). Number -1 indicates that, this area is a lake. Otherwise A[i][j] indicates the amount of crystal in this area.<br>Following Q line, each line contains four integers p, q, x, y. (1 &lt;= p &lt;= x &lt;= N, 1 &lt;= q &lt;= y &lt;= M) indicating the rectangular range of this question is from (p,q) to (x,y). (p,q) is upper left corner of range, and (x,y) is lower right corner of range.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, first line should contains &#x201C;Case #: &#x201D;, &#x201D;#&#x201D;is case number (starting from 1). Each of the following Q line contains a number indicating the answer of question.<br>Look at sample output for more details. There is a blank line between two consecutive test cases.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n4 4 3 2\n1 -1 0 3\n1 1 2 0\n2 1 0 -1\n1 4 6 1\n1 1 1 1\n1 1 3 3\n1 3 3 4</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1:\n2\n9\n8</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2010+Asia+Regional+Tianjin+Site+%A1%AA%A1%AA+Online+Contest&amp;source=1&amp;searchmode=source\"> 2010 Asia Regional Tianjin Site &#x2014;&#x2014; Online Contest </a> ","type":"source","format":"html"}]}