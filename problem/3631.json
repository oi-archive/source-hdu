{"title":" Shortest Path","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3631","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3631&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3631","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3631"},"statement":[{"title":"Problem Description","content":"When YY was a boy and LMY was a girl, they trained for NOI (National Olympiad in Informatics) in GD team. One day, GD team&#x2019;s coach, Prof. GUO asked them to solve the following shortest-path problem.<br>There is a weighted directed multigraph G. And there are following two operations for the weighted directed multigraph:<br>(1) Mark a vertex in the graph.<br>(2) Find the shortest-path between two vertices only through marked vertices.<br>For it was the first time that LMY faced such a problem, she was very nervous. At this moment, YY decided to help LMY to analyze the shortest-path problem. With the help of YY, LMY solved the problem at once, admiring YY very much. Since then, when LMY meets problems, she always calls YY to analyze the problems for her. Of course, YY is very glad to help LMY. Finally, it is known to us all, YY and LMY become programming lovers.<br>Could you also solve the shortest-path problem?<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The input consists of multiple test cases. For each test case, the first line contains three integers N, M and Q, where N is the number of vertices in the given graph, N&#x2264;300; M is the number of arcs, M&#x2264;100000; and Q is the number of operations, Q &#x2264;100000. All vertices are number as 0, 1, 2, &#x2026; , N - 1, respectively. Initially all vertices are unmarked. Each of the next M lines describes an arc by three integers (x, y, c): initial vertex (x), terminal vertex (y), and the weight of the arc (c). (c &gt; 0) Then each of the next Q lines describes an operation, where operation &#x201C;0 x&#x201D; represents that vertex x is marked, and operation &#x201C;1 x y&#x201D; finds the length of shortest-path between x and y only through marked vertices. There is a blank line between two consecutive test cases.<br>End of input is indicated by a line containing N = M = Q = 0.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"Start each test case with &quot;Case #:&quot; on a single line, where # is the case number starting from 1.<br>For operation &#x201C;0 x&#x201D;, if vertex x has been marked, output &#x201C;ERROR! At point x&#x201D;.<br>For operation &#x201C;1 x y&#x201D;, if vertex x or vertex y isn&#x2019;t marked, output &#x201C;ERROR! At path x to y&#x201D;; if y isn&#x2019;t reachable from x through marked vertices, output &#x201C;No such path&#x201D;; otherwise output the length of the shortest-path. The format is showed as sample output.<br>There is a blank line between two consecutive test cases.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5 10 10\n1 2 6335\n0 4 5725\n3 3 6963\n4 0 8146\n1 2 9962\n1 0 1943\n2 1 2392\n4 2 154\n2 2 7422\n1 3 9896\n0 1\n0 3\n0 2\n0 4\n0 4\n0 1\n1 3 3\n1 1 1\n0 3\n0 4\n0 0 0</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1:\nERROR! At point 4\nERROR! At point 1\n0\n0\nERROR! At point 3\nERROR! At point 4</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2010+Asia+Regional+Tianjin+Site+%A1%AA%A1%AA+Online+Contest&amp;source=1&amp;searchmode=source\"> 2010 Asia Regional Tianjin Site &#x2014;&#x2014; Online Contest </a> ","type":"source","format":"html","require":["katex"]}]}