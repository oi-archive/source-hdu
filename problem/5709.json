{"title":"Claris Loves Painting","time_limit":5000,"memory_limit":250,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5709","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5709&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5709","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5709"},"statement":[{"title":"Problem Description","content":"Claris loves painting very much, so he painted a tree with beautiful colors.<br><br>The tree is a rooted tree with $n$ nodes which are conveniently labeled by $1,2,...,n$. Its root is the $1$-st node, and the $i$-th node is painted with color $c_i$. If $c_i=c_j$, then we think these two nodes have the same color.<br><br>We define $depth_i$ as the distance between the $i$-th node and the root, and simply, the distance between two adjacent nodes is always $1$.<br><br>Standing in front of this beautiful tree, Claris comes up with $m$ questions.<br>In each question, there are two integers $x$ and $d$, which means that Claris wants to know the number of different kinds of colors occur in $S$, where $S=\\left\\{v|v\\ in\\ x&apos;s\\ subtree\\ and\\ depth_v\\leq depth_x+d\\right\\}$.<br>","type":"description","format":"html"},{"title":"Input","content":"The first line of the input contains an integer $T(1\\leq T\\leq 500)$, denoting the number of test cases.<br><br>In every test case, there are two integers $n(1\\leq n\\leq 100000)$ and $m(1\\leq m\\leq 100000)$ in the first line, denoting the number of nodes and queries.<br>The second line contains $n$ integers, the $i$-th integer $c_i(1\\leq c_i\\leq n)$ denotes the color of the $i$-th node.<br>The third line contains $n-1$ integers, the $i$-th integer $f_{i+1}(1\\leq f_i&lt;i)$ denotes the father of the $i+1$-th node.<br>In the following $m$ lines, each line contains two integers $x(1\\leq x\\leq n)$ and $d(0\\leq d&lt;n)$, denoting each query.<br><br>The input has been encoded, if you read $x$ and $d$, the real $x$ and $d$ are $x \\oplus last$ and $d \\oplus last$, where $last$ is the answer of the previous query and $\\oplus$ means bitwise exclusive-or.<br><br>Notice : <br>If it is the first query in this test case, then $last=0$.<br>It is guaranteed that $\\sum n \\leq 500000$ and $\\sum m \\leq 500000$.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each query output a single integer in a line, denoting the answer.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n5 8\n1 3 3 2 2\n1 1 3 3\n1 0\n0 0\n3 0\n1 3\n2 1\n2 0\n6 2\n4 1</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n2\n3\n1\n1\n2\n1\n1</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=%26quot%3B%B0%CD%BF%A8%CB%B9%B1%AD%26quot%3B+%D6%D0%B9%FA%B4%F3%D1%A7%C9%FA%B3%CC%D0%F2%C9%E8%BC%C6%BE%BA%C8%FC+-+%C5%AE%C9%FA%D7%A8%B3%A1&amp;source=1&amp;searchmode=source\"> &quot;&#xFFFD;&#x37F;&#xFFFD;&#x2F9;&#xFFFD;&#xFFFD;&quot; &#xFFFD;&#x439;&#xFFFD;&#xFFFD;&#xFFFD;&#x467;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#x1BE;&#xFFFD;&#xFFFD;&#xFFFD; - &#x16E;&#xFFFD;&#xFFFD;&#x5E8;&#xFFFD;&#xFFFD; </a> ","type":"source","format":"html"}]}