{"title":"Query on a graph","time_limit":3000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5957","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5957&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5957","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5957"},"statement":[{"title":"Problem Description","content":"You are given a connected simple graph(in which both multiple edges and loops are disallowed) with N nodes and N edges. In this graph each node has a weight, and each edge has the same length of one unit. Define D(u,v) as the distance between node u and node v. Define S(u,k) as the set of nodes x which satisfy D(u,x) &#x2264; k.<br>We will ask you to perform some instructions of the following forms.<br>MODIFY u k d: weight of all nodes in S(u,k) increase by d or decrease by -d. <br>QUERY u k: ask for the sum of weight of all nodes in S(u,k).<br>In the beginning, the weight of all nodes are 0. ","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line of input contains an integer t, the number of test cases. t test cases follow. For each test case, in the first line there is an integer N(N &#x2264; 100000). The i-th line of the next N line describes the i-th edge: two integers u,v denotes an edge between u and v. In the next line, an integer Q(Q &#x2264; 100000) indicates the number of instructions. Next Q lines contain instructions MODIFY u k d or QUERY u k, where |d|&#x2264; 100 and 0 &#x2264; k &#x2264; 2. ","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each QUERY instruction, output a integer in a line. ","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n6\n1 2\n2 3\n3 4\n4 1\n4 5\n3 6\n5\nMODIFY 1 1 3\nMODIFY 3 1 2\nMODIFY 5 2 1\nQUERY 3 2\nQUERY 4 1\n6\n1 2\n2 3\n3 1\n1 4\n2 5\n3 6\n5\nMODIFY 3 1 5\nMODIFY 2 2 2\nQUERY 6 1\nMODIFY 4 1 -2\nQUERY 2 2</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">21\n14\n14\n28</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2016ACM%2FICPC%D1%C7%D6%DE%C7%F8%C9%F2%D1%F4%D5%BE-%D6%D8%CF%D6%C8%FC%A3%A8%B8%D0%D0%BB%B6%AB%B1%B1%B4%F3%D1%A7%A3%A9&amp;source=1&amp;searchmode=source\"> 2016ACM/ICPC&#x4E9A;&#x6D32;&#x533A;&#x6C88;&#x9633;&#x7AD9;-&#x91CD;&#x73B0;&#x8D5B;&#xFF08;&#x611F;&#x8C22;&#x4E1C;&#x5317;&#x5927;&#x5B66;&#xFF09; </a> ","type":"source","format":"html","require":["katex"]}]}