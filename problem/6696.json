{"title":"Dense Subgraph","time_limit":6000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6696","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6696&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6696","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6696"},"statement":[{"title":"Problem Description","content":"You have a tree on $n$ vertices, and each vertex has a weight $a_v$ and a degree at most $5$.<br><br>Let&apos;s call the <b>density</b> of a subset of vertices $S$ value $\\frac{\\sum_{v \\in S} a_v}{|S|}$, and call the <b>beauty</b> of the tree with some vertices turned off the maximum value of the <b>density</b> of a subset of at least two turned on vertices with connected induced subgraph, or $0$ if no such subset exists.<br><br>Now you need to calculate the number of ways to choose such a set of turned off vertices among $2^n$ ways that the <b>beauty</b> of the tree is no larger than $x$, modulo $1\\,000\\,000\\,007$.<br>","type":"description","format":"html"},{"title":"Input","content":"The input contains several test cases, and the first line contains a single integer $T~(1 \\le T \\le 30)$, the number of test cases.<br><br>The first line of each test case contains two integers $n~(2 \\leq n \\leq 35\\,000)$ and $x~(0 \\leq x \\leq 35\\,000)$, the number of vertices of a tree and the constraint on the beauty.<br><br>The next line contains $n$ integers $a_1, a_2, \\ldots, a_n~(0 \\leq a_i \\leq 35\\,000)$, the weights of the tree vertices.<br><br>Each of the next $n-1$ lines contains two integers $u$ and $v~(1 \\leq u, v \\leq n)$, describing an edge connecting vertices $u$ and $v$ in the tree. <br><br><b>It is guaranteed that each vertex of a tree has a degree at most $5$.</b><br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output a line containing a single integer, indicating the number of ways to choose such a set of turned off vertices among $2^n$ ways that the <b>beauty</b> of the tree is no larger than $x$, modulo $1\\,000\\,000\\,007$.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n5 0\n1 1 1 1 1\n1 2\n2 3\n3 4\n4 5\n3 2\n2 1 3\n1 2\n1 3</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">13\n6</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2019+Multi-University+Training+Contest+10&amp;source=1&amp;searchmode=source\"> 2019 Multi-University Training Contest 10 </a> ","type":"source","format":"html"}]}