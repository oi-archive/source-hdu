{"title":"Rikka with K-Match","time_limit":7000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6094","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6094&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6094","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6094"},"statement":[{"title":"Problem Description","content":"As we know, Rikka is poor at math. Yuta is worrying about this situation, so he gives Rikka some math tasks to practice. There is one of them:<br><br>Yuta has a graph $G$ with $n$ nodes $(i,j)(1 \\leq i \\leq n,1 \\leq j \\leq m)$. There is an edge between $(a,b)$ and $(c,d)$ if and only if $|a-c|+|b-d|=1$. Each edge has its weight.<br><br>Now Yuta wants to calculate the minimum weight $K$-matching of $G$.<br><br>It is too difficult for Rikka. Can you help her?&#xA0;&#xA0;<br><br>An edge set $S$ is a match of $G=\\langle V,E \\rangle$ if and only if each nodes in $V$ connects to at most one edge in $S$. A match $S$ is a $K$-match if and only if $|S|=K$. The weight of a match $S$ is the sum of the weights of the edges in $S$. And finally, the minimum weight $K$-matching of $G$ is defined as the $K$-match of $G$ with the minimum weight.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line contains a number $t(1 \\leq t \\leq 1000)$, the number of the testcases. And there are no more than $3$ testcases with $n &gt; 100$.<br><br>For each testcase, the first line contains three numbers $n,m,K(1 \\leq n \\leq 4 \\times 10^4,1 \\leq m \\leq 4),1 \\leq K \\leq \\lfloor \\frac{nm}{2} \\rfloor$.<br><br>Then $n-1$ lines follow, each line contains $m$ numbers $A_{i,j}(1 \\leq A_{i,j} <br>\\leq 10^9)$ -- the weight of the edge between $(i,j)$ and $(i+1,j)$.<br><br>If $m&gt;1$, then $n$ lines follow, each line contains $m-1$ numbers $B_{i,j}(1 \\leq B_{i,j} \\leq 10^9)$ -- the weight of the edge between $(i,j)$ and $(i,j+1)$.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each testcase, print a single line with a single number -- the answer.<br><br>It is guaranteed that there exists at least one $K$-match.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n3 3 1\n3 4 5\n8 9 10\n1 2\n6 7\n11 12\n3 3 2\n3 4 5\n8 9 10\n1 2\n6 7\n11 12\n3 3 3\n3 4 5\n8 9 10\n1 2\n6 7\n11 12</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n5\n12</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2017+Multi-University+Training+Contest+-+Team+5&amp;source=1&amp;searchmode=source\"> 2017 Multi-University Training Contest - Team 5 </a> ","type":"source","format":"html","require":["katex"]}]}