{"title":"Bus Pass","time_limit":5000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=2377","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=2377&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=2377","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=2377"},"statement":[{"title":"Problem Description","content":"You travel a lot by bus and the costs of all the seperate tickets are starting to add up. <br><br>Therefore you want to see if it might be advantageous for you to buy a bus pass. <br><br>The way the bus system works in your country (and also in the Netherlands) is as follows: <br><br>when you buy a bus pass, you have to indicate a center zone and a star value. You are allowed to travel freely in any zone which has a distance to your center zone which is less than your star value. For example, if you have a star value of one, you can only travel in your center zone. If you have a star value of two, you can also travel in all adjacent zones, et cetera. <br><br>You have a list of all bus trips you frequently make, and would like to determine the minimum star value you need to make all these trips using your buss pass. But this is not always an easy task. For example look at the following figure: <br><br><center><img style=\"max-width:100%;\" src=\"../../../data/images/C141-1002-1.jpg\"></center><br><br>Here you want to be able to travel from A to B and from B to D. The best center zone is 7400, for which you only need a star value of 4. Note that you do not even visit this zone on your trips! <br>","type":"description","format":"html"},{"title":"Input","content":"On the first line an integert(1 &lt;=t&lt;= 100): the number of test cases. Then for each test case: <br><br>One line with two integersnz(2 &lt;=nz&lt;= 9 999) andnr(1 &lt;=nr&lt;= 10): the number of zones and the number of bus trips, respectively. <br><br>nz lines starting with two integers id<sub>i</sub> (1 &lt;= id<sub>i</sub> &lt;= 9 999) and mz<sub>i</sub> (1 &lt;= mz<sub>i</sub> &lt;= 10), a number identifying the i-th zone and the number of zones adjacent to it, followed by mz<sub>i</sub> integers: the numbers of the adjacent zones. <br><br>nr lines starting with one integer mr<sub>i</sub> (1 &lt;= mr<sub>i</sub> &lt;= 20), indicating the number of zones the ith bus trip visits, followed by mr<sub>i</sub> integers: the numbers of the zones through which the bus passes in the order in which they are visited. <br><br>All zones are connected, either directly or via other zones. <br><br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case: <br><br>One line with two integers, the minimum star value and the id of a center zone which achieves this minimum star value. If there are multiple possibilities, choose the zone with the lowest number. <br><br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n17 2\n7400 6 7401 7402 7403 7404 7405 7406\n7401 6 7412 7402 7400 7406 7410 7411\n7402 5 7412 7403 7400 7401 7411\n7403 6 7413 7414 7404 7400 7402 7412\n7404 5 7403 7414 7415 7405 7400\n7405 6 7404 7415 7407 7408 7406 7400\n7406 7 7400 7405 7407 7408 7409 7410 7401\n7407 4 7408 7406 7405 7415\n7408 4 7409 7406 7405 7407\n7409 3 7410 7406 7408\n7410 4 7411 7401 7406 7409\n7411 5 7416 7412 7402 7401 7410\n7412 6 7416 7411 7401 7402 7403 7413\n7413 3 7412 7403 7414\n7414 3 7413 7403 7404\n7415 3 7404 7405 7407\n7416 2 7411 7412\n5 7409 7408 7407 7405 7415\n6 7415 7404 7414 7413 7412 7416</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">4 7400</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=bapc2007&amp;source=1&amp;searchmode=source\"> bapc2007 </a> ","type":"source","format":"html"}]}