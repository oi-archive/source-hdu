{"title":"List wants to travel","time_limit":3000,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5893","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5893&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5893","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5893"},"statement":[{"title":"Problem Description","content":"A boy named List who is perfect in English. Now he wants to travel and he is making a plan. But the cost of living in same citie always changes. Now he wants to know how many different kinds of continuous same cost he has to pay for living between  two cities. Can you help him? (He is so lazy to do this by himself.)","type":"description","format":"html"},{"title":"Input","content":"There are multiple cases. The first line contains two positive numbers N and M(N (N&lt;=40000) where N is the amount of cities and M (M&lt;=50000)) is the amount of operations.Then N-1 lines where each line have 3 integers a  b and c, representing that there is a bidirectionoal road between city a and city b, and the cost is c.(a != b and c &lt;= 100000). Then there are M lines of operation. For example, &quot;Change a b c&quot; means changing all the costs of the road which are passed by him when he travels from city a to city b to c. &quot;Query a b&quot; means he wants you to tell him how many different kinds of continuous same cost he has to pay traveling from city a to city b.(if a == b, the cost is 0).","type":"input_format","format":"html"},{"title":"Output","content":"He insure you that there is exactly one route between every two different cities.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">9 3\n1 2 2\n2 3 1\n1 7 2\n1 4 2\n3 5 2\n3 6 1\n5 8 2\n5 9 3\nQuery 1 8\nChange 2 6 3\nQuery 1 6</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n2</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2016+ACM%2FICPC+Asia+Regional+Shenyang+Online&amp;source=1&amp;searchmode=source\"> 2016 ACM/ICPC Asia Regional Shenyang Online </a> ","type":"source","format":"html"}]}