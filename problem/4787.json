{"title":"GRE Words Revenge","time_limit":10000,"memory_limit":320,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4787","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4787&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4787","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4787"},"statement":[{"title":"Problem Description","content":"&#x3000;&#x3000;Now Coach Pang is preparing for the Graduate Record Examinations as George did in 2011. At each day, Coach Pang can:<br>&#x3000;&#x3000;<b>&quot;+w&quot;</b>: learn a word w<br>&#x3000;&#x3000;<b>&quot;?p&quot;</b>: read a paragraph p, and count the number of learnt words. Formally speaking, count the number of substrings of p which is a learnt words.<br>&#x3000;&#x3000;Given the records of N days, help Coach Pang to find the count. For convenience, the characters occured in the words and paragraphs are only &apos;0&apos; and &apos;1&apos;.","type":"description","format":"html"},{"title":"Input","content":"&#x3000;&#x3000;The first line of the input file contains an integer T, which denotes the number of test cases. T test cases follow.<br>&#x3000;&#x3000;The first line of each test case contains an integer N (1 &lt;= N &lt;= 10<sup>5</sup>), which is the number of days. Each of the following N lines contains either &quot;+w&quot; or &quot;?p&quot;. Both p and w are 01-string in this problem.<br>&#x3000;&#x3000;Note that the input file has been encrypted. For each string occured, let L be the result of last &quot;?&quot; operation. The string given to you has been shifted L times (the shifted version of string s<sub>1</sub>s<sub>2</sub> ...  s<sub>k</sub> is s<sub>k</sub>s<sub>1</sub>s<sub>2</sub> ... s<sub>k-1</sub>). You should decrypt the string to the original one before you process it. Note that L equals to 0 at the beginning of each test case.<br>&#x3000;&#x3000;The test data guarantees that for each test case, total length of the words does not exceed 10<sup>5</sup> and total length of the paragraphs does not exceed 5 * 10<sup>6</sup>.","type":"input_format","format":"html"},{"title":"Output","content":"&#x3000;&#x3000;For each test case, first output a line &quot;Case #x:&quot;, where x is the case number (starting from 1).<br>&#x3000;&#x3000;And for each &quot;?&quot; operation, output a line containing the result.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n3\n+01\n+01\n?01001\n3\n+01\n?010\n?011</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1:\n2\nCase #2:\n1\n0</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2013+Asia+Chengdu+Regional+Contest+&amp;source=1&amp;searchmode=source\"> 2013 Asia Chengdu Regional Contest  </a> ","type":"source","format":"html"}]}