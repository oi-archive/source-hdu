{"title":"Equation of XOR","time_limit":1000,"memory_limit":64.2265625,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4025","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4025&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4025","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4025"},"statement":[{"title":"Problem Description","content":"Recently, Jimmy is learning about linear algebra from Blue Mary while having the course of Boolean algebra in class offered by Prof. Z. Since Jimmy has been thoroughly bored by the boring homework assigned by two teachers, evil Jimmy plans to set a hard question to baffle them as revenge for their heavy tasks. As a result, Jimmy comes up with an idea that merging the knowledge from both the two classes and constructs a complicate problem: the XOR equation system.<br>Let&#x2019;s consider the following equations:<br>(a11 . x1) ^ (a12 . x2) ^ &#x2026; ^ (a1m . xm) = 0 <br>(a21 . x1) ^ (a22 . x2) ^ &#x2026; ^ (a2m . xm) = 0 <br>&#x2026;<br>(an1 . x1) ^ (an2 . x2) ^ &#x2026; ^ (anm . xm) = 0<br>which satisfies the following conditions:<br>1.&#xA0;&#xA0;aij  in {0,1} &#xA0;&#xA0;for 1 &#x2264; i &#x2264; n and 1 &#x2264; j &#x2264; m;<br>2.&#xA0;&#xA0;xi  in Si where Si is a subset of {0,1,2,3}, 1 &#x2264; i &#x2264; m;<br>3.&#xA0;&#xA0;|Si| &#x2264; 3, 1 &#x2264; i &#x2264; m;<br>4.&#xA0;&#xA0;1&#x2264;n &#x2264; 30, 1 &#x2264; m &#x2264; 22.<br><br>In the system of equations, operation &#x201C; . &#x201C; denotes the multiplication operation while &#x201C; ^ &#x201D; is for bitwise XOR. Moreover, the bitwise XOR takes two bit patterns of equal length and performs the logical XOR operation on each pair of corresponding bits. The result in each position is 1 if the two bits are different, and 0 if they are the same.<br>Rather than expecting a solution of a specified equation system, Jimmy would like to ask the teachers to calculate that how many distinct solutions can satisfy a given equation system. What a confusing puzzle! Help Jimmy&#x2019;s teachers please!<br>","type":"description","format":"html"},{"title":"Input","content":"There are several test cases. The first line of input is a single positive integer T (&lt;= 15) indicating the number of test cases, then T cases follow.<br>For each test case, the first line contains two integers N and M giving the two dimensions of the equation system respectively where N is the number of rows and M for columns. Then N lines are following, each line contains m integers. Item at line i and column j represents aij. The next m lines are descriptions of Si that the leading integer K denotes the number of elements in Si and the following K integers represent elements.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output one line containing a single integer which represents the answer of this case.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n1 2\n1 1\n3 0 1 2\n2 3 1</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=The+36th+ACM%2FICPC+Asia+Regional+Shanghai+Site+%A1%AA%A1%AA+Online+Contest&amp;source=1&amp;searchmode=source\"> The 36th ACM/ICPC Asia Regional Shanghai Site &#x2014;&#x2014; Online Contest </a> ","type":"source","format":"html"}]}