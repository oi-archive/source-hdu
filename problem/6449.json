{"title":"Sequences Generator","time_limit":8000,"memory_limit":320,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6449","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6449&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6449","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6449"},"statement":[{"title":"Problem Description","content":"The RBM Second Generation of Dual Core Microprocessor Chip, also known as RBM2gDCMC, can generate a digital sequence of length $n$.<br>Each digit in a sequence provided by RBM2gDCMC is regarded as an integer between $1$ and $n$ in this problem.<br><br>Now I will show you the passcode for the email belonging to Gini Romety, which is a sequence of length $m$ with integers between $1$ and $n$.<br>You are asked to calculate the probabilities of the coincidence with Gini Romety&apos;s passcode for all consecutive subsequence of length $m$ in a sequence generated by RBM2gDCMC.<br>","type":"description","format":"html"},{"title":"Input","content":"The input contains several test cases, and the first line contains a positive integer $T$ indicating the number of test cases which is up to $5000$.<br><br>For each test case, the first line contains two integers $n$ and $m$, satisfying $1 \\leq m \\leq n \\leq 3 \\times 10^5$, which are described as above.<br><br>The following $n$ lines describe the generating logic for all digits in a sequence built by RBM2gDCMC.<br>The $i$-th line of them contains two integers $l_i$ and $r_i$, satisfying $1 \\leq l_i \\leq r_i \\leq n$ and $r_i - l_i \\leq 9$, and $(r_i - l_i + 1)$ following integers, denoted by $w_{i, l_i}, w_{i, l_i + 1}, \\cdots, w_{i, r_i}$, where $0 \\leq w_{i, j} \\leq 10^9$ and $\\sum_{j}{w_{i, j}} = 10^9$.<br>These data indicate that for the $i$-th digit the probability of being an integer $j$ in $[1, l_i) \\cup (r_i, n]$ is zero, and the probability of being an integer $j$ in $[l_i, r_i]$ is $\\frac{w_{i, j}}{10^9}$.<br><br>The next line contains $m$ integers, denoted by $b_1, b_2, \\cdots, b_m$, describing the passcode for Gini Romety&apos;s email, where $1 \\leq b_1, b_2, \\cdots, b_m \\leq n$.<br><br>We guarantee that the sum of $n$ in all test cases is no larger than $2 \\times 10^6$.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output a line containing &quot;Case #x:&quot; (without quotes) at first, where x is the test case number starting from $1$.<br><br>After that, output $(n - m + 1)$ lines such that the $i$-th of them contains a real number indicating the probability of the coincidence for the passcode of Gini Romety&apos;s email and the subsequence of a sequence produced by RBM2gDCMC from the $i$-th digit to the $(i + m - 1)$-th one with an absolute error of at most $10^{-9}$.<br>Precisely speaking, assume that your answer is $a$ and the jury&apos;s answer is $b$, your answer will be considered correct if $|a - b| \\le 10^{-9}$, where $|x|$ means the absolute value of $x$.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n5 3\n1 3 100000000 200000000 700000000\n1 3 600000000 150000000 250000000\n1 3 333333333 333333334 333333333\n3 4 450000000 550000000\n1 3 999999998 1 1\n1 2 3</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1:\n0.004999999995000\n0.090000000180000\n0.000000000000000</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=The+43rd+ACM+International+Collegiate+Programming+Contest+Asia+Shenyang+Regional+Contest&amp;source=1&amp;searchmode=source\"> The 43rd ACM International Collegiate Programming Contest Asia Shenyang Regional Contest </a> ","type":"source","format":"html"}]}