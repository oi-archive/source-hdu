{"title":"Counting heaps","time_limit":5000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=2974","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=2974&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=2974","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=2974"},"statement":[{"title":"Problem Description","content":"We are given a rooted tree of n vertices. The vertices are to be labeled with numbers 1,2,..., n so that each label is unique and the heap condition holds, i.e. the label of any vertex is less than the label of its parent. How many such labellings exist? Since this number may be quite large, calculate only its<br>remainder modulo m.","type":"description","format":"html"},{"title":"Input","content":"The input contains several tree descriptions. The first line contains the number of input trees t (t &lt;=250).<br><br>Each tree description begins with a line containing the size of the tree n (1 &lt;= n &lt;= 500000) and an integer m (2 &lt;= m &lt;= 10^9). n - 1 lines follow, i-th of which contains p(i + 1), the number of the parent of the i + 1-th vertex (1 &lt;= p(i + 1) &lt;= i). Vertex number 1 will be the root in each tree, so its parent will not be given. Total size of the input will not exceed 50MB.","type":"input_format","format":"html"},{"title":"Output","content":"For each tree output the number of its valid labellings modulo given m.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">4\n3 1000000\n1\n1\n4 1000000\n1\n1\n1\n5 1000000\n1\n2\n3\n4\n5 1000000\n1\n1\n3\n3</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n6\n1\n8\n\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\n<center><img src=\"../../../data/images/con181-1010-1.JPG\"></center>\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=Central+European+Programming+Contest+2008&amp;source=1&amp;searchmode=source\"> Central European Programming Contest 2008 </a> ","type":"source","format":"html"}]}