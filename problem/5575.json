{"title":"Discover Water Tank","time_limit":12500,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5575","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5575&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5575","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5575"},"statement":[{"title":"Problem Description","content":"A lot of frogs are living in a water tank, but none of them know exactly how much water are there.<br><br>The water tank has an infinite height, but with a narrow bottom. The length of the tank is $N$, and the width is only $1$.<br><br>Now $N - 1$ boards has divided the tank into $N$ parts, each with an $1 \\times 1$ bottom. Boards may have different heights. Water cannot flow through the boards, but can run freely if the water level is higher, following the basic physical rules.<br><br>The Frog King wants to know more details of the tank, so he sent someone to choose $M$ positions and find whether there&apos;s water at that position.<br><br>For example, each time he&apos;ll choose$(x, y)$, checking the $x^{th}$ part of the tank($1 \\leq x \\leq N$), counting from left to right, and find whether there&apos;s water at height $(y + 0.5)$.<br><br>Now the King gets $M$ results, but he finds some of them might be wrong. The King wants to find out the <b>maximum</b> possible number of the correct results.","type":"description","format":"html"},{"title":"Input","content":"First line contains an integer $T$, which indicates the number of test cases.<br><br>Every test case begins with two integers $N$ and $M$, which is the numbers of tanks and numbers of results.<br><br>The second line of each test case contains $N - 1$ integers, $h_1$, $h_2$, $\\cdots$, $h_{N-1}$, and $h_i$ indicates the height of $i^{th}$ board&apos;s height.<br><br>Then $M$ lines follow, the $i^{th}$ line, formated as &apos;$x\\ y\\ z$&apos;, indicates $i^{th}$ result. $z$ is $0$ if there is no water at height $(y + 0.5)$ in $x^{th}$ tank, otherwise $z$ is $1$.<br><br>$\\cdot$ $1 \\leq T \\leq 100$.<br><br>$\\cdot$ For 90% data, $1 \\leq N \\leq 1000$ and $1 \\leq M \\leq 2000$<br><br>$\\cdot$ for 100% data, $1 \\leq N \\leq 10^5$ and $1 \\leq M \\leq 2 \\cdot 10^5$.<br><br>$\\cdot$ $1 \\leq h_i \\leq 10^9$ for all $1 \\leq i \\leq N - 1$.<br><br>$\\cdot$ for every result, $1 \\leq x \\leq N$, $1 \\leq y \\leq 10^9$ and $z$ is either $0$ or $1$.","type":"input_format","format":"html"},{"title":"Output","content":"For every test case, you should output &quot;<b>Case #x: y</b>&quot;,where $x$ indicates the case number and counts from $1$, and $y$ is the maximum possible number of the correct results.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n3 4\n3 4\n1 3 1\n2 1 0\n2 2 0\n3 3 1\n2 2\n2\n1 2 0\n1 2 1</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1: 3\nCase #2: 1\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nIn the first sample case, if the 1-st condition is true, then there&apos;s water at height 3.5 in the first part. The water will run over the board with height 3, so the water level in the second part should also be the same as the first part, which contradicts the 2-nd and 3-rd observation.\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2015ACM%2FICPC%D1%C7%D6%DE%C7%F8%C9%CF%BA%A3%D5%BE-%D6%D8%CF%D6%C8%FC%A3%A8%B8%D0%D0%BB%BB%AA%B6%AB%C0%ED%B9%A4%A3%A9&amp;source=1&amp;searchmode=source\"> 2015ACM/ICPC&#x4E9A;&#x6D32;&#x533A;&#x4E0A;&#x6D77;&#x7AD9;-&#x91CD;&#x73B0;&#x8D5B;&#xFF08;&#x611F;&#x8C22;&#x534E;&#x4E1C;&#x7406;&#x5DE5;&#xFF09; </a> ","type":"source","format":"html"}]}