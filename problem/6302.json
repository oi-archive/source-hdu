{"title":"Maximum Weighted Matching","time_limit":4000,"memory_limit":63.9990234375,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6302","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6302&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6302","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6302"},"statement":[{"title":"Problem Description","content":"Chiaki is good at generating special graphs. Initially, she has a graph with only two vertices connected by an edge. Each time, she can choose an edge $(u,v)$, make a copy of it, insert some new vertices (maybe zero) in the edge (i.e. let the new vertices be $t_1,t_2,\\dots,t_k$, Chiaki would insert edges $(u,t_1)$, $(t_1,t_2)$,  $(t_{k-1}, t_k)$, $(t_k, v)$ into the graph).<br>Given a weighted graph generated by above operations, Chiaki would like to know the maximum weighted matching of the graph and the number different maximum weighted matchings modulo ($10^9 + 7)$).<br>A matching in a graph is a set of pairwise non-adjacent edges, none of which are loops; that is, no two edges share a common vertex.<br>A maximum weighted matching is defined as a matching where the sum of the values of the edges in the matching have a maximal value.","type":"description","format":"html"},{"title":"Input","content":"There are multiple test cases. The first line of input contains an integer $T$, indicating the number of test cases. For each test case:<br>The first line contains two integers $n$ and $m$ ($1 \\le n, m \\le 10^5$) -- the number of vertices and the number of edges.<br>Each of the next $m$ lines contains three integers $u_i$, $v_i$ and $w_i$ ($1 \\le u_i, v_i \\le n, 1 \\le w_i \\le 10^9$) -- deonting  an edge between $u_i$ and $v_i$ with weight $w_i$.<br>It is guaranteed that neither the sum of all $n$ nor the sum of all $m$ exceeds $10^6$.","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output two integers separated by a single space. The first one is the sum of weight and the second one is the number of different maximum weighted matchings modulo ($10^9 + 7$).<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n6 7\n1 2 1\n2 3 1\n4 5 1\n5 6 1\n1 4 1\n2 5 1\n3 6 1\n4 5\n1 2 1\n1 3 1\n1 4 1\n2 3 1\n3 4 1</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3 3\n2 2</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2018+Multi-University+Training+Contest+1&amp;source=1&amp;searchmode=source\"> 2018 Multi-University Training Contest 1 </a> ","type":"source","format":"html"}]}