{"title":"Instrction Arrangement","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4109","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4109&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4109","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4109"},"statement":[{"title":"Problem Description","content":"Ali has taken the Computer Organization and Architecture course this term. He learned that there may be dependence between instructions, like WAR (write after read), WAW, RAW.<br>If the distance between two instructions is less than the Safe Distance, it will result in hazard, which may cause wrong result. So we need to design special circuit to eliminate hazard. However the most simple way to solve this problem is to add bubbles (useless operation), which means wasting time to ensure that the distance between two instructions is not smaller than the Safe Distance.<br>The definition of the distance between two instructions is the difference between their beginning times.<br>Now we have many instructions, and we know the dependent relations and Safe Distances between instructions. We also have a very strong CPU with infinite number of cores, so you can run as many instructions as you want simultaneity, and the CPU is so fast that it just cost 1ns to finish any instruction.<br>Your job is to rearrange the instructions so that the CPU can finish all the instructions using minimum time.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The input consists several testcases.<br>The first line has two integers N, M (N &lt;= 1000, M &lt;= 10000), means that there are N instructions and M dependent relations.<br>The following M lines, each contains three integers X, Y , Z, means the Safe Distance between X and Y is Z, and Y should run after X. The instructions are numbered from 0 to N - 1.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"Print one integer, the minimum time the CPU needs to run.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5 2\n1 2 1\n3 4 1</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nIn the 1st ns, instruction 0, 1 and 3 are executed;\nIn the 2nd ns, instruction 2 and 4 are executed.\nSo the answer should be 2.\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2011+Alibaba-Cup+Campus+Contest&amp;source=1&amp;searchmode=source\"> 2011 Alibaba-Cup Campus Contest </a> ","type":"source","format":"html","require":["katex"]}]}