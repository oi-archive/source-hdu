{"title":"DZY Loves Connecting","time_limit":2000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5647","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5647&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5647","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5647"},"statement":[{"title":"Problem Description","content":"DZY has an unrooted tree consisting of $n$ nodes labeled from $1$ to $n$.<br><br>DZY likes connected sets on the tree. A connected set $S$ is a set of nodes, such that every two nodes $u,v$ in $S$ can be connected by a path on the tree, and the path should only contain nodes from $S$. Obviously, a set consisting of a single node is also considered a connected set.<br><br>The size of a connected set is defined by the number of nodes which it contains. DZY wants to know the sum of the sizes of all the connected sets. Can you help him count it?<br><br>The answer may be large. Please output modulo $10^9 + 7$.<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"First line contains $t$ denoting the number of testcases.<br>$t$ testcases follow. In each testcase, first line contains $n$. In lines $2 \\sim n$, $i$th line contains $p_i$, meaning there is an edge between node $i$ and node $p_i$. ($1\\le p_i \\le i-1,2\\le i\\le n$)<br><br>($n\\ge 1$&#xFF0C; sum of $n$ in all testcases does not exceed $200000$)<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"Output one line for each testcase, modulo $10^9 + 7$.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n1\n5\n1\n2\n2\n3</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n42\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nIn the second sample, the 4 edges are (1,2),(2,3),(2,4),(3,5). All the connected sets are {1},{2},{3},{4},{5},{1,2},{2,3},{2,4},{3,5},{1,2,3},{1,2,4},{2,3,4},{2,3,5},{1,2,3,4},{1,2,3,5},{2,3,4,5},{1,2,3,4,5}.\n\nIf you need a larger stack size, \nplease use #pragma comment(linker, &quot;/STACK:102400000,102400000&quot;) and submit your solution using C++.\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=BestCoder+Round+%2376+%28div.2%29&amp;source=1&amp;searchmode=source\"> BestCoder Round #76 (div.2) </a> ","type":"source","format":"html","require":["katex"]}]}