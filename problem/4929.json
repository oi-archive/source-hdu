{"title":"Another Letter Tree","time_limit":6000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4929","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4929&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4929","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4929"},"statement":[{"title":"Problem Description","content":"   A letter tree is given on this page (HDOJ 4601).<br><br>   Another letter tree of N nodes is now given, where each node is assigned to a lowercase letter. When making a tour from a node to another, one should always follow the shortest path between them. That is, no nodes should be visited twice during his tour.<br><br>   After one travels along a path, he will obtain a Path String formed by the letters assigned to nodes that he just moves past. The string exactly records all nodes in the order he visits.<br><br>   Now we&#x2019;re faced with the problem. Initially we have a string S<sub>0</sub> and totally Q queries each in a shape of (u, v). For each query, we make a tour <b>from u to v</b> and obtain a Path String S<sub>uv</sub> , and your task is to calculate how many times that S<sub>0</sub> occurs as a subsequence of S<sub>uv</sub> . For example, &#x201C;ab&#x201D; occurs 3 times in &#x201C;abab&#x201D; as a subsequence.<br><br>   A subsequence is a sequence that can be derived from another sequence by deleting some elements without changing the order of the remaining elements. For instance, &#x201C;abc&#x201D; and &#x201C;ec&#x201D; are both subsequence of &#x201C;adebc&#x201D;, while &#x201C;ba&#x201D; and &#x201C;ed&#x201D; are not.<br><br>   The answer might be large, and thus you&#x2019;re only required to output it modulo 10007.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"   The input consists of several test cases. The number of test cases T (T&lt;=5) occurs in the first line of input.<br><br>For each test case:<br>   The first line consists of two integers N and Q(1&lt;=N, Q&lt;=50000), denoting the number of nodes and queries, respectively.<br>   Each of the following N - 1 lines contains a pair of integers u, v(1&lt;=u, v&lt;=N ), denoting an edge between node u and v.<br>   The following line contains a string of N lowercase letters, where the ith denotes the letter represented by the ith node.<br>   The following line contains S<sub>0</sub>(1&lt;=|S<sub>0</sub>|&lt;=30).<br>   The following Q lines describe all queries, each of which describes the start node u and destination node v.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"   For each query, output the required answer modulo 10007 in a line.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n6 3\n1 2\n1 3\n2 4\n2 5\n3 6\nabbaaa ab\n4 5\n4 6\n2 1\n6 3\n1 2\n1 3\n2 4\n2 5\n3 6\nabbaaa aba\n4 5\n4 6\n2 1</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n3\n0\n1\n4\n0</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Author","content":"BUPT","type":"source","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2014+Multi-University+Training+Contest+6&amp;source=1&amp;searchmode=source\"> 2014 Multi-University Training Contest 6 </a> ","type":"source","format":"html","require":["katex"]}]}