{"title":"Yu-Gi-Oh!","time_limit":2000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5383","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5383&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5383","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5383"},"statement":[{"title":"Problem Description","content":"&quot;Yu-Gi-Oh!&quot;, also known as &quot;Dueling Monsters&quot;, is a popular trading card game which has nearly 20 years history. Next year, YGO will reach its 20th birthday.<br><br>Stilwell has $n$ monsters on the desk, each monster has its $level_i$ and $ATK_i$. There are two kinds of monsters, Tuner monsters and Non-Tuner monsters.<br><br>Now, Stilwell plans to finish some &quot;Synchro Summon&quot;, and &quot;Synchro Summon&quot; is a kind of special summon following these rules (a little different from the standard YGO rules):<br><br>(1) A &quot;Synchro Summon&quot; needs two monsters as the material of this summon, and they must be one Tuner monster and one Non-Tuner monster.<br>    In other words, we can cost one Tuner monster and one Non-Tuner monster to get a Synchro monster (&quot;cost&quot; means remove form the desk, &quot;get&quot; means put on to the desk).<br><br>(2) To simplify this problem, Synchro monsters are neither Tuner monsters nor Non-Tuner monsters.<br><br>(3) The level sum of two material must be equal to the level of Synchro monster we summon.<br>    For example:<br>     A Level 3 Tuner monster $+$ A Level 2 Non-Tuner monster $=$ A Level 5 Synchro Monster<br>     A Level 2 Tuner monster $+$ A Level 4 Non-Tuner monster $=$ A Level 6 Synchro Monster<br>     A Level 4 Tuner monster $+$ A Level 4 Non-Tuner monster $=$ A Level 8 Synchro Monster<br><br>(4) The material of some Synchro monster has some limits, the material must contain some specific monster.<br>    For example:<br>     A Level 5 Synchro Monster $\\alpha$ requires A Level 3 Tuner monster $\\alpha$ to be its material<br>     A Level 6 Synchro Monster $\\beta$ requires A Level 4 Non-Tuner monster $\\beta$ to be its material<br>     A Level 8 Synchro Monster $\\gamma$ requires A Level 4 Tuner monster $\\gamma$ $+$ A Level 4 Non-Tuner monster $\\gamma$ to be its material<br>     A Level 5 Synchro Monster $\\varphi$ doesn&apos;t require any monsters to be its material<br>    Then<br>     A Level 3 Tuner monster $\\alpha$ $+$ A Level 2 Non-Tuner monster $=$ A Level 5 Synchro Monster $\\alpha$<br>     A Level 3 Tuner monster $\\delta$ $+$ A Level 2 Non-Tuner monster $\\neq$ A Level 5 Synchro Monster $\\alpha$<br>     A Level 2 Tuner monster $+$ A Level 4 Non-Tuner monster $\\beta$ $=$ A Level 6 Synchro Monster $\\beta$<br>     A Level 3 Tuner monster $+$ A Level 3 Non-Tuner monster $\\zeta$ $\\neq$ A Level 6 Synchro Monster $\\beta$<br>     A Level 4 Tuner monster $\\gamma$ $+$ A Level 4 Non-Tuner monster $\\gamma$ $=$ A Level 8 Synchro Monster $\\gamma$<br>     A Level 4 Tuner monster $\\sigma$ $+$ A Level 4 Non-Tuner monster $\\gamma$ $\\neq$ A Level 8 Synchro Monster $\\gamma$<br>     A Level 4 Tuner monster $\\gamma$ $+$ A Level 4 Non-Tuner monster $\\phi$ $\\neq$ A Level 8 Synchro Monster $\\gamma$<br>     A Level 3 Tuner monster $+$ A Level 2 Non-Tuner monster $=$ A Level 5 Synchro Monster $\\varphi$<br>     A Level 3 Tuner monster $\\alpha$ $+$ A Level 2 Non-Tuner monster $=$ A Level 5 Synchro Monster $\\varphi$<br><br>Stilwell has $m$ kinds of Synchro Monster cards, the quantity of each Synchro Monster cards is infinity.<br><br>Now, given $level_i$ and $ATK_i$ of every card on desk and every kind of Synchro Monster cards. Please finish some Synchro Summons (maybe zero) to maximum $\\sum ATK_i$ of the cards on desk.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line of the input contains a single number $T$, the number of test cases.<br><br>For each test case, the first line contains two integers $n$, $m$.<br><br>Next $n$ lines, each line contains three integers $tuner_i$, $level_i$, and $ATK_i$, describe a monster on the desk. If this monster is a Tuner monster, then $tuner_i=1$, else $tuner_i=0$ for Non-Tuner monster.<br><br>Next $m$ lines, each line contains integers $level_j$, $ATK_j$, $r_j$, and following $r_j$ integers are the required material of this Synchro Monster (the integers given are the identifier of the required material).<br>The input data guarantees that the required material list is available, two Tuner monsters or two Non-Tuner monsters won&apos;t be required. If $r_i=2$ the level sum of two required material will be equal to the level of Synchro Monster.<br><br>$T\\leq 10$, $n,m\\leq 300$, $1\\leq level_i\\leq 12$, $0\\leq ATK_i\\leq 5000$, $0\\leq r_i\\leq 2$","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"$T$ lines, find the maximum $\\sum ATK_i$ after some Synchro Summons.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5\n2 2\n1 3 1300\n0 2 900\n5 2300 1 1\n8 2500 0\n2 1\n1 3 1300\n1 2 900\n5 2300 1 1\n3 1\n1 3 1300\n0 2 900\n0 2 800\n5 2300 1 1\n3 1\n1 1 233\n0 1 233\n0 1 200\n2 466 2 1 2\n6 3\n1 3 1300\n0 2 900\n0 5 1350\n1 4 1800\n0 10 4000\n0 10 1237\n5 2300 1 1\n8 3000 0\n6 2800 0</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2300\n2200\n3200\n666\n11037</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Author","content":"SXYZ","type":"source","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2015+Multi-University+Training+Contest+8&amp;source=1&amp;searchmode=source\"> 2015 Multi-University Training Contest 8 </a> ","type":"source","format":"html","require":["katex"]}]}