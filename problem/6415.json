{"title":"Rikka with Nash Equilibrium","time_limit":5000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6415","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6415&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6415","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6415"},"statement":[{"title":"Problem Description","content":"Nash Equilibrium is an important concept in game theory.<br><br>Rikka and Yuta are playing a simple matrix game. At the beginning of the game, Rikka shows an $n \\times m$ integer matrix $A$. And then Yuta needs to choose an integer in $[1,n]$, Rikka needs to choose an integer in $[1,m]$. Let $i$ be Yuta&apos;s number and $j$ be Rikka&apos;s number, the final score of the game is $A_{i,j}$. <br><br>In the remaining part of this statement, we use $(i,j)$ to denote the strategy of Yuta and Rikka.<br><br>For example, when $n=m=3$ and matrix $A$ is <br>\\begin{align*}<br>\\begin{bmatrix}<br>1 &amp; 2 &amp; 1\\\\<br>1 &amp; 4 &amp; 3\\\\<br>1 &amp; 1 &amp; 1\\\\<br>\\end{bmatrix}<br>\\end{align*}<br>If the strategy is $(1,2)$, the score will be $2$; if the strategy is $(2,2)$, the score will be $4$.<br><br>A pure strategy Nash equilibrium of this game is a strategy $(x,y)$ which satisfies neither Rikka nor Yuta can make the score higher by changing his(her) strategy unilaterally. Formally, $(x,y)$ is a Nash equilibrium if and only if:<br>\\begin{align*}<br>\\begin{cases}<br>A_{x,y} \\geq A_{i,y} \\ \\ \\forall i \\in [1, n] \\\\<br>A_{x,y} \\geq A_{x,j} \\ \\ \\forall j \\in [1,m]<br>\\end{cases}<br>\\end{align*}<br><br>In the previous example, there are two pure strategy Nash equilibriums: $(3,1)$ and $(2,2)$.<br><br>To make the game more interesting, Rikka wants to construct a matrix $A$ for this game which satisfies the following conditions:<br>1. Each integer in $[1, nm]$ occurs exactly once in $A$.<br>2. The game has at most one pure strategy Nash equilibriums. <br><br>Now, Rikka wants you to count the number of matrixes with size $n \\times m$ which satisfy the conditions.","type":"description","format":"html"},{"title":"Input","content":"The first line contains a single integer $t(1 \\leq t \\leq 20)$, the number of the testcases.<br><br>The first line of each testcase contains three numbers $n,m$ and $K(1 \\leq n,m \\leq 80, 1 \\leq K \\leq 10^9)$.<br><br>The input guarantees that there are at most $3$ testcases with $\\max(n,m) &gt; 50$.","type":"input_format","format":"html"},{"title":"Output","content":"For each testcase, output a single line with a single number: the answer modulo $K$.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n3 3 100\n5 5 2333</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">64\n1170</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2018+Multi-University+Training+Contest+9&amp;source=1&amp;searchmode=source\"> 2018 Multi-University Training Contest 9 </a> ","type":"source","format":"html"}]}