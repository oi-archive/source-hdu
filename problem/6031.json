{"title":"Innumerable Ancestors","time_limit":5000,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6031","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6031&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6031","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6031"},"statement":[{"title":"Problem Description","content":"There is a tree having $n$ nodes, labeled from 1 to $n$. The root of the tree is always 1, and the depth of a node $p$ is the number of nodes on the shortest path between node $p$ and the root.<br>In computer science, the Lowest Common Ancestor (LCA) of two nodes $v$ and $w$ in a tree is the lowest (i.e. deepest) node that has both $v$ and $w$ as descendants, where we define each node to be a descendant of itself (so if $v$ has a direct connection from $w$, $w$ is the lowest common ancestor).<br>You have to answer $m$ queries. Each query gives two non-empty node sets $A$ and $B$, there might be some nodes in both sets.<br>You should select one node $x$ from set $A$, and one node $y$ from set $B$, $x$ and $y$ can be the same node. Your goal is to maximize the depth of the LCA of $x$ and $y$.<br>Please write a program to answer these queries.","type":"description","format":"html"},{"title":"Input","content":"The input contains several test cases, no more than 5 test cases.<br>In each test case, the first line contains two integers $n(1\\leq n\\leq 100000)$ and $m(1\\leq m\\leq 100000)$, denoting the number of nodes and queries.<br>For the next $n-1$ lines,each line contians two integers $a$ and $b$, denoting a bi-directional edge between node $a$ and $b$.<br>Then there are $2m$ lines, every two lines describes one query.<br>For each query, the first line describes the set A.<br>The first integer $k(1\\leq k\\leq n)$ denotes the number of nodes in set $A$, and the next $k$ integers describing the nodes in set $A$. There might be some nodes appear multiple times in the set.<br>The second line describes the set $B$ in the same format of set $A$.<br><br>It is guaranteed that $\\sum k\\leq 100000$ in each test case.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For every query, print a number denoting the answer, which means the maximum depth of the LCA.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">7 3\n1 2\n1 3\n3 4\n3 5\n4 6\n4 7\n1 6\n1 7\n2 6 7\n1 7\n2 5 4\n2 3 2</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n4\n2</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2017%D6%D0%B9%FA%B4%F3%D1%A7%C9%FA%B3%CC%D0%F2%C9%E8%BC%C6%BE%BA%C8%FC+-+%C5%AE%C9%FA%D7%A8%B3%A1&amp;source=1&amp;searchmode=source\"> 2017&#xFFFD;&#x439;&#xFFFD;&#xFFFD;&#xFFFD;&#x467;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#x1BE;&#xFFFD;&#xFFFD;&#xFFFD; - &#x16E;&#xFFFD;&#xFFFD;&#x5E8;&#xFFFD;&#xFFFD; </a> ","type":"source","format":"html"}]}