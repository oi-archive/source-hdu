{"title":"Wealthy Family","time_limit":10000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4169","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4169&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4169","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4169"},"statement":[{"title":"Problem Description","content":"While studying the history of royal families, you want to know how wealthy each family is. While you have various &apos;net worth&apos; figures for each individual throughout history, this is complicated by double counting caused by inheritance. One way to estimate the wealth of a family is to sum up the net worth of a set of k people such that no one in the set is an ancestor of another in the set. The wealth of the family is the maximum sum achievable over all such sets of k people. Since historical records contain only the net worth of male family members, the family tree is a simple tree in which every male has exactly one father and a non-negative number of sons. You may assume that there is one person who is an ancestor of all other family members.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The input consists of a number of cases. Each case starts with a line containing two integers separated by a space: N (1 &lt;= N &lt;= 150,000), the number of people in the family, and k (1 &lt;= k &lt;= 300), the size of the set. The next N lines contain two non-negative integers separated by a space: the parent number and the net worth of person i (1 &lt;= i &lt;= N). Each person is identified by a number between 1 and N, inclusive. There is exactly one person who has no parent in the historical records, and this will be indicated with a parent number of 0. The net worths are given in millions and each family member has a net worth of at least 1 million and at most 1 billion.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each case, print the maximum sum (in millions) achievable over all sets of k people satisfying the constraints given above. If it is impossible to choose a set of k people without violating the constraints, print &apos;impossible&apos; instead.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5 3\n0 10\n1 15\n1 25\n1 35\n4 45\n3 3\n0 10\n1 10\n2 10</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">85\nimpossible</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=The+2011+Rocky+Mountain+Regional+Contest&amp;source=1&amp;searchmode=source\"> The 2011 Rocky Mountain Regional Contest </a> ","type":"source","format":"html","require":["katex"]}]}