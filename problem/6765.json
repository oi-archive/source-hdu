{"title":"Count on a Tree II Striking Back","time_limit":4000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6765","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6765&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6765","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6765"},"statement":[{"title":"Problem Description","content":"You are given a tree with $n$ nodes. The tree nodes are numbered from $1$ to $n$. The color of the $i$-th node is $col_i$.<br><br>You need to perform the following operations for $m$ times:<br><br>&#xB7; &quot;$\\texttt{1 x y}$&quot; ($1\\leq x,y\\leq n$): Change the color of the $x$-th node into $y$.<br><br>&#xB7; &quot;$\\texttt{2 a b c d}$&quot; ($1\\leq a,b,c,d\\leq n$): Let&apos;s denote $f(u,v)$ as the number of different colors occured on the path from $u$ to $v$. You need to answer whether $f(a,b)&gt;f(c,d)$ is true.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line of the input contains a single integer $T$ ($1 \\leq T \\leq 4$), the number of test cases.<br><br>For each case, the first line of the input contains two integers $n$ and $m$ ($1 \\leq n \\leq 500\\,000$, $1\\leq m\\leq 10\\,000$), denoting the number of nodes and the number of operations.<br><br>The second line of the input contains $n$ integers $col_1,col_2,\\dots,col_n$ ($1\\leq col_i\\leq n$), denoting the initial color of each node.<br><br>Each of the following $n-1$ lines contains two integers $u_i$ and $v_i$ ($1\\leq u_i,v_i\\leq n,u_i\\neq v_i$), denoting an bidirectional edge between the $u_i$-th node and the $v_i$-th node.<br><br>Each of the next $m$ lines describes an operation in formats described in the statement above, except that some parameters are encrypted in order to enforce online processing.<br><br>Let $cnt$ be the number of queries that you answered &quot;$\\texttt{Yes}$&quot; before in this test case. Note that $cnt$ should be reset to $0$ in each new test case. For each operation, $x,y,a,b,c$ and $d$ are encrypted. The actual values of $x,y,a,b,c$ and $d$ are $x\\oplus cnt,y\\oplus cnt,a\\oplus cnt,b\\oplus cnt,c\\oplus cnt$ and $d\\oplus cnt$. In the expressions above, the symbol &quot;$\\oplus$&quot; denotes the bitwise exclusive-or operation. Also note that the constraints described in the statement above apply to the corresponding parameters only after decryption, the encrypted values are not subject to those constraints.<br><br>It is guaranteed that $f(a,b)\\geq 2f(c,d)$ or $f(c,d)\\geq 2f(a,b)$ always holds for each query.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each query, print a single line. If $f(a,b)&gt;f(c,d)$ is true, print &quot;$\\texttt{Yes}$&quot; else print &quot;$\\texttt{No}$&quot;.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n8 4\n1 2 1 4 1 3 3 2\n1 2\n2 3\n3 4\n3 5\n1 6\n6 7\n6 8\n2 1 4 3 5\n2 7 6 5 9\n1 4 9\n2 2 4 7 6</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Yes\nNo\nYes</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2020+Multi-University+Training+Contest+2&amp;source=1&amp;searchmode=source\"> 2020 Multi-University Training Contest 2 </a> ","type":"source","format":"html","require":["katex"]}]}