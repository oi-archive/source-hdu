{"title":"The Budget of Traveler","time_limit":10000,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4684","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4684&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4684","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4684"},"statement":[{"title":"Problem Description","content":"There is a country consisting of n cities. A traveler living in the city with number 1 loves travelling very much. He has made <br>n-1 travel plans, each plan has a unique destination(except city 1). After a travel, he will go back home. On the way back home,  <br>he will buy gifts for all his friends living in the cities(including the starting city and ending city) he will pass. For some<br>strange reasons, each city sells only one kind gift. Besides, packing the gifts need some extra cost.<br>Maybe you are still confused of the description, the following is the details<br>1. Note that the cities form a connected, undirected and a cyclic graph(in another word the cities form a tree).<br>2. When he goes back home after a travel, he will always choose the shortest route.<br>3. The n-1 plans are independent, that means, he will always prepare gifts for his friends ont the route no matter whether he has visited them before.<br>4. The gifts must be packed, and you must pack them in the city where you buy them.<br>5. The packing cost is no matter with the number of gifts. That is, packing two gifts cost the same money with packing one.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line of the input contains an integer T( T&lt;= 10 ), indicating the number of test cases.<br>For each test case, the first line contains only one integers n, indicating the number of cities.<br>The next n lines, each line contains three integers f<sub>i</sub>, p<sub>i</sub>, r<sub>i</sub>, where f<sub>i</sub> is the number of his friend living in city i, p<sub>i</sub> is the price of each gift in city i, r<sub>i</sub> is the packing cost in the city i.<br>The next of n-1 lines, each line contains two integers u<sub>i</sub> and v<sub>i</sub>, indicating that the traveler can go to v<sub>i</sub> from u<sub>i</sub> or go to u<sub>i</sub> from v<sub>i</sub>.<br>You can assume 1&lt;=n&lt;=4*10<sup>5</sup>, 1&lt;=f<sub>i</sub>&lt;=10<sup>4</sup>, 1&lt;=p<sub>i</sub>,r<sub>i</sub>&lt;=10<sup>5</sup>, 1&lt;=u<sub>i</sub>,v<sub>i</sub>&lt;=n<br><br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For every test case,output one line,&quot;Case #k: ans&quot;,where k is the case number,counting from 1, ans is the minimum total cost.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n3\n1 10000 10000\n1 1 20\n1 100 1\n1 2\n1 3</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1: 223</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2013+Multi-University+Training+Contest+8&amp;source=1&amp;searchmode=source\"> 2013 Multi-University Training Contest 8 </a> ","type":"source","format":"html","require":["katex"]}]}