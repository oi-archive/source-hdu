{"title":"From Tree to Graph","time_limit":5000,"memory_limit":320,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6280","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6280&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6280","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6280"},"statement":[{"title":"Problem Description","content":"Bobo has a tree of $n$ vertices numbered with $0, 1, \\dots, (n - 1)$.<br>He subsequently adds $m$ edges between vertex $x_i$ and $\\mathrm{LCA}(x_i, y_i)$<br>where $\\mathrm{LCA}(x_i, y_i)$ is the vertex lying on the unique tree path between vertex $x_i$ and $y_i$ and closest to the vertex $0$.<br><br>Let the graph obtained by adding the edges $\\{(x_1, \\mathrm{LCA}(x_1, y_1)), (x_2, \\mathrm{LCA}(x_2, y_2)), \\dots, (x_i, \\mathrm{LCA}(x_i, y_i))\\}$ to the tree be $G_i$,<br>and $f_i(u)$ be the number of connected components after the removal of vertex $u$ from $G_i$.<br>Bobo knows that for $i \\in \\{0, 1, 2, \\dots, m\\}$<br>$$z_i = f_i(0) \\oplus f_i(1) \\oplus \\dots \\oplus f_i(n - 1).$$<br>($\\oplus$ denotes xor.)<br><br>Given $a, b, x_0, y_0$, he also knows that for $i \\in \\{1, 2, \\dots, m\\}$,<br><br>* $x_i = (a \\cdot x_{i - 1} + b \\cdot y_{i - 1} + z_{i - 1}) \\bmod n$,<br>* $y_i = (b \\cdot x_{i - 1} + a \\cdot y_{i - 1} + z_{i - 1}) \\bmod n$.<br><br>Help him to find $x_m$, $y_m$.<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The input consists of several test cases and is terminated by end-of-file.<br><br>The first line of each test case contains six integers $n$, $m$, $a$, $b$, $x_0$, $y_0$.<br>The $i$-th of the following $(n - 1)$ lines contains two integers $u_i$ and $v_i$, which denotes the tree edge between vertex $u_i$ and $v_i$.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, print two integers which denote $x_m$, $y_m$.<br><br>## Constraint<br><br>* $2 \\leq n \\leq 5000$<br>* $1 \\leq m \\leq n^2$<br>* $0 \\leq a, b, x_0, y_0, u_i, v_i &lt; n$<br>* The sum of $n$ does not exceed $25,000$.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">4 1 1 0 2 3\n0 1\n1 2\n0 3\n4 2 1 0 2 0\n0 1\n1 2\n2 3\n5 25 1 2 3 4\n0 1\n0 2\n1 3\n1 4</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2 3\n1 3\n1 0\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\n\nThe following table shows the detailed value for the second sample.\n\\begin{tabular}{|c|c|c|c|c|c|c|c|c|c}\n    \\hline\n    $i$ &amp; $x_i$ &amp; $y_i$ &amp; $\\mathrm{LCA}(x_i, y_i)$ &amp; $f_i(0)$ &amp; $f_i(1)$ &amp; $f_i(2)$ &amp; $f_i(3)$ &amp; $z_i$ \\\\\n    \\hline\n    0   &amp; 2     &amp; 0     &amp; 0                        &amp; 1        &amp; 2        &amp; 2        &amp; 1        &amp; 0 \\\\\n    1   &amp; 2     &amp; 0     &amp; 0                        &amp; 1        &amp; 1        &amp; 2        &amp; 1        &amp; 3 \\\\\n    2   &amp; 1     &amp; 3     &amp; 1                        &amp; 1        &amp; 1        &amp; 2        &amp; 1        &amp; 3 \\\\\n    \\hline\n\\end{tabular}\n\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=CCPC2018-%BA%FE%C4%CF%C8%AB%B9%FA%D1%FB%C7%EB%C8%FC-%D6%D8%CF%D6%C8%FC%A3%A8%B8%D0%D0%BB%CF%E6%CC%B6%B4%F3%D1%A7%A3%A9&amp;source=1&amp;searchmode=source\"> CCPC2018-&#x6E56;&#x5357;&#x5168;&#x56FD;&#x9080;&#x8BF7;&#x8D5B;-&#x91CD;&#x73B0;&#x8D5B;&#xFF08;&#x611F;&#x8C22;&#x6E58;&#x6F6D;&#x5927;&#x5B66;&#xFF09; </a> ","type":"source","format":"html","require":["katex"]}]}