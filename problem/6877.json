{"title":"Anti-hash Test","time_limit":1000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6877","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6877&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6877","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6877"},"statement":[{"title":"Problem Description","content":"It is well known that the following string $s(n)=s_0s_1 \\dots s_{2^n-1}$ can challenge almost every solution that uses polynomial hashes modulo $2^{64}$: <br><br>$$<br>s_i=\\begin{cases} a &amp; \\text{popcount(i)} \\bmod 2 = 0 \\\\ b &amp; \\text{popcount(i)} \\bmod 2 = 1 \\end{cases}<br>$$<br>where $\\text{popcount}(i)$ means the number of ones in binary representation of number $i$.<br><br>Given a string $u$ and an integer $n$, find the number of occurrences of $u$ in string $s(n)$ and the number of distinct strings $v$ which have the same number of occurrences in string $s(n)$. As both the numbers may be very large, you are only asked to calculate it modulo $10^9 + 7$.","type":"description","format":"html"},{"title":"Input","content":"There are multiple test cases. The first line of input contains an integer $T$, indicating the number of test cases. For each test case:<br><br>The first line contains an integer $n$ ($1 \\le n \\le 10^{18}$).<br><br>The second line contains a string $u$ ($1 \\le |u| \\le \\min(10^6, 2^n)$) consisting only of letters `a&apos; and `b&apos;.<br><br>It is guaranteed that the size of the input file does not exceed 20M.","type":"input_format","format":"html"},{"title":"Output","content":"For each test cases, if the string $u$ does not appear in string $s(n)$, you should simply output $-1$. Otherwise, output two integers denoting the the number of occurrences of $u$ in string $s(n)$ modulo $10^9 + 7$ and the number of distinct strings $v$ which have the same number of occurrences in string $s(n)$ modulo $10^9 + 7$.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">4\n10\na\n10\nabba\n5\nabbabaabbaababbabaababbaabbabaab\n20\nababab</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">512 2\n171 4\n1 344\n-1</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2020+Multi-University+Training+Contest+10&amp;source=1&amp;searchmode=source\"> 2020 Multi-University Training Contest 10 </a> ","type":"source","format":"html"}]}