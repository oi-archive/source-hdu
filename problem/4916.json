{"title":"Count on the path","time_limit":2500,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4916","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4916&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4916","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4916"},"statement":[{"title":"Problem Description","content":"   bobo has a tree, whose vertices are conveniently labeled by 1,2,&#x2026;,n.<br><br>   Let f(a,b) be the minimum of vertices <b>not</b> on the path between vertices a and b.<br><br>   There are q queries (u<sub>i</sub>,v<sub>i</sub>) for the value of f(u<sub>i</sub>,v<sub>i</sub>). Help bobo answer them.<br>","type":"description","format":"html"},{"title":"Input","content":"   The input consists of several tests. For each tests:<br><br>   The first line contains 2 integers n,q (4&#x2264;n&#x2264;10<sup>6</sup>,1&#x2264;q&#x2264;10<sup>6</sup>). Each of the following (n - 1) lines contain 2 integers a<sub>i</sub>,b<sub>i</sub> denoting an edge between vertices a<sub>i</sub> and b<sub>i</sub> (1&#x2264;a<sub>i</sub>,b<sub>i</sub>&#x2264;n). Each of the following q lines contains 2 integer u&#x2032;<sub>i</sub>,v&#x2032;<sub>i</sub> (1&#x2264;u<sub>i</sub>,v<sub>i</sub>&#x2264;n).<br><br>   The queries are encrypted in the following manner.<br><br>       u<sub>1</sub>=u&#x2032;<sub>1</sub>,v<sub>1</sub>=v&#x2032;<sub>1</sub>.<br>       For i&#x2265;2, u<sub>i</sub>=u&#x2032;<sub>i</sub>&#x2295;f(u<sub>i - 1</sub>,v<sub>i - 1</sub>),v<sub>i</sub>=v&#x2032;<sub>i</sub>&#x2295;f(u<sub>i-1</sub>,v<sub>i-1</sub>).<br><br>   Note &#x2295; denotes bitwise exclusive-or.<br>       <br>   It is guaranteed that f(a,b) is defined for all a,b.<br>   <br>   The task contains huge inputs. `scanf` in g++ is considered too slow to get accepted. You may (1) submit the solution in c++; or (2) use hand-written input utilities. <br>","type":"input_format","format":"html"},{"title":"Output","content":"   For each tests:<br><br>   For each queries, a single number denotes the value.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">4 1\n1 2\n1 3\n1 4\n2 3\n5 2\n1 2\n1 3\n2 4\n2 5\n1 2\n7 6</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">4\n3\n1</div></pre>","type":"example","format":"html"},{"title":"Author","content":"Xiaoxu Guo (ftiasch)","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2014+Multi-University+Training+Contest+5&amp;source=1&amp;searchmode=source\"> 2014 Multi-University Training Contest 5 </a> ","type":"source","format":"html"}]}