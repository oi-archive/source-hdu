{"title":"Hourai Jeweled","time_limit":2000,"memory_limit":160,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4303","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4303&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4303","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4303"},"statement":[{"title":"Problem Description","content":"Kaguya Houraisan was once a princess of the Lunarians, a race of people living on the Moon. She was exiled to Earth over a thousand years ago for the crime of using the forbidden Hourai Elixir to make herself immortal. Tales of her unearthly beauty led men from all across the land to seek her hand in marriage, but none could successfully complete her trial of the Five Impossible Requests. <br><center><img style=\"max-width:100%;\" src=\"../../data/images/C398-1004-1.jpg\"></center><br>One of these requests is to reckon the value of &quot;Hourai Jeweled (&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#x5A6;)&quot;. The only one real treasure Kaguya has, in her possession. As showed in the picture, Hourai Jeweled is a tree-shaped twig. In which, each node is ornamented with a valuable diamond and each edge is painted with a briliant color (only bright man can distinguish the difference). Due to lunarians&apos; eccentric taste, the value of this treasure is calculated as all the gorgeous roads&apos; value it has. The road between two different nodes is said to be gorgeous, if and only if all the adjacent edges in this road has diffenrent color. And the value of this road is the sum of all the nodes&apos; through the road.<br>Given the value of each node and the color of each edge. Could you tell Kaguya the value of her Hourai Jeweled?<br>","type":"description","format":"html"},{"title":"Input","content":"The input consists of several test cases. <br>The first line of each case contains one integer N (1 &lt;= N &lt;= 300000), which is the number of nodes in Hourai Jeweled.<br>The second line contains N integers, the i-th of which is Vi (1 &lt;= Vi &lt;= 100000), the value of node i.<br>Each of the next N-1 lines contains three space-separated integer X, Y and Z (1&lt;=X,Y&lt;=N, 1 &lt;= Z &lt;= 100000), which represent that there is an edge between X and Y painted with colour Z. <br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output a line containing the value of Hourai Jeweled.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">6\n6 2 3 7 1 4\n1 2 1\n1 3 2\n1 4 3\n2 5 1\n2 6 2</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">134\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\ngorgeous roads are :\n1-2 \t\tValue: 8\n1-3 \t\tValue: 9\n1-4\t\tValue:13\n1-2-6   \tValue:12\n2-1-3         Value:11\n2-1-4 \tValue:15\n2-5\t\tValue:3\n2-6 \t\tValue:6\n3-1-4\t        Value:16\n3-1-2-6 \tValue:15\n4-1-2-6 \tValue:19\n5-2-6\t\tValue:7\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Author","content":"BUPT","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2012+Multi-University+Training+Contest+1&amp;source=1&amp;searchmode=source\"> 2012 Multi-University Training Contest 1 </a> ","type":"source","format":"html"}]}