{"title":"Final Kichiku “Lanlanshu”","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3886","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3886&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3886","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3886"},"statement":[{"title":"Problem Description","content":"During 2010 summer training, temperlisyer often does problem like this:<br>&#x201C;Consider a decimal integer as sequence of digits {D<sub>0</sub>, D<sub>1</sub> &#x2026; D<sub>n-1</sub>} (D<sub>0</sub> &gt; 0), if exists such x, y and z, satisfying:<br>1.D<sub>i-1</sub>&lt;D<sub>i</sub> (0&lt;i&lt;=x)<br>2.D<sub>i-1</sub>=D<sub>i</sub> (x&lt;i&lt;=y)<br>3.D<sub>i-1</sub>&lt;D<sub>i</sub> (y&lt;i&lt;=z)<br>4.D<sub>i-1</sub>&gt;D<sub>i</sub> (z&lt;i&lt;=n-1)<br><br>We call this integer &#x201C;Lanlanshu&#x201D;, now give you two numbers A and B, calculate how many &#x201C;Lanlanshu&#x201D; are in [A, B].&#x201C;<br>He solved so many of these and finally get bored, and then get crazy! He decided to make up a problem to put this type of problems to an end.<br>Give you a string str consists only by &#x2018;/&#x2019;, &#x2018;-&#x2018; and &#x2018;\\&#x2019;, and its length is l. Consider a decimal integer as sequence of digits {D<sub>0</sub>, D<sub>1</sub> &#x2026; D<sub>n-1</sub>} (D0 &gt; 0), define x<sub>0</sub>=0, x<sub>l</sub>=n-1, if exists such x<sub>1</sub>, x<sub>2</sub>...x<sub>l</sub> (x<sub>0</sub> &lt; x<sub>1</sub> &lt; x<sub>2</sub> &lt; ... &lt; x<sub>l</sub>) satisfying:<br>1. If str[i]=&#x2019;/&#x2019;, D<sub>j-1</sub>&lt;D<sub>j</sub> (x<sub>i</sub>&lt;j&lt;=x<sub>i+1</sub>)<br>2. If str[i]=&#x2019;-&#x2019;, D<sub>j-1</sub>=D<sub>j</sub> (x<sub>i</sub>&lt;j&lt;=x<sub>i+1</sub>)<br>3. If str[i]=&#x2019;\\&#x2019;, D<sub>j-1</sub>&gt;D<sub>j</sub> (x<sub>i</sub>&lt;j&lt;=x<sub>i+1</sub>)<br><br>We call it Final Kichiku &#x201C;Lanlanshu&#x201D;, now give you two numbers A and B, calculate how many Final Kichiku &#x201C;Lanlanshu&#x201D; are in [A, B]. This number maybe huge, we only want to now the last 8 digits of the result.","type":"description","format":"html"},{"title":"Input","content":"Multiple cases (no more than 100), for each case:<br>The first line is string str, length is below 100.<br>The second line contains two integers A and B (0&#x2264;Ai&#x2264;Bi&#x2264;10^100).<br>Input terminates by EOF.","type":"input_format","format":"html"},{"title":"Output","content":"For each case, output 8 digits representing the last 8 digits of the number of Final Kichiku &#x201C;Lanlanshu&#x201D; in [A, B]. If it&#x2019;s less than 8 digits, fill it with leading zeros.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">/\\\n01221 2012</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">00000315</div></pre>","type":"example","format":"html"},{"title":"Author","content":"temperlsyer","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2011+Multi-University+Training+Contest+5+-+Host+by+BNU&amp;source=1&amp;searchmode=source\"> 2011 Multi-University Training Contest 5 - Host by BNU </a> ","type":"source","format":"html"}]}