{"title":"This world need more Zhu","time_limit":5000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5799","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5799&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5799","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5799"},"statement":[{"title":"Problem Description","content":"As we all know,Zhu is the most powerful man.He has the infinite power to protest the world.We need more men like Zhu!<br><br>In Duoladuo,this place is like a tree.There are n points and n-1 edges.And the root is 1.Each point can reach other points.Each point has a value a[i] named Zhu power.<br><br>Liao is a curious baby,he has m questions to ask Zhu.But now Zhu is busy,he wants you to help him answer Liao&apos;s questions.<br><br>Liao&apos;s question will be like&quot;op u v a b&quot;.<br><br>if op is &quot;1&quot;,the u is equal to v.Liao wants to know the GCD of the sum of numbers thats appears a times and the sum of numbers that appears b times in subtree u.<br><br>if op is &quot;2&quot;,Liao wants to know the GCD of the sum of numbers thats appears a times and the sum of numbers that appears b times on the path from u to v.<br><br>GCD is greatest common divisor.<br><br>notice:we can know GCD(x,0) = x.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"In the first line contains a single positive integer T, indicating number of test case.<br><br>In the second line there are two numbers n,m.n is the size of Duoladuo.m is the number of Liao&apos;s questions.<br><br><b>The next line contains n integers A1, A2, ...AN, means the value of i point.<br><br>In the next n-1 line contains tow numbers u,v.It means there is a edge between point u and point v.</b><br><br>The next m lines will be the Liao&apos;s question: <br><br>1 u v a b.<br><br>2 u v a b.<br><br>$1\\le T\\le 10,1\\le n\\le 100000,1\\le m\\le 100000,1\\le op\\le 2,1\\le u,v\\le n,1\\le a,b\\le n,1\\leq A[i] \\leq 1000000000$.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each case, output Case #i:. (ii is the number of the test case, from 1 to T). <br><br>Then, you need to output the answer for every Liao&apos;s questions.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n5 5\n1 2 4 1 2\n1 2\n2 3\n3 4\n4 5\n1 1 1 1 1\n1 1 1 1 2\n2 1 5 1 1\n2 1 5 1 2\n2 1 1 2 2</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1:\n4\n1\n4\n1\n0\n\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nThe query1: gcd(4,4) = 4\nThe query2: gcd(4,1+2)=1\nThe query3: gcd(4,4) = 4\nThe query4: gcd(4,1+2) = 1\nThe query5: gcd(0,0) = 0\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Author","content":"UESTC","type":"source","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2016+Multi-University+Training+Contest+6&amp;source=1&amp;searchmode=source\"> 2016 Multi-University Training Contest 6 </a> ","type":"source","format":"html","require":["katex"]}]}