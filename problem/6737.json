{"title":"Game on Chessboard","time_limit":9000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6737","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6737&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6737","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6737"},"statement":[{"title":"Problem Description","content":"Given a chessboard of size n &#xD7; n. The rows are numbered 1, 2,... , n from top to bottom while the columns are numbered 1, 2, ... , n from left to right, which means that (1, 1) is the top-left corner and that (n, n) is the bottom-right corner.<br>There are some chesses in the chessboard. Each chess has a color, white or black, and a cost value w. The number of chesses in one cell does not exceed 1.<br>You want to remove these chesses. In each time, you can choose one white chess u and one black chess v and then remove them with cost |wu u wv|. Moreover, one chess can be chosen in this operation if and only if there are no other chesses in its bottom-left area. Formally, one chess positioned at (x, y)<br>can be chosen if and only if there are no other chesses (x1, y1) that x1 &#x2265; x and y1 &#x2264; y.<br>However, you may be not able to choose two chesses holding the restriction sometimes. So you can also choose exactly one chess x arbitrarily and remove it with cost wx. Moreover, you can do this operation in any situation as long as there is at least one chess on chessboard.<br>Now you want to remove all the chesses with the minimum total cost. Print the mimimum cost in one line.","type":"description","format":"html"},{"title":"Input","content":"The first line contains one positive integers n (1 &#x2264; n &#x2264; 12), denoting the size of the chessboard.<br>Next n lines each contains a string of length n containing only &#x201C; . &#x201D;, &#x201C;W&#x201D; or &#x201C;B&#x201D;, denoting the initial chessboard, where cell (i, j) is blank if the j-th character in i-th string is &#x201C; . &#x201D;, while &#x201C;W&#x201D; represents a white chess and &#x201C;B&#x201D; represents a black chess.<br>Next n lines each contains n non-negative integers wi,j (0 &#x2264; wi,j &#x2264; 106), denoting the cost values, where the j-th number in i-th line represents the cost value of the chess positioned at (i, j).<br>It is guaranteed that wi,j is positive if and only if there exists a chess at (i, j).","type":"input_format","format":"html"},{"title":"Output","content":"Output a single line containing a non-negative integer, denoting the mimimum cost.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">4\nWBB.\nBWBW\nWBWW\nBBBW\n1 1 1 0\n1 1 1 1\n1 1 1 1\n1 1 1 1</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=642ccpcQHD&amp;source=1&amp;searchmode=source\"> 642ccpcQHD </a> ","type":"source","format":"html"}]}