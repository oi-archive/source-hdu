{"title":"Deleting Edges","time_limit":1000,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6026","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6026&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6026","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6026"},"statement":[{"title":"Problem Description","content":"Little Q is crazy about graph theory, and now he creates a game about graphs and trees.<br>There is a bi-directional graph with $n$ nodes, labeled from 0 to $n-1$. Every edge has its length, which is a positive integer ranged from 1 to 9.<br>Now, Little Q wants to delete some edges (or delete nothing) in the graph to get a new graph, which satisfies the following requirements:<br>(1) The new graph is a tree with $n-1$ edges.<br>(2) For every vertice $v(0&lt;v&lt;n)$, the distance between 0 and $v$ on the tree is equal to the length of shortest path from 0 to $v$ in the original graph.<br>Little Q wonders the number of ways to delete edges to get such a satisfied graph. If there exists an edge between two nodes $i$ and $j$, while in another graph there isn&apos;t such edge, then we regard the two graphs different.<br>Since the answer may be very large, please print the answer modulo $10^9+7$.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The input contains several test cases, no more than 10 test cases.<br>In each test case, the first line contains an integer $n(1\\leq n\\leq 50)$, denoting the number of nodes in the graph.<br>In the following $n$ lines, every line contains a string with $n$ characters. These strings describes the adjacency matrix of the graph. Suppose the $j$-th number of the $i$-th line is $c(0\\leq c\\leq 9)$, if $c$ is a positive integer, there is an edge between $i$ and $j$ with length of $c$, if $c=0$, then there isn&apos;t any edge between $i$ and $j$.<br>The input data ensure that the $i$-th number of the $i$-th line is always 0, and the $j$-th number of the $i$-th line is always equal to the $i$-th number of the $j$-th line.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, print a single line containing a single integer, denoting the answer modulo $10^9+7$.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n01\n10\n4\n0123\n1012\n2101\n3210</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n6</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2017%D6%D0%B9%FA%B4%F3%D1%A7%C9%FA%B3%CC%D0%F2%C9%E8%BC%C6%BE%BA%C8%FC+-+%C5%AE%C9%FA%D7%A8%B3%A1&amp;source=1&amp;searchmode=source\"> 2017&#x4E2D;&#x56FD;&#x5927;&#x5B66;&#x751F;&#x7A0B;&#x5E8F;&#x8BBE;&#x8BA1;&#x7ADE;&#x8D5B; - &#x5973;&#x751F;&#x4E13;&#x573A; </a> ","type":"source","format":"html","require":["katex"]}]}