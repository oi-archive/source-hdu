{"title":"Difference of Languages","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5487","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5487&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5487","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5487"},"statement":[{"title":"Problem Description","content":"A regular language can be represented as a deterministic finite automaton (DFA). A DFA contains a finite set of states $Q$ and a finite set of input symbols called the alphabet $&#xFFFD;&#xFFFD;$. Initially, the DFA is positioned at the start state $q_0&#xFFFD;&#xFFFD;Q$. Given the transition function $&#xFFFD;&#xFFFD;(q,a)$ and an input symbol a, the DFA transit to state $&#xFFFD;&#xFFFD;(q,a)$ if its current state is $q$.<br>Let $w=a_1 a_2&#xFFFD;&#xFFFD;a_n$ be a string over the alphabet $&#xFFFD;&#xFFFD;$. According to the above definition, the DFA transits through the following sequence of states.<br>$$q_0,q_1=&#xFFFD;&#xFFFD;(q_0,a_1 ),q_2=&#xFFFD;&#xFFFD;(q_1,a_2 ),&#xFFFD;&#xFFFD;,q_n=&#xFFFD;&#xFFFD;(q_{n-1},a_n )$$<br>The DFA also contains a set of accept states $F\\subseteq Q$. If the last state $q_n$ is an accept state, we say that the DFA accepts the string $w$. The set of accepted strings is referred as the language that the DFA represents.<br>You are given two DFAs, and the languages that they represent may be different. You want to find the difference between the two languages. Specifically, you are trying to find a string that is accepted by one DFA but not accepted by the other DFA. As there could be multiple such strings, you only want the shortest one. If there are still multiple such strings, you would like the smallest one in lexicographical order.<br><br>","type":"description","format":"html"},{"title":"Input","content":"The first line of input contains a number $T$ indicating the number of test cases ($T&#xFFFD;&#xFFFD;200$).<br>Each test case contains the description of two DFAs.<br>For the first DFA, the first line contains three integers $N$, $M$, and $K$, indicating the number of states, the number of rules describing the transition function, and the number of accept states ($1&#xFFFD;&#xFFFD;K&#xFFFD;&#xFFFD;N&#xFFFD;&#xFFFD;1000,0&#xFFFD;&#xFFFD;M&#xFFFD;&#xFFFD;26N$). The states are numbered from 0 to $N &#xFFFD;C 1$. The start state is always 0.<br>The second line contains $K$ integers representing the accept states. All these numbers are distinct.<br>Each of the next $M$ lines consists of two states $p$ and $q$, and an input symbol $a$, which means that the DFA transits from $p$ to $q$ when it receives the symbol $a$. You may assume that the alphabet in consideration consists of the 26 lowercase letters (a-z). It is guaranteed that, given $p$ and $a$, the next state $q$ is unique.<br>The description of the second DFA follows the same format as the above. <br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output a single line consisting of &#xFFFD;&#xFFFD;Case #X: Y&#xFFFD;&#xFFFD;. $X$ is the test case number starting from 1. $Y$ is the shortest string that is accepted by one DFA but not accepted by the other DFA. If no such string exists, output the digit &#xFFFD;&#xFFFD;0&#xFFFD;&#xFFFD; instead. Note that an empty string is also considered a string.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n3 3 1\n2\n0 1 a\n1 2 b\n2 0 c\n4 4 1\n3\n0 1 a\n1 2 b\n2 3 c\n3 0 a\n3 3 1\n2\n0 1 a\n1 2 b\n2 0 c\n3 4 1\n2\n0 1 a\n1 2 b\n1 2 c\n2 0 c</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1: ab\nCase #2: ac</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2015+ACM%2FICPC+Asia+Regional+Hefei+Online&amp;source=1&amp;searchmode=source\"> 2015 ACM/ICPC Asia Regional Hefei Online </a> ","type":"source","format":"html"}]}