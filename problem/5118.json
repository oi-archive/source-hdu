{"title":"GRE Words Once More!","time_limit":5000,"memory_limit":500,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5118","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5118&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5118","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5118"},"statement":[{"title":"Problem Description","content":"   Now Matt is preparing for the Graduate Record Examinations as Coach Pang did in 2013 and George did in 2011.<br><br>   Thanks to modern techniques, Matt uses automata instead of old-fasioned vocabulary books.<br><br>   The automata used by Matt is a directed acyclic graph (DAG) with N vertices and M edges. The vertices are conveniently numbered by 1, 2, . . . , N . Each edge is labeled with an integer. Additionally, some vertices are marked as special.<br><br>   A GRE word is obtained by concatenating the labels on the path from vertex 1 to a special vertex.<br><br>   Now, Matt has Q questions.  The i-th question is asking for the length of ki-th smallest words among all the GRE words he can obtain in lexicographical order.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"   The first line contains only one integer T , which indicates the number of test cases.<br><br>   For each test case, the first line contains three integers N, M, Q (2 &#x2264; N &#x2264; 10<sup>5</sup>, 0 &#x2264; M &#x2264; 10<sup>5</sup>, 1 &#x2264; Q &#x2264; 10<sup>5</sup>).<br><br>   The second line contains N - 1 integers s<sub>2</sub>, . . . , s<sub>n</sub>.  If the i-th vertex is special, then s<sub>i</sub> = 1. Otherwise, s<sub>i</sub> = 0. Vertex 1 is never special.<br><br>   Each of the following M lines contains three integers a<sub>i</sub>, b<sub>i</sub>, c<sub>i</sub> denoting an edge from vertex ai to vertex b<sub>i</sub> labeled with c<sub>i</sub> (1 &#x2264; a<sub>i</sub>, b<sub>i</sub>  &#x2264; N, 1 &#x2264; c<sub>i</sub> &#x2264; 10<sup>9</sup>). For each vertex v, all outgoing edges are labeled with distinct integers.<br><br>   Each of the following Q lines contains the integer ki (1 &#x2264; k<sub>i</sub> &#x2264; 10<sup>8</sup>) of the i-th question.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"   For each test case, output &#x201C;Case #x:&#x201D; in the frirst line, where x is the case number (starting from 1).<br><br>   Then, for each question, output the length of the word in one line. If the word does not exist, output &#x201C;-1&#x201D; (without quotes) instead.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n3 3 4\n1 1\n1 2 1\n1 3 12\n2 3 3\n1\n2\n3\n4</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1:\n1\n2\n1\n-1\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>There are 3 GRE words in total (sorted in lexicographical order): \n1. (1)\n2.  (1, 3)\n3.  (12)\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2014ACM%2FICPC%D1%C7%D6%DE%C7%F8%B1%B1%BE%A9%D5%BE-%D6%D8%CF%D6%C8%FC%A3%A8%B8%D0%D0%BB%B1%B1%CA%A6%BA%CD%C9%CF%BD%BB%A3%A9&amp;source=1&amp;searchmode=source\"> 2014ACM/ICPC&#x4E9A;&#x6D32;&#x533A;&#x5317;&#x4EAC;&#x7AD9;-&#x91CD;&#x73B0;&#x8D5B;&#xFF08;&#x611F;&#x8C22;&#x5317;&#x5E08;&#x548C;&#x4E0A;&#x4EA4;&#xFF09; </a> ","type":"source","format":"html","require":["katex"]}]}