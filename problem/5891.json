{"title":"String","time_limit":1000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5891","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5891&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5891","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5891"},"statement":[{"title":"Problem Description","content":"Alice just tries to maintain a string, with a kind of operation and a kind of query.<br>The kind of operation allows to insert a character at the end of the string.<br>The kind of query considers the substring, denoted by $T$, of the string from the $l$-th character to the $r$-th one, and asks the maximum length of substring of $T$ which appears at least twice in $T$.<br>If no substring appears at least twice in $T$, the outcome should be $0$.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line consists a string in lowercase and a positive integer m. We use $len$ to denote the length of this string.<br>Each of the following m lines consists a operation or a query.<br><br>We define a temporary variable $tmp$ and it is initially set to $0$.<br>We use the format &quot;1 c&quot; to describe the operation where $(c-&apos;a&apos;+tmp)~mod~26+&apos;a&apos;$ is the new character.<br>We use the format &quot;2 l r&quot; to describe the query where $(l-1+tmp)~mod~len+1$ and $(r-1+tmp)~mod~len+1$ are the indexes of substring $T$.<br>We guarantee that $1\\le (l-1+tmp)~mod~len+1\\le (r-1+tmp)~mod~len+1\\le len$ and after this query $tmp$ should be modified to the outcome.<br><br>The initial length of the string and $m$ are no more than $50000$.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each query, out the outcome in one line.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">aabda 6\n2 1 4\n1 a\n2 1 5\n1 b\n2 6 5\n2 7 4</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n2\n3\n2</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2016+ACM%2FICPC+Asia+Regional+Qingdao+Online&amp;source=1&amp;searchmode=source\"> 2016 ACM/ICPC Asia Regional Qingdao Online </a> ","type":"source","format":"html","require":["katex"]}]}