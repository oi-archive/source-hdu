{"title":"Navi Navigation","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3383","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3383&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3383","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3383"},"statement":[{"title":"Problem Description","content":"The Navi villages on Pandora are part of gigantic hometrees. Hometrees specialize in producing different types of fruits that Navi like to eat. Neytiri&#x2019;s mother Mo&#x2019;at asks her to calculate the shortest path between two given hometrees that allows Mo&#x2019;at to collect every different type of fruit exactly once. Your goal is to help Neytiri calculate these paths. Warning: since there are many hometrees on Pandora, you will not be able to simply examine all possible paths and select the least expensive.<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"Paths between hometrees are described beginning with the line &#x201C;GRAPH BEGIN&#x201D;. Additional lines lists individual hometrees (nodes), the type of fruit produced by the hometree, the distance to the neighboring hometrees, followed (on the same line) by their neighboring hometrees (edges). The line &#x201C;GRAPH END&#x201D; ends the list of connection descriptions. The next lines describe pairs of hometrees for which answers need to be calculated, each on a single line. Following these lines, a completely new instance of the problem can be given, starting from scratch.<br><br>You may assume any hometree can reach any other hometree by some path. Each hometree will be listed at least once as the first item on some line between the GRAPH BEGIN and GRAPH END. The same hometree can be listed more than once with different distance values, but it must always have the same type of fruit assigned to it. Individual connections can appear at most once. It is valid to list only a hometree and its color (specifying no new connections).<br><br>Fruit names will be integers. Not all integers have to be used, however. Your path need only try to collect fruits that at least one tree grows.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"Your output should consist of pairs of hometrees in the same order as in the input, followed by the length of the shortest path between them that collects each type of fruit exactly once. If such a path does not exist, you should output &#x201C;NONE&#x201D;.<br><br>In the first example below, the path a -&gt; b -&gt; c -&gt; d collects all the fruit types (1, 2, 3, and 5) and the path has length 4.0. No good path exists between a and c, however: the path a -&gt; b -&gt; c -&gt; d -&gt; c would collect all the fruit types, but it collects fruit 1 twice!<br><center><img style=\"max-width:100%;\" src=\"../../data/images/C282-1007-1.jpg\"></center> <br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">GRAPH BEGIN \na 3 1 b e \nb 2 2 c \nc 1 1 d\nd 5\ne 2\nGRAPH END\na d\na c\nGRAPH BEGIN\ne 1 2 f\ne 1 3 g\nf 2\ng 2\nh 3 4 g f\nGRAPH END\nh e</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">a d 4.0\na c NONE\nh e 6.0</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2010+MHSPC&amp;source=1&amp;searchmode=source\"> 2010 MHSPC </a> ","type":"source","format":"html","require":["katex"]}]}