{"title":"Watering Hole","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=2887","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=2887&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=2887","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=2887"},"statement":[{"title":"Problem Description","content":"Farmer John has decided to bring water to his N (2 &lt;= N &lt;= 5,000) pastures which are conveniently numbered 1..N. And He has M (1 &lt;= M &lt;= 25,000) pipes. He may bring water to a pasture either by building a well in that pasture or connecting the pasture via a pipe to another pasture which already has water. <br><br>Digging a well in pasture i costs W_i (1 &lt;= W_i &lt;= 100,000). Connecting pastures i and j with a pipe costs p (1 &lt;= p &lt;= 100,000). Since the length and quality are different, there may be more than one pipes in different costs connecting pasture i and j.<br><br>Luckily, farmer John found there was only one plan to minimize his cost.<br><br>Farmer Jack, farmer John&apos;s friend, has P (1 &lt;= P &lt;= 1,000) pipes. He promised that he could give one pipe to Farmer John, and farmer John can use it to connect his pasture i and j. Now, farmer John wants to know how much the minimum amount he will have to pay to water all of his pastures if he chooses one more pipe from Jack.<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"There are serveral cases:<br>Line 1: Three integers: N, M and P<br><br>Lines 2: N space-separated integers; the i-th integer is W_i <br><br>Lines 3..M+3: Three integers: i, j, p. Means a pipe connecting pasture i and j costs p<br><br>Lines M+4..P+M+4: Two Integers: i, j. Farmer Jack can give Farmer John a pipe connecting pasture i and j.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"Line 1..P: A single integer denoting the minimum cost of providing all the pastures with water if farmer John chooses the i-th pipe from farmer Jack. ","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">4 6 1\n5 4 4 3\n1 2 2\n1 3 2\n1 4 2\n2 3 3\n2 4 3\n3 4 4\n3 4</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">7</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2009+Multi-University+Training+Contest+9+-+Host+by+HIT&amp;source=1&amp;searchmode=source\"> 2009 Multi-University Training Contest 9 - Host by HIT </a> ","type":"source","format":"html","require":["katex"]}]}