{"title":"Microblog Subscription","time_limit":5000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4581","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4581&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4581","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4581"},"statement":[{"title":"Problem Description","content":"Jia Baoyu was the best programmer in his big family&#x2014;the Family of Jia, which is why he was regarded as the most charming gentleman among girls. Recently he was designing a new microblog to target the requirements of sharing information in his family. In his system, a microblog can be regarded as a document contains no more than 2000 words.<br>By asked to other member&#x2019;s in the Family of Jia, he decided to release a function of &#x201C;subscription&#x201D; in his microblog. Let&#x2019;s describe this function more specifically:<br>A user can submit a query to describe subscription requirement. A query contains a match type, a match distance constraint and a set of not more than 5 English words. After the user submitted the query, he/she will receive all the new microblog that satisfies the query in his/her &#x201C;Feeds stream&#x201D;. If a microblog satisfies a query, it should match all the words in the query. And a microblog matches a word X when there is at least a word in microblog that matches the word X. Note that the match constraint is applied independently for each word in the query.<br>There are three types of word matching: exact match, approximate match under a Hamming distance constraint  and approximate match under an edit distance. The definitions of these three matches is are follows:<br><strong>Exact match: </strong>two words are exactly the same;<br><strong>Approximate match under Hamming distance D constraint:</strong>two words with the same length have at most D positions at which corresponding letters are different.<br><strong>Approximate match under edit distance D constraint:</strong>one word can be changed into the other word in at most D single-letter edits, including insertion, deletion and substitution.<br>For example, Lin Daiyu submitted a query: edit distance match with distance 1, and the word set &#x201C;flower poem tear&#x201D;. Then she will receive the microblog &#x201C;I wrote a pom full of tears after I saw Daiyu buried the flowers&#x201D;. In this case, &#x201C;flower&#x201D; can be matched with &#x201C;flowers&#x201D; in 1 edit distance, &#x201C;tear&#x201D; can be matched with &#x201C;tears&#x201D; and &#x201C;poem&#x201D; can be matched with &#x201C;pom&#x201D; (obviously it was a typo).<br>After a user submitted a query, he/she could delete the query in anytime. After that he/she would not receive microblogs that satisfy this query.<br>Now please help Jia Baoyu to accomplish this function.<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line of input file contains an integer representing the following number of lines.<br>Each of the following line has three formats:<br><strong>s [id] [type] [dist] [k] [word_1] [word_2] &#x2026; [word_k]</strong><br>The line that starts with lowercase &#x2018;s&#x2019; means adding a query into system. [id] is an integer between 1 to 1000 representing the id of the query. [type] is an integer between 0 to 2 representing the match type (0 means exact match, 1 means hamming distance match and 2 means edit distance match). [dist] is an integer representing the distance constraint (Note that the distance is always 0 for exact match). This distance constraint is at most 2. [k] means the number of following words (0&lt;k&lt;=5). [word_i] represents a word in this query. All the items are separated by a space.<br><strong>e [id]</strong><br>The line that starts with lowercase &#x2018;e&#x2019; means deleting a query from system. [id] is the id of that query. We guarantee that the id always exist and has not deleted before.<br><strong>m [id] [k] [word_1] [word_2] &#x2026; [word_k]</strong><br>The line that starts with lowercase &#x2018;m&#x2019; means a microblog. [id] is an integer between 1 to 100 which means the id of the microblog. [k] is an integer meaning the number of words that follows (0&lt;k&lt;=2000). [word_i] represents a word in this microblog. All the items are separated by a space.<br>The length of a word is less than or equal to 30, and there are no blanks in a word. The number of total queries is less than or equal to 1000, while the number of total microblogs is less than or equal to 100.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each microblog in the input file, output all the matched active queries when it published. The &#x201C;active&#x201D; means that query has been submitted and not deleted yet. The format is:<br><strong>[id] [k] [q_1] [q_2] &#x2026; [q_k]</strong><br>[id] means the id of this microblog. [k] means the number of queries that it satisfies. [q_i] means a query id. Query ids must be sorted increasingly.<br>The order of microblog in output file must be the same as it is displayed in the input file.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">6\ns 1 1 2 1 bkple\nm 2 1 apple\ns 2 0 0 2 apple banana\nm 1 2 apple banana\ne 1\nm 3 2 apple banana</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2 1 1\n1 2 1 2\n3 1 2</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2013ACM-ICPC%BA%BC%D6%DD%C8%FC%C7%F8%C8%AB%B9%FA%D1%FB%C7%EB%C8%FC&amp;source=1&amp;searchmode=source\"> 2013ACM-ICPC&#x676D;&#x5DDE;&#x8D5B;&#x533A;&#x5168;&#x56FD;&#x9080;&#x8BF7;&#x8D5B; </a> ","type":"source","format":"html","require":["katex"]}]}