{"title":"Zhuge Liang's Stone Sentinel Maze","time_limit":4000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4048","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4048&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4048","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4048"},"statement":[{"title":"Problem Description","content":"<center><img style=\"max-width:100%;\" src=\"../../data/images/4048-1.jpg\"></center> <br>Zhuge Liang was a chancellor of the state of Shu Han during the Three Kingdoms period of Chinese history. He is often recognized as the greatest and most accomplished strategist of his era. He was so smart that his name also means &#xFFFD;&#xFFFD;wise man&#xFFFD;&#xFFFD; in Chinese.<br><br>One of Zhuge Liang&#xFFFD;&#xFFFD;s achievements in legend is the Stone Sentinel Maze. It was an array of rocks and boulders built to defend against enemies. The formation was located on Yufu Shore by the Yangtze River near present-day Baidicheng, Chongqing, China, where supposed ruins of the array exist.<br><br>In chapter 84 of the historical novel Romance of the Three Kingdoms, as Lu Xun neared Baidicheng, he felt a strong enemy presence in the area and alerted his army to a possible ambush. He sent scouts ahead, who reported that the region was deserted except for some scattered piles of rocks. The bewildered Lu Xun asked a local, who told him that qi (&quot;energy&quot;) started emerging from the area after Zhuge Liang arranged the rocks there. Lu Xun personally inspected the area and decided that the array was only a petty display of deception. Hence, Lu Xun led a few horsemen with him into the maze, and as he was about to exit, there was a strong gust of wind. At that moment, dust storms overshadowed the sky and the rocks appeared to become valleys; mountainous piles of dirt emerged and the roar of thunder rocked the skies while the waves of the nearby Yangtze River sounded like the clashing of swords and beating of war drums&#xFFFD;&#xFFFD;<br><br>After the research on the Stone Sentinel Maze, scientists find some regulations. The rocks have m different kinds of weight (1&lt;=m&lt;=10,000). The weight of a rock is a positive integer not exceeding 10,000. There are n (3&lt;=n&lt;=100,000) rocks placed on a circle with equal spacing and the greatest common divisor of their weight is 1. They want to know in how many ways the rocks can be placed like that.<br><br>Notice:<br>1. Multiple rocks with the same weight can be placed on the circle.<br>2. If a solution will be the same as another one by rotation, these two solutions should be consider as the same.<br>3. The answer may be quite large. You just need to calculate the remainder of the answer when divided by 10,007.<br>","type":"description","format":"html"},{"title":"Input","content":"The input begins with a line containing an integer T, the number of test cases.<br>For each case, the first line begins with two integers --- the above mentioned m and n. Then m lines follow, each containing a positive integer representing rock weight. It is guaranteed that these m integers are different.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each case, output one integer in one line, representing the remainder of the number of ways when divided by 10,007.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n2 3\n2\n3\n3 3\n6\n10\n15</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n2</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=The+36th+ACM%2FICPC+Asia+Regional+Beijing+Site+%A1%AA%A1%AA+Online+Contest+&amp;source=1&amp;searchmode=source\"> The 36th ACM/ICPC Asia Regional Beijing Site &#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD; Online Contest  </a> ","type":"source","format":"html"}]}