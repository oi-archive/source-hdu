{"title":"GCD pair","time_limit":8000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5042","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5042&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5042","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5042"},"statement":[{"title":"Problem Description","content":"   The greatest common divisor (gcd) of two or more integers (at least one of which is not zero) is the largest positive integer that divides the numbers without a remainder.<br><br>   Now I will give you a simple problem about gcd again. <br><br>   Given a sequence of N integers, A = {a<sub>1</sub>, a<sub>2</sub>, ..., a<sub>N</sub> }.<br><br>   For every pair of &lt; l, r &gt;( 1 &#xFFFD;&#xFFFD; l &#xFFFD;&#xFFFD; r &#xFFFD;&#xFFFD; N ), defined a function F (l, r) = gcd(a<sub>i</sub>)( l &#xFFFD;&#xFFFD; i &#xFFFD;&#xFFFD; r ) that is the greatest common divisor of all the integers in the subsequence {a<sub>l</sub>, a<sub>l+1</sub>, ..., a<sub>r</sub> }<br><br>   Obviously, There are N * (N + 1)/2 pair of &lt; l, r &gt;( 1 &#xFFFD;&#xFFFD; l &#xFFFD;&#xFFFD; r &#xFFFD;&#xFFFD; N ). We can get the rank of pair &lt; l, r &gt; through the following code.<br><br><b><br>1  pair&lt;int,int&gt; get_RANK(int l,int r) <br>2  {<br>3        map&lt;int,int&gt;mp;<br>4        int k1 = 1, k2 = 1;<br>5        for(int i = 1;i &lt;= N;i++)<br>6            for(int j = i;j &lt;= N;j++)<br>7&#xA0;&#xA0;      {<br>8&#xA0;&#xA0;        if(i == l &amp;&amp; j == r)continue;<br>9&#xA0;&#xA0;        if(F(i,j) &lt; F(l,r))<br>10&#xA0;&#xA0;        {<br>11&#xA0;&#xA0;            if(mp.find(F(i,j)) != mp.end())continue;<br>12&#xA0;&#xA0;            k1++;<br>13&#xA0;&#xA0;            mp[F(i,j)] = 1;<br>14&#xA0;&#xA0;        }<br>15&#xA0;&#xA0;        else if(F(i,j) == F(l,r))<br>16&#xA0;&#xA0;        {<br>17&#xA0;&#xA0;&#xA0;&#xA0;       if(i &lt; l || (i == l &amp;&amp; j &lt; r))k2++; <br>18&#xA0;&#xA0;        }<br>19&#xA0;&#xA0;      }<br>20&#xA0;&#xA0;      return make_pair(k1,k2);<br>21  }<br><br>(If you don&#xFFFD;&#xFFFD;t know C++, what a sad story! Sorry!)<br></b><br><br>   There are Q queries, you need to answer the following two queries:<br><br>   &#xFFFD;&#xFFFD;  SELECT k1 k2: ask for the pair &lt; l, r &gt; which is rank &lt; k<sub>1</sub>, k<sub>2</sub> &gt;.If there is no such pair output -1.<br><br>   &#xFFFD;&#xFFFD;  RANK l r: ask for the rank &lt; k<sub>1</sub>, k<sub>2</sub> &gt; of the pair &lt; l, r &gt;","type":"description","format":"html"},{"title":"Input","content":"   The first line of the input is T (1 &#xFFFD;&#xFFFD; T &#xFFFD;&#xFFFD; 10), which stands for the number of test cases you need to solve.<br><br>   The first line of each case contains two integers N ,Q (1 &#xFFFD;&#xFFFD; N, Q &#xFFFD;&#xFFFD;10<sup>5</sup>),denoting the number of integers and queries, respectively.<br><br>   The second line contains N integers, a<sub>1</sub>, a<sub>2</sub>, ..., a<sub>N</sub> (1 &#xFFFD;&#xFFFD; a<sub>i</sub> &#xFFFD;&#xFFFD; 10<sup>5</sup>).<br><br>   For the next Q lines, contain instructions &#xFFFD;&#xFFFD;SELECT k<sub>1</sub> k<sub>2</sub>&#xFFFD;&#xFFFD; or &#xFFFD;&#xFFFD;RANK l r&#xFFFD;&#xFFFD; (1 &#xFFFD;&#xFFFD; k<sub>1</sub>, k<sub>2</sub> &#xFFFD;&#xFFFD; N * (N + 1)/2,1 &#xFFFD;&#xFFFD; l &#xFFFD;&#xFFFD; r &#xFFFD;&#xFFFD; N ),","type":"input_format","format":"html"},{"title":"Output","content":"   For each test case, print a line &#xFFFD;&#xFFFD;Case #t:&#xFFFD;&#xFFFD;(without quotes, t means the index of the test case) at the beginning.<br><br>   For each query, output the answer.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n3 6\n6 2 4\nRANK 1 1\nSELECT 3 1\nRANK 2 3\nSELECT 2 2\nSELECT 1 3\nSELECT 1 4</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1:\n3 1\n1 1\n1 4\n-1\n2 2\n2 3</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2014+ACM%2FICPC+Asia+Regional+Shanghai+Online&amp;source=1&amp;searchmode=source\"> 2014 ACM/ICPC Asia Regional Shanghai Online </a> ","type":"source","format":"html"}]}