{"title":"Interesting Housing Problem","time_limit":2000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=2426","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=2426&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=2426","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=2426"},"statement":[{"title":"Problem Description","content":"For any school, it is hard to find a feasible accommodation plan with every student assigned to a suitable apartment while keeping everyone happy, let alone an optimal one. Recently the president of University ABC, Peterson, is facing a similar problem. While Peterson does not like the idea of delegating the task directly to the class advisors as so many other schools are doing, he still wants to design a creative plan such that no student is assigned to a room he/she dislikes, and the overall quality of the plan should be maximized. Nevertheless, Peterson does not know how this task could be accomplished, so he asks you to solve this so-called &quot;interesting&quot; problem for him.<br>Suppose that there are N students and M rooms. Each student is asked to rate some rooms (not necessarily all M rooms) by stating how he/she likes the room. The rating can be represented as an integer, positive value meaning that the student consider the room to be of good quality, zero indicating neutral, or negative implying that the student does not like living in the room. Note that you can never assign a student to a room which he/she has not rated, as the absence of rating indicates that the student cannot live in the room for other reasons.<br>With limited information available, you&apos;ve decided to simply find an assignment such that every student is assigned to a room he/she has rated, no two students are assigned to the same room, and the sum of rating is maximized while satisfying Peterson&apos;s requirement. The question is &#x2026; what exactly is the answer?<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"There are multiple test cases in the input file. Each test case begins with three integers, N, M, and E (1 &lt;= N &lt;= 500, 0 &lt;= M &lt;= 500, 0 &lt;= E &lt;= min(N * M, 50000)), followed by E lines, each line containing three numbers, S<sub>i</sub>, R<sub>i</sub>, V<sub>i</sub>, (0 &lt;= S<sub>i</sub> &lt; N, 0 &lt;= R<sub>i</sub> &lt; M, |V<sub>i</sub>| &lt;= 10000), describing the rating V<sub>i</sub> given by student S<sub>i</sub> for room R<sub>i</sub>. It is guaranteed that each student will rate each room at most once.<br>Each case is followed by one blank line. Input ends with End-of-File.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, please output one integer, the requested value, on a single line, or -1 if no solution could be found. Use the format as indicated in the sample output.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3 5 5\n0 1 5\n0 2 7\n1 1 6\n1 2 3\n2 4 5\n\n1 1 1\n0 0 0\n\n1 1 0</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1: 18\nCase 2: 0\nCase 3: -1</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2008+Asia+Hangzhou+Regional+Contest+Online&amp;source=1&amp;searchmode=source\"> 2008 Asia Hangzhou Regional Contest Online </a> ","type":"source","format":"html","require":["katex"]}]}