{"title":"Mart Master","time_limit":2000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4894","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4894&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4894","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4894"},"statement":[{"title":"Problem Description","content":"   Trader Dogy lives in city S, which consists of n districts. There are n - 1 bidirectional roads in city S, each connects a pair of districts. Indeed, city S is connected, i.e. people can travel between every pair of districts by roads.<br><br>   In some districts there are marts founded by Dogy&apos;s competitors. When people go to marts, they&apos;ll choose the nearest one. In case there are more than one nearest marts, they&apos;ll choose the one with minimal district number.<br><br>   Dogy&apos;s money could support him to build at most m new marts, but he can&apos;t build new marts in the district which already had his competitors&apos;s marts. he wants to attract as many people as possible, that is, to build his marts in some way that maximize the number of people who will choose his marts as favorite. Could you help him?","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"   There are several test cases, please process till EOF.<br><br>   In each testcase:<br>   First line contains two numbers n and m(1 &#x2264; m &#x2264; n &#x2264; 200).<br>   Next n - 1 lines, each contains three numbers b<sub>i</sub>, e<sub>i</sub> and w<sub>i</sub>, (1 &#x2264; b<sub>i</sub>, e<sub>i</sub> &#x2264; n, 1 &#x2264; w<sub>i</sub> &#x2264; 10000), indicates that there&apos;s one road connecting city b<sub>i</sub> and e<sub>i</sub>, and its length is w<sub>i</sub>.<br><br>   Last line contanins n numbers, each number is either 0 or 1, i<sup>th</sup> number is 1 indicates that the i<sup>th</sup> district has mart in the beginning and vice versa.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"   For each testcase, output one number, denoting the maximum number of districts of people you can attract.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5 1\n1 2 1\n2 3 1\n3 4 1\n4 5 1\n1 0 0 0 1\n5 2\n1 2 1\n2 3 1\n3 4 1\n4 5 1\n1 0 0 0 1</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n3</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Author","content":"Fudan University","type":"source","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2014+Multi-University+Training+Contest+3&amp;source=1&amp;searchmode=source\"> 2014 Multi-University Training Contest 3 </a> ","type":"source","format":"html","require":["katex"]}]}