{"title":"Jumping on a Cactus","time_limit":2000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6864","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6864&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6864","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6864"},"statement":[{"title":"Problem Description","content":"<b>It is preferrable to read the pdf statment.</b><br><br>Cuber QQ has recently learned jumping on graphs. He now wants to demonstrate his skills on a <i>cactus</i>.<br><br>Recall that, <i>cactus</i> refers to a graph with every edge appearing in <b>at most one</b> <i>cycle</i>. If you do not know what a <i>cycle</i> is, formally, a <i>cycle</i> of length $k$ denotes an edge sequence $(u_1,u_2), (u_2,u_3),\\ldots,(u_{k-1},u_k),(u_k,u_1)$.<br><br>Assuming you are given an undirected cactus $G=(V, E)$, with $n$ vertices and $m$ edges. A jumping on the cactus can be thought of as a visit to all vertices where every vertex is visited exactly once. That can be represented with a permutation of $1$ to $n$, $p_1, p_2, \\ldots, p_n$, and they are visited in order.<br><br>Cuber QQ also wishes his jumping to be gradually approaching or distancing away from a particular node $e$. Concretely, we define $d(a, b)$ to be the distance from $a$ to $b$ (the minimum edges needs to be passed through from $a$ to $b$). A jumping is defined to be monotonic if,<br><br><ul><br><li> for all edges $(u, v) \\in E$, $d(u, e) &lt; d(v, e)$ when $u$ is visited before $v$, or,</li><br><li> for all edges $(u, v) \\in E$, $d(u, e) &gt; d(v, e)$ when $u$ is visited after $v$.</li><br></ul><br><br>Count the number of different monotonic jumping plans. Since the answer can be very large, you should print the answer modulo $998~244~353$.<br>","type":"description","format":"html"},{"title":"Input","content":"The first line of the input contains a single integer $T$ ($1\\le T\\le 30$), denoting the number of test cases.<br><br>For each of the next $T$ cases:<br><br><ul><br><li> The first line contains three space-separated integers $n$, $m$, $e$ ($2\\le n\\le 5~000$, $1\\le m\\le 2(n-1)$, $1\\le e\\le n$).</li><br><li> The $i$-th of the next $m$ lines contains two space-separated integers $u_i$, $v_i$ ($1\\le u_i,v_i\\le n$, $u_i\\ne v_i$). It is guaranteed that $d(u_i, e) \\ne d(v_i, e)$.</li><br></ul><br><br>There are at most $10$ test cases where $n\\ge 1~000$.","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output one line contains one integer denoting the answer modulo $998~244~353$.<br><br><h3>Notes</h3><br>For the example, $G$ looks like:<br><br><center><img style=\"max-width:100%;\" src=\"../../../data/images/C904-1010-1.jpg\"></center><br><br>$3$ is the index of reference vertex.<br><br>There are $8$ correct permutations:<br><br><ul><br><li> $\\{ 3,2,4,1,6,5 \\}$.</li><br><li> $\\{ 3,2,1,4,6,5 \\}$.</li><br><li> $\\{ 3,2,1,6,4,5 \\}$.</li><br><li> $\\{ 3,2,1,6,5,4 \\}$.</li><br><li> $\\{ 3,2,4,6,1,5 \\}$.</li><br><li> $\\{ 3,2,6,4,1,5 \\}$.</li><br><li> $\\{ 3,2,6,1,4,5 \\}$.</li><br><li> $\\{ 3,2,6,1,5,4 \\}$.</li><br></ul>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n6 7 3\n6 2\n5 6\n1 5\n1 2\n3 2\n3 2\n4 2</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">8</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2020+Multi-University+Training+Contest+8&amp;source=1&amp;searchmode=source\"> 2020 Multi-University Training Contest 8 </a> ","type":"source","format":"html"}]}