{"title":"Homework","time_limit":7000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4471","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4471&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4471","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4471"},"statement":[{"title":"Problem Description","content":"GS is suffering from tons of boring math assignment. He find it make him tired and impatient so he asks you to finish his assignment in hope that he could hang out in many places of interest and enjoy his life.<br>In this assignment, you&#x2019;re asked to solve the following problem:<br>Given a recurrent function<br><center><img style=\"max-width:100%;\" src=\"../../data/images/C422-1008-1.jpg\"></center><br>and boundary values<br><center><img style=\"max-width:100%;\" src=\"../../data/images/C422-1008-2.jpg\"></center><br>You should solve for f[n].<br>What a easy problems! Wait for a moment, you see a few lines in the last paragraph. It reads as follows: To make the problem a little hard, you are now informed that, at some special values of n (there are q such values, namely n<sub>1</sub>, n<sub>2</sub>, . . . , n<sub>q</sub>), the recurrent formula changes into something else, which means for the k<sup>th</sup> such value n<sub>k</sub>, the recurrent formula changes into<br><center><img style=\"max-width:100%;\" src=\"../../data/images/C422-1008-3.jpg\"></center><br>Still an easy problem, isn&#x2019;t it?<br>Since f[n] may be quite large, you just need to output f[n] module 10<sup>9</sup> + 7.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"There are several test cases.<br>For each test case, the first line contains three integers n (m &lt; n &#x2264; 10<sub>9</sub>), m (1 &#x2264; m &#x2264; 100), q (0 &#x2264; q &#x2264; 100). The second line contains m integers, namely f[1], f[2], . . . , f[m].<br>The following line contains several integers, first comes t (t &#x2264; 100), then t integers namely c[1], c[2], . . . , c[t].<br>The following q lines describe q special cases of the recurrent formula, each containing several integers, namely n<sub>k</sub>, t<sub>k</sub> (t<sub>k</sub> &#x2264; 100, t<sub>k</sub> &lt; n<sub>k</sub>), c<sub>k</sub>[1], c<sub>k</sub>[2], . . . , c<sub>k</sub>[t<sub>k</sub>], as mentioned earlier. It is satisfied that n<sub>i</sub> != n<sub>j</sub> if i != j.<br>All integers are non-negative. Unless specified, all integers are not greater than 10<sup>9</sup>.<br>Input is terminated by EOF.<br>You might assume that all given data is correct.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, output one line &#x201C;Case X: Y&#x201D; where X is the test case number (starting from 1) and Y is the desired answer.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">7 5 0\n1 1 2 3 5\n2 1 1\n10 5 1\n1 1 2 3 5\n2 1 1\n10 2 1 2</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1: 13\nCase 2: 76\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nIn the first sample, you are to solve for f[7] where f[n] = f[n&#x2212;1]+f[n&#x2212;2] and f[1] = 1,\nf[2] = 1, f[3] = 2, f[4] = 3, f[5] = 5.\nIn the second example, you are to solve for f[10] where f[n] = f[n &#x2212; 1] + f[n &#x2212; 2] and\nf[1] = 1, f[2] = 1, f[3] = 2, f[4] = 3, f[5] = 5, as well as specially f[10] = f[9] + 2*f[8].\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2012+Asia+Chengdu+Regional+Contest&amp;source=1&amp;searchmode=source\"> 2012 Asia Chengdu Regional Contest </a> ","type":"source","format":"html","require":["katex"]}]}