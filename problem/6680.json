{"title":"Rikka with Quicksort","time_limit":3000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6680","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6680&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6680","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6680"},"statement":[{"title":"Problem Description","content":"Rikka is interested in computer science, and she has been practicing coding for two years and a half. Today, she wants to do a simple summary of the algorithms she has learned. <br><br>One of the most important algorithms is Quicksort. Though its idea is quite simple, Rikka remembers that it took her a while to prove the time complexity. Let $f(n)$ be the expected number of comparisons required by Quicksort on a sequence with length $n$. Then $f(n)$ follows the following equations:<br>$$<br>\\begin{aligned}<br>f(0) &amp;= 0 \\\\<br>f(i) &amp;= i-1 + \\frac{1}{i}\\sum_{j=1}^{i}\\left( f(j-1) + f(i-j)\\right)  &amp; i \\geq 1<br>\\end{aligned}<br>$$<br>After some simple derivations, Rikka finishes the proof and obtains the result that $f(n) = O(n \\log n)$: As an outstanding undergraduate student, this problem is just a piece of cake for her.<br><br>To make the task more challenging, Rikka asks Yuta, her boyfriend, to set several exercises for her. The following is the hardest one of them:<br><br>Consider a modified version of Quicksort: the recursive process terminates once the length of the interval is less than $m$. At this time, the expected number of comparisons $g_m(n)$ can be described with the following equations:<br>$$<br>\\begin{aligned}<br>g_m(i) &amp;= 0 &amp; 0 \\leq i \\leq m\\\\<br>g_m(i) &amp;= i-1 + \\frac{1}{i}\\sum_{j=1}^{i}\\left( g_m(j-1) + g_m(i-j)\\right)  &amp; i &gt; m<br>\\end{aligned}<br>$$<br>Now, Yuta shows the value of $n,m$, and he wants Rikka to calculate $g_m(n)$. It is generally known that Rikka is not good at math. Therefore she wants you to help her calculate the answer.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line is an integer $t(1 \\leq t \\leq 10)$, the number of test cases.<br><br>For each test case, the input contains a single line with two positive integers $n,m(1 \\leq m \\leq n \\leq 10^9)$.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, output a single line with a single number, the value of $g_m(n)$. <br><br>Clearly, $g_m(n)$ is a rational number. Therefore, you are required to print $g_m(n)\\ \\text{mod}\\ 1000000007$, i.e., print $x \\times y^{-1}\\ \\text{mod}\\ 1000000007$ where $\\frac{x}{y}$ is the irreducible fraction representation of $g_m(n)$.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5\n3 1\n5 1\n5 3\n10 5\n1000 500</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">666666674\n800000013\n400000008\n308730177\n3107840</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2019+Multi-University+Training+Contest+9&amp;source=1&amp;searchmode=source\"> 2019 Multi-University Training Contest 9 </a> ","type":"source","format":"html","require":["katex"]}]}