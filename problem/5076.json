{"title":"Memory","time_limit":4000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5076","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5076&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5076","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5076"},"statement":[{"title":"Problem Description","content":"Little Bob&#xFFFD;&#xFFFD;s computer has 2<sup>n</sup> bytes of memory. For convenience, n-bit integers 0 to 2<sup>n</sup> - 1 are used to index these bytes.<br><br><img style=\"max-width:100%;\" src=\"../../data/images/C549-1007-1.jpg\"><br><br>Now he wants to assign a value to each byte of the memory. In this problem, a byte is composed of m bits. Therefore he can only assign 0 to 2<sup>m</sup> - 1 (inclusive) to a single byte.<br><br>Bob has some preferences on which value to be assigned to each byte. For the byte indexed by i, if it is assigned with value j (0 &#xFFFD;&#xFFFD; j &lt; 2<sup>m</sup>), the preference score for it is w<sub>i</sub>,<sub>j</sub>.<br><br>In addition, each byte has a threshold value. For two different bytes indexed by a and b, if the following two conditions are satisfied, there will be an additional score (u<sub>a</sub> xor u<sub>b</sub>):<br><br>   1.a and b only have one bit of difference in their binary forms;<br><br>   2.The assigned value of byte a is not less than its threshold value, or the assigned value of byte b is not less than its threshold value.<br><br>The total score of an assignment solution is the sum of the preference scores of all bytes plus the sum of all additional scores.<br><br>Bob wants to find an assignment solution with the maximum total score. If there are multiple solutions, you can output any of them.","type":"description","format":"html"},{"title":"Input","content":"The first line contains an integer T (T &#xFFFD;&#xFFFD; 3), denoting the number of the test cases.<br><br>For each test case, the first line contains two integers, n and m(1 &#xFFFD;&#xFFFD; n, m &#xFFFD;&#xFFFD; 8), as mentioned above. The second line contains 2<sup>n</sup> integers, and the i-th integer is the threshold value for byte i. The threshold values are between 0 and 2<sup>m</sup> - 1, inclusively. The third line contains 2<sup>n</sup> integers, and the i-th integer is ui(0 &#xFFFD;&#xFFFD; u<sub>i</sub> &lt; 1024). The next 2<sup>n</sup> lines give all preference scores. Each line contains 2<sup>m</sup> integers, and the j-th integer of the i-th line is w<sub>i</sub>,<sub>j</sub> (-1024 &#xFFFD;&#xFFFD; w<sub>i</sub>,<sub>j</sub> &lt; 1024).","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output one line consisting of 2<sup>n</sup> integers between 0 and 2<sup>m</sup> - 1, and the i-th integer is the value assigned to byte i in the assignment solution with the maximum total score.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n3 2\n0 1 1 3 3 0 3 3\n4 8 8 7 0 9 2 9\n-9 -8 3 2\n-9 -6 4 1\n-6 -8 -5 3\n3 -1 -4 -1\n-6 -5 1 10\n-10 7 3 -10\n-3 -10 -4 -5 \n-2 -1 -9 1</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2 2 3 0 3 1 0 3</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2014+Asia+AnShan+Regional+Contest&amp;source=1&amp;searchmode=source\"> 2014 Asia AnShan Regional Contest </a> ","type":"source","format":"html"}]}