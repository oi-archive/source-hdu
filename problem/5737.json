{"title":"Differencia","time_limit":10000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5737","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5737&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5737","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5737"},"statement":[{"title":"Problem Description","content":"Professor Zhang has two sequences $a_1,a_2,...,a_n$ and $b_1,b_2,...,b_n$. He wants to perform two kinds of operations on the sequences:<br><br>1. + $l$ $r$ $x$: set $a_i$ to $x$ for all $l \\le i \\le r$.<br>2. ? $l$ $r$: find the number of $i$ such that $a_i \\ge b_i$ and $l \\le i \\le r$.<br>","type":"description","format":"html"},{"title":"Input","content":"There are multiple test cases. The first line of input contains an integer $T$, indicating the number of test cases. For each test case:<br><br>The first line contains four integers $n$, $m$, $A$ and $B$ $(1 \\le n \\le 10^5, 1 \\le m \\le 3000000, 1 \\le A, B \\le 2^{16})$ -- the length of the sequence, the number of operations and two parameters.<br><br>The second line contains $n$ integers $a_1, a_2, ..., a_n$ $(1 \\le a_i \\le 10^9)$. The third line contains $n$ integers $b_1, b_2, ..., b_n$ $(1 \\le b_i \\le 10^9)$. <br><br>As there are too many operations, the $m$ operations are specified by parameters $A$ and $B$ given to the following generator routine.<br><br><pre><br>int a = A, b = B, C = ~(1&lt;&lt;31), M = (1&lt;&lt;16)-1;<br>int rnd(int last) {<br>    a = (36969 + (last &gt;&gt; 3)) * (a &amp; M) + (a &gt;&gt; 16);<br>    b = (18000 + (last &gt;&gt; 3)) * (b &amp; M) + (b &gt;&gt; 16);<br>    return (C &amp; ((a &lt;&lt; 16) + b)) % 1000000000;<br>}<br></pre><br><br>For the $i$-th operation, first call rnd(last) three times to get $l$, $r$ and $x$ (i.e. l = rnd(last) % n + 1, r = rnd(last) % n + 1, x = rnd(last) + 1). Then if $l &gt; r$, you should swap their value. And at last, the $i$-th operation is type ?, if $(l+r+x)$ is an even number, or type + otherwise.<br><br>Note: $last$ is the answer of the latest type ? operation and assume $last = 0$ at the beginning of each test case.","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output an integer $S=(\\sum\\limits_{i=1}^{m}{i \\cdot z_i}) \\text{ mod } (10^9 + 7)$, where $z_i$ is the answer for $i$-the query. If the $i$-th query is of type +, then $z_i=0$.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n5 10 1 2\n5 4 3 2 1\n1 2 3 4 5\n5 10 3 4\n5 4 4 2 1\n1 2 3 4 5\n5 10 5 6\n5 4 5 2 1\n1 2 2 4 5</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">81\n88\n87</div></pre>","type":"example","format":"html"},{"title":"Author","content":"zimpha","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2016+Multi-University+Training+Contest+2&amp;source=1&amp;searchmode=source\"> 2016 Multi-University Training Contest 2 </a> ","type":"source","format":"html"}]}