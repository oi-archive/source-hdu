{"title":"Orienteering","time_limit":4000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3525","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3525&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3525","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3525"},"statement":[{"title":"Problem Description","content":"The Orienteering competition is coming soon&#xFFFD;&#xFFFD;Now there are N players to participate in&#xFFFD;&#xFFFD;each has his own cheering squad (lala dui) &#xFFFD;&#xFFFD;In order to ensure order and security competition&#xFFFD;&#xFFFD;Each player&apos;s cheering squad can only send 2*M beautiful mm ,M mm from North Campus&#xFFFD;&#xFFFD;M mm from South Campus(as known that HNU consists of South Campus and North Campus)&#xFFFD;&#xFFFD;<br>In order to facilitate management , the mm from the same Campus must stay at the same side of the road which means there are two Sequences and each Sequence has equal number of mm .The day of the race&#xFFFD;&#xFFFD;each side has many positions starting from the finishing line toward the starting line numbered for the 1,2,3. . . . up to 2*n*m positions&#xFFFD;&#xFFFD;every mm has her own favorite position&#xFFFD;&#xFFFD;however, when she finds her favorite position is occupied by other students, she has to go to the next position, until she finds a empty position(the cost time of this process is negligible)&#xFFFD;&#xFFFD;<br>For example,  there is a mm whose favorite position is 3&#xFFFD;&#xFFFD;when she goes to the position 3&#xFFFD;&#xFFFD;there has a people over there&#xFFFD;&#xFFFD;so she goes to the next position 4&#xFFFD;&#xFFFD;however &#xFFFD;&#xFFFD;still has a people there &#xFFFD;&#xFFFD;until she gets the position 6 where no one occupies this position at present,so she`s position is 6&#xFFFD;&#xFFFD;when all the people find their positions ,the teacher for the competition comes ,he finds that there are still some empty positions ,then he orders that all people move closer to the finishing line which can not change the relative positions of each mm at the both side,so finally their positon number is from 1 to n*m&#xFFFD;&#xFFFD;now we get two sequence A,B A[i] means the mm on the ith position of this side support the player A[i],B[i] means the mm on the ith position of the opposite side support the player B[i].<br>Now the teacher has Picking a speaker , the mm supporting different players must wear different clothes, but those who support the same player should wear the same clothes. In order to make the venue more harmonious visual effect&#xFFFD;&#xFFFD;to choose two sequence (A[c[1]],A[c[2]],......A[c[len]]) (B[d[1]],B[d[2]],.....B[d[len]]),A[c[i]]=B[d[i]] (1=i&lt;=len) The teacher want to know the max len,can you help us?Namely, you should find the max len such that there exists two identical subsequence with len elements in A and B respectively(these two subsequence need not to be continuous).<br>","type":"description","format":"html"},{"title":"Input","content":"The first line of input should give the number of cases, T (at most 20).the first line of each case has two numbers n,m(1&lt;=n&lt;=10000,1&lt;=m&lt;=10)n represent the number of players&#xFFFD;&#xFFFD;numbers from 1 to n &#xFFFD;&#xFFFD;m  represent the number of mm of each player`s cheering squad&#xFFFD;&#xFFFD;The next two lines&#xFFFD;&#xFFFD;each with  n*m*2  numbers&#xFFFD;&#xFFFD;the i*2-1 number means the ith mm`s supported player number v[i]&#xFFFD;&#xFFFD;1&lt;=v[i]&lt;=n&#xFFFD;&#xFFFD;,the i*2 number means the  ith  mm`s faviourite positionw[i](1&lt;=w[i]&lt;=m*n), we set the mm number i is earlier than the mm number j when (i&lt;j).","type":"input_format","format":"html"},{"title":"Output","content":"For each case, output should be one line containing &quot;Case #x: &quot;,then flollow a number ,the max len. ","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n3 2\n1 3 1 4 3 2 2 5 2 2 3 1\n3 1 1 4 2 2 3 1 2 4 1 3</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1: 4\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div> After the operation the A sequence is: 3 3 1 1 2 2 While The  B sequence is : 3 2 3 1 2 1 The most longest common sequence is 3 3 1 1 so the len is 4.</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2010+ACM-ICPC+Multi-University+Training+Contest%A3%A89%A3%A9%A1%AA%A1%AAHost+by+HNU&amp;source=1&amp;searchmode=source\"> 2010 ACM-ICPC Multi-University Training Contest&#xFFFD;&#xFFFD;9&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;Host by HNU </a> ","type":"source","format":"html"}]}