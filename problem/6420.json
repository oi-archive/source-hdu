{"title":"Rikka with Spanning Tree","time_limit":2000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6420","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6420&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6420","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6420"},"statement":[{"title":"Problem Description","content":"Rikka is interested in researching traditional problems on particular graphs. Today, she chooses the task &quot;counting the number of spanning trees in an undirected edge&quot;.<br><br>With an array $a$ of length $n$, Rikka constructs an undirected graph with $\\sum_{i=1}^n a_i$ vertices in the following way:<br>1. Construct an auxiliary array $B$: $B_0 = 0. B_i = B_{i-1}+a_i, \\forall i \\in [1,n].$<br>2. Assign a color to each vertex. The color of vertex $i$ is an integer $j$ which satisfies $i \\in (B_{j-1},B_j]$.<br>3. For each pair $(i,j)(i&lt;j)$, if vertex $i$ and $j$ have the same color, link an undirected edge between $i$ and $j$. <br><br>In other words, Rikka constructs a graph which contains $n$ cliques, and the $i$th clique&apos;s size is $a_i$.<br><br>Rikka finds that if $n&gt;1$, the graph cannot be connected, and there must not be any spanning trees in it. To avoid this, Rikka adds extra $m$ edges $(u_i,v_i)$ to this graph.<br><br>Now, Rikka wants to count the number of different spanning trees in this graph.<br><br>Two spanning trees are different if and only if there is one edge which occurs in exactly one of the two trees.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line contains a single integer $t(1 \\leq t \\leq 50)$, the number of the testcases.<br><br>For each testcase, the first line contains two integers $n,m(1 \\leq n \\leq 200, 0 \\leq m \\leq 200)$.  The second line contains $n$ integers $a_i(1 \\leq a_i \\leq 10^6)$.<br><br>Then $m$ lines follows, each line contains two integers $u_i,v_i(1 \\leq u_i,v_i \\leq \\sum_{k=1}^n a_i)$, which describes an extra edge.<br><br>The input guarantees that:<br>1. There are at most $5$ testcases with $\\max(n,m) &gt; 50$.<br>2. The graph does not have multiplicate edges and self circle. i.e., $u_i \\neq v_i$, $u_i,v_i$ have different colors and unordered pairs $(u_i,v_i)$ are different from each other. <br>3. The final graph is connected.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each testcase, output a single line with a single integer, the answer modulo $998244353$.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n1 0\n5\n2 1\n5 5\n1 6\n4 4\n1 2 3 4\n1 2\n3 4\n6 7\n10 1</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">125\n15625\n296</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2018+Multi-University+Training+Contest+9&amp;source=1&amp;searchmode=source\"> 2018 Multi-University Training Contest 9 </a> ","type":"source","format":"html","require":["katex"]}]}