{"title":"Matrix Puzzle","time_limit":4000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3334","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3334&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3334","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3334"},"statement":[{"title":"Problem Description","content":"As you know, math is quite incredible.For example,if you want to know all x that not only satisfy the expression A^x = B ( mod C) where A,B and C are given and C is a prime number, but also smaller than C, you could use the following algorithm <br>(http://en.wikipedia.org/wiki/Baby-step_giant-step).<br>Now your task is quite simple. You are given A,B, here A and B are matrixes( n X n).You are expected to solve the following expression.<br><img style=\"max-width:100%;\" src=\"http://acm.hdu.edu.cn/data/images/C235-1002-1.png\"> mod 1000000007","type":"description","format":"html"},{"title":"Input","content":"There are no more than 20 cases.<br>For each case,there are two integers n,L  in the first line indicating the size of the matrixes , the value of L. (Here 1&lt;= n &lt;= 50, 1&lt;= L &lt;= 10^11)<br>Then follows 2n lines.<br>For the first n lines, indicating the matrix A.<br>For the next n lines, indicating the matrix B.<br>All the numbers in the matrix are between 0 and 10^9","type":"input_format","format":"html"},{"title":"Output","content":"Output a single line with &#x201C;Case #idx: &#x201D;,here idx is the case number start from 1. Then output if there is only one valid solution (the solution must no larger than L and larger than 0).<br>If there is only one valid solution ,then just output &#x201C;Yes&#x201D;, otherwise output &#x201C;No&#x201D;.<br>We  assure that the ABS(|A|) (determinant&#x2019;s abosolute value)is always larger than one after the mod operation in all the cases.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1 6\n2\n2\n\n1 4\n2\n1\n\n2 3\n1 2\n2 1\n5 4\n4 5</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1: Yes\nCase 2: No\nCase 3: Yes</div></pre>","type":"example","format":"html"},{"title":"Author","content":"AekdyCoin@FZU","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=HDOJ+Monthly+Contest+%A8C+2010.03.06&amp;source=1&amp;searchmode=source\"> HDOJ Monthly Contest &#x2013; 2010.03.06 </a> ","type":"source","format":"html"}]}