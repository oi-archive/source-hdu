{"title":"Mahjong","time_limit":2000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4306","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4306&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4306","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4306"},"statement":[{"title":"Problem Description","content":"In the 22nd Century, more than one hundred million people attend the Mahjong Sports all over the world. Professional Mahjong players are getting more and more attentions. In many high schools, there&#xFFFD;&#xFFFD;ll be a large-scale Mahjong match every year to select talented students to attend the National Olympiad in Mahjong. For high scores to prove themselves and eager to be a professional Mahjong player someday, students compete with each other for the honor of the Mahjong.<br>Saki, a girl whose mother and elder sister are professional Mahjong players, will attend the National Olympiad in Mahjong in province (NOMP) this year. To beat other high school, achieve the first prize and attend the National Olympiad in Mahjong (NOM), she and her friends decide to make a camp to train their Mahjong skill.<br>A very important skill of Mahjong match is to control power of the game. A good Mahjong player could control the game, even all tiles of the game, just like Amae Koromo, whose favorite skill is &quot;catching the moon from the bottom of the sea&quot;. This time, Saki and her friends are training their control skill of the Mahjong tiles via the following way. <br><center><img style=\"max-width:100%;\" src=\"../../data/images/c398-1007-1.jpg\"></center><br><br>Saki got a lot of colored Mahjong tiles, and put them into an n * n matrix. Assume there are no more than two Mahjong tiles with the same color. Saki wants to use the Psychic force to control the tiles to the specified state. She could do two kinds of operation as follows:<br>A. To choose a row arbitrarily, and then swap two tiles&apos; position in this row. This operation will cost CA magic power.<br>B. To choose a column arbitrarily, and then swap two tiles&apos; position in this column. This operation will cost CB magic power.<br>Moreover, if you do the same kind of operation as you just did, the operation will cost no power. For example, Saki could make operation BAAAAA but just cost CB+CA magic power. Saki wants to know how to do the operations to finish the task with the least cost.<br>","type":"description","format":"html"},{"title":"Input","content":"There are several cases.<br>The first line is an integer T (T &lt; = 20), indicating the test cases.<br>Each case starts with three integers n, CA, CB, (1&lt;=n&lt;=300, 1&lt;=CA, CB&lt;=10^6). then 2*n*n integer follows, indicating the initial state and the target state of the grid. Each integer Aij(1&lt;=Aij&lt;=10^5) represent a Mahjong tile.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, you should output the minimum cost of the game. If Saki couldn&apos;t finish the game, output &quot;Take off the shoes!&quot; instead. The output format is as follows.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n3 16 9\n2 5 6\n1 1 3\n7 8 3\n2 5 1\n3 3 6\n7 8 1\n2 193 43\n1 2\n2 1\n1 2\n2 2\n3 10 20\n1 2 3\n4 5 4\n3 2 1\n2 1 2\n1 5 3\n4 3 4</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1: 34\nCase #2: Take off the shoes!\nCase #3: 30</div></pre>","type":"example","format":"html"},{"title":"Author","content":"BUPT","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2012+Multi-University+Training+Contest+1&amp;source=1&amp;searchmode=source\"> 2012 Multi-University Training Contest 1 </a> ","type":"source","format":"html"}]}