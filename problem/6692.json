{"title":"Line Graphs","time_limit":12000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6692","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6692&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6692","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6692"},"statement":[{"title":"Problem Description","content":"Last year, Rounddog participated in a contest with a pretty hard problem set and failed in solving the problem about line graphs. So he decides to make a deep study of line graphs these days.<br><br>In the mathematical discipline of graph theory, the line graph of a simple undirected graph $G$ is another simple undirected graph $L(G)$ that represents the adjacency between every two edges in $G$.<br>Precisely speaking, for an undirected graph $G$ without loops or multiple edges, its line graph $L(G)$ is a graph such that<br>- each vertex of $L(G)$ represents an edge of $G$; and<br>- two vertices of $L(G)$ are adjacent if and only if their corresponding edges share a common endpoint in $G$.<br><br><center><img style=\"max-width:100%;\" src=\"../../../data/images/C755-1002-1.png\"></center><br><br>Given a simple undirected graph $G$, Rounddog&apos;s study aims to find the maximum cliques in its line graph $L(G)$ and he decides to make some critical results of his early study as a challenge for you.<br><br>In this problem, you are given a simple undirected graph $G$ and a small positive integer $k$. After finding all maximum cliques in $L^k(G)$, where $L^0(G)=G$ and $L^s(G)=L(L^{s-1}(G))$ for each positive integer $s$, you need to show Rounddog the number of vertices in one of the maximum cliques and the number of distinct maximum cliques modulo $1\\,000\\,000\\,007$.<br><br>Here a subset of vertices of an undirected graph is called clique if and only if there is an edge between each pair of vertices in the subset, and maximum cliques are those cliques with the maximum number of vertices.<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The input contains several test cases, and the first line contains a single integer $T~(1 \\le T \\le 1\\,000)$, the number of test cases.<br><br>For each test case, the first line contains three integers $n~(1 \\le n \\le 100\\,000)$, $m~(0 \\le m \\le 200\\,000)$ and $k~(1 \\le k \\le 4)$, the number of vertices and edges in the given simple undirected graph $G$ and the number of iterations of the line graph operation.<br><br>Then $m$ lines follow, describing all edges of the graph.<br>Each line of them contains two integers $u$ and $v~(1 \\le u, v \\le n, u \\ne v)$, representing an edge between the $u$-th vertex and the $v$-th vertex.<br><br>It is guaranteed that the sum of $n$ in all test cases does not exceed $2\\,000\\,000$, the sum of $m$ does not exceed $3\\,000\\,000$, and the graph in each test case contains no loops or multiple edges.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, output a single line with two integers, the number of vertices in one of the maximum cliques and the number of distinct maximum cliques modulo $1\\,000\\,000\\,007$.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n5 0 4\n5 4 1\n1 2\n1 3\n1 4\n1 5\n5 4 4\n1 2\n1 3\n1 4\n1 5</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">0 1\n4 1\n6 12</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2019+Multi-University+Training+Contest+10&amp;source=1&amp;searchmode=source\"> 2019 Multi-University Training Contest 10 </a> ","type":"source","format":"html","require":["katex"]}]}