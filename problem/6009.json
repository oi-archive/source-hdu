{"title":" Lazors","time_limit":6000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6009","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6009&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6009","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6009"},"statement":[{"title":"Problem Description","content":"Lazors is a puzzle game of lazers and reflections. There is a board of size N &#xD7; M; some lazer transmitters and receivers installed on the board; and some tiles are initally placed in the board cells. The goal is to move the tiles so that all receivers get radiated by lazer beams with possible a series of reflections and refractions.<br>Transmitters are always at the center of one side of a cell. The direction of an emitted lazer beam is either diagnal or anti-diagonal. Each transmitter can be described by 4 parameters: x, y, from_dir, to_dir, where from_dir and to_dir is one of N, S, E, or W, representing north, south, east or west side of the cell. The first two parameters indicate the emitted lazer beam comes from cell on row x, column y; the last two indicate the direction of the emitted lazer beam.<br>Receivers are also at the center of one side of a cell. Each receiver can be described by 3 parameters:<br>x, y, dir, where dir is one of N, S, E, or W, representing north, south, east or west side of the cell. The parameters indicate the receiver is located at the center of dir side of the cell on row x, column y.<br>There are 4 types of tiles: white tile, black tile, glass tile, and prism tile. Each type of tile has its unique nature on lazer beam reflection and refraction.<br>A white tile reflects lazer beams by law of reflection. In the following picture, the transmitter is the small red dot in the north-west corner, and the radiated receiver is the big red dot in the<br>north-east corer.<br> <center><img style=\"max-width:100%;\" src=\"../../../data/images/6009-1.jpg\"></center> <br>A black tile absorbs lazer beams. Lazer beams are stopped upon hitting the black tile. In the following picture, the transmitter is the small red dot in the north-west corner, and the un-radiated receiver is the target icon in the south-east corner.<br> <center><img style=\"max-width:100%;\" src=\"../../../data/images/6009-2.jpg\"></center><br>A glass tile split one lazer beam into two lazer beams, with one beam reflected by law of reflection and the other passing through the tile. In the following picture, the transmitter is the small red dot in the south-east corner, and the radiated receivers are the two big red dots above the receiver.<br> <center><img style=\"max-width:100%;\" src=\"../../../data/images/6009-3.jpg\"></center><br>A prism tile refracts lazer beams. A lazer beam is &#x201C;shifted&#x201D; by one unit of grid and keeps going with the orignal direction. In the following picture, the transmitter is the small red dot in the north-west corner, and the radiated receiver is the big red dot in the south-east corner.<br> <center><img style=\"max-width:100%;\" src=\"../../../data/images/6009-4.jpg\"></center> <br>A fixed tile is locked on the board. You cannot move a fixed tile. In the following picutre, the white tile on row 2 column 2 is fixed. Black tiles, glass tiles, and prism tiles can also be fixed.<br><center><img style=\"max-width:100%;\" src=\"../../../data/images/6009-5.jpg\"></center> <br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line of the input gives the number of test cases, T. T test cases follow.<br>Each test case starts with a line containing two integers: N, M. Each of the following N lines contains M characters:<br>$\\bullet$ &#x2018;.&#x2019; indicates an empty cell.<br>$\\bullet$ &#x2018;#&#x2019; indicates an cell that forbids placing any tiles.<br>$\\bullet$ &#x2018;o&#x2019; or &#x2018;O&#x2019; indicates a white tile.<br>$\\bullet$ &#x2018;b&#x2019; or &#x2018;B&#x2019; indicates a black tile.<br>$\\bullet$ &#x2018;x&#x2019; or &#x2018;X&#x2019; indicates a glass tile.<br>$\\bullet$ &#x2018;m&#x2019; or &#x2018;M&#x2019; indicates a prism tile.<br>$\\bullet$ Capitial letters indicate fixed tiles.<br>Next line contains an integer X, the number of transmitters. Each of the following X lines contains<br>2 integers x, y; and 2 characters from_dir, to_dir.<br>Next line contains an integer Y , the number of receivers. Each of the following Y lines contains 2 integers x, y; and 1 character dir.<br><br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, output a line containing &#x201C;Case #x:&#x201D;, where x is the test case number (starting from 1). Next print the borad configuration with the same format as the input if there exists a solution, or print a line &#x201C;No solution!&#x201D;. If there exist multiple solutions, any solution is accepted.<br><h2>limits</h2><br>$\\bullet$ 1 &#x2264; T &#x2264; 120.<br>$\\bullet$ 1 &#x2264; N, M &#x2264; 6.<br>$\\bullet$ 1 &#x2264; N &#xD7; M &#x2264; 24.<br>$\\bullet$ 0 &#x2264; x &lt; N.<br>$\\bullet$ 0 &#x2264; y &lt; M.<br>$\\bullet$ dir, from_dir, to_dir is one of N, S, E, or W.<br>$\\bullet$ 1 &#x2264; X &#x2264; 2.<br>$\\bullet$ 1 &#x2264; Y &#x2264; 5.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n3 3\n###\n#.#\n##o\n1\n0 0 N E\n1\n0 2 N\n\n3 3\n#m.\n.xb\no##\n2\n0 0 N E\n0 2 E S\n2\n1 0 W\n2 0 W\n\n4 4\no.bo\nobBo\nb.b.\nBb..\n1\n0 1 N E\n1\n2 3 E</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1:\n###\n#o#\n##.\nCase #2:\n#xb\n..o\nm##\nCase #3:\nb.ob\no.Bo\nb...\nBbob\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nCase #1:\n <center><img src=\"../../../data/images/6009-6.jpg\"></center>\nCase #2:\n<center><img src=\"../../../data/images/6009-7.jpg\"></center>\nCase #3:\n<center><img src=\"../../../data/images/6009-8.jpg\"></center> \n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2016+CCPC-Final&amp;source=1&amp;searchmode=source\"> 2016 CCPC-Final </a> ","type":"source","format":"html","require":["katex"]}]}