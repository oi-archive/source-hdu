{"title":"Rikka with Sequence","time_limit":5500,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6087","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6087&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6087","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6087"},"statement":[{"title":"Problem Description","content":"As we know, Rikka is poor at math. Yuta is worrying about this situation, so he gives Rikka some math tasks to practice. There is one of them:<br><br>Yuta has an array $A$ with $n$ numbers and he keeps a copy of the initial value of array $A$ as $A&apos;(A&apos;_i=A_i)$. Then he makes $m$ operations on it. <br><br>There are three types of operations:<br>$1\\ l \\ r$: Yuta wants Rikka to sum up $A_i$ for all $i$ in $[l,r]$.<br>$2 \\ l\\ r\\ k$: Yuta runs the C++ code &#xFFFD;&#xFFFD;for (int i=l;i&lt;=r;i++) A[i]=A[i-k]&#xFFFD;&#xFFFD; on sequence $A$. (The pascal version of the code snippet is &#xFFFD;&#xFFFD;for i:=l to r do A[i]:=A[i-k]&#xFFFD;&#xFFFD;). <br>$3\\ l\\ r$: Yuta changes $A_i$ back to $A&apos;_i$, for all $i \\in [l,r]$.<br><br>It is too difficult for Rikka. Can you help her?","type":"description","format":"html"},{"title":"Input","content":"The first line contains two numbers $1 \\leq n,m \\leq 2 \\times 10^5$. <br><br>The second line contains n numbers $A_i$. Then m lines follow, each line describe an operation. <br><br>It is guaranteed that $1 \\leq k&lt;l, 0 \\leq A_i \\leq 10^9$","type":"input_format","format":"html"},{"title":"Output","content":"For each query, print a single line with a single number -- the answer.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5 7\n1 2 3 4 5\n1 1 5\n2 3 4 1\n1 1 5\n2 3 4 2\n1 1 5\n3 1 5\n1 1 5</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">15\n12\n11\n15</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2017+Multi-University+Training+Contest+-+Team+5&amp;source=1&amp;searchmode=source\"> 2017 Multi-University Training Contest - Team 5 </a> ","type":"source","format":"html"}]}