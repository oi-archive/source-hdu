{"title":"Tree","time_limit":3000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4955","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4955&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4955","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4955"},"statement":[{"title":"Problem Description","content":"   Teacher Mai has a directed graph with n nodes and n edges. This graph is special: Out degree of each node is 1, and there is no self loop.<br><br>   For every node Teacher Mai wrote down a set of nodes which directly links to this node.<br><br>   For example, the graph contains 4 edges: {1-&gt;2,2-&gt;4,3-&gt;1,4-&gt;1}, the set of each node is {3,4},{1},{},{2}<br><br>   But Teacher Mai found that he forgot writing which node the set belonged to.<br><br>   Teacher Mai wanted to recover it, but he found there are many graphs with the same node sets.<br><br>   You should count the number of different graphs have the same node sets as the given one.<br><br>   The number can be very large, just output the number modulo 1000000007 (10^9+7).<br>   <br>   <b>If there is no solution, the answer is 0.</b><br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"   There are multiple test cases, terminated by a line &quot;0&quot;.<br><br>   For each test case, the first line contains a integer n (1&lt;=n&lt;=1000).<br><br>   The following are n lines representing the set of each node. For every line, there is a integer p first, indicating the size of the set. Then there are p integers, indicating the node with index from 1 to n in this set.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"   For each test case, output one line &quot;Case #k: ans&quot;, where k is the case number, counting from 1, ans is the number module 10^9+7.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">6\n1 1\n0\n0\n0\n2 2 3\n3 4 5 6\n0</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1: 38</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Author","content":"xudyh","type":"source","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2014+Multi-University+Training+Contest+8&amp;source=1&amp;searchmode=source\"> 2014 Multi-University Training Contest 8 </a> ","type":"source","format":"html","require":["katex"]}]}