{"title":"HDU CakeMan","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3751","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3751&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3751","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3751"},"statement":[{"title":"Problem Description","content":"If you ask one student of HDU &#x201C;who is the superstar in HDU now?&#x201D; ,the answer must be &#x201C;HDU CakeMan&#x201D; .He sells little cakes in the gate of the HDU students&#x2019; dormitory every day .As he says &#x201C;&#x505A;&#x4EBA;&#x8981;&#x6709;&#x5C0F;&#x86CB;&#x7CD5;&#x7CBE;&#x795E;,&#x4E0D;&#x6015;&#x98CE;&#x5439;&#x96E8;&#x6253;,&#x6C38;&#x8FDC;&#x4E09;&#x5757;&#x94B1;&#x201D;.But he has  no permission. So once seeing ChengGuan coming , he have to run home as fast as possible.<br><center><img style=\"max-width:100%;\" src=\"../../../data/images/C319-1008-1.jpg\"></center><br>Now , ChengGuan is coming now. After some days investigation,ChengGuan have the map of HDU , and know the home of CakeMan, so can you tell me the minimum time ChengGuan cost to catch CakeMan?<br><br>Once seeing ChengGuan coming, CakeMan will run home through a way which cost the least time , if there are more than one ways , he will randomly choose one ,so none knows which way he takes this time. <br>ChengGuan are be ordered to catch him today, so they want to know the nearest grid which CakeMan will surely pass (excluding the start point of CakeMan and CakeMan&#x2019;s home).<br><br>","type":"description","format":"html"},{"title":"Input","content":"The first line of input gives the number of cases, T (at most 90).<br>the first line of each case has four numbers n,m. (2&lt;=n,m&lt;=100)<br>then n lines with m characters describe the maze<br>&#x2018;D&#x2019; represents the init position of CakeMan.<br>&#x2018;S&#x2019; represents the position of the home of CakeMan.<br>&#x2018;C&#x2019; represents the position of the home of ChengGuan.<br>&#x2018;.&#x2019; represents the grids can be walked on.<br>&#x2018;X&#x2019; represents the wall which can not be stepped on.<br>&#x2018;A&#x2019; A is a integer between 0 and 9, represents the grid stands one HDU student who want A pack of Cake. when CakeMan pass on the grid has a integer on it ,he have to stay A seconds to sell cakes to the students (total costs A + 1 seconds to pass the grid), otherwise he pass the grid in one second. And the data makes sure that there must be at least one way to let CakeMan home.","type":"input_format","format":"html"},{"title":"Output","content":"If there is one nearest grid on the map where ChengGuan can catch CakeMan surely, output how much time(one second one step) can ChengGuan get to this grid.output -1 other wise.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n4 9\n..X..S...\n.........\nX...123..\nD.......C</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">7</div></pre>","type":"example","format":"html"},{"title":"Author","content":"ReDow","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=HDU+3rd+%A1%B0Vegetable-Birds+Cup%A1%B1+Programming+Open+Contest&amp;source=1&amp;searchmode=source\"> HDU 3rd &#x201C;Vegetable-Birds Cup&#x201D; Programming Open Contest </a> ","type":"source","format":"html"}]}