{"title":"A Captivating Match","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3632","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3632&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3632","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3632"},"statement":[{"title":"Problem Description","content":"The FIFA 2010 Soccer World Cup has gone, Small Jan returned to her own planet. After she saw the Spain emerged the biggest winner, she believe that, as a Queen, she can also arrange a captivating match-International Cavalry PK Contest(ACM-ICPC) for her lovely and hard working subjects. But her subjects are so busying that they have no time to watch the group match. So, our smart Queen wants to make the final more valuable. Every Knight has a value in people&#xFFFD;&#xFFFD;s minds and the final&#xFFFD;&#xFFFD;s value is dependent on the last valiancy Knights (equals to the winner&apos;s value).<br>Now assuming that the Knights have been numbered from 1 to N, and any time Small Jan could arrange a match between any two Knights adjacent to each other, but the loser will quit. For example, (1, 2, 3, 4, 5),if the Queen arranged Knights 3 and 4 for a match and Knight 3 lost, then Knights 2 and 4 would be adjacent to each other (the result of each Knight competing with others is saved in a table). <br>Here, Small Jan want to know the max value of the final, can you help her?","type":"description","format":"html"},{"title":"Input","content":"The first line of the input is a single positive integer T(0 &lt; T &lt;= 30), telling the number of test scenarios to follow. <br>Each scenario begins with a line containing an integer N, 0 &lt; N &lt;= 100, being the number of Knights. <br>The following line contains N integers, 0 &lt; Vi &lt; 1000, being the value of each Knight in people&#xFFFD;&#xFFFD;s minds. <br>Thelast is a N &#xFFFD;&#xFFFD; N matrix. If a[i,j] = 1 indicate when Knight  i competing with j, Knight i always win, which also means a[j, i] must equals 0 and if i=j, a[i,j] must equals 0. ","type":"input_format","format":"html"},{"title":"Output","content":"For each input case, output a line containing a single number, which is the max value of the final, following the case number (start with 1) ","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n3\n1 2 3\n0 1 0\n0 0 1\n1 0 0\n3\n1 2 3\n0 1 1\n0 0 0\n0 1 0</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1: 3\nCase 2: 1</div></pre>","type":"example","format":"html"},{"title":"Author","content":"Westwind Blows@HDU","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2010+ACM-ICPC+Multi-University+Training+Contest%A3%A819%A3%A9%A1%AA%A1%AAHost+by+HDU&amp;source=1&amp;searchmode=source\"> 2010 ACM-ICPC Multi-University Training Contest&#xFFFD;&#xFFFD;19&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;Host by HDU </a> ","type":"source","format":"html"}]}