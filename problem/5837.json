{"title":"Robots","time_limit":1000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5837","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5837&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5837","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5837"},"statement":[{"title":"Problem Description","content":"QXJ has $N$ robots on the plane, the i-th is at $(x_i, y_i)$, numbereded 1 to $N$. Every robot is painted by one kind of color, numbered 1 to $M$.<br><br>Each robots can move $K$ times. In one move,a robot at $(x,y)$ can move to $(x-1,y),(x,y+1),(x+1,y),(x,y-1)$.<br><br>After exactly $K$ moves, she wants robots with same color to gather at the same postion and the robot on the i-th color gather at different postion with robots on (i-1)-th or (i+1)-th color.<br><br>Now she wants to know how many ways of moving these robots following to rules above.<br><br>Two ways are different if one of final postions of certain robot is different or there is at least one robot whose moving path is different.","type":"description","format":"html"},{"title":"Input","content":"The first line is the number of test cases $T (T \\leq 10)$. <br><br>The first line of each case contains three integer $N(1 \\leq N \\leq 200), M(1 \\leq M \\leq 20), K(1 \\leq K \\leq 500)$, indicating the number of robots ,the number of color and the number of steps robots can move.<br><br>The second line,contains $M$ integer $m_i$, indicating the number of robots with the i-th color.<br><br>The robots numbered $[1,m1]$ are on the 1st color.The robots numbered $[m1+1,m1+m2]$ are one the 2nd color, ans so on.<br><br>The next $N$ line,each contains two integers $x_i, y_i$, indicating the postion of i-th robots..<br><br>$(0\\leq |x_i, y_i| \\leq 250)$.","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output a single line &quot;Case #x: y&quot;, where x is the case number, starting from 1. And y is the answer(module $10^9 + 7$).","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n3 3 1\n1 1 1\n1 0 \n0 1 \n1 2 \n4 2 2\n2 2\n0 1\n0 3\n0 2\n0 4</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1: 49\nCase #2: 256</div></pre>","type":"example","format":"html"},{"title":"Author","content":"UESTC","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2016%D6%D0%B9%FA%B4%F3%D1%A7%C9%FA%B3%CC%D0%F2%C9%E8%BC%C6%BE%BA%C8%FC+-+%CD%F8%C2%E7%D1%A1%B0%CE%C8%FC&amp;source=1&amp;searchmode=source\"> 2016&#xFFFD;&#x439;&#xFFFD;&#xFFFD;&#xFFFD;&#x467;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#x1BE;&#xFFFD;&#xFFFD;&#xFFFD; - &#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#x461;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD; </a> ","type":"source","format":"html"}]}