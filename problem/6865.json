{"title":"Kidnapper's Matching Problem","time_limit":2000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6865","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6865&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6865","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6865"},"statement":[{"title":"Problem Description","content":"<b>It is preferrable to read the pdf statment.</b><br><br>One day when you were sitting in the couch and eating chips, a guy called you, who claimed that his name was Cuber QQ and he had your girlfriend kidnapped. This seems quite unlikely to you because you do not even have a girlfriend. However, to kill the boring time of Sunday afternoon, you asked how much the ransom is. Surprisingly, Cuber QQ is not interested in your money, the ransom is the answer to a matching problem. It turns out that Cuber QQ is a lover of binary operators, xor especially.<br><br>First of all, he shall give you a <b>pair</b> of sequences $a$ and $b$, with length $n$ and $m$ respectively.<br><br>Given that $a$ and $b$ do not necessarily have the same length, they do not exactly make a <b>pair</b>. Therefore consecutive subsequences of $a$ are used to make pairs with $b$, That makes $n-m+1$ pairs: $a_l, a_{l + 1}, \\ldots, a_{l + m - 1}$ and $b$ for all $1 \\le l \\le n-m+1$.<br><br>For each pair  $(a_l, a_{l + 1}, \\ldots, a_{l + m - 1}; b)$, we say they are xor-matched if their <b>pairwise-xor</b>&apos;s are all available in a pre-defined set $S$. Concretely, the pair is a match if and only if $a_{l+i-1} \\oplus b_i \\in 2_{\\oplus}^{S}$ of all $1 \\le i \\le m$. $2_{\\oplus}^{S}$ is defined as the set of all possible <b>xor-sum</b> of $S$&apos;s subsets, i.e.,<br><br>$$2_{\\oplus}^{S} = \\{ t | t = \\bigoplus_{w \\in X} w, X \\subseteq S \\}$$<br><br>Note that, since $\\{\\}$ is always a valid subset of $S$, $0$ is always included in $2_{\\oplus}^{S}$.<br><br>Now Cuber QQ wants you to tell him, for which $l$&apos;s, $a_l, a_{l + 1}, \\cdots, a_{l + m - 1}$ makes a match with $b$. He is not sending your illusory girlfriend back before you correctly answer his question.","type":"description","format":"html"},{"title":"Input","content":"The first line contains an integer $T$ ($1 \\le T \\le 2 \\cdot 10^4$), denotes the number of test cases.<br><br>Each test case begins with three space-separated integers $n$ ($1 \\le n \\le 2 \\cdot 10^5$), $m$ ($1 \\le m \\le \\min(n, 5 \\cdot 10^4$)) and $k$ ($1 \\le k \\le 100$), denoting the lengths of $a$, $b$ and the size of $S$.<br><br>The next line contains $n$ space-separated integers $a_1, a_2, \\cdots, a_n$ ($0 \\le a_i &lt; 2^{30}$).<br><br>The next line contains $m$ space-separated integers $b_1, b_2, \\cdots, b_m$ ($0 \\le b_i &lt; 2^{30}$).<br><br>The last line contains $k$ space-separated integers $S_1, S_2, \\cdots, S_k$ ($0 \\le S_i &lt; 2^{30}$).<br><br>It is guaranteed that $\\sum n \\le 1.2 \\cdot 10^6, \\sum m \\le 3 \\cdot 10^5, \\sum k \\le 6 \\cdot 10^5$.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each case, you should output:<br><br>$$<br>\\sum_{i = 1}^{n - m + 1} [(a_i, a_{i + 1}, \\cdots, a_{i + m - 1}) \\text{ matches } b] \\cdot 2^{i - 1} \\bmod (10^9 + 7)<br>$$<br><br>where $[\\text{condition}]$ equals 1 if $\\text{condition}$ holds and $0$ otherwise.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n4 2 2\n2 5 7 6\n3 4\n5 6\n13 3 3\n1 1 4 5 1 4 1 9 1 9 8 1 0\n2 5 1\n1 2 15</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n80</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2020+Multi-University+Training+Contest+8&amp;source=1&amp;searchmode=source\"> 2020 Multi-University Training Contest 8 </a> ","type":"source","format":"html"}]}