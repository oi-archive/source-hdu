{"title":"Lady CA and the graph","time_limit":6000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5664","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5664&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5664","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5664"},"statement":[{"title":"Problem Description","content":"Lady CA has a tree with $n$ points numbered $1,2,...,n$, and each edge has its weight. The unique route connecting two points is called a chain, and the length of a chain equals the sum value of the weights of the edges passed.<br>The point number $m$ is called the root. Lady CA defines a special kind of chain called folded chain, the chain connecting the points numbered $x,y\\left(x\\neq y\\right)$ is called a folded chain, if and only if the chain connecting the point numbered $x$ and the root doesn&apos;t pass the point numbered $y$, and the chain connecting the point numbered $y$ and the root doesn&apos;t pass the point numbered $x$.<br>Lady CA wants to find the length of the $k$th longest folded chain. Notice that the chain connecting the points numbered $x,y$ and the chain connecting the points numbered $y,x$ are the same.<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line contains an integer $T\\left(1\\leq T\\leq3\\right)$&#x2014;&#x2014;The number of the test cases. For each test case:<br>The first line contains three integers $n\\left(2\\leq n \\leq50,000\\right),m\\left(1\\leq m \\leq n\\right),k\\left(1\\leq k \\leq\\frac{n\\times\\left(n-1\\right)}{2}\\right)$. Between each two adjacent integers there is a white space separated.<br>The second line to the $n$th line describes the $n-1$ edges in the graph. Each line contains three integers $u,v\\left(1\\leq u,v\\leq n,u\\neq v\\right),w\\left(1\\leq w\\leq10,000\\right)$, which means there is an edge which has a weight $w$ connecting the points numbered $u,v$. Between each two adjacent integers there is a white space separated.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, the only line contains the only integer that is the length of the $k$th longest folded chain. If the $k$th longest folded chain doesn&apos;t exist, print NO.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n5 1 3\n1 2 8\n1 5 4\n2 3 5\n2 4 6\n5 1 5\n1 2 8\n1 5 4\n2 3 5\n2 4 6</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">12\nNO\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nWhen and only when $x=2,y=5$ or $x=3,y=5$ or $x=4,y=5$ or $x=3,y=4$, the chain connecting the point numbered $x,y$ is a folded chain. The only 4 folded chains have lengths of 12,17,18,11, so the answer of the first test case, the length of the third longest folded chain is 12.\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=BestCoder+Round+%2379+%28div.1%29&amp;source=1&amp;searchmode=source\"> BestCoder Round #79 (div.1) </a> ","type":"source","format":"html","require":["katex"]}]}