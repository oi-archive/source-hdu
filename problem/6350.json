{"title":"Always Online","time_limit":4000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6350","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6350&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6350","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6350"},"statement":[{"title":"Problem Description","content":"Wayne is an administrator of some metropolitan area network. The network he managed can be formed into a simple connected graph with $n$ vertices and $m$ edges, which means the graph does not contain any self-loop and there is at most one edge and at least one path between every two vertices. Furthermore, the network also meets the condition there are at most two non-intersect paths, which share no common edges, between every two vertices.<br><br>Wayne knows the bandwidth of each edge in that network but it is not enough for him. He needs plenty of statistic data to display, for example, he wants to know what the maximum data rate between every two vertices is. For the sake of clarity, vertices in that are numbered from $1$ to $n$ and the maximum bits each edge could transmit per second will be given. Your task is assisting him to calculate the value of the following formula:<br><br>$$\\sum_{1 \\leq s &lt; t \\leq n}{\\left(s \\oplus t \\oplus \\mathrm{flow}(s, t)\\right)},$$<br><br>where $\\oplus$ means the bitwise exclusive-OR operator and $\\mathrm{flow}(s, t)$ means the maximum bits that could be transmitted per second between vertex $s$ and vertex $t$.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line contains one integer $T$, indicating the number of test cases.<br>The following lines describe all the test cases. For each test case:<br>The first line contains two integers $n$ and $m$.<br>Each of the following $m$ lines contains three integers $u, v$ and $w$, indicating a bidirectional edge between vertex $u$ and vertex $v$ that can transmit at most $w$ bits per second in each direction.<br>$1 \\leq T \\leq 100$, $1 \\leq n \\leq 10^5$, $n - 1 \\leq m \\leq \\frac{3}{2}(n - 1)$, $1 \\leq u, v \\leq n$, $u \\neq v$, $0 \\leq w &lt; 10^9$.<br>It is guaranteed that the sum of $n$ in all test cases does not exceed $10^6$ and the size of the standard input file does not exceed $26$ MiB.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, print the answer in one line.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n3 3\n1 2 5\n2 3 6\n3 1 5\n5 6\n1 2 5\n2 3 6\n3 1 5\n3 4 6\n4 5 5\n5 3 6</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">27\n116\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nFor the first sample, flow(1, 2) = flow(1, 3) = 10, flow(2, 3) = 11.\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2018+Multi-University+Training+Contest+5&amp;source=1&amp;searchmode=source\"> 2018 Multi-University Training Contest 5 </a> ","type":"source","format":"html","require":["katex"]}]}