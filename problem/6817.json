{"title":"Expression","time_limit":15000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6817","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6817&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6817","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6817"},"statement":[{"title":"Problem Description","content":"You are given an expression string of length $L$ consisting of variables and $+,\\space -,\\space  *,\\space  ()$. The symbol $[k]$ is used to denote the variable $x_k$ $(k \\in [1,n])$ . It is assumed that there are $n$ different variables in total. <b>It guarantees that  each variable appears only once.</b> So the expression string can be regarded as a multivariate function $f(x_1,x_2,\\cdots,x_n)$.<br><br>We denote:<br><br>$$<br>g(t)=\\sum_{1 \\le i_1,i_2,\\cdots, i_t \\le n} h(i_1,i_2,\\cdots,i_t; t)<br>$$<br><br>$$<br>h(i_1,i_2,\\cdots,i_t; t)= \\frac{\\partial^{t} }{\\partial x_{i_1} \\partial x_{i_2} \\cdots \\partial x_{i_t}} f<br>$$<br><br>For the  given  value of $x_i,i \\in [1,n]$. You have the following two tasks.<br><br>1.Calculate $g(0),g(1),\\cdots,g(5).$<br><br>2.For the following m queries, you are given $t \\in [1,30],\\  i_1,i_2,\\cdots,i_t\\in [1,n]$, print the answer $h(i_1,i_2,\\cdots,i_t; t).$<br><br>Since they may be too large, print all of them $mod \\ 998244353$.<br><br>If you knew little about higher-order partial and mixed derivatives, you can refer to https://en.wikipedia.org/wiki/Partial_derivative#Notation.","type":"description","format":"html"},{"title":"Input","content":"The first line contains an integer $T$ denoting the number of test cases.<br><br>For each test case:<br><br>The first line contains two integers $L$ and $n$ --- $L$ represents the length of expression string and $n$ represents the number of variables.<br><br>The second line contains one string consisting of variables and $+,\\  -,\\  *,\\  ()$.<br><br>The third line contains $n$ integers, which are the values of $x_i$. <br><br>The fourth line contains a integer $m$ denoting the number of query.<br><br>The $i$-th of the following $m$ lines denotes the $i$-th query,$\\space$ which contains integers $t,i_1,i_2, \\cdots, i_t$.<br><br>It guarantees that:<br><br>$T \\in [1,20],\\space x_i \\in [-10^8,10^8],\\space L \\in [1,10^5],\\space\\sum L \\in [1,3 \\times 10^5].$<br><br>$n \\in [1,10^4],\\space\\sum n \\in [1,3 \\times 10^4],\\space\\sum t \\in [1,10^7],\\space\\sum m \\in [0,8 \\times 10^5].$","type":"input_format","format":"html"},{"title":"Output","content":"For each test, print $m + 1$ lines.<br><br>The first line outputs $6$ integers: the $i$-th integer means $g(i-1) \\ mod \\ 998244353 ,\\ i \\in [1,6]$.<br><br>For the $i$-th of the following $m$ lines, print the answer of $i$-th query $mod <br> \\ 998244353.$","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n11 3\n[1]*[2]*[3]\n1 2 3\n3\n1 1\n2 1 2\n3 1 2 3</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">6 11 12 6 0 0\n6\n3\n1</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2020+Multi-University+Training+Contest+5&amp;source=1&amp;searchmode=source\"> 2020 Multi-University Training Contest 5 </a> ","type":"source","format":"html"}]}