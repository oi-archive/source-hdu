{"title":"Digital Calculator","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3624","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3624&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3624","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3624"},"statement":[{"title":"Problem Description","content":"The Advanced Calculator Machinery (ACM) is going to release a new series of calculators. Like it or not, as a member of ACM, you are asked to develop the software for the new calculator. Here is the detailed technical specification.<br>The general usage of the calculator is that users input expressions, the calculator computes and displays the final result, or error messages if there is something wrong. The expression is in infix notation and the calculator supports following operators:<br><br><center><img style=\"max-width:100%;\" src=\"../../data/images/3624-1.jpg\"></center> <br>People always make mistakes. When user inputs an invalid expression, the calculator should display an error message, telling user that error occurs. There are totally four possible errors:<br>1. Syntax error: Any kind of syntax error, such as missing operators, redundancy operators and unpaired brackets.<br>2. Divide by zero: The right operand of operator &#xFFFD;&#xFFFD;/&#xFFFD;&#xFFFD; or &#xFFFD;&#xFFFD;%&#xFFFD;&#xFFFD; is zero.<br>3. Integer overflow: At any step of the calculation, any intermediate values go beyond the range of 32-bit signed integers.<br>4. Invalid exponent: The right operand of operator&#xFFFD;&#xFFFD;^&#xFFFD;&#xFFFD; is negative, or both operands are zero (we consider 0^0 undefined).<br>The calculation works this way: at first the calculator omits all space characters of the expression, check the syntax, and then computes. It always finds the highest priority part of the expression, then operators which combines them, then calculate the result and continue the process, until the final result has been got or error occurs.<br>For example, for expression 2^3^(-4*5), there are mainly 5 steps (we use brackets to note every part of the expression):<br>1. Check the syntax, no syntax errors.<br>2. Fetch the highest priority operator 4, no errors.<br>3. Do arithmetic -(4), get result -4, no errors.<br>4. Do arithmetic (-(4))*(5), get result -20, no errors.<br>5. Because operator &#xFFFD;&#xFFFD;^&#xFFFD;&#xFFFD; has right associativity, we do arithmetic (3)^((-(4))*(5)), e.g. (3)^(-20) first. -20 is a negative number, and negative numbers are not allowed as an exponent, so the calculator simply outputs error message and stops.<br>Notes: Because &#xFFFD;&#xFFFD;-&#xFFFD;&#xFFFD; has two meanings, the calculator will treat it as an unary operation at first,<br>and if it fails, &#xFFFD;&#xFFFD;-&#xFFFD;&#xFFFD; would be treated as minus operation then.<br>Write a program to simulate the calculator.","type":"description","format":"html"},{"title":"Input","content":"The first line of the input file is an integer T&lt;=200, then following T test cases.<br>Each test case has only one line, the input expression given to the calculator. Each expression has no more than 2000 characters.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output one line contains the case number and the final result or &#xFFFD;&#xFFFD;ERROR!&#xFFFD;&#xFFFD; if any error occurs. See sample for detailed format.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">6\n2^(1 2 - 9)^(5%3)\n9-8**7\n4%(2^0-1)\n-5%-3+-5%3\n7^--100\n(7-3)^(3-7)</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1: 512\nCase 2: ERROR!\nCase 3: ERROR!\nCase 4: -4\nCase 5: ERROR!\nCase 6: ERROR!</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2010+Asia+Regional+Tianjin+Site+%A1%AA%A1%AA+Online+Contest&amp;source=1&amp;searchmode=source\"> 2010 Asia Regional Tianjin Site &#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD; Online Contest </a> ","type":"source","format":"html"}]}