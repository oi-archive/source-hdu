{"title":"GuGu Convolution","time_limit":2500,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6442","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6442&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6442","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6442"},"statement":[{"title":"Problem Description","content":"As a newbie, XianYu is now learning generating function!<br>Given a series $\\{a\\}=(a_0,a_1,a_2,\\cdots)$, we can easily define its exponential generating function as $g_{\\{a\\}}(x) = \\sum\\limits_{i=0}^{\\infty}\\dfrac{a_i}{i!}x^i$.<br>Now we define a series $\\{u_c\\}=(c^0,c^1,c^2,\\cdots)$ and let $e_c$ represents the ${u_c}$ with $0$ filled in all its even items. Formally, ${\\{e_c\\}}=(0,c^1,0,c^3,0,c^5,\\cdots)$.<br><br>&apos;Do you know convolution?&apos;<br>&apos;GU GU.&apos; GuGu utters.<br>&apos;Well, let me show you.<br>Given two generating function $g_{\\{a\\}}$ and $g_{\\{b\\}}$, the convolution can be represented as $G(x)=(g_{\\{a\\}}*g_{\\{b\\}})(x)=\\sum\\limits_{n=0}^{\\infty}(\\sum\\limits_{i+j=n}a_ib_j)x^n$.<br>It is quite easy, right?&apos;<br>&apos;GU GU.&apos; GuGu utters.<br>&apos;Ok. Now you have to find the coefficient of $x^n$ of the convolution $G(x)=(g_{\\{u_A\\}}*g_{\\{e_\\sqrt{B}\\}})$, given $n$, $A$ and $B$.<br>Let $G_n$ representes that coefficient, you should tell me $n!G_n$.<br>You may know the severity of unsolving this problem.&apos;<br><br>As GuGu is not that kind of good for it, it turns to you for help.<br>&apos;GU GU!&apos; GuGu thanks.<br><br><div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div><br>First Sample: $1!(\\dfrac{1^0}{0!}\\dfrac{\\sqrt{1}^1}{1!} + \\dfrac{1^1}{1!}\\dfrac{0}{0!}) = 1 \\sqrt{1}$<br>Second Sample: $2!(\\dfrac{523^0}{0!}\\dfrac{0}{2!} + \\dfrac{523^1}{1!}\\dfrac{\\sqrt{12}^1}{1!} + \\dfrac{523^2}{2!}\\dfrac{0}{0!}) = 2092 \\sqrt{3}$<br>P.S.: $1046\\sqrt{12}$ is equal to the answer. However, $12$ has a factor $4=2^2$ so it can&apos;t be output directly.<br></div>","type":"description","format":"html"},{"title":"Input","content":"There is an integer $T$ in the first line, representing the number of cases.<br>Then followed $T$ lines, and each line contains four integers $A,B,n,p$. The meaning of $A,B,n$ is described above, and that of $p$ will be described in Output session.<br>$1\\leq T \\leq 10^5$<br>$1\\leq A,B \\leq 10^6$<br>$1\\leq n \\leq 10^{18}$<br>$1\\leq p \\leq 10^{9}$","type":"input_format","format":"html"},{"title":"Output","content":"Let $\\sum\\limits_{i=1}^{q} a_i\\sqrt{b_i}$ represents the answer, with $b_i \\neq b_j, \\gcd(b_i,b_j)=1, 1\\leq i&lt; j\\leq q$, and none of $b_i$&apos;s factors is square number.<br>Print $T$ lines only. Each line comes with a number $q$ and followed $q$ pairs of integers $a_i$ $b_i$, with $b_i$ in increasing order. Since $a_i$ may be large, please print $a_i\\%p$ instead. All integers in the same line should be seperated by exactly one space.<br>You may find that each answer is unique.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n1 1 1 7\n523 12 2 2100\n1 1 1000000000000000000 998244353</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1 1 1\n1 2092 3\n1 121099884 1</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2018%D6%D0%B9%FA%B4%F3%D1%A7%C9%FA%B3%CC%D0%F2%C9%E8%BC%C6%BE%BA%C8%FC+-+%CD%F8%C2%E7%D1%A1%B0%CE%C8%FC&amp;source=1&amp;searchmode=source\"> 2018&#xFFFD;&#x439;&#xFFFD;&#xFFFD;&#xFFFD;&#x467;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#x1BE;&#xFFFD;&#xFFFD;&#xFFFD; - &#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#x461;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD; </a> ","type":"source","format":"html"}]}