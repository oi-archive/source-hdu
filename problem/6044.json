{"title":"Limited Permutation","time_limit":2000,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6044","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6044&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6044","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6044"},"statement":[{"title":"Problem Description","content":"As to a permutation $p_1, p_2, \\cdots, p_n$ from $1$ to $n$, it is uncomplicated for each $1 \\leq i \\leq n$ to calculate $(l_i, r_i)$ meeting the condition that $\\min(p_L, p_{L + 1}, \\cdots, p_R) = p_i$ if and only if $l_i \\leq L \\leq i \\leq R \\leq r_i$ for each $1 \\leq L \\leq R \\leq n$.<br><br>Given the positive integers $n$, $(l_i, r_i)$ $(1 \\leq i \\leq n)$, you are asked to calculate the number of possible permutations $p_1, p_2, \\cdots, p_n$ from $1$ to $n$, meeting the above condition.<br><br>The answer may be very large, so you only need to give the value of answer modulo $10^9 + 7$.","type":"description","format":"html"},{"title":"Input","content":"The input contains multiple test cases.<br><br>For each test case:<br><br>The first line contains one positive integer $n$, satisfying $1 \\leq n \\leq 10^6$.<br><br>The second line contains $n$ positive integers $l_1, l_2, \\cdots, l_n$, satisfying $1 \\leq l_i \\leq i$ for each $1 \\leq i \\leq n$.<br><br>The third line contains $n$ positive integers $r_1, r_2, \\cdots, r_n$, satisfying $i \\leq r_i \\leq n$ for each $1 \\leq i \\leq n$.<br><br>It&apos;s guaranteed that the sum of $n$ in all test cases is not larger than $3 \\cdot 10^6$.<br><br>Warm Tips for C/C++: input data is so large (about 38 MiB) that we recommend to use <b>fread()</b> for buffering friendly.<br><pre>size_t fread(void *buffer, size_t size, size_t count, FILE *stream); // reads an array of <b>count</b> elements, each one with a size of <b>size</b> bytes, from the <b>stream</b> and stores them in the block of memory specified by <b>buffer</b>; the total number of elements successfully read is returned.</pre>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output &quot;<b>Case #$x$: $y$</b>&quot; in one line (without quotes), where $x$ indicates the case number starting from $1$ and $y$ denotes the answer of corresponding case.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n1 1 3\n1 3 3\n5\n1 2 2 4 5\n5 2 5 5 5</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1: 2\nCase #2: 3</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2017+Multi-University+Training+Contest+-+Team+1&amp;source=1&amp;searchmode=source\"> 2017 Multi-University Training Contest - Team 1 </a> ","type":"source","format":"html"}]}