{"title":"Count The Pairs","time_limit":10000,"memory_limit":63.9990234375,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4750","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4750&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4750","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4750"},"statement":[{"title":"Problem Description","content":"<center><img style=\"max-width:100%;\" src=\"../../data/images/C479-1003-1.jpg\"></center> <br>&#xA0;&#xA0;With the 60th anniversary celebration of Nanjing University of Science and Technology coming soon, the university sets n tourist spots to welcome guests. Of course, Redwood forests in our university and its Orychophragmus violaceus must be recommended as top ten tourist spots, probably the best of all. Some undirected roads are made to connect pairs of tourist spots. For example, from Redwood forests (suppose it&#x2019;s a) to fountain plaza (suppose it&#x2019;s b), there may exist an undirected road with its length c. By the way, there is m roads totally here. Accidently, these roads&#x2019; length is an integer, and all of them are different. Some of these spots can reach directly or indirectly to some other spots. For guests, they are travelling from tourist spot s to tourist spot t, they can achieve some value f. According to the statistics calculated and recorded by us in last years, We found a strange way to calculate the value f:<br>&#xA0;&#xA0;From s to t, there may exist lots of different paths, guests will try every one of them. One particular path is consisted of some undirected roads. When they are travelling in this path, they will try to remember the value of longest road in this path. In the end, guests will remember too many longest roads&#x2019; value, so he cannot catch them all. But, one thing which guests will keep it in mind is that the minimal number of all these longest values. And value f is exactly the same with the minimal number.<br>&#xA0;&#xA0;Tom200 will recommend pairs (s, t) (start spot, end spot points pair) to guests. P guests will come to visit our university, and every one of them has a requirement for value f, satisfying f&gt;=t. Tom200 needs your help. For each requirement, how many pairs (s, t) you can offer?<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"&#xA0;&#xA0;Multiple cases, end with EOF.<br>&#xA0;&#xA0;First line:n m<br>&#xA0;&#xA0;n tourist spots ( 1&lt;n&lt;=10000), spots&#x2019; index starts from 0.<br>&#xA0;&#xA0;m undirected roads ( 1&lt;m&lt;=500000).<br><br>&#xA0;&#xA0;Next m lines, 3 integers, a b c<br>&#xA0;&#xA0;From tourist spot a to tourist spot b, its length is c. 0&lt;a, b&lt;n, c(0&lt;c&lt;1000000000), all c are different.<br><br>&#xA0;&#xA0;Next one line, 1 integer, p (0&lt;p&lt;=100000)<br>&#xA0;&#xA0;It means p guests coming.<br><br>&#xA0;&#xA0;Next p line, each line one integer, t(0&lt;=t)<br>&#xA0;&#xA0;The value t you need to consider to satisfy f&gt;=t.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"&#xA0;&#xA0;For each guest&apos;s requirement value t, output the number of pairs satisfying f&gt;=t.<br>&#xA0;&#xA0;Notice, (1,2), (2,1) are different pairs.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2 1\n0 1 2\n3\n1\n2\n3\n3 3\n0 1 2\n0 2 4\n1 2 5\n5\n0 \n2\n3\n4\n5</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n2\n0\n6\n6\n4\n4\n0</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2013+ACM%2FICPC+Asia+Regional+Nanjing+Online&amp;source=1&amp;searchmode=source\"> 2013 ACM/ICPC Asia Regional Nanjing Online </a> ","type":"source","format":"html","require":["katex"]}]}