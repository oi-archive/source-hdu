{"title":"Periodical Cicadas","time_limit":7000,"memory_limit":78.125,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6004","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6004&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6004","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6004"},"statement":[{"title":"Problem Description","content":"Nearly all cicadas spend years underground as juveniles, before emerging above ground for a short adult stage of several weeks to a few months.<br>The seven periodical cicada species are so named because, in any one location, all of the members of the population are developmentally synchronized they emerge as adults all at once every seven years.<br>The lifecycles of most periodical cicada species range from two to seventeen years, although some could be longer.<br>There is a forest which can be roughly divided into a matrix of size N &#xD7;M. The upper-left region is (1, 1) and the lower-right region is (N, M).<br>A population of periodical cicadas live within each region of the matrix. The population in region (i, j) emerged in year $a_{i,j}$ for the first time, and re-emerges every $b_{i,j}$ years. i.e. they are $b_{i,j}$ - periodical cicadas.<br>Given a selected rectangular area, entomologists wonder if there is a time when all cicadas in that area emerge together.<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line of the input gives the number of test cases, T. T test cases follow. Each test cases begin with two integers N and M.<br>The following N lines each consists of M integers $a_{i,j}$ representing the year cicadas emerged in region (i, j) for the first time.<br>The following N more lines each consists of M integers $b_{i,j}$ representing the periodical cycle of the cicadas in that region.<br>Then comes a line with an integer Q representing the number of queries. The following Q lines each consists of 4 integers: $x_1, y_1, x_2, y_2,$  representing the upper-left and lower-right coordinate of the selected rectangular area.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, first output one line containing &#x201C;Case #x:&#x201D;, where x is the test case number (starting from 1).<br>The following Q lines each consists of an integer which is the year when all cicadas in the selected area emerge together for the first time or -1 if it&#x2019;s impossible.<br><h2>limits</h2><br>$\\bullet 1 &#x2264; T &#x2264; 10.$<br>$\\bullet 1 &#x2264; N, M &#x2264; 200.$<br>$\\bullet 0 &#x2264; a_{i,j} &lt; b_{i,j} &#x2264; 40.$<br>$\\bullet 1 &#x2264; x_1 &#x2264; x_2 &#x2264; N.$<br>$\\bullet 1 &#x2264; y_1 &#x2264; y_2 &#x2264; M.$<br>$\\bullet$ 1 &#x2264; Q &#x2264; 500000.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n3 4\n3 1 1 2\n1 1 2 1\n1 0 5 5\n5 4 2 3\n2 2 3 2\n4 2 6 6\n5\n2 2 2 2\n1 1 3 4\n1 4 2 4\n1 1 1 2\n2 2 3 4\n1 2\n0 1\n2 2\n1\n1 1 1 2</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1:\n1\n-1\n5\n13\n-1\nCase #2:\n-1</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2016+CCPC-Final&amp;source=1&amp;searchmode=source\"> 2016 CCPC-Final </a> ","type":"source","format":"html","require":["katex"]}]}