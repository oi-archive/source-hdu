{"title":"Random Inversion Machine","time_limit":1000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5404","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5404&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5404","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5404"},"statement":[{"title":"Problem Description","content":"Teacher Mai has a game machine, which has $n$ slots in a row, numbered from $1$ to $n$, inclusively. He plays a game with the machine for several rounds. In each round, he divides that row into $k$ segments with marks at boundaries between adjacent segments. Each segment must contain a positive number of slots. Then, the machine generates a random permutation of $\\{1, 2, \\cdots , n\\}$ and displays the permutation on the slots.Finally, the machine calculates the inversion number of each segment and multiplies them together to get the score of the round. The inversion number of a sequence is the number of inversions (also called inversion pairs) in the sequence.<br><br>Teacher Mai can play the game for as many rounds as he wants, but he must use different partitions in different rounds. Two partitions are considered to be different if there is a mark somewhere in one partition but not in the other. The total game score is simply the sum of the score of each round. However, the machine has been intruded by a malware, which changes the permutation before the machine calculates the score of each round. It sorts the numbers in the $m$ specific slots with numbers $p_1,p_2,\\cdots,p_m$.<br><br>For example, if $n=4,k=1,m=2,p=\\{1,3\\}$ and the permutation generated is $(2,4,1,3)$. The malware will pick numbers $2$ and $1$ and sort them, changing the permutation into $(1,4,2,3)$. So Teacher Mai will get a score of $2$ (pairs $(4,2)$ and $(4,3)$) in this round. Teacher Mai wants to know the maximum expected game score he can get.<br>","type":"description","format":"html"},{"title":"Input","content":"There are multiple test cases.<br><br>For each test case, the first line contains three numbers $n,k,m(1\\leq k,m\\leq n\\leq 100)$.<br><br>The second line contains $m$ numbers $p_1,p_2,\\cdots,p_m(1\\leq p_1&lt;p_2&lt;\\cdots&lt;p_m\\leq n)$.<br><br>In the $i$-th test case, $n=10i$.<br>","type":"input_format","format":"html"},{"title":"Output","content":"As the answer for the problem can be very large, please calculate it as an irreducible fraction $A/B$ and output $(A*B^{-1})$ mod $(10^9 + 7)$ for each test case in a separate line. Here, $B^{-1}$ is the multiplicative inverse of $B$ modulo $10^9 + 7$. The input constraints guarantee that $B$ and $10^9 + 7$ are coprime, so this expression is properly defined.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">6 2 3\n1 4 5\n10 3 4\n2 6 7 9</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">225000005\n608333402</div></pre>","type":"example","format":"html"},{"title":"Author","content":"xudyh","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2015+Multi-University+Training+Contest+9&amp;source=1&amp;searchmode=source\"> 2015 Multi-University Training Contest 9 </a> ","type":"source","format":"html"}]}