{"title":"Candy Factory","time_limit":2000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4780","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4780&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4780","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4780"},"statement":[{"title":"Problem Description","content":"&#xA0;&#xA0;A new candy factory opens in pku-town. The factory import M machines to produce high quality candies. These machines are numbered from 1 to M.<br>&#xA0;&#xA0;There are N candies need to be produced. These candies are also numbered from 1 to N. For each candy i , it can be produced in any machine j. It also has a producing time(s<sub>i</sub>,t<sub>i</sub>) , meaning that candy i must start producing at time s<sub>i</sub> and will finish at t<sub>i</sub>. Otherwise if the start time is p<sub>i</sub>(s<sub>i</sub> &lt; p<sub>i</sub> &lt; t<sub>i</sub>) then candy will still finish at t<sub>i</sub> but need additional  K*(p<sub>i</sub> - s<sub>i</sub>) cost. The candy can&#xFFFD;&#xFFFD;t be produced if p<sub>i</sub> is greater than or equal to t<sub>i</sub>. Of course one machine can only produce at most one candy at a time and can&#xFFFD;&#xFFFD;t stop once start producing.<br>&#xA0;&#xA0;On the other hand, at time 0 all the machines are in their initial state and need to be &#xFFFD;&#xFFFD;set up&#xFFFD;&#xFFFD; or changed before starting producing. To set up Machine j from its initial state to the state which is suitable for producing candiy i, the time required is C<sub>ij</sub> and cost is D<sub>ij</sub>. To change a machine from the state suitable for candy i<sub>1</sub> into the state suitable for candy i<sub>2</sub>, time required is E<sub>i1i2</sub> and cost is F<sub>i1i2</sub>.<br>&#xA0;&#xA0;As the manager of the factory you have to make a plan to produce all the N candies. While the sum of producing cost should be minimized.<br>","type":"description","format":"html"},{"title":"Input","content":"&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;There are multiple test cases.<br>&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;For each case, the first line contains three integers N(1&lt;=N&lt;=100), M(1&lt;=M&lt;=100), K(1&lt;=K&lt;=100) . The meaning is described above.<br>&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;Then N lines follow, each line contains 2 integers s<sub>i</sub> and t<sub>i</sub>(0 &lt;= s<sub>i</sub> &lt; t<sub>i</sub> &lt;100000).<br>&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;Then N lines follow, each line contains M integers, the j-th integer of the i-th line indicating C<sub>ij</sub>(1&lt;=C<sub>ij</sub>&lt;=100000) .<br>&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;Then N lines follow, each line contains M integers, the j-th integer of the i-th line indicating D<sub>ij</sub>(1&lt;=D<sub>ij</sub>&lt;=100000) .<br>&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;Then N lines follow, each line contains N integers, the i<sub>2</sub>-th integer of the i<sub>1</sub>-th line indicating E<sub>i1i2</sub>(1&lt;=E<sub>i1j2</sub>&lt;=100000) . <br>&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;Then N lines follow, each line contains N integers, the i<sub>2</sub>-th integer of the i<sub>1</sub>-th line indicating F<sub>i1i2</sub>(1 &lt;= F<sub>i1j2</sub>&lt;=100000) . <br>&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;Since the same candy will only be produced once, E<sub>ii</sub> and F<sub>ii</sub> are meaningless and will always be -1.<br>&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;The input ends by N=0 M=0 K=0. Cases are separated with a blank line.","type":"input_format","format":"html"},{"title":"Output","content":"&#xA0;&#xA0;For each test case, if all of M candies can be produced, output the sum of minimum producing cost in a single line. Otherwise output -1.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3 2 1\n4 7\n2 4\n8 9\n4 4\n3 3\n3 3\n2 8\n12 3\n14 6\n-1 1 1\n1 -1 1\n1 1 -1\n-1 5 5\n5 -1 5\n5 5 -1\n\n1 1 2\n1 5\n5\n5\n-1\n-1\n\n0 0 0</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">11\n-1\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nFor the first example, the answer can be achieved in the following way:\n<center><img src=\"../../data/images/C486-1011-1.jpg\"></center> \n\tIn the picture, S i represents setting up time for candy i, A i  represents changing time  for candy i  and P i represents producing time for candy i .\n\tSo the total cost includes: \n&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;setting up machine 1 for candy 1, costs 2\n&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;setting up machine 2 for candy 2, costs 3\n&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;changing state from candy 2 to candy 3, costs 5\n&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;late start of candy 2, costs 1 \n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2013+Asia+Hangzhou+Regional+Contest+&amp;source=1&amp;searchmode=source\"> 2013 Asia Hangzhou Regional Contest  </a> ","type":"source","format":"html"}]}