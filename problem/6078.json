{"title":"Wavel Sequence","time_limit":2000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6078","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6078&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6078","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6078"},"statement":[{"title":"Problem Description","content":"Have you ever seen the wave? It&apos;s a wonderful view of nature. Little Q is attracted to such wonderful thing, he even likes everything that looks like wave. Formally, he defines a sequence $a_1,a_2,...,a_n$ as &apos;&apos;wavel&apos;&apos; if and only if $a_1&lt;a_2&gt;a_3&lt;a_4&gt;a_5&lt;a_6...$<br><br><center><br><img style=\"max-width:100%;\" src=\"../../../data/images/C762-1012-1.jpg\"><br>Picture from Wikimedia Commons<br></center><br><br>Now given two sequences $a_1,a_2,...,a_n$ and $b_1,b_2,...,b_m$, Little Q wants to find two sequences $f_1,f_2,...,f_k(1\\leq f_i\\leq n,f_i&lt;f_{i+1})$ and $g_1,g_2,...,g_k(1\\leq g_i\\leq m,g_i&lt;g_{i+1})$, where $a_{f_i}=b_{g_i}$ always holds and sequence $a_{f_1},a_{f_2},...,a_{f_k}$ is &apos;&apos;wavel&apos;&apos;.<br><br>Moreover, Little Q is wondering how many such two sequences $f$ and $g$ he can find. Please write a program to help him figure out the answer.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line of the input contains an integer $T(1\\leq T\\leq15)$, denoting the number of test cases.<br><br>In each test case, there are $2$ integers $n,m(1\\leq n,m\\leq 2000)$ in the first line, denoting the length of $a$ and $b$.<br><br>In the next line, there are $n$ integers $a_1,a_2,...,a_n(1\\leq a_i\\leq 2000)$, denoting the sequence $a$.<br><br>Then in the next line, there are $m$ integers $b_1,b_2,...,b_m(1\\leq b_i\\leq 2000)$, denoting the sequence $b$.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, print a single line containing an integer, denoting the answer. Since the answer may be very large, please print the answer modulo $998244353$.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n3 5\n1 5 3\n4 1 1 5 3</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">10\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\n(1)f=(1),g=(2).\n(2)f=(1),g=(3).\n(3)f=(2),g=(4).\n(4)f=(3),g=(5).\n(5)f=(1,2),g=(2,4).\n(6)f=(1,2),g=(3,4).\n(7)f=(1,3),g=(2,5).\n(8)f=(1,3),g=(3,5).\n(9)f=(1,2,3),g=(2,4,5).\n(10)f=(1,2,3),g=(3,4,5).\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2017+Multi-University+Training+Contest+-+Team+4&amp;source=1&amp;searchmode=source\"> 2017 Multi-University Training Contest - Team 4 </a> ","type":"source","format":"html","require":["katex"]}]}