{"title":"Graph","time_limit":5000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4467","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4467&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4467","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4467"},"statement":[{"title":"Problem Description","content":"P. T. Tigris is a student currently studying graph theory. One day, when he was studying hard, GS appeared around the corner shyly and came up with a problem:<br>Given a graph with n nodes and m undirected weighted edges, every node having one of two colors, namely black (denoted as 0) and white (denoted as 1), you&#x2019;re to maintain q operations of either kind:<br>* Change x: Change the color of x<sup>th</sup> node. A black node should be changed into white one and vice versa.<br>* Asksum A B: Find the sum of weight of those edges whose two end points are in color A and B respectively. A and B can be either 0 or 1.<br>P. T. Tigris doesn&#x2019;t know how to solve this problem, so he turns to you for help.","type":"description","format":"html"},{"title":"Input","content":"There are several test cases.<br>For each test case, the first line contains two integers, n and m (1 &#x2264; n,m &#x2264; 10<sup>5</sup>), where n is the number of nodes and m is the number of edges.<br>The second line consists of n integers, the i<sup>th</sup> of which represents the color of the i<sup>th</sup> node: 0 for black and 1 for white.<br>The following m lines represent edges. Each line has three integer u, v and w, indicating there is an edge of weight w (1 &#x2264; w &#x2264; 2<sup>31</sup> - 1) between u and v (u != v).<br>The next line contains only one integer q (1 &#x2264; q &#x2264; 10<sup>5</sup>), the number of operations.<br>Each of the following q lines describes an operation mentioned before.<br>Input is terminated by EOF.","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output several lines.<br>The first line contains &#x201C;Case X:&#x201D;, where X is the test case number (starting from 1).<br>And then, for each &#x201C;Asksum&#x201D; query, output one line containing the desired answer.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">4 3\n0 0 0 0\n1 2 1\n2 3 2\n3 4 3\n4\nAsksum 0 0\nChange 2\nAsksum 0 0\nAsksum 0 1\n4 3\n0 1 0 0\n1 2 1\n2 3 2\n3 4 3\n4\nAsksum 0 0\nChange 3\nAsksum 0 0\nAsksum 0 1</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1:\n6\n3\n3\nCase 2:\n3\n0\n4</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2012+Asia+Chengdu+Regional+Contest&amp;source=1&amp;searchmode=source\"> 2012 Asia Chengdu Regional Contest </a> ","type":"source","format":"html"}]}