{"title":"Equilibrium Mobile","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=2766","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=2766&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=2766","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=2766"},"statement":[{"title":"Problem Description","content":"<center><img style=\"max-width:100%;\" src=\"../../../data/images/C179-1001-1.jpg\"></center><br>A mobile is a type of kinetic sculpture constructed to take advantage of the principle of equilibrium. It consists of a number of rods, from which weighted objects or further rods hang. The objects hanging from the rods balance each other, so that the rods remain more or less horizontal. Each rod hangs from only one string, which gives it freedom to rotate about the string.<br><br>We consider mobiles where each rod is attached to its string exactly in the middle, as in the figure underneath. You are given such a configuration, but the weights on the ends are chosen incorrectly, so that the mobile is not in equilibrium. Since that&apos;s not aesthetically pleasing, you decide to change some of the weights. <br><center><img style=\"max-width:100%;\" src=\"../../../data/images/C179-1001-2.jpg\"></center><br><br>What is the minimum number of weights that you must change in order to bring the mobile to equilibrium? You may substitute any weight by any (possibly non-integer) weight. For the mobile shown in the figure, equilibrium can be reached by changing the middle weight from 7 to 3, so only 1 weight needs to changed. ","type":"description","format":"html"},{"title":"Input","content":"On the first line one positive number: the number of testcases, at most 100. After that per testcase:<br><br>    * One line with the structure of the mobile, which is a recursively defined expression of the form:<br><br>        &lt;expr&gt; ::= &lt;weight&gt; | &quot;[&quot; &lt;expr&gt; &quot;,&quot; &lt;expr&gt; &quot;]&quot;<br><br>      with &lt;weight&gt; a positive integer smaller than 109 indicating a weight and [&lt;expr&gt;,&lt;expr&gt;] indicating a rod with the two expressions at the ends of the rod. The total number of rods in the chain from a weight to the top of the mobile will be at most 16. ","type":"input_format","format":"html"},{"title":"Output","content":"Per testcase:<br><br>    * One line with the minimum number of weights that have to be changed. ","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n[[3,7],6]\n40\n[[2,3],[4,5]]</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n0\n3</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=NWERC+2008&amp;source=1&amp;searchmode=source\"> NWERC 2008 </a> ","type":"source","format":"html"}]}