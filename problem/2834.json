{"title":"Girl Friend II","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=2834","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=2834&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=2834","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=2834"},"statement":[{"title":"Problem Description","content":"After a long time of effort, RoBa still keeps single. He finds that all the girls are so hard to understand. They can become happy in one minute, and then get angry in the next. What&#x2019;s more, what they do is usually quite different from what they think! <br><br>As an algorithmic geek, RoBa builds a probability model to study a girl&#x2019;s behavior. That is, there are N kinds of inner states for one girl. At the beginning, the girl can be at state i with probability Si. Then at every minute after that, the girl&#x2019;s state can be changed from state i to state j with probability Pij. Of course, S1+S2+&#x2026;+SN = 100 (in percent), and for all the i, Pi1+Pi2+&#x2026;+PiN=100<br><br>And that&#x2019;s still not practical enough. RoBa knows that he cannot see the inner state of a girl directly, but can only see her outer behavior. There are M kinds of behaviors, and when a girl is at state i, she will take behavior k with probability Aik. And again, for all the i, Ai1+Ai2+&#x2026;+AiM=100<br><br>Now, given a sequence of a girl&#x2019;s outer behavior and all the probabilities describe above (we don&#x2019;t know how RoBa get them!), can you help him to find out the girl&#x2019;s most probable inner state sequence?<br><center><img style=\"max-width:100%;\" src=\"../../../data/images/2834-1.JPG\"></center><br>For example, as the figure above described, RoBa observes a girl for three minutes, and the behavior sequence is laugh -&gt; Silent -&gt; Silent. Then the poor boy wants to guess the girl&#x2019;s real state. Let&#x2019;s suppose he make a guess that the girl&#x2019;s inner state sequence is happy -&gt; sad -&gt; happy. With the probabilities above, he can find its possibility is SHappy * AHappy,Laugh * PHappy,Sad * ASad,Silent * PSad,Happy * AHappy,Silent. So RoBa can calculate the possibility of all the inner state sequence, for example, sad-&gt;sad-&gt;happy, happy-&gt;happy-&gt;happy, and so on. Then he just simply picks the sequence with the highest possibility as the answer. Of course, this will cost too much time, so RoBa need a more clever algorithm to achieve the same result.<br><br>To be more formally, given a girl&#x2019;s outer behavior sequence (B1, B2, &#x2026; BT), it is natural that the possibility of a girl&#x2019;s inner sequence (C1, C2, &#x2026; CT) is <br><center><img style=\"max-width:100%;\" src=\"../../../data/images/2834-2.JPG\"></center><br>Don&#x2019;t be scared of the formula above, it just describe our intuition precisely. This problem is not such difficult as it seems, believe me .","type":"description","format":"html"},{"title":"Input","content":"There are several test cases in the input. <br><br>The first line of each test case contains N and M, (1 &lt;= N, M &lt;= 50), the second line contains N numbers S1, S2, &#x2026;, SN, that is, the probability of girl&#x2019;s initial states. Then an N*N matrix follow, whose entry in the i-th row and j-th column is Pij, that is, the probability of the girl&#x2019;s transition from state i to state j. Then an N*M matrix follow, whose entry in the i-th row and k-th column is Aik, that is, the probability of the girl&#x2019;s behavior is k when she is at state i. As the definition, the sum of each row of the two matrices is 100, and every entry in the matrices is an integer in the range [0,100]. And the last line begins with an integer T (1 &lt;= T &lt;= 50), indicating the observe time of RoBa, then T integers follow, indicating the girls outer behavior sequence. All the T integers are in the range [1..M].<br><br>You can assume the observation sequence is always possible in the input, that is, with probability greater than 0.<br>","type":"input_format","format":"html"},{"title":"Output","content":"Output T integers in one line for each case, indicating this girl&#x2019;s most probable inner state sequence. All the integers should be in the range [1..N], of course. You will get accepted if the possibility of your output is close enough to the standard output.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2 2\n50 50\n50 50\n50 50\n50 50\n50 50\n2 1 2\n\n2 2\n0 100\n50 50\n49 51\n50 50\n50 50\n2 1 2</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1 1\n2 2\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nHint: The first case indicating a rather &#x201C;random&#x201D; girl, all the initial states, transition, and behavior are of equal possibility, \nso the four possible inner state sequences 1-1, 1-2, 2-1, 2-2 are of equal possibility. In the second case, the girl is at state 2 definitely at the beginning. \nThen there is a little bigger chance to change to state 2 than state 1, so the sequence 2-2 is more possible than 2-1. \n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2009+Multi-University+Training+Contest+2+-+Host+by+TJU+&amp;source=1&amp;searchmode=source\"> 2009 Multi-University Training Contest 2 - Host by TJU  </a> ","type":"source","format":"html"}]}