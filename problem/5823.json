{"title":"color II","time_limit":2000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5823","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5823&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5823","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5823"},"statement":[{"title":"Problem Description","content":"You are given an undirected graph with n vertices numbered 0 through n-1.<br><br>Obviously, the vertices have 2^n - 1 non-empty subsets. For a non-empty subset S, we define a proper coloring of S is a way to assign each vertex in S a color, so that no two vertices in S with the same color are directly connected by an edge. Assume we&apos;ve used k different kinds of colors in a proper coloring. We define the chromatic number of subset S is the minimum possible k among all the proper colorings of S.<br><br>Now your task is to compute the chromatic number of every non-empty subset of the n vertices.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"First line contains an integer t. Then t testcases follow. <br><br>In each testcase: First line contains an integer n. Next n lines each contains a string consisting of &apos;0&apos; and &apos;1&apos;. For 0&lt;=i&lt;=n-1 and 0&lt;=j&lt;=n-1, if the j-th character of the i-th line is &apos;1&apos;, then vertices i and j are directly connected by an edge, otherwise they are not directly connected.<br><br>The i-th character of the i-th line is always &apos;0&apos;. The i-th character of the j-th line is always the same as the j-th character of the i-th line.<br><br>For all testcases, 1&lt;=n&lt;=18. There are no more than 100 testcases with 1&lt;=n&lt;=10, no more than 3 testcases with 11&lt;=n&lt;=15, and no more than 2 testcases with 16&lt;=n&lt;=18.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each testcase, only print an integer as your answer in a line.<br><br>This integer is determined as follows:<br>We define the identity number of a subset S is $id(S)=\\sum_{v\\in S} 2^v$. Let the chromatic number of S be $f_{id(S)}$.<br><br>You need to output $\\sum_{1&lt;=id(S)&lt;=2^n - 1} f_{id(S)} \\times 233^{id(S)} \\mod 2^{32}$.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n4\n0110\n1010\n1101\n0010\n4\n0111\n1010\n1101\n1010</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1022423354\n2538351020\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nFor the first test case, ans[1..15]= {1, 1, 2, 1, 2, 2, 3, 1, 1, 1, 2, 2, 2, 2, 3}\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Author","content":"&#x5B66;&#x519B;&#x4E2D;&#x5B66;","type":"source","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2016+Multi-University+Training+Contest+8&amp;source=1&amp;searchmode=source\"> 2016 Multi-University Training Contest 8 </a> ","type":"source","format":"html","require":["katex"]}]}