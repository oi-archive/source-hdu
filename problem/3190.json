{"title":"Marriage Match","time_limit":2000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3190","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3190&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3190","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3190"},"statement":[{"title":"Problem Description","content":"You may know the funny problem &#xFFFD;&#xFFFD;The Stable Marriage Problem&#xFFFD;&#xFFFD;. Now let&#xFFFD;&#xFFFD;s find a new match algorithm. <br>Firstly the women and men stand in a line separately and each woman will choose the man she likes.<br>Then it&#xFFFD;&#xFFFD;s your task to make a match for these people. You should choose m women and m men from the initial queues. Let them stand in a line separately by initial order.  If the woman stands in the ith place do not like the man stands in the ith place, the match is unacceptable. To increase the possibility of the match, the women can accept the men their friends like. Please find out the maximal m.<br>","type":"description","format":"html"},{"title":"Input","content":"There are several test cases.<br>Each test case starts with two integer p and q in a line means the number of women and the number of men.(0 &lt; p , q &lt;= 100000)<br>Then a line with p numbers follows means the queue of women. (The id ranges from 1 to p)<br>Then a line with q numbers follows means the queue of men. (The id ranges from 1 to q)<br>Then a line with p numbers which means the man the ith woman likes.<br>Then a line with an integer t, means the number of friendships between women.(0 &lt; t &lt; 100000)<br>Then t lines follow. Each line contains two numbers a and b means a and b are friends.(a!=b, 1 &lt;= a, b &lt;= p)<br>You may support the friendship can transmit. If a and b are friends and c and b are friends, then a and c are friends. Notice every woman will have no more than five friends.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each case, output the maximal m in one line.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">4 4\n1 3 2 4\n1 4 2 3\n2 3 1 2\n2\n1 2\n3 4</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=HDU+2009-11+Programming+Contest&amp;source=1&amp;searchmode=source\"> HDU 2009-11 Programming Contest </a> ","type":"source","format":"html"}]}