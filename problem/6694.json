{"title":"Play Games with Rounddog","time_limit":8000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6694","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6694&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6694","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6694"},"statement":[{"title":"Problem Description","content":"As a typical Nim game, picking stones is very famous all over the world with its quite simple rule. Initially, there are several piles of stones. Two players take turns to remove at least one stone from one of the piles. Whoever cannot make any legal move loses this game.<br><br>On August 17th, a very special day, Rounddog and Calabash create another picking stones game of their own. The new rule is as the following.<br><br>To start with, Calabash takes out a string $S$ from his right pocket as the keystone of their game, which has $m$ round in total.<br><br>At the beginning of each round, their common friend Severus will select a substring $T$ from $S$. Then before they officially start playing, there are three phases need to be applied.<br><br>In Phase 1, Calabash will select several <b>distinct</b> substrings from $S$, satisfying that they all have a suffix $T$. Taking &quot;$\\texttt{claris}$&quot; as an example, one of its suffixes is &quot;$\\texttt{ris}$&quot;. <br><br>Phase 2 requires some magical power. Calabash will turn all strings he selects to stone piles. Specifically, for each string $X$ he chooses, it will become a pile of $W_{p}$ stones where $p$ is the number of occurrences of $X$ in $S$. For example, &quot;$\\texttt{aba}$&quot; occurs in &quot;$\\texttt{ababa}$&quot; for 2 times.<br><br>Rounddog will be in charge of Phase 3. After Severus and Calabash&apos;s movement, Rounddog chooses some piles from Calabash&apos;s selection, and throws them away. But Rounddog can&apos;t throw all the piles Calabash selected, because it will lead the game to the end immediately.<br><br>With the left piles, Rounddog and Calabash will start playing based on the original rule of Picking Stones. Calabash always moves first. <br><br>Now, our beloved Quailty wants to know whether Calabash will win in each round if they both perform the optimal strategy. Furthermore, he also wants you to calculate <b>the maximum total number of stones</b> Calabash can achieve in Phase 2 on the premise of his victory.<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The input contains several test cases, and the first line contains a single integer $T~(1 \\le T \\le 3)$, the number of test cases.<br><br>In each test case, the first line contains an integer $n~(1 \\le n \\le 100\\,000)$.<br><br>The second line contains a string $S$ of length $n$ with only lowercase English letters.<br><br>The third line contains $n$ integers, $i$-th of which is $W_i~(1 \\le W_i &lt; 2^{58})$.<br><br>The fourth line contains an integer $m~(1 \\le m \\le 200\\,000)$, representing the number of games.<br><br>Each of the next $m$ lines contains two integers $l$ and $r~(1 \\le l \\le r \\le n)$ meaning that in this game, Severus will select $S[l,r]$ as $T$.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, output $m$ lines, each of which contains an integer representing the maximum total number of stones Calabash can achieve on the premise of his victory, or $-1$ if he always loses.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n5\naabab\n1 3 5 7 9\n5\n1 1\n1 2\n2 2\n2 3\n3 5</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">6\n1\n6\n4\n1</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2019+Multi-University+Training+Contest+10&amp;source=1&amp;searchmode=source\"> 2019 Multi-University Training Contest 10 </a> ","type":"source","format":"html","require":["katex"]}]}