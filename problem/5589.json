{"title":"Tree","time_limit":2000,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5589","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5589&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5589","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5589"},"statement":[{"title":"Problem Description","content":"There is a tree, whose vertices are labeled by 1, 2, &#x2026;, N. They are connected by N&#x2013;1 edges. Each edge has a weight.For any two vertices u and v, f(u,v) is xor(exclusive-or) sum of weights of all edges on the path from u to v.There are Q queries,for each query,giving you a interval [l,r], you should calculate the number of pairs (u,v) such that f(u,v) &gt; M ($l\\leq u &lt; v \\leq r$) &#x3002;","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"There are multiple test cases.<br>For each case contains 3 integers N, M and Q on a line.$(1\\leq N , M , Q\\leq 50000)$<br>Each of the next N - 1 lines contains three space separated integers a, b and c denoting an edge between a and b, whose weight is c.$(1\\leq a, b\\leq N,0\\leq c\\leq 50000)$<br>Each of the next Q lines contains two integers l and r.$(1\\leq l\\leq r\\leq N)$<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each query,output the answer in a line.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5 10 3\n1 2 13\n2 3 15\n2 4 17\n2 5 8\n1 5\n2 4\n3 3</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">6\n3\n0</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=BestCoder+Round+%2364+%28div.1%29&amp;source=1&amp;searchmode=source\"> BestCoder Round #64 (div.1) </a> ","type":"source","format":"html","require":["katex"]}]}