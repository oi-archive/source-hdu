{"title":"Query on a tree VII","time_limit":2000,"memory_limit":100,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4645","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4645&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4645","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4645"},"statement":[{"title":"Problem Description","content":"You are given a tree (an acyclic undirected connected graph) with n nodes. The tree nodes are numbered from 1 to n.<br>Each node has a color, white or black, and a weight.<br>We will ask you to perfrom some instructions of the following form:<br><strong>0 u</strong> : ask for the maximum weight among the nodes which are connected to u, two nodes are connected if all the node on the path from u to v (inclusive u and v) have a same color.<br><strong>1 u </strong>: toggle the color of u(that is, from black to white, or from white to black).<br><strong>2 u w</strong>: change the weight of u to w.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"Multicase. <br>The first line contains a number n denoted how many nodes in the tree(1 &#x2264; n &#x2264; 10<sup>5</sup>). The next n - 1 lines, each line has two numbers (u,  v) describe a edge of the tree(1 &#x2264; u,  v &#x2264; n).<br><br>The next 2 lines, each line contains n number, the first line is the initial color of each node(0 or 1), and the second line is the initial weight, let&apos;s say Wi, of each node(|W<sub>i</sub>| &#x2264; 10<sup>9</sup>).<br><br>The next line contains a number m denoted how many operations we are going to process(1 &#x2264; m &#x2264; 10<sup>5</sup>). The next m lines, each line describe a operation (t, u) as we mentioned above(0 &#x2264; t &#x2264; 2, 1 &#x2264; u &#x2264; n, |w| &#x2264; 10<sup>9</sup>).","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each query operation, output the corresponding result.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5\n1 2\n1 3\n1 4\n1 5\n0 1 1 1 1\n1 2 3 4 5\n3\n0 1\n1 1\n0 1\n7\n1 2\n1 3\n2 4\n2 5\n3 6\n3 7\n0 0 0 0 0 0 0\n1 2 3 4 5 6 7\n4\n0 1\n1 1\n0 2\n0 3</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n5\n7\n5\n7</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2013+Multi-University+Training+Contest+5&amp;source=1&amp;searchmode=source\"> 2013 Multi-University Training Contest 5 </a> ","type":"source","format":"html","require":["katex"]}]}