{"title":"Flight","time_limit":3000,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5849","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5849&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5849","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5849"},"statement":[{"title":"Problem Description","content":"You are given a tree of  $N$ vertices.<br><br>The query is specified by two vertices  $u,v$ and an integer $d$ .<br><br>This time, a pair of vertices is called good if the distance between them is not less than $d$ .<br><br>(Here, distance between two vertices means the number of edges lying on the path between them.)<br><br>In each step, you can only move between good pair of vertices.<br><br>Now your task is to calculate the minimum number of steps to reach $v$ , starting from  $u$. If you can&#xFFFD;&#xFFFD;t reach the destination, the answer is -1 for that query.<br><br>A lot of queries are given to you to make this problem difficult.<br>","type":"description","format":"html"},{"title":"Input","content":"There are multiple test cases. The first line of the input contains an integer  $T(T\\leq 15 )$, the number of test cases.<br><br>Each test case consists of the following lines:<br><br>The first line contains three integers  $N(1\\leq N\\leq 2\\cdot 10^5$ denoting the number of vertices,  $Q(1\\leq Q\\leq 10^6$  denoting the number of queries and  $M(1\\leq M\\leq 2\\cdot 10^5$ denoting the upper bound of  $d$.<br><br>The second line contains  $N-1$ integers $f_2,f_3,\\cdots f_N$ ,representing $(i,f_i)$  is a tree edge for every $i(2\\leq i\\leq N,1\\leq f_i &lt; i )$. <br><br>The third line contains six integers $u_1,v_1,d_1,A,B,C$<br>$(1\\leq u_1,v_1\\leq N,0\\leq d_1&lt;M,10^4\\leq A,B,C\\leq 2\\cdot 10^4$).<br><br>The first query is specified by $u_1,v_1,d_1$.<br><br> The $i$ -th ($2\\leq i\\leq Q$ ) query is specified by  $u_1,v_1,d_1$  , which are generated by the following rules:<br><br>$u_i=((A\\ u_{i-1} + B + ans_{i-1})\\ mod\\ N) + 1$<br>$v_i = ((B\\ v_{i-1} +C +ans_{i-1})\\ mod\\ N)+1$<br>$d_i = (C\\ D_{i-1} + A +ans_{i-1})\\ mod\\ M$","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output an integer $S = \\sum_{i=1}^{Q} i\\cdot (ans_i+1)$.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n6 9 5\n1 2 1 3 3\n6 3 0 10865 16947 15183</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">55</div></pre>","type":"example","format":"html"},{"title":"Author","content":"&#xFFFD;&#xFFFD;&#x7F9;&#xFFFD;&#x4B5;&#xFFFD;&#x6FA;&#x3F4;&#xFFFD;&#x467;&#xFFFD;&#xFFFD;DPRK&#xFFFD;&#xFFFD;","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2016+Multi-University+Training+Contest+9&amp;source=1&amp;searchmode=source\"> 2016 Multi-University Training Contest 9 </a> ","type":"source","format":"html"}]}