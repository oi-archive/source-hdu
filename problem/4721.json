{"title":"Food and Productivity","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4721","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4721&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4721","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4721"},"statement":[{"title":"Problem Description","content":"In the Game Civilization X, the world is made up of square-shaped &quot;tiles&quot;, forming a rectangle on the world map. For a tile located at row X and column Y , we give it a coordinate, say (X, Y ).<br>As you can see, different tiles have different &quot;terrain-types&quot;, so they may have different amount of Resources. In this problem, we only consider two of them: Food and Productivity.<br>An important step in the Game is building cities. After you choose a tile to build a city, the Food amount in that tile will increase by A, and the Productivity amount will increase by B, no other tiles will be changed.<br>You decide to build your first city on the map, as an experienced player, you will choose the best tile on the map, here is how you make up your mind:<br>For each tile (X, Y ), you set up an &quot;Influence Range&quot; of that tile. Each tile (x<sub>i</sub>, y<sub>i</sub>) is said to be within the range if the following equation holds:<br><center>max(|X - x<sub>i</sub>| ,  |Y - y<sub>i</sub>|) &lt;= R</center><br>After checking all the tiles within that range, you will get two values: the sum of all those tiles&apos; Food amount, and the sum of all those tiles&apos; Productivity. Among those two values, the final score for tile (X, Y ) will be the smaller one.<br>When choosing tiles, you just choose the tile with the highest score to build your city.<br>You are given a map with size N * M, and you wonder, for different values of A and B, what is the highest score for your first city?","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line has a number T (T &lt;= 10) , indicating the number of test cases.<br>For each test case, first line has four numbers N, M, R and Q (1 &lt;= N, M &lt;= 500, 0 &lt;= 2 * R + 1 &lt;= min(N,M), Q &lt;= 200000), which is the size of the map.<br>Then come N lines each with M numbers, they are the original Food (0 &lt; Food &lt;= 3) amount for each tile.<br>Then come N lines each with M numbers, they are the original <i>Productivity</i><br>(0 &lt; <i>Productivity</i> &lt;= 3) amount for each tile.<br>Then come Q lines each with two numbers A and B (0 &lt;= A, B &lt;= 10<sup>6</sup>). Each is a query for you to answer. Those queries will not affect each other.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For test case X, output \\Case #X:&quot; first, in a single line.<br>Then output Q lines, each with an answer.<br>There should be a blank line <b>*BETWEEN*</b> each test case.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n3 3 0 2\n1 2 1\n1 1 1\n1 1 1\n1 1 1\n1 2 1\n1 1 1\n1 2\n2 1</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1:\n3\n3</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2013+ACM%2FICPC+Asia+Regional+Online+%A1%AA%A1%AA+Warmup2&amp;source=1&amp;searchmode=source\"> 2013 ACM/ICPC Asia Regional Online &#x2014;&#x2014; Warmup2 </a> ","type":"source","format":"html","require":["katex"]}]}