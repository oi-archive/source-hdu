{"title":"Rikka with Game","time_limit":6000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5426","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5426&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5426","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5426"},"statement":[{"title":"Problem Description","content":"As we know, Rikka is poor at math. Yuta is worrying about this situation, so he gives Rikka some math tasks to practice. But today Rikka doesn&apos;t want to do math tasks, so they begin to play some games:<br><br>Long long ago, There is a continent which has $n$ citis and $n-1$ roads on it. Each city is connected to others directly or indirectly. <br><br>Now you want to build your own kingdom and make city 1 be the capital. Then you will cut off all the roads which connects a city which belong to your country and a city outside your country. Your country must satisfy the following rules:<br><br>1.City 1 must belong to your country.<br><br>2.Each pair of cities in your country can get to each other by the roads which haven&apos;t been cut off.<br><br>After cutting off the roads, actually, the continent has been cut to many unicom blocks. And then each unicom block develops into an independent state. To preserve the peace, you need to choose at most $k$ other counties (can&apos;t be your own country) and establish diplomatic relations with them.<br><br>Each city have a prosperous value $w_i$ and the prosperous value of each country is equal to the sum of the prosperous value of the citis in it. And the stable value of your country is eaual the prosperous value of your own country plus $a \\times$ the sum of the prosperous value of the countrie which have diplomatic relations with you.<br><br>Now, you need to maximal the stable value.<br><br>It is too difficult for Rikka. Can you help her?","type":"description","format":"html"},{"title":"Input","content":"There are no more than 1000 testcases and there are no more than 3 testcase meet $n,k \\geq 100$.<br><br>For each testcase, the first line contains three integers $n,a,k(1 \\leq n \\leq 10^5, -10^3 \\leq a \\leq 10^3, 0 \\leq k \\leq 500)$.<br><br>The second line contains $n$ integers $w_i(-10^9 \\leq w_i \\leq 10^9)$<br><br>Then $n-1$ lines follow. Each line contains two numbers $u,v(1 \\leq u,v \\leq n)$ , which means there is an edge between $u$ and $v$. ","type":"input_format","format":"html"},{"title":"Output","content":"For each testcase, print a single number -- the answer.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3 2 1\n10 100 1000\n1 2\n1 3</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2110\n\nHint\nYour country is {1,2} and you can establish diplomatic relations with {3}. Finally the stable value is 2110.</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=BestCoder+Round+%2353+%28div.1%29+%28%24%29&amp;source=1&amp;searchmode=source\"> BestCoder Round #53 (div.1) ($) </a> ","type":"source","format":"html"}]}