{"title":"RP problem","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4818","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4818&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4818","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4818"},"statement":[{"title":"Problem Description","content":"&#xA0;&#xA0;As an ACMer, you must have heard of the legend of Ren Pin (RP), which means a person&#x2019;s lucky degree. Neither can RP be created, nor eliminated without foundation. It can only be transferred from one person to another. Moreover, everyone has his social circle. It&#x2019;s guaranteed that each person has at least one friend and he cannot be the friend of himself. The relationship is directed. In RP system, one&#x2019;s RP is transferred from himself to all of his friends uniformly every day. For example, A has three friends, B, C and D and his current RP is 1. In tomorrow, 1/3 of his RP will be transferred to B, 1/3 to C and 1/3 to D and RP from those treat him as friends will be transferred to him as well.<br><br>&#xA0;&#xA0;On the other hand, the god in charge of the RP system is tired of the transferring RP from one person to another every day. Making the assumption that the total amount of RP is 1, he wants to know whether there is a stable distribution in RP system, so that by reallocating the RP of each person, he can lighten his workload. Stable distribution means if the structure of social network keeps unchanged, no matter how many days pass by, everyone&#x2019;s RP keeps unchanged. You will see an example as follows. For the ease of presentation, let &#x201C;X-&gt;Y&#x201D; denotes X takes Y as his friend. There are only three persons A, B and C in the world with A-&gt;B, B-&gt;C, C-&gt;A and C-&gt;B. If the current RPs of A, B, C are 0.2, 0.4, 0.4 respectively, then the RPs will still be 0.2, 0.4, 0.4 in tomorrow. It&#x2019;s obviously that the distribution keeps unchanged no matter how many days pass by, so (0.2, 0.4, 0.4) is a stable distribution. However, if the current RPs of A, B, C are 0.3, 0.3, 0.4, respectively, then the RPs will be 0.2, 0.5, 0.3 in tomorrow, so (0.3, 0.3, 0.4) is not a stable distribution. The god wonders, for a given a social network, how many stable distributions exist?<br><br>&#xA0;&#xA0;Furthermore, if there is one and only one stable distribution, your friend A, who is lack of luck, wants to know whether he can increase his RP by making one more new friend. More specifically, letting RP(A, G) be the RP of A in the stable distribution for a network G, the RP of A after adding A-&gt;X to G is RP(A, G \\/ {A-&gt;X}). Your friend A wants to know if there exists a person X, such that RP(A, G \\/ {A-&gt;X}) is strictly larger than RP(A, G). For example, there are four persons A, B, C, D in the world with A-&gt;B, B-&gt;C, C-&gt;A, D-&gt;A. The only one stable distribution is (1/3, 1/3, 1/3, 0). If A-&gt;D is added to the network, the stable distribution will be (2/5, 1/5, 1/5, 1/5) and 2/5 &gt; 1/3, so A can increase his RP by making friend with D. If there are multiple qualifying persons, your friend A wants to know which one can increase his RP to the maximum extent.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line of input contains an integer T (T &#x2264; 50) indicating the number of datasets. Each dataset starts with two integers n and m (n &#x2264; 100, n &#x2264; m &#x2264; n*(n-1)), where n and m indicate the number of persons and the number of relationships, respectively. Next m lines describe the relationships in the social network. Each of these lines will contain two integers u and v (0 &#x2264; u, v &lt; n), indicating u-&gt;v.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, output a single line. If the number of stable distributions is infinite, print &#x201C;INF&#x201D;, otherwise, print the number of stable distributions. If there is only one stable distribution, print the person whom your friend A can increase the most RP by making friend with. If there exists multiple such persons, print the one with the smallest ID. However, if no person satisfies the requirement, print &#x201C;-1&#x201D;.<br><br>Your friend A&#x2019;s ID is always (n-1).","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n4 4\n0 1\n1 0\n2 3\n3 2\n3 3\n0 1\n1 2\n2 0\n3 3\n0 1\n1 0\n2 1</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">INF\n1 1\n1 -1</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2013+Asia+Regional+Changchun+&amp;source=1&amp;searchmode=source\"> 2013 Asia Regional Changchun  </a> ","type":"source","format":"html","require":["katex"]}]}