{"title":"In A Crazy City","time_limit":5000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3238","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3238&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3238","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3238"},"statement":[{"title":"Problem Description","content":"I live in a crazy city full of crossings and bidirectional roads connecting them. On most of the days, there will be a celebration in one of the crossings, that&#xFFFD;&#xFFFD;s why I call this city crazy.<br><br>Everyday, I walk from my home (at crossing <i>s</i>) to my office (at crossing <i>t</i>). I don&apos;t like crowds, but I don&apos;t want to waste time either, so I always choose a shortest path among all possible paths that does not visit the crossing of the celebration. If no such path exists, I don&#xFFFD;&#xFFFD;t go to work (it&#xFFFD;&#xFFFD;s a good excuse, isn&#xFFFD;&#xFFFD;t it)!<br><br>In order to analyze this &#xFFFD;&#xFFFD;celebration effect&#xFFFD;&#xFFFD; in detail, I need <i>n</i> pairs of values (<i>l<sub>i</sub></i>, <i>c<sub>i</sub></i>), where <i>l<sub>i</sub></i> is the length of the shortest path from crossing <i>s</i> to crossing <i>t</i>, not visiting crossing <i>i</i>, <i>c<sub>i</sub></i> is the number of such shortest paths (not visiting crossing <i>i</i>). Could you help me? Note that if I can&#xFFFD;&#xFFFD;t go to work when celebration is held at crossing <i>i</i>, define <i>l<sub>i</sub></i> = <i>c<sub>i</sub></i> = 0. This includes the case when there is no path between <i>s</i> and <i>t</i> even if there&#xFFFD;&#xFFFD;s no celebration at all.<br><br>Ah, wait a moment. Please don&#xFFFD;&#xFFFD;t directly give me the values - that&#xFFFD;&#xFFFD;ll drive me crazy (too many numbers!). All I need is finding some interesting conclusions behind the values, but currently I&#xFFFD;&#xFFFD;ve no idea what exactly I want.<br><br>Before I know what you should calculate, please <b>prove</b> that you can indeed find all the pairs (<i>l<sub>i</sub></i>, <i>c<sub>i</sub></i>) by telling me the value of <i>f(x) = (l<sub>1</sub>+c<sub>1</sub>x+l<sub>2</sub>x<sup>2</sup>+c<sub>2</sub>x<sup>3</sup>+l<sub>3</sub>x<sup>4</sup>+c<sub>3</sub>x<sup>5</sup>+&#xFFFD;&#xFFFD;+l<sub>n</sub>x<sup>2n-2</sup>+c<sub>n</sub>x<sup>2n-1</sup>)</i> mod 19880830, for some given <i>x</i>.","type":"description","format":"html"},{"title":"Input","content":"There will be at most 20 test cases. Each case begins with 5 integers <i>n, m, s, t, q</i> (1 &lt;= <i>s,t</i> &lt;= <i>n</i> &lt;= 100,000, 0 &lt;= <i>m</i> &lt;= 500,000, 1 &lt;= <i>q</i> &lt;= 5). <i>n</i> is the number of crossings, <i>m</i> is the number of roads and <i>q</i> is the number of queries. <i>s</i> and <i>t</i> are different integers that represent my home and office, respectively. Each of the following <i>m</i> lines describes a road with three integers: <i>u, v, w</i> (1 &lt;= <i>u,v</i> &lt;= <i>n</i>, 1 &lt;= <i>w</i> &lt;= 10,000), indicating a bidirectional road connecting crossing <i>u</i> and crossing <i>v</i>, with length <i>w</i>. There may be multiple roads connecting the same pair of crossings, but a road cannot be connecting a crossing and itself. The next line contains <i>q</i> integers <i>x<sub>i</sub></i> (1 &lt;= <i>x<sub>i</sub></i> &lt;= 10<sup>9</sup>). The last test case is following by five zeros, which should not be processed.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, print the case number and <i>q</i> integers <i>f(x<sub>1</sub>), f(x<sub>2</sub>), &#xFFFD;&#xFFFD;, f(x<sub>q</sub>)</i> separated by a single space between consecutive items, on one line. Print a blank line after the output of each test case.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">4 5 1 4 2\n1 2 1\n1 3 1\n2 4 2\n3 4 3\n1 4 4\n1 10\n3 2 1 3 1\n1 2 12\n2 3 2\n1\n0 0 0 0 0</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1: 10 132400\n\nCase 2: 0\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div><b>Explanation</b>\n\nIn the first sample, <i>l1</i> = <i>c1</i> = 0, <i>l2</i> = 4, <i>c2</i> = 2, <i>l3</i> = 3, <i>c3</i> = 1, <i>l4</i> = <i>c4</i> = 0. In the second sample, everything is zero.</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2009+Asia+Wuhan+Regional+Contest+Hosted+by+Wuhan+University&amp;source=1&amp;searchmode=source\"> 2009 Asia Wuhan Regional Contest Hosted by Wuhan University </a> ","type":"source","format":"html"}]}