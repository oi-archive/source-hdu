{"title":"Sword","time_limit":3000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4769","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4769&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4769","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4769"},"statement":[{"title":"Problem Description","content":"Satoshi, who has strong obsessions with Chinese domestic RPG, will never miss the marvelous game, Gu Jian Qi Tan II, a.k.a., the Legend of Ancient Sword II, because of its gorgeous graphics, picturesque characters and lively design.<br><br>Recently, Satoshi has some troubles in the new battle mode of the game, and seeks you for help to solve the problems.<br><br>Specifically, in the new instant-action mode, Satoshi can control N roles, and his goal is to kill all M tiny monsters to declare victory. The tiny monsters are too fragile to survive from any skills of any roles. In every second, Satoshi can choose to operate one single role once, or do nothing. However, to make his series of operations magnificent, he would not use same role in any two consecutive seconds, i.e., the role used in i-th second cannot be used in the (i+1)-th second anymore.<br><br>For each role, we know the number of skills he/she owns, as well as the LPT (loop time) of each skill, which indicates that the skill could be performed in every LPT seconds starting from the beginning (e.g., if the LPT of a skill is 3, Satoshi could cast the skill at 3s, 6s, 9s, ..., so on and so forth). Moreover, the information of whether a skill can reach (touch) a certain monster is also provided (i.e., whether a monster is within the attacking range of a specific skill). Your task is to help Satoshi use the minimum amount time to win the game; ties are broken by preferring fewer number of operations, which is counted by the number of seconds in which Satoshi chooses to operate a role instead of doing nothing.<br><br>Note that Satoshi could choose a certain role, and of course no roles, in a specific second. And when he operates a role in a specific second, he can cast all the available skills (subject to the the LPT constraints) if he wants. Time begins with the 1st second.<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The integer R in the first line of input indicates the total number of test cases. For each test case, there are two integers N (1 &lt;= N &lt;= 10) and M (1 &lt;= M &lt;= 200) as stated above, in the first line. Then N blocks of input follow. For the i-th block, the first line contains an integer S_i (1 &lt;= S_i &lt;= 300) denoting the number of skills that the i-th role owns. Each of the the next S_i lines in the i-th block has M+1 integers, i.e., the LPT (1 &lt;= LPT &lt;= 6) of the i-th role, and M Boolean values (0/1) where the j-th Boolean value indicates if the j-th monster is within the attacking range of the i-th role.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, print the minimum number of seconds T by which Satoshi could win the game, as well as the corresponding minimum number of operations that Satoshi has to perform (in T seconds), in a single line; if it is impossible for Satoshi to win, output nothing but a zero in a single line.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">4\n\n1 1\n1\n1 1\n\n1 1\n1\n3 1\n\n2 2\n2\n1 1 0\n2 1 0\n1\n1 1 0\n\n1 2\n3\n2 1 0\n5 0 1\n6 1 1</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1 1\n3 1\n0\n5 2</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2013+ACM%2FICPC+Asia+Regional+Changchun+Online&amp;source=1&amp;searchmode=source\"> 2013 ACM/ICPC Asia Regional Changchun Online </a> ","type":"source","format":"html","require":["katex"]}]}