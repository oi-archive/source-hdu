{"title":"Starloop System","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4744","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4744&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4744","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4744"},"statement":[{"title":"Problem Description","content":"At the end of the 200013<sup>th</sup> year of the Galaxy era, the war between Carbon-based lives and Silicon civilization finally comes to its end with the Civil Union born from the ruins. The shadow fades away, and the new-born Union is opening a new page.<br><br>Although the war ended, the affect of the war is far from over. Now the council is busy fixing the transportation system. Before the war, all the stars were connected with artificial wormholes which were destroyed during the war. At the same time, natural wormholes are breaking down with the growing traffic. A new traffic system is on the schedule.<br><br>As two civilizations combine, the technology integrates. Scientists find a new traffic system called the Starloop System.<br><br>This system is made up of several starloops. People build a starway to connect two stars. A startloop is a closed path with no repetitions of stars or starways allowed, other than the repetition of the starting and ending star. And a starloop contains at least two starts and two starways. A startloop&apos;s cost is the sum of the length of all the starways in it. Length of a starway connecting two stars is floor(x), which x is the euclidean distance between two stars. You can build more than one starway between any two stars, but one starway can only belongs to one starloop.<br><br><center><img style=\"max-width:100%;\" src=\"../../data/images/C478-1007-1.jpg\"></center> <br><br>As the picture above shows, there are two starloops. One is blue and the other one is brown.<br><br>As a starloop is set up, each star on the starloop will get a unit of star-energy. So the two blue stars can get one unit of star-energy, and at the same time the black two stars can get two units because they both belong to two starloops. When a star earns a certain number of energy units, the transporter on that star will be activated. One can easily travel between any two stars whose transporter is activated.<br><br>Now the council wants to know the minimal cost to build a starloop system on all the stars . In other words, every star&apos;s transporter should be activated","type":"description","format":"html"},{"title":"Input","content":"There are multiple test cases. <br>For each test case:<br>There is a line with one integer n which is the number of stars.<br><br>The following n lines each describes a star by four integers xi, yi, zi and wi, defined as the spatial coordinate and the number of energy units the star needs to activate the transporter. Please NOTE that getting more than wi energy units will put the star in a dangerous situation, so it is not allowed.<br>The input ends with n = 0.<br><b><br>1&lt;=n&lt;=100<br>|xi|,|yi|,|zi|&lt;=200<br>wi&lt;=50<br></b><br><br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output one line that contains an integer equals to the minimal cost you can get. If there is no solution, just output -1;","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n0 0 2 1\n0 2 0 1\n2 0 0 1\n3\n0 0 2 2\n0 2 0 1\n2 0 0 1\n3\n0 0 2 3\n0 2 0 1\n2 0 0 1\n0</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">6\n8\n-1</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2013+ACM%2FICPC+Asia+Regional+Hangzhou+Online&amp;source=1&amp;searchmode=source\"> 2013 ACM/ICPC Asia Regional Hangzhou Online </a> ","type":"source","format":"html"}]}