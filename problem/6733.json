{"title":"Sakurada Reset","time_limit":12000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6733","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6733&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6733","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6733"},"statement":[{"title":"Problem Description","content":"A huge revolution is coming up in Sakurada. In order to avoid the revolution, Asai Kei is going to take some actions. The director of the revolution will also take some actions to defend Asai Kei. In this problem, each action can be described as a positive integer.<br>Specifically, Asai Kei will choose a non-empty subsequence as the actual actions to take from a given sequence a. Meanwhile, the director will similarly choose a non-empty subsequence as the defending actions from a given sequence b. And the influence value of a sequence of actions p1, p2, &#xFFFD;&#xFFFD; &#xFFFD;&#xFFFD; &#xFFFD;&#xFFFD; , pk of length k is defined as follows:<br><center>$\\sum^{k}_{i=1}$$p_i$ * ${1000}^{k-i}$</center><br>Now given action sequences a and b, Asai Kei will choose a non-empty subsequence A from a and the director will choose a non-empty subsequence B from b. Asai Kei can beat the director if and only if the influence value of A is strictly greater than B.<br>You want to know the number of different schemes for them to choose subsequences A and B so that Asai Kei can beat the director. Two schemes (A1, B1),(A2, B2) are considered to be different if A1 = A2 or B1 = B2, and two sequences p, q are considered to be different if their influence values are different. Print the answer modulo 998244353 in a single line.","type":"description","format":"html"},{"title":"Input","content":"The first line contains two positive integers n, m (1 &#xFFFD;&#xFFFD; n, m &#xFFFD;&#xFFFD; 5 000), denoting the length of a and the length of b.<br>The next line contains n positive integers ai (1 &#xFFFD;&#xFFFD; ai &#xFFFD;&#xFFFD; 100), denoting the sequence a.<br>The next line contains m positive integers ai (1 &#xFFFD;&#xFFFD; bi &#xFFFD;&#xFFFD; 100), denoting the sequence b.","type":"input_format","format":"html"},{"title":"Output","content":"Output a single line containing a non-negative integer, denoting the answer modulo 998244353.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3 5\n2 1 2\n1 2 2 1 2</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">22\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nAsai Kei can choose 6 subsequences: (1), (2), (1,2), (2,1), (2,2), (2,1,2), and their influence values\nare 1, 2, 1002, 2001, 2002, 2001002 respectively. The director can choose 11 subsequences: (1), (2),\n(1,1), (1,2), (2,1), (2,2), (1,1,2), (1,2,1), (1,2,2), (2,1,2), (2,2,2), and their influence values are 1, 2,\n1001, 1002, 2001, 2002, 1001002, 1002001, 1002002, 2001002, 2002002 respectively.\nThere are 0 + 1 + 3 + 4 + 5 + 9 = 22 schemes in total that Asai Kei can beat the director.\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=642ccpcQHD&amp;source=1&amp;searchmode=source\"> 642ccpcQHD </a> ","type":"source","format":"html"}]}