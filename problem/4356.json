{"title":"Three Eggache God","time_limit":2000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4356","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4356&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4356","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4356"},"statement":[{"title":"Problem Description","content":"Alpheus has n monsters,their heights are A<sub>1</sub>,A<sub>2</sub>,A<sub>3</sub>....A<sub>n</sub>. God Kufeng has n sons,their heights are 1,2,3....n.<br>One day, Our daredevil God Kufeng wants to challenge Alpheus. He sends his n sons to fight with Alpheus&apos;s n monsters ,the i-th son fighting with the i-th monster. During one challenge,if the i-th son&apos;s height is equal or greater than the i-th monster&apos;s height,the i-th son will get one score for his father,else,he&apos;ll get nothing.<br>Since Alpheus is strong enough to accept an infinity number of challenges,God Kufeng can challenge Alpheus again and again,but he has to change his son&apos;s order after every challenge,and the same permutation can not appear more than once.(that is,God Kufeng has n! times to challenge Alpheus).<br>Now,God Wu--the god of universe,wants to make things difficult to Kufeng.He has n sons too,their heights are W<sub>1</sub>,W<sub>2</sub>,W<sub>3</sub>....W<sub>n</sub>(it is a permutation of 1,2,3.....n),God Wu said to Kufeng: Only when the lexicographic order of your sons&apos; heights is bigger than my son&apos;s,you can challenge my lovely Alpheus!<br>Question:What is the total score God Kufeng can get?Output the answer mod 1000000007.<br>Note:<br>Alpheus will never change his monster&apos;s order,God Wu will never change his son&apos;s order.<br>For two permutation A and B,if A<sub>i</sub>=B<sub>i</sub> for all i(1&lt;=i&lt;=n),we say A=B.else,we get the smallest i that A<sub>i</sub>!=B<sub>i</sub>,if A<sub>i</sub>&gt;B<sub>i</sub>,we say A&apos;s lexicographic order is bigger than B,otherwise,B is bigger than A.","type":"description","format":"html"},{"title":"Input","content":"First,there is an integer T(T&lt;=20),the number of test cases.<br>For every case,there are three lines.<br>The first line is an integer n(1&lt;=n&lt;=2000),the number of sons of God Kufeng.<br>The second line has n integers,W<sub>1</sub>,W<sub>2</sub>,W<sub>3</sub>.....W<sub>n</sub>,the heights of God Wu&apos;s sons.(we guarantee that W<sub>1</sub>,W<sub>2</sub>,W<sub>3</sub>.....W<sub>n</sub> is a permutation of 1,2,3....n).<br>The third line also has n integers, A<sub>1</sub>,A<sub>2</sub>,A<sub>3</sub>....A<sub>n</sub>(1&lt;=A<sub>i</sub>&lt;=n),the heights of Alpheus&apos;s monsters.","type":"input_format","format":"html"},{"title":"Output","content":"For every test case,output one line,&quot;Case #k: ans&quot;,where k is the case number,counting from 1,ans is the total score God Kufeng can get(mod 1000000007).","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n3\n3 1 2\n1 2 3\n3\n3 2 1\n1 1 1</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1: 2\nCase #2: 0</div></pre>","type":"example","format":"html"},{"title":"Author","content":"loveqinqin@UESTC03","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2012+Multi-University+Training+Contest+6&amp;source=1&amp;searchmode=source\"> 2012 Multi-University Training Contest 6 </a> ","type":"source","format":"html"}]}