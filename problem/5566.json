{"title":"Clarke and room","time_limit":2000,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5566","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5566&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5566","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5566"},"statement":[{"title":"Problem Description","content":"Clarke is a patient with multiple personality disorder. One day, Clarke split into $n$ guys, the $i$th Clarke named $name_i$.  <br>They live in $n$ rooms connected by $n-1$ roads. There is only one path between any two rooms. Now, their landlord is to check the name with a long list. The landlord will check $m$ times, at $i$th time, he wants to know the maximum length of the names which appear on the list $s_i$ on the path between $x_i$ and $y_i$ rooms(including $x_i$ and $y_i$).   ","type":"description","format":"html"},{"title":"Input","content":"The first line contains an integer $T(1 \\le T \\le 10)$, the number of test cases.  <br>For each test case:  <br>The first line contains an integer $n(1 \\le n \\le 100000)$.  <br>Then $n$ lines follow, the $i$th line contains a string $name_i$.  <br>Then $n-1$ lines follow, the $i$th line contains an integer $f_{i+1}(1 \\le f_{i+1} \\le i)$, denoting there is an edge between $i+1$ and $f_{i+1}$.  <br>Then $m$ lines follow, the $i$th line contains two integers $x_i, y_i(1 \\le x_i, y_i \\le n)$ and a string $s_i$.  <br>Every string is composed by lower letter.  <br>$1 \\le |name_i|, |s_i|, \\sum_{i=1}^{n} |name_i|, \\sum_{i=1}^{m} |s_i| \\le 100000$  ","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, print $m$ lines with the answers.  ","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n4\na\nab\nabc\nd\n1\n2\n1\n3\n1 1 abc\n1 1 d\n1 3 abc</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n0\n3\n\nHint:\nAsk 1: $a$ appears in $abc$, so the answer is $1$.  \nAsk 2: There is no one appears in $d$, so the answer is $0$.  \nAsk 3: $a$, $ab$ and $abc$ appear in $abc$, so the answer is $3$.  </div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=BestCoder+Round+%2362+%28div.1%29&amp;source=1&amp;searchmode=source\"> BestCoder Round #62 (div.1) </a> ","type":"source","format":"html"}]}