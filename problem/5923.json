{"title":"Prediction","time_limit":2500,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5923","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5923&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5923","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5923"},"statement":[{"title":"Problem Description","content":"There is a graph $G =\\left \\langle V_G, E_G  \\right \\rangle $&#xA0;&#xA0;with&#xA0;&#xA0;$|V_G| = n$ and $|E_G| = m$, and a magic tree $T =\\left \\langle V_T, E_T  \\right \\rangle)$ rooted at 1, which contains m vertices.<br><br>Each vertex of the magic tree corresponds to an edge in the original graph G and each edge occurs in the magic tree exactly once.<br><br>Each query includes a set $S(S \\subseteq  V_T)$, and you should tell Mr. Frog the number of components in the modified graph $G^` = (V_G, E_G^`)$, where $E_G^`$ is a set of edges in which every edge corresponds to a vertex v in magic tree T satisfying at least one of the following two conditions&#xFFFD;&#xFFFD;<br><br>$\\bullet v \\in S$.<br>$\\bullet $v is an ancestor of some vertices in S.<br><br>Note that the queries are independent, and namely one query will not influence another.<br>","type":"description","format":"html"},{"title":"Input","content":"The input contains several test cases and the first line of the input data is an integer T, denoting the number of test cases.<br><br>For each test case, the first line contains two integers n and m($1 \\leq n \\leq 500,1 \\leq m \\leq 10000$), where n is the number of vertices and m is the number of edges.<br><br>The second line contains m - 1 integers describing the magic tree, i-th integer represents the parent of the (i + 1)-th vertex.<br><br>Then the following m lines describe the edges of the graph G. Each line contains two integers u and v indicating the two ends of the edge.<br><br>The next line contains only one integer q($1 \\leq q \\leq 50000$), indicating the number of queries.<br><br>Then the following q lines represent queries,&#xA0;&#xA0;i-th line represents the i-th query, which contains an integer $k_i$ followed by $k_i$ integers representing the set $S_i$.<br><br>It is guarenteed that $\\sum_{i=1}^{q}k_i \\leq 300000$.","type":"input_format","format":"html"},{"title":"Output","content":"For each case, print a line &quot;Case #x:&quot;, where x is the case number (starting from 1).<br><br>For each query, output a single line containing only one integer representing the answer, namely the number of components.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n5 4\n1 1 3\n1 2\n2 3\n3 4\n4 5\n3\n1 2\n2 2 3\n2 2 4</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1:\n3\n2\n1\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nmagic tree and the original graph in the sample are:\n\n<img src=\"../../data/images/C729-1002-1.jpg\">\n\nIn the first query, S = {2} and the modified graph G&apos; = {{1, 2, 3, 4}, {(1, 2), (2, 3)}}, thus the number of the components in the modified graph is 3.\nIn the second query, S = {1, 2, 3}, where 1 is the ancestor of 2 (and 3) in the magic tree, and the modified graph G&apos;&apos; = {{1, 2, 3,4}, {(1, 2), (2, 3), (3, 4)}},\n therefore the number of the components in the modified graph is 2.\nIn the third query, S = {1, 2, 3, 4}, where 1 is the ancestor of 2 (and 4), 3 is the ancestor of 4, and the modified graph G&apos; = {{1, 2, 3,4}, {(1, 2), (2, 3), (3,4), (4, 5)}}, \ntherefore the answer equals to 1.\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2016CCPC%B6%AB%B1%B1%B5%D8%C7%F8%B4%F3%D1%A7%C9%FA%B3%CC%D0%F2%C9%E8%BC%C6%BE%BA%C8%FC+-+%D6%D8%CF%D6%C8%FC&amp;source=1&amp;searchmode=source\"> 2016CCPC&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#x467;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#x1BE;&#xFFFD;&#xFFFD;&#xFFFD; - &#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD; </a> ","type":"source","format":"html"}]}