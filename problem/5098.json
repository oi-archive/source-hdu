{"title":"Smart Software Installer","time_limit":1000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5098","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5098&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5098","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5098"},"statement":[{"title":"Problem Description","content":"   The software installation is becoming more and more complex. An automatic tool is often useful to manage this process. An IT company is developing a system management utility to install a set of software packages automatically with the dependencies. They found that reboot is often required to take effect after installing some software. A software package cannot be installed until all software packages it depends on are installed and take effect. <br><br>   In the beginning, they implemented a simple installation algorithm, but the system would reboot many times during the installation process. This will have a great impact on the user experience. After some study, they think that this process can be further optimized by means of installing as much packages as possible before each reboot.<br><br>   Now, could you please design and implement this algorithm for them to minimize the number of restart during the entire installation process?","type":"description","format":"html"},{"title":"Input","content":"   The first line is an integer n (1 &lt;= n &lt;= 100), which is the number of test cases. The second line is blank. The input of two test cases is separated by a blank line.<br><br>   Each test case contains m (1 &lt;= n &lt;= 1000) continuous lines and each line is no longer than 1024 characters. Each line starts with a package name and a comma (:). If an asterisk (*) exists between the package name and the comma, the reboot operation is required for this package. The remaining line is the other package names it depends on, separated by whitespace. Empty means that there is no dependency for this software. For example, &#x201C;a: b&#x201D; means package b is required to be installed before package a. Package names consist of letters, digits and underscores, excluding other special symbols.<br><br>   Assume all packages here need to be installed and all referenced packages will be listed in an individual line to define the reboot property. It should be noted that cyclic dependencies are not allowed in this problem.","type":"input_format","format":"html"},{"title":"Output","content":"   For each test case, you should output a line starting with &#x201C;Case #: &quot; (# is the No. of the test case, starting from 1) and containing the reboot count for this test case. (Refer to the sample format)","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n\nglibc:\ngcc*: glibc\n\nuefi*:\ngcc*:\nraid_util*: uefi\ngpu_driver*: uefi\nopencl_sdk: gpu_drivergcc</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1: 1\nCase 2: 2 </div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2014%C9%CF%BA%A3%C8%AB%B9%FA%D1%FB%C7%EB%C8%FC%A1%AA%A1%AA%CC%E2%C4%BF%D6%D8%CF%D6%A3%A8%B8%D0%D0%BB%C9%CF%BA%A3%B4%F3%D1%A7%CC%E1%B9%A9%CC%E2%C4%BF%A3%A9&amp;source=1&amp;searchmode=source\"> 2014&#x4E0A;&#x6D77;&#x5168;&#x56FD;&#x9080;&#x8BF7;&#x8D5B;&#x2014;&#x2014;&#x9898;&#x76EE;&#x91CD;&#x73B0;&#xFF08;&#x611F;&#x8C22;&#x4E0A;&#x6D77;&#x5927;&#x5B66;&#x63D0;&#x4F9B;&#x9898;&#x76EE;&#xFF09; </a> ","type":"source","format":"html"}]}