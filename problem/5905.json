{"title":"Black White Tree","time_limit":2000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5905","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5905&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5905","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5905"},"statement":[{"title":"Problem Description","content":"Alex has a tree $T$ with $n$ vertices conveniently labeled with $1,2,...,n$. Each vertex of the tree is colored black or white. For every integer pair $(a, b)$, Alex wants to know whether there is a subtree of $T$ with exact $a$ white vertices and $b$ black vertices.<br><br>A subtree of $T$ is a subgraph of $T$ that is also a tree.","type":"description","format":"html"},{"title":"Input","content":"There are multiple test cases. The first line of input contains an integer $T$ $(1 \\le T \\le 100)$ indicating the number of test cases. For each test case:<br><br>The first line contains an integer $n$ $(1 \\le n \\le 2000)$. The next line contains a binary string $s$ length $n$ where $s_i$ denoting the color of the $i$-th vertex (&apos;0&apos; means white, while &apos;1&apos; means black). Each of the following $n - 1$ lines contains two integers $a_i, b_i$, denoting an edge between vertices $a_i$ and $b_i$ $(1 \\le a_i, b_i \\le n)$.","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output an integer $W = \\sum_{a=0}^{n}\\sum_{b=0}^{n}{(a+1)(b+1)S(a,b)}$. $S(a,b)=1$ if there is a subtree with exact $a$ white vertices and $b$ black vertices, or $0$ otherwise.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n4\n1010\n1 4\n2 4\n3 4\n3\n101\n1 2\n2 3\n10\n1010111001\n1 2\n1 3\n1 8\n2 4\n2 6\n2 7\n3 9\n4 5\n7 10</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">33\n15\n365</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=BestCoder+Round+%2387&amp;source=1&amp;searchmode=source\"> BestCoder Round #87 </a> ","type":"source","format":"html"}]}