{"title":"Rikka with Segment Tree","time_limit":2000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6690","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6690&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6690","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6690"},"statement":[{"title":"Problem Description","content":"Rikka is a master of data structures and Segment tree is Rikka&apos;s favorite data structure. This problem is a simple exercise about it.<br><br>Given a positive integer $n$, the segment tree on $[1,n]$ can be built by a recursive process: Starting with $[1,n]$, suppose the current interval is $[l,r]$, the process recursively builds subtrees for $\\left[l, \\left \\lfloor \\frac{l+r}{2} \\right\\rfloor\\right], \\left[ \\left \\lfloor \\frac{l+r}{2} \\right \\rfloor + 1, r \\right]$ until $l = r$.<br><br>For example, when $n=5$, there are $9$ intervals on the segment tree: $[1,1],[2,2],[3,3],[4,4],[5,5],[1,2],[4,5],[1,3],[1,5]$. <br><br>To explore the structure of segment trees, Rikka defines a magic function $f(i,n)$ which represents the depth of node $[i,i]$ on a segment tree on $[1, n]$ (the depth of the root is defined as $1$). For example, $f(1,5)=f(2,5)=4,f(3,5)=f(4,5)=f(5,5)=3$.<br><br>Now Rikka gives you two positive integers $L,R(L \\leq R)$, and she wants you to calculate:<br>$$<br>\\sum_{n=L}^R \\sum_{i=1}^n \\left(f(i,n) \\times i \\right)<br>$$","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line of the input contains a single integer $T(1 \\leq T \\leq 1000)$, the number of test cases.<br><br>For each test case, the input contains a single line with two positive integers $L,R(1 \\leq L \\leq R \\leq 10^{18})$.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, output a single line with a single integer, the answer.  The answer may be very large, you only need to output the answer modulo $998244353$.<br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5\n4 4\n1 4\n1 10\n1 100\n1 1000</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">30\n52\n843\n1236922\n763123843</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2019+Multi-University+Training+Contest+9&amp;source=1&amp;searchmode=source\"> 2019 Multi-University Training Contest 9 </a> ","type":"source","format":"html","require":["katex"]}]}