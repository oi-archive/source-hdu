{"title":"Sisters","time_limit":1000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3963","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3963&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3963","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3963"},"statement":[{"title":"Problem Description","content":"Mikoto(Railgun) is an excellent ESP(Extra Sensory Perception) girl with the dreadful skill Railgun in Academy City. <br><center><img style=\"max-width:100%;\" src=\"../../data/images/3963-1.jpg\"></center> <br>But there is a bitter reality that Mikoto&apos;s sisters are being massacred by Yuriko(Accelerator) for experiments. <br><center><img style=\"max-width:100%;\" src=\"../../data/images/3963-2.jpg\"></center> <br>As Yuriko is the most powerful ESPer, what Mikoto can do is to destroy all related laboratories in Academy City to delay the massacre.<br><br>N Laboratories are connected by M wires and the power system can be considered to an undirected graph.<br><br>Academy City is divided into several districts.<br><br>If there are at least two non-intersecting paths between two laboratories, then the two cities belong to the same district.<br><br>Two paths are considered as non-intersecting paths if and only if there is no same edge in both of them.<br><br>If there are one wire connecting two laboratories of two different districts, then the two districts are neighbors. Power can be transported between neighbor districts.<br><br>Mikoto can destroy all laboratories in the district where she is by the Railgun, that costs K+X(X is the numbers of laboratories in this district) points energy. Mikoto can use the Railgun anywhere and any number of times.<br><br>What&apos;s more, Mikoto generates electricity at the same time she shoot the Railgun. Mikoto can use the power to destroy all laboratories in other districts via wires. For any district to be attacked by electricity, the cost is f(n) points energy, and n is the number of districts (excluding the district where Mikoto shoot the Railgun) in the path from Mikoto to it. More specifically, if Mikoto have shot the Railgun destroying all laboratories in the district she chose, she can choose several other districts to be attacked by electricity she generate and the cost for each district is described above.<br><br>Now, the problem is the mininum cost to destroy all laboratories. ","type":"description","format":"html"},{"title":"Input","content":"There are several test cases.<br><br>For each test case, the first line contains three integers, N(1 &#xFFFD;&#xFFFD; N &#xFFFD;&#xFFFD; 1000), M(1 &#xFFFD;&#xFFFD; M &#xFFFD;&#xFFFD; 1000000), K(1 &#xFFFD;&#xFFFD; K &#xFFFD;&#xFFFD; 1000000000).<br>Then, 2 to M + 1 lines, each line contain two different integers a and b (1 &#xFFFD;&#xFFFD; a,b &#xFFFD;&#xFFFD; N), meaning that there is a undirected wire between laboratories a and b.<br><br>Then, the M + 2 lines contain N-1 number, meaning f(1), f(2), ... , f(n - 1). (0 &#xFFFD;&#xFFFD; f(1) &#xFFFD;&#xFFFD; f(2) &#xFFFD;&#xFFFD; ... &#xFFFD;&#xFFFD; f(N - 1) &#xFFFD;&#xFFFD; 1000000000)<br><br>You can safely assume that all numbers in the input and output will in the range of 32-bit signed integer and all the laboratories are connected by wires.<br><br>Input is terminated by EOF. ","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output one single number which is the mininum cost to destroy all laboratories. ","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5 5 10\n1 2\n1 3\n2 3\n1 4\n2 5\n5 10 15 20\n5 4 10\n2 1\n3 2\n4 1\n5 3\n4 9 11 12</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">23\n34</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2011+Multi-University+Training+Contest+13+-+Host+by+HIT+&amp;source=1&amp;searchmode=source\"> 2011 Multi-University Training Contest 13 - Host by HIT  </a> ","type":"source","format":"html"}]}