{"title":"Letter Tree","time_limit":5000,"memory_limit":129.65625,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4601","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4601&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4601","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4601"},"statement":[{"title":"Problem Description","content":"A letter tree is a rooted tree that each edge is assigned to a lowercase letter. Node 1 is always considered the root. When making a tour in the tree, one is only allowed to step &quot;down&quot;. In other word, if you&apos;re now on some node of the tree, you can only make a step to one of its children nodes.<br>After you travel along a path in the tree, you will obtain a Path String, which is formed by the letters assigned to edges that you just move along. The string exactly records all edges in the order of your visit.<br>Now we&apos;re faced with the problem. Located at some node u on the tree, your task is to move for exactly m steps and obtain a maximal lexicographic Path String. In order to avoid the huge output, you&apos;re only required to output the hash code of the string after it is transformed into a 26-base number, where &apos;a&apos; for 0, &apos;b&apos; for 1, &#x2026;, &apos;z&apos; for 25. For instance, &quot;bac&quot; = (678)<sub>26</sub> for 678=1&#xD7;26<sup>2</sup>+0&#xD7;26<sup>1</sup>+2&#xD7;26<sup>0</sup>.<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The input contains several test cases.<br>An integer T(T&#x2264;20) will exist in the first line of input, indicating the number of test cases.<br>Each test case begins with an integer N(2&#x2264;N&#x2264;10<sup>5</sup>), which denotes the number of nodes in the tree.<br>The following (N-1) lines describe the edges. An edge is described in the format of (u,v,c), which denotes an undirected edge between u and v with a lowercase letter c assigned.<br>The following line contains a single integer M(1&#x2264;M&#x2264;10<sup>5</sup>), indicating the number of queries.<br>The following M lines, each with a pair of positive integers (u,m), describe the queries. (1&#x2264;m&#x2264;10<sup>5</sup>)<br>The nodes are labeled from 1 to N.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"Output the hash code modulo 10<sup>9</sup>+7 of the maximal lexicographic Path String for each query, one per line. If it&apos;s impossible to move for m steps, output IMPOSSIBLE.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n6\n1 2 a\n1 3 b\n2 4 c\n2 5 b\n2 6 c\n3\n1 1\n1 2\n3 1</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n2\nIMPOSSIBLE\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nThe answer to the first two queries are respectively &quot;b&quot; and &quot;ac&quot;. Note that &quot;ac&quot; and &quot;c&quot; have the same code under the 26-base transformation.\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2013+Multi-University+Training+Contest+1&amp;source=1&amp;searchmode=source\"> 2013 Multi-University Training Contest 1 </a> ","type":"source","format":"html","require":["katex"]}]}