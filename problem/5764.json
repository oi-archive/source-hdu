{"title":"After a Sleepless Night","time_limit":1000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5764","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5764&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5764","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5764"},"statement":[{"title":"Problem Description","content":"The yearly Multi-University Training Contest is coming, and ?? had already prepared an interesting and challenging problem for all those intelligent brains. However, when he told teammates about his &#x201C;wonderful idea&#x201D;, it really shocked him that all of them, except himself, had already seen an existing problem with the same trick.So he need to rack his brain again.<br>But nothing is difficult for a willing heart. After thinking about it all through the night, he came up with a new problem: <br>The original rooted tree has n nodes, numbered from 1 to n. Each node has a value, all of these values form a permutation of [1,n]. We reset these values by the following way: <br><br>new value(P) = max{previous value(Q)|Q is in the subtree with root P}<br><br> Given the new tree(each node&#x2019;s number, it&#x2019;s neighbors and it&#x2019;s value), your job is to restore its original appearance.<br><b> Note that the  root of the given tree is unspecified.</b><br>","type":"description","format":"html"},{"title":"Input","content":"First line gives the number of test cases T. <br>Each cases begins with n(the number of nodes).Next line gives n integers, the i&#x2019;th integers means i-th node&#x2019;s value. Then n-1 lines, each line has two integers a and b, describes the edge connecting node a and node b..<br>T&lt;=20, 1&lt;=n&lt;=100000. All node&#x2019;s values are in range [1,n]. The given edges construct a tree of nodes 1 to n.Sum of n in all cases&lt;=200000.<br>There may be blank lines before each case. <br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, first output &quot;Case #x: &quot;.If it&#x2019;s impossible to restore the original tree, output &#x201C;Impossible&#x201D;. Otherwise, output original values of nodes 1,2,...n in order, separated by spaces.If there exist multiple answers, the lexicographically smallest one is needed.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n\n2\n2 2\n1 2\n\n3\n3 1 2\n1 2\n2 3</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1: 1 2\nCase #2: Impossible\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\n<b>In first case, both nodes can be chosen as the root. If we choose node 1, its value must be 1, and node 2 have value 2. So the answer is &#x201D;1 2&#x201D;.\nIn the second, by enumerating all situations, we can easily find that there is no proper original tree.\n</b>\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Author","content":"FZU","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2016+Multi-University+Training+Contest+4&amp;source=1&amp;searchmode=source\"> 2016 Multi-University Training Contest 4 </a> ","type":"source","format":"html"}]}