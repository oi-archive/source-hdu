{"title":"Network","time_limit":10000,"memory_limit":96,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3027","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3027&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3027","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3027"},"statement":[{"title":"Problem Description","content":"There is a network which is a completely binary tree. In the network, there are 2N users numbered from 1, 2, 3, 4, ... 2N, which are the leaves in the network-tree. For example, Figure 1 is a network-tree. In the tree, there are 8 users (leaf nodes) and 7 transmitters (gray nodes).<br><center><img style=\"max-width:100%;\" src=\"../../../data/images/exe3027-1.JPG\"></center><br>Using network-tree means that you have to pay a cost for it. The charging way is so interesting, named &quot;pair charging&quot;. The cost you must pay is the sum of cost from every pair of user i and user j ( 1 &#x2264; i &lt; j &#x2264; 2N). Every user can choose mode A or mode B to pay for the charge.<br><br>For every two users i, j (1 &#x2264; i &lt; j &#x2264; 2N), first find their LCA (The Least Common Ancestors): Transmitter P. Then count the number of mode A users in the tree of ROOT transmitter P, so do mode B.<br><br>Next, let&apos;s name the number nA and nB and at last charge the cost.<br><br>f[i][j] is the flow between user i and user j.<br><br>The charging way is followed:<br><center><img style=\"max-width:100%;\" src=\"../../../data/images/exe3027-2.JPG\"></center><br>At first, every user has an initial mode, A or B. However, they want to reduce the cost, so a part of them would change the mode from A to B, or from B to A. Every change will have an extra cost. If user i changes his mode, he will pay Ci cost.<br><br>Now, you should find the minimum cost, that is, the sum of the cost having to pay for and the extra cost of changing mode. ","type":"description","format":"html"},{"title":"Input","content":"First line, an integer N (N &#x2264; 10).<br><br>Sencond line, 2N integers, ith integer stands for ith user&apos;s initial mode. 0 is mode A, 1 is mode B.<br><br>Third line, 2N integers, ith integer stands for Ci, the cost that ith user changes his mode. (0 &#x2264; Ci &#x2264; 500 000)<br><br>Next 2N - 1 line, describe the flow of every pair of users. The i + 3 th line&apos;s (in the whole input) j row&apos;s integer standing for the f[i][j + i]. (1 &#x2264; i &#x2264; 2^N ,1 &#x2264; j &#x2264; 2^N - i, 0 &#x2264; f[i][j] &#x2264; 500). ","type":"input_format","format":"html"},{"title":"Output","content":"Only a single integer, standing for the minimum cost above.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2 \n1 0 1 0 \n2 2 10 9\n10 1 2 \n2 1 \n3</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">8\n\nExplanation: Changing the user 1&apos;s mode from B to A will minimumize the cost. </div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2009+Multi-University+Training+Contest+6+-+Host+by+WHU&amp;source=1&amp;searchmode=source\"> 2009 Multi-University Training Contest 6 - Host by WHU </a> ","type":"source","format":"html"}]}