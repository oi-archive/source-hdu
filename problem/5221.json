{"title":"Occupation","time_limit":6000,"memory_limit":128,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5221","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5221&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5221","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5221"},"statement":[{"title":"Problem Description","content":"Miceren finds a huge country named HY. HY has $N$ cities numbered from 1 to $N$ connected by $N~-~1$ bidirectional roads. There exists a path between any two cities. <br><br>It can be imagined as a tree with $n$ vertices rooted at vertex 1.<br><br>Miceren wants to occupy some cities here. Each city has a value $v_i$. (Notice that the value of a city may be negative. Nevertheless, Miceren wants to occupied this city.) <br><br>As some usual stories, someone named Cloud wants to &quot;steal&quot; some cities from Miceren. <br><br>At the beginning, Miceren and Cloud don&apos;t occupy any city. <br><br>In the following $Q$ days, one of three events may happen<br><br>1. Miceren will walk from the a-th city to the b-th city and all cities visited in this trip will belong to Miceren. ($1~\\le~a, b~\\le~N$)<br><br>2. Cloud will steal the x-th city. If Miceren occupied the x-th city before, Miceren will lost the control of this city. ($1~\\le~x~\\le~N$)<br><br>3. Miceren will occupy the subtree rooted at x.($1~\\le~x~\\le~N$)<br><br>As Miceren&apos;s friend, you must tell Miceren the total value of all cities which belong to Miceren after each day.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line contains a single integer $T$, indicating the number of test cases.<br><br>Each test case begin with one integer $N$, indicating the number of cities in HY. <br><br>The next line contains $N$ integer $V_i$, indicating the value of each city. <br><br>The next $N~-~1$ lines contain the details of the roads. Each line contains two integers $u,~v$ meaning that there is a road between cities $u$ and $v$. <br><br>The next line contains one integer $Q$. <br><br>The next $Q$ lines contain the details of event. If the format is &quot;1 a b&quot;, it means the first event happened where Miceren walks from a-th city to b-th city. If the format is &#x201C;2 x&#x201D;, it means the second event happened where Cloud &quot;steal&quot;s the x-th city. Otherwise the format is &#x201C;3 x&#x201D; and the third event happened where Micron occupied the subtree rooted at x.<br><br>$T$ is about 100.<br><br>$1~\\le~N, Q~\\le~100000.$<br><br>$-1000~\\le~V_i~\\le~1000.$<br><br>The ratio of test cases with $N~\\gt~100$ is less than 5%.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test queries, print the answer.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n10\n1 2 3 4 5 6 7 8 9 10 \n1 2\n1 3\n2 4\n2 5\n5 9\n5 10\n3 6\n3 7\n3 8\n6\n1 10 4\n1 9 7\n2 5\n3 4\n2 4\n1 6 10</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">21\n41\n36\n36\n32\n43\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>If you need a larger stack size, \nplease use #pragma comment(linker, &quot;/STACK:102400000,102400000&quot;) and submit your solution using C++.</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=%C8%FC%C2%EB%26quot%3BBestCoder%26quot%3B%B1%AD%D6%D0%B9%FA%B4%F3%D1%A7%C9%FA%B3%CC%D0%F2%C9%E8%BC%C6%B9%DA%BE%FC%C8%FC&amp;source=1&amp;searchmode=source\"> &#x8D5B;&#x7801;&quot;BestCoder&quot;&#x676F;&#x4E2D;&#x56FD;&#x5927;&#x5B66;&#x751F;&#x7A0B;&#x5E8F;&#x8BBE;&#x8BA1;&#x51A0;&#x519B;&#x8D5B; </a> ","type":"source","format":"html","require":["katex"]}]}