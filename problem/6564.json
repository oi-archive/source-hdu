{"title":"Wheel of Fortune","time_limit":8000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6564","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6564&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6564","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6564"},"statement":[{"title":"Problem Description","content":"<i>The Wheel of Fortune reminds you that the wheel is always turning and life is in a state of constant change. If you&#x2019;re going through a difficult time right now, rest assured it can only get better from here and soon you will be blessed with good luck and good fortune. Similarly, if things are going amazingly well, know that this too will change and life may return to &#x2019;normal&#x2019; soon after. This is why it is so important to cherish the blissful moments in your life and make the most of them while they are within reach &#x2013; because in a flash they could be gone.</i><br><br>Alice wants to make a wheel and decorate it with a circle of jewels. She has $n$ different jewels each of which can be colored in $m$ colors. The arrangement of Jewels always symbolizes fortune. Specifically, when the $i$-th jewel is colored with the $c_i$-th color, it is attached with $a_i$,$c_i$ amount of luck. After coloring all the $n$ jewels, she needs to arrange them in some order $k_1$, $k_2$, &#xB7; &#xB7; &#xB7; , $k_n$(a permutation) such that no two adjacent jewels on the wheel are of the same color. Otherwise she may encounter disasters. Alice enjoys peaceful life and wants to find the minimum possible |max{$a_{k_i}$,$c_{k_i}$|1 &#x2264; $i$ &#x2264; $n$} - min{$a_{k_i}$,$c_{k_i}$|1 &#x2264; $i$ &#x2264; $n$}from all the valid arrangements.","type":"description","format":"html"},{"title":"Input","content":"The input starts with a line containing a number $T$ which indicates the number of test cases. Each test case starts with a line containing two numbers $n$ (2 &#x2264; $n$ &#x2264; 2000) and $m$ (1 &#x2264; $m$ &#x2264; 2000) which indicate the number of jewels and colors respectively. Then n lines follow and each contains m numbers indicating $a_{i,j}$ (1 &#x2264; $a_{i,j}$ &#x2264; 1000000)","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, please print only one line in the form of &#x201C;Case $x$: $ans$&#x201D;, where $x$ is the test number and $ans$ indicates the answer. If it is impossible for Alice to find a valid arrangement, the answer is -1.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n4 2\n1 2\n2 1\n1 1\n2 2\n4 3\n8 3 7\n2 6 7\n2 7 3\n5 6 3</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1: 1\nCase 2: 1\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nThe following picture is the illustration of the samples, in which numbers and shapes indicate indexes of jewels and their colors separately.\nIn the first sample, we use the first color to color the jewels with indexes 1 and 3, and color the others with the second color.\nIn the second sample, we use the second color to color the jewel with index 1, the first color to color the jewels with indexes 2 and 3, and the third one to color the jewel with index 4.\nThe orders of jewels are illustrated below.\n<center><img src=\"../../../data/images/C642-1010-1.JPG\"></center> \n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=642ccpc%BC%AA%C1%D6&amp;source=1&amp;searchmode=source\"> 642ccpc&#x5409;&#x6797; </a> ","type":"source","format":"html"}]}