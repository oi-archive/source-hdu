{"title":"Kingdom","time_limit":3000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6587","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6587&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6587","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6587"},"statement":[{"title":"Problem Description","content":"Tom and Jerry were sent to a kingdom for some intelligence purpose. They were ordered to draw a map of the kingdom.<br>It&apos;s known that the kingdom consists of $n$ cities, numbered from $1$ to $n$, along with $n-1$ bidirectional roads connecting them. The cities form a binary tree, whose root is the kingdom&apos;s capital. The nodes on the tree either have no child, or a single left child, or a single right child, or both.<br>To avoid being caught spying, the commander ordered Tom and Jerry not to directly draw the map, but to record some specific information separately, which combined can deduce what the kingdom looks like.<br>When on a tree node, Tom was ordered to:<br>1. Record the label of current node.<br>2. Go to left child node(if any).<br>3. Go to right child node(if any).<br>Jerry was ordered to:<br>1. Go to left child node(if any).<br>2. Record the label of current node.<br>3. Go to right child node(if any).<br>But things often go south in Tom and Jerry&apos;s lives. When returned homeland with their information, they found that some of the numbers they wrote down are spotted. In despair, they decide to calculate how many kinds of form can the kingdom be according to the remaining information. As the number is large, you are only required to print it mod $998244353$.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line contains an integer $T(1\\le T\\le 10)$, the number of test cases. Then $T$ cases follow.<br>For each test case:<br>In the first line, a integer $n(1\\le n\\le 100)$, the number of cities in the kingdom.<br>In the second line, $n$ integers $a_1,a_2,a_3,...,a_n$ separated by space, Tom&apos;s sequence.<br>In the third line, $n$ integers $b_1,b_2,b_3,...,b_n$ separated by space, Jerry&apos;s sequence($0\\le a_i,b_i\\le n$).<br>The spotted numbers are indicated by $0$.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, output one line containing one integer, the number of corresponding kingdom&apos;s form mod $998244353$.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n3\n1 0 0\n0 0 1</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">4\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nHere are the 4 possible forms.\n<center><img src=\"../../../data/images/C722-1010-1.png\"></center> \n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2019+Multi-University+Training+Contest+1&amp;source=1&amp;searchmode=source\"> 2019 Multi-University Training Contest 1 </a> ","type":"source","format":"html","require":["katex"]}]}