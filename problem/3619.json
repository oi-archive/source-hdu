{"title":"Heroes of Might and Magic","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3619","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3619&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3619","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3619"},"statement":[{"title":"Problem Description","content":"After a very long journey and uncountable number of uphill battles, hero Raelag (who is the transformed Agrael, notice that &quot;Raelag&quot; is an anagram of &quot;Agrael&quot;) finally find the map shows where the &quot;Holy Cap&quot; is. Now he is going to find the treasure. <br><br>The map is made up of squares of equal size which are arranged in r rows and c columns. At the beginning, Raelag is at the square Labeled &apos;S&apos;, and the &quot;Holy Cap&quot; is at the square Labeled &apos;T&apos;. It is guarranteed that there is only one &apos;S&apos; and only one &apos;T&apos; in a map. Squares that labeled with &apos;#&apos; in the map means squares that can&apos;t be passed; &apos;.&apos; means roads that can be passed without any physical loss and squares that labeled with an integer i (1 &#x2264; i &#x2264; 9) means when Raelag pass through this square, he will suffer i points of physical loss. Squares that labeled with capital letter &apos;A&apos;, &apos;B&apos;, &apos;C&apos;, &apos;D&apos; or &apos;E&apos; means doors that can be passed only if Raelag has the right key (There are at most 5 kinds of doors in a map). The squares labeled with &apos;S&apos;, &apos;T&apos; and other capital letters all can be passed with out physical loss. Raelag can move to squares only if that square share an edge with the square he is now in. Raelag can&apos;t move out of the map. <br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The fist line of input file contains a single integer T (1 &#x2264; T &#x2264; 10) - the number of test cases. For each test case, in the first line their are three integers: r, c and k (1 &#x2264; r, c &#x2264; 50, 0 &#x2264; k &#x2264; 5), representing the hight, length of the map and the number of kinds of doors in the map. Then there are r lines giving the map. Then k lines follows giving the position of the keys to the door &apos;A&apos;, &apos;B&apos;, &apos;C&apos;, &apos;D&apos;, and &apos;E&apos; in order. <br><br>The uperleft conner is row 1 and colomn 1. <br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, output a single integer: the minimum points of physical lose Raelag needs to suffer to find the &quot;Holy Cup&quot;. If he can&apos;t find the &quot;Holy Cap&quot; any way, output &quot;-1&quot;. <br>","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n3 3 1\nS21\n#A#\n11T\n1 3\n3 5 2\nS..A.\n##.##\n.B.AT\n3 1\n1 5</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">6\n-1</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2010+ACM-ICPC+Multi-University+Training+Contest%A3%A818%A3%A9%A1%AA%A1%AAHost+by+TJU+&amp;source=1&amp;searchmode=source\"> 2010 ACM-ICPC Multi-University Training Contest&#xFF08;18&#xFF09;&#x2014;&#x2014;Host by TJU  </a> ","type":"source","format":"html","require":["katex"]}]}