{"title":"Diamond Rush","time_limit":8000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6766","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6766&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6766","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6766"},"statement":[{"title":"Problem Description","content":"There are $n \\times n$ cells on a grid, the top-left cell is at $(1,1)$ while the bottom-right cell is at $(n,n)$. In the cell at $(i,j)$, there are $\\left(n^2\\right)^{a_{i,j}}$ diamonds.<br><br>Initially, you are at $(1,1)$, every time you can move to $(i+1,j)$ or $(i,j+1)$ from $(i,j)$ without moving out of the grid. Your destination is at $(n,n)$, so you will take exactly $2n-2$ moves. When you are at a cell, you can take all the diamonds inside this cell, including the starting point $(1,1)$ and the destination $(n,n)$.<br><br>However, some cells are blocked but you don&apos;t know which cells are blocked. Please write a program to answer $q$ queries. In each query, you will be given four integers $xl,xr,yl,yr$, you need to report the maximum number of diamonds that you can take without passing the cells $(i,j)$ such that $xl\\leq i\\leq xr$ and $yl\\leq j\\leq yr$.","type":"description","format":"html"},{"title":"Input","content":"The first line of the input contains a single integer $T$ ($1 \\leq T \\leq 5$), the number of test cases.<br><br>For each case, the first line of the input contains two integers $n$ and $q$ ($2 \\leq n \\leq 400,1\\leq q\\leq 200\\,000$), denoting the size of the grid and the number of queries.<br><br>Each of the following $n$ lines contains $n$ integers, the $i$-th line contains $a_{i,1},a_{i,2},\\dots,a_{i,n}$ ($1\\leq a_{i,j}\\leq n^2$), denoting the number of diamonds in each cell.<br><br>Each of the following $q$ lines contains four integers $xl,xr,yl$ and $yr$ ($1\\leq xl\\leq xr\\leq n,1\\leq yl\\leq yr\\leq n$), denoting each query. It is guaranteed that you can find at least one valid path in each query.","type":"input_format","format":"html"},{"title":"Output","content":"For each query, print a single line containing an integer, denoting the maximum number of diamonds that you can take. Note that the answer may be extremely large, so please print it modulo $10^9+7$ instead.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n2 2\n2 3\n1 4\n1 1 2 2\n2 2 1 1</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">276\n336</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2020+Multi-University+Training+Contest+2&amp;source=1&amp;searchmode=source\"> 2020 Multi-University Training Contest 2 </a> ","type":"source","format":"html"}]}