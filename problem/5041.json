{"title":"Just A Challenge","time_limit":10000,"memory_limit":256,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5041","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5041&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5041","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5041"},"statement":[{"title":"Problem Description","content":"   Matt receives a gift from his friend Bobo. It is a tree which has N vertices and (N - 1) edges with single character. Yes, it is the tree in computer science.<br><br>   Matt denotes the number of edges between vertices a and b as d(a, b). The string obtained by concatenating all characters from a to b is defined as s(a, b). <br><br>   Given string L and R of length M, Matt would like to know the number of (a, b) s.t.<br><br>   &#xFFFD;&#xFFFD; d(a, b) = M,<br>   &#xFFFD;&#xFFFD; L&lt;=s(a, b)&lt;=R.<br><br>   where &quot;&lt;=&quot; means lexicographical comparision.","type":"description","format":"html"},{"title":"Input","content":"   The first line of the input contains an integer T, denoting the number of testcases. Then T test cases follow.<br><br>   For each test case, the first line contains two integers N (2&lt;=N&lt;=10^5) and M (1&lt;=M&lt;N).<br><br>   Each of the following (N - 1) lines contains a<sub>i</sub>, b<sub>i</sub>, c<sub>i</sub> denoting an edge between vertex a<sub>i</sub> and b<sub>i</sub> with character c<sub>i</sub> (1&lt;=a<sub>i</sub>, b<sub>i</sub>&lt;=n).The vertices are conveniently labled with 1, 2,&#xFFFD;&#xFFFD;&#xFFFD;&#xFFFD;, n. c<sub>i</sub> is either &apos;a&apos; or &apos;b&apos;.<br><br>   The last two lines contain string L and R (|L| = |R| = M, L&lt;=R). L and R consist of &apos;a&apos; and &apos;b&apos;. ","type":"input_format","format":"html"},{"title":"Output","content":"   For each test case, output one line &quot;Case #x: y&quot;, where x is the case number (starting from 1), y is the number of (a, b).","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n2 1\n1 2 a\na\nb\n4 2\n1 2 a\n2 3 b\n3 4 a\naa\nab</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case #1: 2\nCase #2: 2\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>Please use  #pragma comment(linker, &quot;/STACK:16777216&quot;)</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2014+ACM%2FICPC+Asia+Regional+Beijing+Online&amp;source=1&amp;searchmode=source\"> 2014 ACM/ICPC Asia Regional Beijing Online </a> ","type":"source","format":"html"}]}