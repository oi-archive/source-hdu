{"title":"In Search of Gold","time_limit":4000,"memory_limit":512,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=6769","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=6769&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=6769","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=6769"},"statement":[{"title":"Problem Description","content":"Sunset got a map about an abandoned gold mine in the border town. The map shows that the gold mine consists of $n$ rooms connected by $n-1$ bidirectional tunnels, forming a tree structure. The map is so strange that on the $i$-th tunnel, there are two numbers $a_i$ and $b_i$. The only thing Sunset knows is that there are exactly $k$ tunnels whose lengths are taken from $a$ while the lengths of other $n-k-1$ tunnels are taken from $b$.<br><br>Tomorrow Sunset will explore that gold mine. He is afraid of getting lost in the gold mine, so can you please tell him the diameter of the gold mine if he is lucky enough? In other words, please calculate the minimum possible length of the diameter from the information Sunset has.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The first line of the input contains a single integer $T$ ($1 \\leq T \\leq 10\\,000$), the number of test cases.<br><br>For each case, the first line of the input contains two integers $n$ and $k$ ($2 \\leq n \\leq 20\\,000$, $0\\leq k\\leq n-1$, $k\\leq 20$), denoting the number of rooms and the parameter $k$.<br><br>Each of the following $n-1$ lines contains four integers $u_i,v_i,a_i$ and $b_i$ ($1\\leq u_i,v_i\\leq n$, $u_i\\neq v_i$, $1\\leq a_i,b_i\\leq 10^9$), denoting an bidirectional tunnel between the $u_i$-th room and the $v_i$-th room, the length of which is either $a_i$ or $b_i$.<br><br>It is guaranteed that the sum of all $n$ is at most $200\\,000$.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, output a single line containing an integer, the minimum possible length of the diameter.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n4 1\n1 2 1 3\n2 3 4 2\n2 4 3 5</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">6</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2020+Multi-University+Training+Contest+2&amp;source=1&amp;searchmode=source\"> 2020 Multi-University Training Contest 2 </a> ","type":"source","format":"html","require":["katex"]}]}