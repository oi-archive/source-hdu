{"title":"Hyperspace","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=2810","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=2810&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=2810","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=2810"},"statement":[{"title":"Problem Description","content":"Hyperspace ,A Euclidean space of dimension greater than three (the original meaning of the word hyperspace, common in late nineteenth century British books, sometimes used in paranormal context, but which has become rarer since then). Minkowski space, a concept, often referred to by science fiction writers as hyperspace that refers to the four-dimensional space-time of special relativity.<br><img style=\"max-width:100%;\" src=\"http://acm.hdu.edu.cn/data/images/C190-1002-1.jpg\"> <img style=\"max-width:100%;\" src=\"http://acm.hdu.edu.cn/data/images/C190-1002-2.jpg\"> <br>Here we define a &#xFFFD;&#xFFFD;Hyperspace&#xFFFD;&#xFFFD; as a set of points in three-dimensional space. We define a function to describe its &#xFFFD;&#xFFFD;Hyperspace Value&#xFFFD;&#xFFFD;<br><img style=\"max-width:100%;\" src=\"http://acm.hdu.edu.cn/data/images/C190-1002-3.jpg\"> <br>Every vi (0&lt;=i&lt;=k) could be describe in three-dimensional reference system, say v0 (1, 2, 3)<br>For the following question, we will have to deal with the &#xFFFD;&#xFFFD;Hyperspaces&#xFFFD;&#xFFFD;, you may assume that the number of &#xFFFD;&#xFFFD;Hyperspace&#xFFFD;&#xFFFD; is always no larger than 100.<br>As we say above, we give every &#xFFFD;&#xFFFD;Hyperspace&#xFFFD;&#xFFFD; an &#xFFFD;&#xFFFD;ID&#xFFFD;&#xFFFD; to identify it.<br>If you want to connect two points in two different &#xFFFD;&#xFFFD;Hyperspaces&#xFFFD;&#xFFFD;, it will cost you F to build the connection. F can be defined as the following expression:<br><img style=\"max-width:100%;\" src=\"http://acm.hdu.edu.cn/data/images/C190-1002-4.jpg\"><br>In addition, you can only create at most one connection between any two &#xFFFD;&#xFFFD;Hyperspaces&#xFFFD;&#xFFFD;.<br>If you want to connect two points in the same &#xFFFD;&#xFFFD;Hyperspaces&#xFFFD;&#xFFFD; whose &#xFFFD;&#xFFFD;ID&#xFFFD;&#xFFFD; is k, it will cost you G to build the connection. G can be defined as the following expression:<br><img style=\"max-width:100%;\" src=\"http://acm.hdu.edu.cn/data/images/C190-1002-5.jpg\"><br>Here <br><img style=\"max-width:100%;\" src=\"http://acm.hdu.edu.cn/data/images/C190-1002-6.jpg\"><br>Now your task is quite easy. <br>AekdyCoin gives you n &#xFFFD;&#xFFFD;Hyperspaces&#xFFFD;&#xFFFD;.<br>Then he gives you information about all the points in the &#xFFFD;&#xFFFD;Hyperspaces&#xFFFD;&#xFFFD;<br>Now he wants to know the minimal cost to connect all the points in all &#xFFFD;&#xFFFD;Hyperspaces&#xFFFD;&#xFFFD;<br><br><font color=\"#FF0000\"> you have to ensure that any two different points in the same &quot;Hyperspace&quot; could be connected directly or indirectly by the connections you build in this &quot;Hyperspace&quot;. </font> ","type":"description","format":"html"},{"title":"Input","content":"The input consists of several test cases.<br>In the first line there is an integer n (1&lt;=n&lt;=100), indicating the number of &#xFFFD;&#xFFFD;Hyperspaces&#xFFFD;&#xFFFD;<br>Then follow an integer m (1&lt;=m&lt;=100000) <br>You can assume that the number of different points in every &#xFFFD;&#xFFFD;Hyperspace&#xFFFD;&#xFFFD; is always no larger than 100.<br>The next m lines contain the descriptions of all the points<br>All the descriptions are given in the following format x,y,z,id<br>Indicating the point (x,y,z) belongs to the id &#xFFFD;&#xFFFD;Hyperspace&#xFFFD;&#xFFFD;<br>id is an integer.<br>x,y,z are all real number with at most four fractional digits.<br>-10000&lt;=x,y,z&lt;=10000,1&lt;=id&lt;=n","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output the minimal cost on a single line.<br>Please round it to four fractional digits.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n2\n1 2 1 1\n1 3 1 1</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1.0000</div></pre>","type":"example","format":"html"},{"title":"Author","content":"AekdyCoin","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=HDU+1st+%A1%B0Old-Vegetable-Birds+Cup%A1%B1+Programming+Open+Contest&amp;source=1&amp;searchmode=source\"> HDU 1st &#xFFFD;&#xFFFD;Old-Vegetable-Birds Cup&#xFFFD;&#xFFFD; Programming Open Contest </a> ","type":"source","format":"html"}]}