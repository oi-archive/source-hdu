{"title":"Farm Game","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3696","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3696&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3696","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3696"},"statement":[{"title":"Problem Description","content":"&#x201C;Farm Game&#x201D; is one of the most popular games in online community. In the community each player has a virtual farm. The farmer can decide to plant some kinds of crops like wheat or paddy, and buy the corresponding crop seeds. After they grow up, The farmer can harvest the crops and sell them to gain virtual money. The farmer can plant advanced crops like soybean, watermelon or pumpkin, as well as fruits like lychee or mango. <br><br>Feeding animals is also allowed. The farmer can buy chicken, rabbits or cows and feeds them by specific crops or fruits. For example, chicken eat wheat. When the animals grow up, they can also &#x201C;output&#x201D; some products. The farmer can collect eggs and milk from hens and cows. They may be sold in a better price than the original crops.<br><br>When the farmer gets richer, manufacturing industry can be set up by starting up some machines. For example, Cheese Machine can transfer milk to cheese to get better profits and Textile Machine can spin cony hair to make sweaters. At this time, a production chain appeared in the farm. <br><br>Selling the products can get profits. Different products may have different price. After gained some products, the farmer can decide whether to sell them or use them as animal food or machine material to get advanced products with higher price. <br><br>Jack is taking part in this online community game and he wants to get as higher profits as possible. His farm has the extremely high level so that he could feed various animals and build several manufacturing lines to convert some products to other products.<br><br>In short, some kinds of products can be transformed into other kinds of products. For example, 1 pound of milk can be transformed into 0.5 pound of cheese, and 1 pound of crops can be transformed into 0.1 pound of eggs, etc. Every kind of product has a price. Now Jack tell you the amount of every kind of product he has, and the transform relationship among all kinds of products, please help Jack to figure out how much money he can make at most when he sell out all his products.<br><br>Please note that there is a transforming rule: if product A can be transformed into product B directly or indirectly, then product B can never be transformed into product A, no matter directly or indirectly.<br><br>","type":"description","format":"html"},{"title":"Input","content":"The input contains several test cases. The first line of each test case contains an integers N (N&lt;=10000) representing that there are N kinds of products in Jack&#x2019;s farm. The product categories are numbered for 1 to N. In the following N lines, the ith line contains two real numbers p and w, meaning that the price for the ith kind of product is p per pound and Jack has w pounds of the ith kind of product.<br><br>Then there is a line containing an integer M (M&lt;=25000) meaning that the following M lines describes the transform relationship among all kinds of products. Each one of those M lines is in the format below:<br><br>K a<sub>0</sub>, b<sub>1</sub>, a<sub>1</sub>, b<sub>2</sub>, a<sub>2</sub>, &#x2026;, b<sub>k-1</sub>, a<sub>k-1</sub><br><br>K is an integer, and 2&#xD7;K-1 numbers follows K. ai is an integer representing product category number. bi is a real number meaning that 1 pound of product a<sub>i-1</sub> can be transformed into bi pound of product ai. <br><br>The total sum of K in all M lines is less than 50000.<br><br>The input file is ended by a single line containing an integer 0.<br><br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, print a line with a real number representing the maximum amount of money that Jack can get. The answer should be rounded to 2 digits after decimal point. We guarantee that the answer is less than 10^10. <br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n2.5 10\n5 0\n1\n2 1 0.5 2\n2\n2.5 10\n5 0\n1\n2 1 0.8 2\n0</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">25.00\n40.00</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2010+Asia+Fuzhou+Regional+Contest&amp;source=1&amp;searchmode=source\"> 2010 Asia Fuzhou Regional Contest </a> ","type":"source","format":"html"}]}