{"title":"Fast wyh2000 Transform","time_limit":8000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=5287","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=5287&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=5287","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=5287"},"statement":[{"title":"Problem Description","content":"Young theoretical computer scientist wyh2000 recently falls in love with some strange convolution and optimization algorithms related to them.<br><br>Given two arrays of $n$ non-negative integers $a, b$, where the indices are between $0$ and $n-1$. We define their wyh2000-convolution is an array $c$ of length $2n-1$, indices between $0$ and $2n-2$, satisfing<br>$$c_i\\equiv \\sum_{j+k=i} \\binom{i}{j} a_jb_k (mod \\ 3)$$<br><br>where $\\binom{i}{j}=\\frac{i!}{j!(i-j)!}$.Wyh2000 is looking for some algorithm called Fast Wyh2000 Transform (FWT) to solve this problem. Can you help him find it?<br>","type":"description","format":"html"},{"title":"Input","content":"The input consists of multiple datasets. The first line consists a positive integer $T$, representing the number of datasets.<br><br>The next $3T$ lines follow, each $3$ lines form a dataset. On the first line of a dataset lies a positive integer $n$. The second line contains $n$ integers $a_0, a_1, ..., a_{n-1}$, which is in the range of $[0,2]$. The third line contains $n$ integers $b_0, b_1, ..., b_{n-1}$, which is also in the range of $[0,2]$.<br><br>For pretest, $T=25, n\\le 50 000$. For $92\\%$ of the test cases, $n\\le 100$.<br><br>For final test, $T=100, n\\le 50000$. For $95\\%$ of the test cases, $n\\le 200$. For $97\\%$ of the test cases, $n\\le 10^4$.","type":"input_format","format":"html"},{"title":"Output","content":"For each dataset, output a line containing $2n-1$ integers in the range of $[0,2]$, representing $c_0, c_1, ..., c_{2n-2}$.<br><br>**please add a space after every line of your output**","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2\n4\n0 1 2 1\n1 0 1 2\n4\n1 1 1 1\n2 2 2 2</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">0 1 2 1 2 2 1 \n2 1 2 1 1 1 1\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nDon&apos;t add extra spaces after any line of your hack data. \n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=BestCoder+Round+%2348+%28%24%29&amp;source=1&amp;searchmode=source\"> BestCoder Round #48 ($) </a> ","type":"source","format":"html"}]}