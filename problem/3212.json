{"title":"Card Collection","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3212","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3212&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3212","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3212"},"statement":[{"title":"Problem Description","content":"In <i>Card Captor Sakura</i>, Sakura is a lovely girl. One day, she opens a magic box containing many cards. Every card has a respective natural force in the real world, such as wind, water, YY, LMY, and so on. Suddenly a gust of wind blows away these cards. Sakura only has a card called &#x201C;THE_WINDY&#x201D; in her hand. Sakura knows if any card is not found, disaster comes. So she must collect all the cards. Cards can only be collected one by one. Suppose there are N cards to be collected. It takes Ti to collect the ith card, 1&#x2264;i&#x2264;N. For the ith card, there is a corresponding card Pi. If card Pi has been collected, it only takes time ti to collect the ith card, where ti&lt;Ti.<br><br>Your task is to help Sakura design a schedule that takes the shortest time to collect all cards.<br>","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"The input consists of several test cases. Each test case starts with a line giving the number N of cards (1&#x2264;N&#x2264;100). Each of the next N lines describes a card.<br><br>Every card has the format: Name1 Ti Name2 ti, where Name1 and Name2 are cards&#x2019; names, consisting of uppercase letters and underlines. The length of cards&#x2019; names is no more than 20 characters. Card Name1 is a card to be collected. It takes Ti to collect Card Name1 without Card Name2. And it takes ti to collect Card Name1 with Card Name2, where ti&lt;Ti.<br><br>End of input is indicated by a line consisting of a single 0.<br>","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each test case, output a single line. Each line should give a single integer: the shortest time.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5\nTHE_FLY 67 THE_WINDY 39\nTHE_SHADOW 97 THE_WINDY 49\nTHE_WATER 139 THE_FLY 69\nTHE_RAIN 37 THE_WATER 18\nTHE_WOOD 5 THE_RAIN 1\n1\nTHE_LOOP 35 THE_LOOP 25\n0</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">176\n35</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2009+Shanghai+Network+Contest+Host+by+DHU&amp;source=1&amp;searchmode=source\"> 2009 Shanghai Network Contest Host by DHU </a> ","type":"source","format":"html","require":["katex"]}]}