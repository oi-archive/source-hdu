{"title":"ZCC loves march","time_limit":5000,"memory_limit":127.6484375,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4879","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4879&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4879","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4879"},"statement":[{"title":"Problem Description","content":"   On a m*m land stationed n troops, numbered from 1 to n. The i-th troop&apos;s position can be described by two numbers (xi,yi) (1&lt;=xi&lt;=m,1&lt;=yi&lt;=m). It is possible that more than one troop stationed in the same place.<br>   Then there are t minutes, in each minute one of the following two events will occur:<br>   (1)the x-th troop moves towards a direction( Up(U) Down(D) Left(L) Right(R))for d units;(You can suppose that the troops won&apos;t move out of the boundary)<br>   (2)the x-th troop needs to regroup the troops which stations in the same row or column with the x-th troop. That is, these troops need to move to the x-th troop&apos;s station.<br>   Suggest the cost of i-th troop moving to the j-th troop is (xi-xj)^2+(yi-yj)^2, every time a troop regroups, you should output the cost of the regrouping modulo 10^9+7.<br>","type":"description","format":"html"},{"title":"Input","content":"   The first line: two numbers n,m(n&lt;=100000,m&lt;=10^18)<br>   Next n lines each line contain two numbers xi,yi(1&lt;=xi,yi&lt;=m)<br>   Next line contains a number t.(t&lt;=100000)<br>   Next t lines, each line&apos;s format is one of the following two formats:<br>    (1)S x d, S&#x2208;{U,L,D,R}, indicating the first event(1&lt;=x&lt;=n,0&lt;=d&lt;m)<br>    (2)Q x, indicating the second event(1&lt;=x&lt;=n)<br>   In order to force you to answer the questions online, each time you read x&apos;, x=x&apos;&#x2295;lastans(&quot;&#x2295;&quot; means &quot;xor&quot;), where lastans is the previous answer you output. At the beginning lastans=0. <br>","type":"input_format","format":"html"},{"title":"Output","content":"   Q lines, i-th line contain your answer to the i-th regrouping event.(modulo 10^9+7)","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5 3\n1 3\n2 1\n2 2\n2 3\n3 2\n6\nQ 1\nL 0 2\nL 5 2\nQ 5\nR 3 1\nQ 3</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n1\n7\n\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>The input after decode:\nQ 1\nL 1 2\nL 4 2\nQ 4\nR 2 1\nQ 2\n <center><img src=\"../../data/images/C503-1008-1.png\"></center>  </div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Author","content":"&#x9547;&#x6D77;&#x4E2D;&#x5B66;","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2014+Multi-University+Training+Contest+2&amp;source=1&amp;searchmode=source\"> 2014 Multi-University Training Contest 2 </a> ","type":"source","format":"html"}]}