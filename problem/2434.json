{"title":"Let's play UNO","time_limit":1000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=2434","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=2434&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=2434","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=2434"},"statement":[{"title":"Problem Description","content":"Uno is a famous card game played with a specially printed deck. It&apos;s very<br>popular as a funny game in a party. <br>A so-called &quot;official rules&quot; is presented at the Wikipedia, but there are a lot of different extended rules all over the <br>world according to their specific needs. <br><br><img style=\"max-width:100%;\" src=\"../../../data/images/C143-1007-1.jpg\"><br><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;In this problem, you are required to obey our rules introduced below:<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;The Uno deck consists of cards of 4 colors: red(R), green(G), blue(B), and yellow(Y). <br>Each color has two kinds of cards, number cards and action cards. <br>The ranks in number cards are 0-9. There are 3 &quot;action&quot; cards in each color, labeled &quot;skip&quot;(S), &quot;draw two&quot;(D), and &quot;reverse&quot;(R). <br>The functions of the actions will be described afterwards. <br>For each color, there are two copies of each positive number card and action card, but only one zero card, producing 25 cards in total.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;Besides, there are also special black action cards called &quot;wild cards&quot;, &quot;wild&quot;(WC) and &quot;wild draw four&quot;(WF). <br>There are four &quot;wild&quot; and &quot;wild draw four&quot; cards each. Hence, there are 108 cards in total.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;In this problem, a card is marked with an ID of two characters length, the first is the color (R, G, B, Y, W) while the second is the rank (0-9, S, D, R, C, F). <br>For example, the ID of red 2 is R2, the yellow reverse is YR, the wild cards are WC and WF.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;Supposed there are n players numbered from 1 to n clockwise. <br>Before playing, players take turns(in the order of 1, 2, ... n) to pick seven successive cards from the stock. <br>The top card of the remaining stock is exposed to start the game, treated as if player 1 dropped that card. <br>The exposed card will never be WC or WF in this problem. <br>Then the game begins clockwise (next player is 2), or counter-clockwise (next player is n) if the top exposed card is a reverse. <br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;At each turn, a player may drop a card from their hand that matches the color or rank of the top exposed card (e.g., if the top card is R3, you can drop R5 or G3; <br>if the top card is RD, you can drop R3 or GD) or play a WC. <br>What&apos;s more, if the player has a WF and no other legal cards to drop, he can drop the WF. <br>Then the card dropped just now becomes the top exposed card.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;If a player has no legal cards, he must draw the top card of the stock and place it in his hand. <br>After dropping a single card or drawing, the next player clockwise takes a turn, or counter-clockwise when the reverse is in effect.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;When a player drops down to only one card, that player is required to say &quot;uno&quot; to warn other players. <br>The game ends when a player drops all his/her cards, or the stock is emptied but the current player has to draw a card. <br>If the last card is an action card, the special effect still occurs.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;When the game ends, all players count the number of points pertaining to the values of the cards in their hands. <br>Number cards worth the face value on them, colored special cards worth twenty, and wilds worth fifty, e.g., R2 worth 2, G0 worth 0, BD and YS worth 20, WC and WF worth 50.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;The descriptions of the action cards:<br><br> <img style=\"max-width:100%;\" src=\"../../../data/images/C143-1007-2.jpg\"><br><br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;Now here comes the problem. <br>There are N people playing Uno under the rules mentioned above. Given the sequence of the 108 cards of the stock, you are asked to simulate a Uno game. <br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;At each turn, the player will always drop a card if permitted. <br>If there are more than one choices, the player will drop the card with the largest point. <br>If still a tie, he will choose the one whose ID is the smallest alphabetical order.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;When a player drops WC or WF, he has to name a color. <br>The first time he will name red, the second time he will name green, the third time blue, the fourth time yellow, the fifth time red again, and so on.<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;When the game ends, you should output the final score of each player, and we also want to know how many times each player calls &quot;Uno&quot;. <br>","type":"description","format":"html"},{"title":"Input","content":"The first line of the input file contains a single number: the number of test <br>cases to follow. Each test case has two lines:<br>The first line contains the number of players N , with 2&lt;=N&lt;=10.<br>The second line contains 108 IDs of the Uno cards, separated by one space. <br>Each ID is two characters long as introduced in the description above.<br>","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, output two lines:<br>The first line are N integers, the ith integer is the final score of player i.<br>The second lines are also N integers, the ith integer shows how many times<br>player i calls &quot;Uno&quot;.<br>","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">1\n2\nR9 RD RD RS RS RR RR \nB0 B1 B1 B2 B2 B3 B3 \nG0 GD GD GS GS GR GR G9 G9 G8 G8 G7 G7 G6 G6 G5 G5 G4 G4 G3 G3 G2 G2 G1 G1 \nY0 Y9 Y9 Y8 Y8 Y7 Y7 Y6 Y6 Y5 Y5 Y4 Y4 Y3 Y3 Y2 Y2 Y1 Y1 YD YD YS YS YR YR \nR9 R8 R8 R7 R7 R6 R6 R5 R5 R4 R4 R3 R3 R2 R2 R1 R1 R0 \nB4 B4 B5 B5 B6 B6 B7 B7 B8 B8 B9 B9 BD BD BS BS BR BR \nWC WC WC WC WF WF WF WF</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">249 0\n0 1\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>\nThe process of this game is:\nG0(exposed) \n-&gt; B0(Player 2)\t\t-&gt; Draw GD(Player 1)\t\t-&gt; B3(Player 2) \n-&gt;Draw GD(Player 1)\t-&gt; B3(Player 2) \t\t\t-&gt; Draw GS(Player 1)\n-&gt; B2(Player 2)\t\t-&gt; Draw GS(Player 1)\t\t-&gt; B2(Player 2)\n-&gt; Draw GR(Player 1)\t-&gt; B1, call &#xFFFD;&#xFFFD;Uno&#xFFFD;&#xFFFD;(Player 2)\t-&gt; Draw GR(Player 1) \n-&gt; B1(Player 2), end.\nScore of player 1: 20*12(6 red action cards and 6 green action cards)+9(R9)\n\n</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2008+Asia+Chengdu+Regional+Contest+Online&amp;source=1&amp;searchmode=source\"> 2008 Asia Chengdu Regional Contest Online </a> ","type":"source","format":"html"}]}