{"title":"Defence of the Trees","time_limit":10000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4892","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4892&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4892","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4892"},"statement":[{"title":"Problem Description","content":"   There are n trees (each of them can be considered as a point) on a two-dimensional coordinate system. There are k categories of trees, category of the i<sup>th</sup> tree are represented by A<sub>i</sub>. There are also m stumps (each of them can be considered as a point, too) on this two-dimensional coordinate system. Stumps can be connected with straight wires.<br><br>   Your task is to connect some of the stumps by wires to build exactly one simple polygon (that is, a polygon without self-intersection and degeneration) which contains trees of all k categories inside. Meanwhile, in order to save money, you should make the total length of wires as short as possible. Your task is to calculate the shortest total length of wires, or to determine that there is no solutions.","type":"description","format":"html"},{"title":"Input","content":"   There are several testcases, please process till EOF.<br><br>   In each testcases:<br>   First one line, three numbers n, m, k. Following n lines contains n 2D-coordinates describing each tree. Next one line contains n number, where i<sup>th</sup> number A<sub>i</sub> denotes i<sup>th</sup> tree&apos;s category. Next m lines describe the coordinates of stumps, you may assume that there is no trees lying on segments between any two stumps.<br><br>   All input will be integer, and absolute value of them will be less than 23333, 1 &#x2264; n &#x2264; 300, 1 &#x2264; m &#x2264; 40,  1 &#x2264; k &#x2264; 6,1 &#x2264; A<sub>i</sub> &#x2264; k.In about 90% of testcases,m &#x2264; 10.","type":"input_format","format":"html"},{"title":"Output","content":"   For each testcase, print one line, if there is no solutions, Output &quot;Impossible&quot; (without quotes), else output a real number indicating the minimal total length. Your answer will be considered correct if and only if the absolute error or relative error are less than 10<sup>-6</sup>.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2 4 1  \n0 0  \n2 0  \n1 1  \n1 -1  \n1 1  \n-3 -1  \n5 1  \n2 4 2  \n0 0  \n2 0  \n1 2  \n1 -1  \n1 1  \n-3 -1  \n5 1  </div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">10.472135955000  \n16.944271909999  </div></pre>","type":"example","format":"html"},{"title":"Author","content":"Fudan University","type":"source","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2014+Multi-University+Training+Contest+3&amp;source=1&amp;searchmode=source\"> 2014 Multi-University Training Contest 3 </a> ","type":"source","format":"html"}]}