{"title":"GemAnd Prince","time_limit":5000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4090","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4090&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4090","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4090"},"statement":[{"title":"Problem Description","content":"Nowadays princess Claire wants one more guard and posts the ads throughout the kingdom. For her unparalleled beauty, generality, goodness and other virtues, many people gather at the capital and apply for the position. Because princess Claire is very clever, she doesn&apos;t want a fool to be her guard. As Claire is clever, she invents a game to test the applicants. The game is described as follows.<br>The game begins with a rectangular board of n rows and m columns, containing n*m grids. Each grid is filled with a gem and each gem is covered by one color, denoted by a number.(as the following shows).<br><center><img style=\"max-width:100%;\" src=\"../../data/images/4090-1.jpg\"></center> <br><center><img style=\"max-width:100%;\" src=\"../../data/images/4090-2.jpg\"></center> <br><center><img style=\"max-width:100%;\" src=\"../../data/images/4090-3.jpg\"></center> <br><center><img style=\"max-width:100%;\" src=\"../../data/images/4090-4.jpg\"></center> <br><br>If a gem has the same color with another one, and shares the same corner or the same border with it, the two are considered to be adjacent. Two adjacent gems are said to be connective. And we define that if A and B are connective, B and C are connective, then A and C are connective, namely the adjacency is transitive. Each time we can choose a gem and pick up all of the gems connected to it, including itself, and get a score equal to the square of the number of the gems we pick this time(but to make the game more challenging, the number of gems to be picked each time must be equal or larger than three).Another rule is that if one gem is picked, all the gems above it(if there is any)fall down to fill its grid,and if there is one column containing no gems at all, all the columns at its right(also if there is any) move left to fill the column. These rules can be shown as follows.<br><center><img style=\"max-width:100%;\" src=\"../../data/images/4090-5.jpg\"></center> <br><br>As the picture [a] above,all the gems that has color 1 are connective. After we choose one of them to be picked, all the gems that are connected to it must also be picked together, as the picture [b] shows (here we use 0 to denote the holes generated by the absence of gems).<br>Then the rest gems fall, as shown in picture [c]. Then the rest gems move left, as shown in picture [d]. Because we picked six gems at this time, our score increases 6*6=36.And furthermore, because we cannot find another gem, which has at least three gems connected to it(including itself),to be picked, the game comes to an end.<br>Each applicant will face such a board and the one who gets the highest score will have the honor to serve princess Claire. <br>Aswmtjdsj also wants to serve for princess Claire. But he realizes that competing with so many people, even among whom there are powerful ACMers, apparently there is little chance to succeed. With the strong desire to be the lucky dog, Aswmtjdsj asks you for help. Can you help make his dream come true?","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"There are no more than 15 test cases, separated by a blank line, end with EOF. Each case has n+1 lines, the first line of a case has three integers n, m, k (1&lt;=n, m&lt;=8, 1&lt;=k&lt;=6). Each of the next n lines contains m integers. The integer at (i+1)th line and jth column denotes the color of the gem at the grid (i, j), where the grid(1, 1) denotes the top left one, while the grid(n, m) is the lower right one. The integer in the grid is among [1, k].","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"For each case you should output the highest score you can get in one single line.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3 3 3\n1 1 3\n1 2 1\n1 1 2\n\n5 4 3\n2 2 3 3\n1 1 3 3\n3 2 2 2\n3 1 1 1\n3 1 2 2</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">36\n103</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2011+Asia+Beijing+Regional+Contest+&amp;source=1&amp;searchmode=source\"> 2011 Asia Beijing Regional Contest  </a> ","type":"source","format":"html","require":["katex"]}]}