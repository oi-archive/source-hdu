{"title":"Min-max-multiply","time_limit":5000,"memory_limit":63.9990234375,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=4817","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=4817&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=4817","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=4817"},"statement":[{"title":"Problem Description","content":"MMM is solving a problem on an online judge, but her solution got TLE (Time limit exceeded). Here is her submitted Java solution:<br><br>public class PleaseUseProperClassNameAccordingToYourContestEnvironment {<br>&#xA0;&#xA0;private static Scanner cin;<br>&#xA0;&#xA0;private static int n;<br>&#xA0;&#xA0;private static char[] command;<br>&#xA0;&#xA0;private static long[] arr;<br>&#xA0;&#xA0;private static long minValue, maxValue;<br>&#xA0;&#xA0;public static void read() {<br>&#xA0;&#xA0;&#xA0;&#xA0;n = cin.nextInt();<br>&#xA0;&#xA0;&#xA0;&#xA0;minValue = cin.nextLong();<br>&#xA0;&#xA0;&#xA0;&#xA0;maxValue = cin.nextLong();<br>&#xA0;&#xA0;&#xA0;&#xA0;command = new char[n];<br>&#xA0;&#xA0;&#xA0;&#xA0;arr = new long[n];<br>&#xA0;&#xA0;&#xA0;&#xA0;cin.nextLine();<br>&#xA0;&#xA0;&#xA0;&#xA0;String[] tokens = cin.nextLine().split(&quot; &quot;);<br>&#xA0;&#xA0;&#xA0;&#xA0;for (int i = 0; i &lt; n; i++) {<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;command[i] = tokens[i].charAt(0);<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;arr[i] = Long.valueOf(tokens[i].substring(1));<br>&#xA0;&#xA0;&#xA0;&#xA0;}<br>&#xA0;&#xA0;}<br><br>&#xA0;&#xA0;public static void go() {<br>&#xA0;&#xA0;&#xA0;&#xA0;int numQuery = cin.nextInt();<br>&#xA0;&#xA0;&#xA0;&#xA0;long ans = 0;<br>&#xA0;&#xA0;&#xA0;&#xA0;long y, y0;<br>&#xA0;&#xA0;&#xA0;&#xA0;for (int i = 0; i &lt; numQuery; i++) {<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;y0 = cin.nextLong();<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;y = y0;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;for (int j = 0; j &lt; n; ++j) {<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;switch (command[j]) {<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;case &apos;+&apos;:<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;y += arr[j];<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;break;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;case &apos;-&apos;:<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;y -= arr[j];<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;break;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;case &apos;*&apos;:<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;y *= arr[j];<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;break;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;case &apos;@&apos;:<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;y += y0 * arr[j];<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;y = Math.min(maxValue, y);<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;y = Math.max(minValue, y);<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;ans += y;<br>&#xA0;&#xA0;&#xA0;&#xA0;}<br>&#xA0;&#xA0;&#xA0;&#xA0;System.out.println(ans);<br>&#xA0;&#xA0;}<br><br>&#xA0;&#xA0;public static void main(String argv[]) throws IOException {<br>&#xA0;&#xA0;&#xA0;&#xA0;cin = new Scanner(System.in);<br>&#xA0;&#xA0;&#xA0;&#xA0;int numTest = cin.nextInt();<br>&#xA0;&#xA0;&#xA0;&#xA0;while (numTest-- &gt; 0) {<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;read();<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;go();<br>&#xA0;&#xA0;&#xA0;&#xA0;}<br>&#xA0;&#xA0;}<br>}<br><br>She thought that maybe this is due to the slowness of Java compared to C++. So she changed her program into C++, however, she got TLE again:<br><br>const int kMaxN = 1000000;<br>char command[kMaxN];<br>long long arr[kMaxN];<br>int main() {<br>&#xA0;&#xA0;int num_case = 0;<br>&#xA0;&#xA0;scanf(&quot;%d&quot;, &amp;num_case);<br>&#xA0;&#xA0;assert(1 &lt;= num_case &amp;&amp; num_case &lt;= 10);<br>&#xA0;&#xA0;for (int icase = 0; icase &lt; num_case; ++icase) {<br>&#xA0;&#xA0;&#xA0;&#xA0;int n;<br>&#xA0;&#xA0;&#xA0;&#xA0;long long min_value, max_value;<br>&#xA0;&#xA0;&#xA0;&#xA0;scanf(&quot;%d%lld%lld&quot;, &amp;n, &amp;min_value, &amp;max_value);<br>&#xA0;&#xA0;&#xA0;&#xA0;assert(1 &lt;= n &amp;&amp; n &lt;= 1000000);<br>&#xA0;&#xA0;&#xA0;&#xA0;assert(1 &lt;= min_value &amp;&amp; min_value &lt;= max_value);<br>&#xA0;&#xA0;&#xA0;&#xA0;assert(max_value &lt;= 10000000000LL); // 10^10<br>&#xA0;&#xA0;&#xA0;&#xA0;for (int i = 0; i &lt; n; ++i) {<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;scanf(&quot; %c%lld&quot;, command + i, arr + i);<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;assert(1 &lt;= arr[i] &amp;&amp; arr[i] &lt;= 10000000000LL); // 10^10<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;if (command[i] == &apos;*&apos; || command[i] == &apos;@&apos;) {<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;assert(arr[i] &lt;= 100000); // 10^5<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}<br>&#xA0;&#xA0;&#xA0;&#xA0;}<br>&#xA0;&#xA0;&#xA0;&#xA0;int num_query;<br>&#xA0;&#xA0;&#xA0;&#xA0;scanf(&quot;%d&quot;, &amp;num_query);<br>&#xA0;&#xA0;&#xA0;&#xA0;assert(num_query &lt;= 1000000);<br>&#xA0;&#xA0;&#xA0;&#xA0;long long ans = 0;<br>&#xA0;&#xA0;&#xA0;&#xA0;for (int iquery = 0; iquery &lt; num_query; ++iquery) {<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;long long start_value;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;scanf(&quot;%lld&quot;, &amp;start_value);<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;assert(1 &lt;= start_value &amp;&amp; start_value &lt;= 10000000000LL); // 10^10<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;long long sum = start_value;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;for (int i = 0; i &lt; n; ++i) {<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;switch(command[i]) {<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;case &apos;+&apos;:<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;sum += arr[i];<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;break;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;case &apos;-&apos;:<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;sum -= arr[i];<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;break;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;case &apos;@&apos;:<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;sum += start_value * arr[i];<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;break;<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;default:<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;assert(command[i] == &apos;*&apos;);<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;sum *= arr[i];<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;sum = min(sum, max_value);<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;sum = max(sum, min_value);<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}<br>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;ans += sum;<br>&#xA0;&#xA0;&#xA0;&#xA0;}<br>&#xA0;&#xA0;&#xA0;&#xA0;printf(&quot;%lld\\n&quot;, ans);<br>&#xA0;&#xA0;}<br>&#xA0;&#xA0;return 0;<br>}<br><br>MMM was so desperate that she asked the judge for help. The judge found out that both programs produce the correct output; however, they cannot finish execution within the time limit. Could you, our talented contestant, help her optimize the algorithm and got AC?","type":"description","format":"html"},{"title":"Input","content":"The first line of input is an integer T (0 &lt; T &#x2264; 100) indicating the number of test cases.<br><br>For each case, there are 3 integers n, min_value, max_value in the first line, which denote the number of operations, the minimum and maximum value after each operation, respectively (1 &#x2264; n &#x2264; 10^6, 1 &#x2264; min_value &#x2264; max_value &#x2264; 10^10).<br><br>Then there are n operations in the next line. Each operation is an operator, &apos;+&apos;, &apos;-&apos;, &apos;@&apos; or &apos;*&apos;, followed by a positive integer, without any spaces between them.<br><br>For operations of format +x and -x, you can assume 1 &#x2264; x &#x2264; 10^10.<br><br>And for operations of format *x and @x, you can assume 1 &#x2264; x &#x2264; 10^5.<br><br>After the line of operations, there would be an integer num_query indicating the number of queries (1 &#x2264; num_query &#x2264; 10^6).<br><br>Then num_query integers x_i follows, each of them is of range 1 &#x2264; x_i &#x2264; 10^10","type":"input_format","format":"html"},{"title":"Output","content":"For each case, output num_query numbers. Please refer to the problem statement for the meaning of the result.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">3\n\n9 1 10\n-6 +1 +2 +3 -4 *3 -5 @1 -5\n10\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n6 1 10\n-6 +1 +2 +3 -4 *3\n10\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n2 20 25\n+20 -1\n1\n3</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">36\n93\n22\n<div style=\"font-family:Times New Roman;font-size:14px;background-color:F4FBFF;border:#B7CBFF 1px dashed;padding:6px\"><div style=\"font-family:Arial;font-weight:bold;color:#7CA9ED;border-bottom:#B7CBFF 1px dashed\"><i>Hint</i></div>Don&apos;t submit your code until you believe that significant optimization over MMM&apos;s solution has been achieved.\nMMM&apos;s solution would run for an hour on our test data but we expect your solution to finish within seconds.</div><i style=\"font-size:1px\"> </i></div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2013+Asia+Regional+Changchun+&amp;source=1&amp;searchmode=source\"> 2013 Asia Regional Changchun  </a> ","type":"source","format":"html"}]}