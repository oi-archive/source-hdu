{"title":"Base Station","time_limit":2000,"memory_limit":32,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3879","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3879&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3879","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3879"},"statement":[{"title":"Problem Description","content":"A famous mobile communication company is planning to build a new set of base stations. According to the previous investigation, n places are chosen as the possible new locations to build those new stations. However, the condition of each position varies much, so the costs to built a station at different places are different. The cost to build a new station at the ith place is P<sub>i</sub> (1&lt;=i&lt;=n).<br><br>When complete building, two places which both have stations can communicate with each other.<br><br>Besides, according to the marketing department, the company has received m requirements. The ith requirement is represented by three integers A<sub>i</sub>, B<sub>i</sub> and C<sub>i</sub>, which means if place A<sub>i </sub>and B<sub>i</sub> can communicate with each other, the company will get C<sub>i</sub> profit.<br><br>Now, the company wants to maximize the profits, so maybe just part of the possible locations will be chosen to build new stations. The boss wants to know the maximum profits.","type":"description","format":"html","require":["katex"]},{"title":"Input","content":"Multiple test cases (no more than 20), for each test case:<br>The first line has two integers n (0&lt;n&lt;=5000) and m (0&lt;m&lt;=50000).<br>The second line has n integers, P1 through Pn, describes the cost of each location.<br>Next m line, each line contains three integers, A<sub>i</sub>, B<sub>i</sub> and C<sub>i</sub>, describes the ith requirement.","type":"input_format","format":"html","require":["katex"]},{"title":"Output","content":"One integer each case, the maximum profit of the company.","type":"output_format","format":"html","require":["katex"]},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">5 5\n1 2 3 4 5\n1 2 3\n2 3 4\n1 3 3\n1 4 2\n4 5 3</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">4</div></pre>","type":"example","format":"html","require":["katex"]},{"title":"Author","content":"liulibo","type":"source","format":"html","require":["katex"]},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2011+Multi-University+Training+Contest+5+-+Host+by+BNU&amp;source=1&amp;searchmode=source\"> 2011 Multi-University Training Contest 5 - Host by BNU </a> ","type":"source","format":"html","require":["katex"]}]}