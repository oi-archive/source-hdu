{"title":"Chips Challenge","time_limit":5000,"memory_limit":64,"operation":{"submit":"http://acm.hdu.edu.cn/submit.php?pid=3840","submissions":"http://acm.hdu.edu.cn/status.php?first=&pid=3840&user=&lang=0&status=0","statistics":"http://acm.hdu.edu.cn/statistic.php?pid=3840","discussion":"http://acm.hdu.edu.cn/discuss/problem/list.php?problemid=3840"},"statement":[{"title":"Problem Description","content":"A prominent microprocessor company has enlisted your help to lay out some interchangeable components (widgets) on some of their computer chips. Each chip&#xFFFD;&#xFFFD;s design is an N&#xFFFD;&#xFFFD;N square of slots. One slot can hold a single component, and you are to try to fit in as many widgets as possible.<br><br>Modern processor designs are complex, of course. You unfortunately have several restrictions:<br><ul><li> Some of the slots are disabled.</li><br><li> Some of the slots are already occupied by other components and cannot be used for widgets.</li><br><li> There are sibling memory buses connected to the horizontal and vertical edges of the chip and their bandwidth loads need to match. As such, there must be exactly as many components in the first row as in the first column, exactly as many in the second row as in the second column, and so on. Component counts include both the components already specified on the chip and the added widgets.</li><br><li> Similarly, the power supply is connected at the end of each row and column. To avoid hot spots, any given row or column must have no more than A=B of the total components on the chip for a given A and B.</li><br></ul><br><br>A specification for a chip is N lines of N characters, where &#xFFFD;&#xFFFD;.&#xFFFD;&#xFFFD; indicates an open slot, &#xFFFD;&#xFFFD;/&#xFFFD;&#xFFFD; indicates a disabled slot, and &#xFFFD;&#xFFFD;C&#xFFFD;&#xFFFD; indicates a slot already occupied by a component. For example:<br><br>CC/..<br>././/<br>..C.C<br>/.C..<br>/./C/<br><br>If no more than 3/10 of the components may be in any one row or column, the maximum number of widgets that can be added to this 5 &#xFFFD;&#xFFFD; 5 chip is 7. A possible arrangement is below, where &#xFFFD;&#xFFFD;W&#xFFFD;&#xFFFD; indicates a widget added in an open slot.<br><br>CC/W.<br>W/W//<br>W.C.C<br>/.CWW<br>/W/C/<br><br>","type":"description","format":"html"},{"title":"Input","content":"The input consists of several test cases. Each case starts with a line containing three integers: The size of the chip N (1 &lt;= N &lt;= 40), and A and B (1 &lt;= B &lt;= 1000, 0 &lt;= A &lt;= B) as described above. Each of the following N lines contains N characters describing the slots, one of &#xFFFD;&#xFFFD;.&#xFFFD;&#xFFFD;, &#xFFFD;&#xFFFD;/&#xFFFD;&#xFFFD; or &#xFFFD;&#xFFFD;C&#xFFFD;&#xFFFD;, as described above.<br>The last test case is followed by a line containing three zeros.","type":"input_format","format":"html"},{"title":"Output","content":"For each test case, display a single line beginning with the case number. If there is a solution, display the maximum number of widgets that can be added to the chip. Display &#xFFFD;&#xFFFD;impossible&#xFFFD;&#xFFFD; if there is no solution.<br>Follow the format of the sample output.","type":"output_format","format":"html"},{"title":"Sample Input","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">2 1 1\n/.\n//\n2 50 100\n/.\nC/\n2 100 100\n./\nC.\n5 3 10\nCC/..\n././/\n..C.C\n/.C..\n/./C/\n5 2 10\nCC/..\n././/\n..C.C\n/.C..\n/./C/\n0 0 0</div></pre>","type":"example","format":"html"},{"title":"Sample Output","content":"<pre><div style=\"font-family:Courier New,Courier,monospace;\">Case 1: 0\nCase 2: 1\nCase 3: impossible\nCase 4: 7\nCase 5: impossible</div></pre>","type":"example","format":"html"},{"title":"Source","content":" <a href=\"/search.php?field=problem&amp;key=2011WorldFinal&amp;source=1&amp;searchmode=source\"> 2011WorldFinal </a> ","type":"source","format":"html"}]}